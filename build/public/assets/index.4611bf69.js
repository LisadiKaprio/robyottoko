import{d as V,r as _,o as a,c as l,a as b,b as e,F as U,e as A,t as w,f as v,m as $t,w as u,v as g,g as G,h as q,i as c,j as O,n as Y,k as P,u as zt,l as F,p as W,q as H,s as _t,x as Jt,y as dt,z as j,A as Bt,B as Wt,C as Ht,D as Qt,E as Kt}from"./vendor.7107ada0.js";const Gt=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))m(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const h of y.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&m(h)}).observe(document,{childList:!0,subtree:!0});function n(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerpolicy&&(y.referrerPolicy=f.referrerpolicy),f.crossorigin==="use-credentials"?y.credentials="include":f.crossorigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function m(f){if(f.ep)return;f.ep=!0;const y=n(f);fetch(f.href,y)}};Gt();var S=(t,s)=>{const n=t.__vccOpts||t;for(const[m,f]of s)n[m]=f;return n};const Yt=V({name:"app"}),Xt={id:"app"};function Zt(t,s,n,m,f,y){const h=_("router-view");return a(),l("div",Xt,[b(h)])}var jt=S(Yt,[["render",Zt]]);const ut=async(t,s,n)=>new Promise((m,f)=>{const y=new window.XMLHttpRequest;y.open(t,s,!0),y.withCredentials=!0;const h=n.headers||{};for(const i in h)y.setRequestHeader(i,h[i]);y.addEventListener("load",function(i){m({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),y.addEventListener("error",function(i){f(new Error("xhr error"))}),y.upload&&n.onUploadProgress&&y.upload.addEventListener("progress",function(i){n.onUploadProgress&&n.onUploadProgress(i)}),y.send(n.body)}),et=async(t,s={})=>ut("get",t,s),xt=async(t,s={})=>ut("post",t,s),bt=async(t,s)=>ut("post",t,{headers:{Accept:"application/json","Content-Type":"application/json"},body:s}),K=async(t,s)=>bt(t,JSON.stringify(s));var M={resendVerificationMail:async t=>K("/api/user/_resend_verification_mail",t),requestPasswordReset:async t=>K("/api/user/_request_password_reset",t),register:async t=>K("/api/user/_register",t),resetPassword:async t=>K("/api/user/_reset_password",t),handleToken:async t=>K("/api/_handle-token",t),saveVariables:async t=>K("/api/save-variables",t),twitchUserIdByName:async t=>K("/api/twitch/user-id-by-name",t),saveUserSettings:async t=>K("/api/save-settings",t),getPageVariablesData:async()=>et("/api/page/variables"),getPageIndexData:async()=>et("/api/page/index"),getPageSettingsData:async()=>et("/api/page/settings"),getMe:async()=>et("/api/user/me"),logout:async()=>xt("/api/logout"),login:async t=>K("/api/auth",t),getConf:async()=>et("/api/conf"),upload:async(t,s)=>{const n=new FormData;return n.append("file",t,t.name),ut("post","/api/upload",{body:n,onUploadProgress:s})},importPlaylist:async t=>bt("/api/sr/import",t),getDrawcastAllImages:async()=>et("/api/drawcast/all-images/")};const te=V({data:()=>({widgets:null}),async created(){const t=await M.getPageIndexData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.widgets=s.widgets}}),ee={key:0,id:"app"},se={id:"top",ref:"top"},ne={id:"main",ref:"main"},ie={class:"table is-striped is-fullwidth"},ae=e("thead",null,[e("tr",null,[e("th",null,"Widget"),e("th",null,"Hint")])],-1),le=["href"];function oe(t,s,n,m,f,y){const h=_("navbar");return t.widgets?(a(),l("div",ee,[e("div",se,[b(h)],512),e("div",ne,[e("table",ie,[ae,e("tbody",null,[(a(!0),l(U,null,A(t.widgets,(i,r)=>(a(),l("tr",{key:r},[e("td",null,[e("a",{href:i.url,target:"blank"},w(i.title),9,le)]),e("td",null,w(i.hint),1)]))),128))])])],512)])):v("",!0)}var re=S(te,[["render",oe]]);let mt=null;const gt=$t();async function wt(){const t=await M.getMe();mt=t.status===200?await t.json():null,mt&&gt.emit("login")}async function de(){return(await(await M.logout()).json()).success?(mt=null,gt.emit("logout"),{error:!1}):{error:"[2021-09-25 18:36]"}}async function ue(t,s){const n=await M.login({user:t,pass:s});return n.status===200?(await wt(),{error:!1}):n.status===401?{error:(await n.json()).reason}:{error:"Unknown error"}}var Q={getMe:()=>mt,eventBus:gt,logout:de,login:ue,init:wt};const me=V({data:()=>({user:"",pass:"",error:"",success:""}),async mounted(){const s=new URLSearchParams(window.location.search).get("t");if(s){this.success="",this.error="";const n=await M.handleToken({token:s});n.status===200?(await n.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const t=await Q.login(this.user,this.pass);t.error?this.error=t.error:this.$router.push({name:"index"})}}}),he={class:"center-screen"},ce=e("h1",{class:"title is-6"},"Hyottoko.club",-1),pe={key:0,class:"field has-background-success-light has-text-success-dark"},ge={key:1,class:"field has-background-danger-light has-text-danger-dark"},fe={class:"field"},ve={class:"control has-icons-left"},ye=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),$e={class:"field"},_e={class:"control has-icons-left"},be=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),we={class:"field"},ke={class:"field"},Ce=c("Register an account"),Ve=c(" | "),Se=c("Forgot password?");function De(t,s,n,m,f,y){const h=_("router-link");return a(),l("div",he,[ce,e("form",null,[t.success?(a(),l("div",pe,w(t.success),1)):v("",!0),t.error?(a(),l("div",ge,w(t.error),1)):v("",!0),e("div",fe,[e("div",ve,[u(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":s[0]||(s[0]=i=>t.user=i),onKeyup:s[1]||(s[1]=i=>t.error="")},null,544),[[g,t.user]]),ye])]),e("div",$e,[e("div",_e,[u(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":s[2]||(s[2]=i=>t.pass=i),onKeyup:[s[3]||(s[3]=i=>t.error=""),s[4]||(s[4]=G((...i)=>t.submit&&t.submit(...i),["enter"]))]},null,544),[[g,t.pass]]),be])]),e("div",we,[e("span",{class:"button is-small is-primary",onClick:s[5]||(s[5]=(...i)=>t.submit&&t.submit(...i))},"Login")]),e("div",ke,[b(h,{to:{name:"register"}},{default:q(()=>[Ce]),_:1}),Ve,b(h,{to:{name:"forgot-password"}},{default:q(()=>[Se]),_:1})])])])}var Ue=S(me,[["render",De]]);const Ie=t=>t?{file:t.file,filename:t.filename,urlpath:!t.urlpath&&t.file?`/uploads/${encodeURIComponent(t.file)}`:t.urlpath}:null,Ae=t=>t?{file:t.file,filename:t.filename,urlpath:!t.urlpath&&t.file?`/uploads/${encodeURIComponent(t.file)}`:t.urlpath,volume:t.volume}:null,kt=(t=null)=>({submitButtonText:!t||typeof t.submitButtonText=="undefined"?"Submit":t.submitButtonText,submitConfirm:!t||typeof t.submitConfirm=="undefined"?"":t.submitConfirm,recentImagesTitle:!t||typeof t.recentImagesTitle=="undefined"?"":t.recentImagesTitle,canvasWidth:!t||typeof t.canvasWidth=="undefined"?720:t.canvasWidth,canvasHeight:!t||typeof t.canvasHeight=="undefined"?405:t.canvasHeight,customDescription:!t||typeof t.customDescription=="undefined"?"":t.customDescription,customProfileImage:!t||typeof t.customProfileImage=="undefined"?null:Ie(t.customProfileImage),palette:!t||typeof t.palette=="undefined"?["#000000","#808080","#ff0000","#ff8000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff8080","#80ff80","#ffffff","#c0c0c0","#800000","#804000","#808000","#008000","#008080","#000080","#800080","#8080ff","#ffff80"]:t.palette,displayDuration:!t||typeof t.displayDuration=="undefined"?5e3:t.displayDuration,displayLatestForever:!t||typeof t.displayLatestForever=="undefined"?!1:t.displayLatestForever,displayLatestAutomatically:!t||typeof t.displayLatestAutomatically=="undefined"?!1:t.displayLatestAutomatically,autofillLatest:!t||typeof t.autofillLatest=="undefined"?!1:t.autofillLatest,notificationSound:!t||typeof t.notificationSound=="undefined"?null:Ae(t.notificationSound),favoriteLists:!t||typeof t.favoriteLists=="undefined"?[{list:t&&t.favorites?t.favorites:[],title:t&&t.favoriteImagesTitle?t.favoriteImagesTitle:""}]:t.favoriteLists});let Ct=null;const Te=async()=>{const t=await M.getConf();Ct=t.status===200?await t.json():null};var Vt={init:Te,getConf:()=>Ct};const Pe=1,at=1e3*Pe,lt=60*at,ot=60*lt,ht=24*ot;let rt=[];const Ne=t=>{switch(t){case"error":rt=["error"];break;case"info":rt=["error","info"];break;case"log":rt=["error","info","log"];break;case"debug":rt=["error","info","log","debug"];break}};Ne("info");const St=(t,...s)=>{const n=t,m=f=>(...y)=>{rt.includes(f)&&console[f](Re("hh:mm:ss",new Date),`[${n}]`,...s,...y)};return{log:m("log"),info:m("info"),debug:m("debug"),error:m("error")}},Re=(t,s)=>t.replace(/(hh|mm|ss)/g,(n,m)=>{switch(m){case"hh":return ct(s.getHours(),"00");case"mm":return ct(s.getMinutes(),"00");case"ss":return ct(s.getSeconds(),"00");default:return n}}),ct=(t,s)=>{const n=`${t}`;return n.length>=s.length?n:s.substr(0,s.length-n.length)+n},ft=(t,s=!1)=>{if(t==="")throw new Error("unable to parse duration");const n=`${t}`.trim();if(!n)throw new Error("unable to parse duration");const m=d=>{if(d<0&&!s)throw new Error("negative value not allowed");return d};if(n.match(/^-?\d+$/))return m(parseInt(n,10));const f=n.match(/^(-?(?:\d*)\.(?:\d*))(d|h|m|s)$/);if(f){const d=parseFloat(f[1]);if(isNaN(d))throw new Error("unable to parse duration");const p=f[2];let C=0;return p==="d"?C=d*ht:p==="h"?C=d*ot:p==="m"?C=d*lt:p==="s"&&(C=d*at),m(Math.round(C))}const y=n.match(/^(-?)(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!y)throw new Error("unable to parse duration");const h=y[1]?-1:1,i=y[2]?parseInt(y[2],10):0,r=y[3]?parseInt(y[3],10):0,o=y[4]?parseInt(y[4],10):0,$=y[5]?parseInt(y[5],10):0,k=y[6]?parseInt(y[6],10):0;return m(h*($*at+o*lt+r*ot+i*ht+k))},Fe=(t,s=!1)=>{try{return ft(t,s)}catch{return 0}},Ee=(t,s=["ms","s","m","h","d"])=>{let n=t;const m=Math.floor(n/ht);n=n%ht;const f=Math.floor(n/ot);n=n%ot;const y=Math.floor(n/lt);n=n%lt;const h=Math.floor(n/at);n=n%at;const r=[n,h,y,f,m];let o=0;for(;o<r.length&&r[o]===0;)o++;let $=r.length-1;for(;$>=0&&r[$]===0;)$--;const k=[];for(let d=o;d<=$;d++)k.unshift(`${r[d]}${s[d]}`);return k.join(" ")};function Me(t,s,n){if(n>=t.length){let m=n-t.length+1;for(;m--;)t.push(void 0)}return t.splice(n,0,t.splice(s,1)[0]),t}const Oe=(t,s)=>{const n=[/\$args(?:\((\d*)(:?)(\d*)\))?/g,/\$rand\(\s*(\d+)?\s*,\s*?(\d+)?\s*\)/g,/\$var\(([^)]+)\)/g,/\$user\.name/g,/\$customapi\(([^$)]*)\)\['([A-Za-z0-9_ -]+)'\]/g,/\$customapi\(([^$)]*)\)/g,/\$urlencode\(([^$)]*)\)/g,/\$calc\((\d+)([*/+-])(\d+)\)/g];let m=t,f;do{f=m;for(const y of n)m=m.replace(y,s)}while(f!==m);return m},Le=(t,s=",",n=-1)=>{const m=t.split(s);return n===-1||m.length<=n?m:[...m.slice(0,n-1),m.slice(n-1).join(s)]},qe=t=>{let s=t.length;for(;s>0;){const n=Math.floor(Math.random()*s);s--;const m=t[s];t[s]=t[n],t[n]=m}return t};function Dt(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath}}function Ut(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath,volume:100}}var X={arrayMove:Me,humanDuration:Ee,parseHumanDuration:Fe,mustParseHumanDuration:ft,doDummyReplacements:Oe,split:Le,shuffle:qe,pad:ct,mediaFileFromUploadedFile:Dt,soundMediaFileFromUploadedFile:Ut};const ze=1001,It=4e3,At=St("WsWrapper.ts");class Je{constructor(s,n){this.handle=null,this.reconnectTimeout=null,this.sendBuffer=[],this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{},this.addr=s,this.protocols=n}send(s){this.handle?this.handle.send(s):this.sendBuffer.push(s)}connect(){const s=new WebSocket(this.addr,this.protocols);s.onopen=n=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=s;this.sendBuffer.length>0;){const m=this.sendBuffer.shift();m&&this.handle.send(m)}this.onopen(n)},s.onmessage=n=>{this.onmessage(n)},s.onclose=n=>{this.handle=null,n.code===It?At.info("custom disconnect, will not reconnect"):n.code===ze?At.info("going away, will not reconnect"):this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3),this.onclose(n)}}disconnect(){this.handle&&this.handle.close(It)}}const Tt=St("WsClient.ts");class Be extends Je{constructor(s,n){super(s,n);this._on={},this.onopen=m=>{this._dispatch("socket","open",m)},this.onmessage=m=>{if(this._dispatch("socket","message",m),this._on.message){const f=this._parseMessageData(m.data);f.event&&this._dispatch("message",`${f.event}`,f.data)}},this.onclose=m=>{this._dispatch("socket","close",m)}}onSocket(s,n){this.addEventListener("socket",s,n)}onMessage(s,n){this.addEventListener("message",s,n)}addEventListener(s,n,m){const f=Array.isArray(n)?n:[n];this._on[s]=this._on[s]||{};for(const y of f)this._on[s][y]=this._on[s][y]||[],this._on[s][y].push(m)}_parseMessageData(s){try{const n=JSON.parse(s);if(n.event)return{event:n.event,data:n.data||null}}catch(n){Tt.info(n)}return{event:null,data:null}}_dispatch(s,n,...m){const y=(this._on[s]||{})[n]||[];if(y.length!==0){Tt.log(`ws dispatch ${s} ${n}`);for(const h of y)h(...m)}}}const We=t=>{const s=Q.getMe();return`${location.protocol}//${location.host}/widget/${t}/${s.widgetToken}/`},He=t=>{const s=Vt.getConf(),n=Q.getMe();return new Be(`${s.wsBase}/${t}`,n?n.token:"")};var z={widgetUrl:We,wsClient:He};const Qe=V({data:()=>({unchangedJson:"{}",changedJson:"{}",inited:!1,settings:kt(),defaultSettings:kt(),ws:null,drawUrl:"",favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}}}),async created(){this.ws=z.wsClient("drawcast"),this.ws.onMessage("init",async t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.drawUrl=t.drawUrl;const s=await M.getDrawcastAllImages();this.favoriteSelection.items=await s.json(),this.inited=!0}),this.ws.connect()},watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},receiveUrl(){return z.widgetUrl("drawcast_receive")},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage==0?0:1)},currentFavoriteSelectionItems(){const t=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(t,t+this.favoriteSelection.pagination.perPage)}},methods:{addFavoriteList(){if(!this.settings){console.warn("addFavoriteList: this.settings not initialized");return}this.settings.favoriteLists.push({list:[],title:""})},removeFavoriteList(t){if(!this.settings){console.warn("removeFavoriteList: this.settings not initialized");return}const s=[];for(let n in this.settings.favoriteLists)parseInt(n,10)!==parseInt(`${t}`,10)&&s.push(this.settings.favoriteLists[n]);this.settings.favoriteLists=s},toggleFavorite(t,s){if(!this.settings){console.warn("toggleFavorite: this.settings not initialized");return}this.settings.favoriteLists[t].list.includes(s)?this.settings.favoriteLists[t].list=this.settings.favoriteLists[t].list.filter(n=>n!==s):this.settings.favoriteLists[t].list.push(s)},customProfileImageChanged(t){if(!this.settings){console.warn("customProfileImageChanged: this.settings not initialized");return}this.settings.customProfileImage=t.file?t:null},notificationSoundChanged(t){if(!this.settings){console.warn("notificationSoundChanged: this.settings not initialized");return}this.settings.notificationSound=t.file?t:null},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:{canvasWidth:parseInt(`${this.settings.canvasWidth}`,10)||720,canvasHeight:parseInt(`${this.settings.canvasHeight}`,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,recentImagesTitle:this.settings.recentImagesTitle,customDescription:this.settings.customDescription,customProfileImage:this.settings.customProfileImage,palette:this.settings.palette,displayDuration:parseInt(`${this.settings.displayDuration}`,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,autofillLatest:this.settings.autofillLatest,notificationSound:this.settings.notificationSound,favoriteLists:this.settings.favoriteLists}})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},unmounted(){this.ws&&this.ws.disconnect()}}),Ke={id:"app"},Ge={id:"top",ref:"top"},Ye={id:"actionbar",class:"p-1"},Xe=["disabled"],Ze=["href"],je=["href"],xe={id:"main",ref:"main"},ts={key:0,class:"table is-striped",ref:"table"},es=e("tr",null,[e("td",{colspan:"3"},"General")],-1),ss=e("td",null,[e("code",null,"settings.canvasWidth")],-1),ns=e("td",null,[c(" Width of the drawing area."),e("br"),c(" Caution: changing this will clear the area for currenty connected users. ")],-1),is=e("td",null,[e("code",null,"settings.canvasHeight")],-1),as=e("td",null,[c(" Height of the drawing area."),e("br"),c(" Caution: changing this will clear the area for currenty connected users. ")],-1),ls=e("td",null,[e("code",null,"settings.displayDuration")],-1),os=e("td",null," The duration in Milliseconds that each drawing will be shown ",-1),rs=e("td",null,[e("code",null,"settings.displayLatestForever")],-1),ds=e("td",null,"If checked, the latest drawing will be shown indefinately.",-1),us=e("td",null,[e("code",null,"settings.displayLatestAutomatically")],-1),ms=e("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),hs=e("td",null,[e("code",null,"settings.autofillLatest")],-1),cs=e("td",null," Fill the latest submitted drawing into the draw panel when opening the draw page. ",-1),ps=e("td",null,[e("code",null,"settings.submitButtonText")],-1),gs=e("td",null,null,-1),fs=e("td",null,[e("code",null,"settings.submitConfirm")],-1),vs=e("td",null," Leave empty if no confirm is required by user before sending. ",-1),ys=e("td",null,[e("code",null,"settings.recentImagesTitle")],-1),$s=e("td",null,"Title for the recently submitted images gallery.",-1),_s=e("td",null,[e("code",null,"settings.customDescription")],-1),bs=e("td",null,"Description text below the drawing panel.",-1),ws=e("td",null,[e("code",null,"settings.customProfileImage")],-1),ks=e("td",null,[c(" Profile image that will be displayed next to the "),e("code",null,"settings.customDescription"),c(". ")],-1),Cs=e("td",null,[e("code",null,"settings.palette")],-1),Vs=["onUpdate:modelValue"],Ss=e("br",null,null,-1),Ds=e("br",null,null,-1),Us=e("td",null,[c(" Default colors appearing on the draw page."),e("br"),c(" Caution: Changing this will change selected color for currenty connected users. ")],-1),Is=e("td",null,[e("code",null,"settings.notificationSound")],-1),As=e("td",null,[c(" Add a sound here that plays when new drawings arrive. "),e("br"),c(" Note: Not played in drawing window, only in widget. ")],-1),Ts=e("div",null,[e("code",null,"settings.favoriteLists")],-1),Ps={class:"preview"},Ns=["src"],Rs={key:0},Fs=["onClick"],Es=e("div",null,"Title:",-1),Ms=["onUpdate:modelValue"],Os=e("div",null,"Currently selected favorites:",-1),Ls={class:"favorites"},qs=["src","onClick","onMouseover"],zs=e("div",{class:"mt-2"},"Select favorites:",-1),Js={class:"favorites-select"},Bs=["src","onClick","onMouseover"],Ws=["disabled"],Hs=["disabled"],Qs=e("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function Ks(t,s,n,m,f,y){const h=_("navbar"),i=_("image-upload"),r=_("sound-upload");return a(),l("div",Ke,[e("div",Ge,[b(h),e("div",Ye,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...o)=>t.sendSave&&t.sendSave(...o))}," Save ",8,Xe),e("a",{class:"button is-small mr-1",href:t.receiveUrl,target:"_blank"},"Open widget",8,Ze),e("a",{class:"button is-small",href:t.drawUrl,target:"_blank"},"Open draw",8,je)])],512),e("div",xe,[t.inited?(a(),l("table",ts,[e("tbody",null,[es,e("tr",null,[ss,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>t.settings.canvasWidth=o)},null,512),[[g,t.settings.canvasWidth]])]),ns]),e("tr",null,[is,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>t.settings.canvasHeight=o)},null,512),[[g,t.settings.canvasHeight]])]),as]),e("tr",null,[ls,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.settings.displayDuration=o)},null,512),[[g,t.settings.displayDuration]])]),os]),e("tr",null,[rs,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>t.settings.displayLatestForever=o)},null,512),[[O,t.settings.displayLatestForever]])]),ds]),e("tr",null,[us,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=o=>t.settings.displayLatestAutomatically=o)},null,512),[[O,t.settings.displayLatestAutomatically]])]),ms]),e("tr",null,[hs,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=o=>t.settings.autofillLatest=o)},null,512),[[O,t.settings.autofillLatest]])]),cs]),e("tr",null,[ps,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[7]||(s[7]=o=>t.settings.submitButtonText=o)},null,512),[[g,t.settings.submitButtonText]])]),gs]),e("tr",null,[fs,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[8]||(s[8]=o=>t.settings.submitConfirm=o)},null,512),[[g,t.settings.submitConfirm]])]),vs]),e("tr",null,[ys,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=o=>t.settings.recentImagesTitle=o)},null,512),[[g,t.settings.recentImagesTitle]])]),$s]),e("tr",null,[_s,e("td",null,[u(e("textarea",{class:"textarea","onUpdate:modelValue":s[10]||(s[10]=o=>t.settings.customDescription=o)},null,512),[[g,t.settings.customDescription]])]),bs]),e("tr",null,[ws,e("td",null,[b(i,{modelValue:t.settings.customProfileImage,"onUpdate:modelValue":[s[11]||(s[11]=o=>t.settings.customProfileImage=o),t.customProfileImageChanged],width:"100px",height:"50px",class:"spacerow media-holder"},null,8,["modelValue","onUpdate:modelValue"])]),ks]),e("tr",null,[Cs,e("td",null,[(a(!0),l(U,null,A(t.settings.palette,(o,$)=>(a(),l("label",{class:"square",key:$},[u(e("input",{type:"color","onUpdate:modelValue":k=>t.settings.palette[$]=k},null,8,Vs),[[g,t.settings.palette[$]]]),e("span",{class:"square-inner",style:Y({backgroundColor:o})},null,4)]))),128)),Ss,Ds,e("button",{class:"button is-small",onClick:s[12]||(s[12]=o=>t.settings.palette=t.defaultSettings.palette)}," Reset to default palette ")]),Us]),e("tr",null,[Is,e("td",null,[b(r,{modelValue:t.settings.notificationSound,"onUpdate:modelValue":[s[13]||(s[13]=o=>t.settings.notificationSound=o),t.notificationSoundChanged],class:"spacerow media-holder"},null,8,["modelValue","onUpdate:modelValue"])]),As]),e("tr",null,[e("td",null,[Ts,e("div",null,[e("span",{class:"button is-small",onClick:s[14]||(s[14]=(...o)=>t.addFavoriteList&&t.addFavoriteList(...o))},"Add a list")]),e("div",Ps,[t.favoriteSelection.hovered?(a(),l("img",{key:0,src:t.favoriteSelection.hovered},null,8,Ns)):v("",!0)])]),e("td",null,[(a(!0),l(U,null,A(t.settings.favoriteLists,(o,$)=>(a(),l("div",{key:$},[t.settings.favoriteLists.length>1?(a(),l("div",Rs,[e("span",{class:"button is-small",onClick:k=>t.removeFavoriteList($)},"Remove this list",8,Fs)])):v("",!0),Es,u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":k=>o.title=k},null,8,Ms),[[g,o.title]]),Os,e("div",Ls,[(a(!0),l(U,null,A(o.list,(k,d)=>(a(),l("img",{src:k,key:d,width:"50",height:"50",onClick:p=>t.toggleFavorite($,k),onMouseover:p=>t.favoriteSelection.hovered=k,onMouseleave:s[15]||(s[15]=p=>t.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,qs))),128))]),zs,e("div",Js,[(a(!0),l(U,null,A(t.currentFavoriteSelectionItems,(k,d)=>(a(),l("img",{src:k,key:d,width:"50",height:"50",onClick:p=>t.toggleFavorite($,k),onMouseover:p=>t.favoriteSelection.hovered=k,onMouseleave:s[16]||(s[16]=p=>t.favoriteSelection.hovered=""),class:P(["thumbnail mr-1",{"is-favorited":o.list.includes(k)}])},null,42,Bs))),128))]),e("span",{class:"button is-small",onClick:s[17]||(s[17]=k=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page-1),disabled:t.favoriteSelection.pagination.page>1?null:!0},"Prev",8,Ws),e("span",{class:"button is-small",onClick:s[18]||(s[18]=k=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page+1),disabled:t.favoriteSelection.pagination.page<t.favoriteSelectionTotalPages?null:!0},"Next",8,Hs)]))),128))]),Qs])])],512)):v("",!0)],512)])}var Gs=S(Qe,[["render",Ks]]);const Ys=V({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(t){this.variables=this.variables.filter((s,n)=>n!==t)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await M.saveVariables({variables:this.variables}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await M.getPageVariablesData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.variables=s.variables,this.setUnchanged()}}),Xs={id:"app"},Zs={id:"top",ref:"top"},js={id:"actionbar",class:"p-1"},xs=["disabled"],tn={id:"main"},en={class:"mb-4"},sn=e("h1",{class:"title mb-2"},"Global Variables",-1),nn=e("div",{class:"help"},[c(" Variables can be used from commands with "),e("code",null,"$var(variable_name)"),c(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),an={class:"table is-striped"},ln=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Value"),e("th")])],-1),on=["onUpdate:modelValue"],rn=["onUpdate:modelValue"],dn=e("i",{class:"fa fa-trash"},null,-1);function un(t,s,n,m,f,y){const h=_("navbar"),i=_("doubleclick-button");return a(),l("div",Xs,[e("div",Zs,[b(h),e("div",js,[e("button",{class:"button is-small",onClick:s[0]||(s[0]=(...r)=>t.onAdd&&t.onAdd(...r))},"Add"),e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[1]||(s[1]=(...r)=>t.sendSave&&t.sendSave(...r))}," Save ",8,xs)])],512),e("div",tn,[e("div",en,[sn,nn,e("table",an,[ln,e("tbody",null,[(a(!0),l(U,null,A(t.variables,(r,o)=>(a(),l("tr",{key:o},[e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":$=>r.name=$},null,8,on),[[g,r.name]])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":$=>r.value=$},null,8,rn),[[g,r.value]])]),e("td",null,[b(i,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:$=>t.remove(o)},{default:q(()=>[dn]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var mn=S(Ys,[["render",un]]);const hn=V({data:()=>({user:"",pass:"",email:"",error:"",success:!1}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const t=await M.resendVerificationMail({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const t=await M.register({user:this.user,pass:this.pass,email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),cn={class:"center-screen"},pn=e("h1",{class:"title is-6"},"Hyottoko.club",-1),gn={key:0,class:"field has-background-success-light has-text-success-dark"},fn=c(" Account registered. Please check your mail. Click "),vn=c("here"),yn=c(" to login. "),$n={key:1},_n={key:0,class:"field has-background-danger-light has-text-danger-dark"},bn={key:0},wn=c(" A user with this email is already registered. "),kn=e("br",null,null,-1),Cn=c("Request a password reset."),Vn={key:1},Sn=c(" A user with this email is already registered. "),Dn=e("br",null,null,-1),Un={key:2},In={key:3},An={key:4},Tn={class:"field"},Pn={class:"control has-icons-left"},Nn=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),Rn={class:"field"},Fn={class:"control has-icons-left"},En=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),Mn={class:"field"},On={class:"control has-icons-left"},Ln=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),qn={class:"field"},zn=["disabled"];function Jn(t,s,n,m,f,y){const h=_("router-link");return a(),l("div",cn,[pn,t.success?(a(),l("div",gn,[fn,b(h,{to:{name:"login"}},{default:q(()=>[vn]),_:1}),yn])):(a(),l("div",$n,[t.error?(a(),l("div",_n,[t.error==="verified_mail_already_exists"?(a(),l("div",bn,[wn,kn,b(h,{to:{name:"forgot-password"}},{default:q(()=>[Cn]),_:1})])):t.error==="unverified_mail_already_exists"?(a(),l("div",Vn,[Sn,Dn,e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...i)=>t.onRequestVerificationEmail&&t.onRequestVerificationEmail(...i))},"Resend verification email")])):t.error==="verified_name_already_exists"?(a(),l("div",Un," A user with this name is already registered. ")):t.error==="unverified_name_already_exists"?(a(),l("div",In," A user with this name is already registered. ")):(a(),l("span",An,w(t.error),1))])):v("",!0),e("div",Tn,[e("div",Pn,[u(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":[s[1]||(s[1]=i=>t.user=i),s[2]||(s[2]=i=>t.error="")]},null,512),[[g,t.user]]),Nn])]),e("div",Rn,[e("div",Fn,[u(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":[s[3]||(s[3]=i=>t.email=i),s[4]||(s[4]=i=>t.error="")]},null,512),[[g,t.email]]),En])]),e("div",Mn,[e("div",On,[u(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":[s[5]||(s[5]=i=>t.pass=i),s[6]||(s[6]=i=>t.error="")],onKeyup:s[7]||(s[7]=G((...i)=>t.submit&&t.submit(...i),["enter"]))},null,544),[[g,t.pass]]),Ln])]),e("div",qn,[e("button",{class:"button is-small is-primary",disabled:t.canRegister?null:!0,onClick:s[8]||(s[8]=(...i)=>t.submit&&t.submit(...i))}," Register ",8,zn)])]))])}var Bn=S(hn,[["render",Jn]]);const Wn=V({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[],tmi_identity_client_id:"",tmi_identity_client_secret:""},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const t=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],s=document.location,n=`${s.protocol}//${s.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${n}&scope=${t.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(t){this.twitch_channels=this.twitch_channels.filter((s,n)=>n!==t)},addchannel(){this.twitch_channels.push({user_id:this.user.id,bot_status_messages:1,channel_id:"",channel_name:"",access_token:""})},async loadid(t){this.twitch_channels[t].channel_id=await this.getTwitchUserIdByName(this.twitch_channels[t].channel_name)},async getTwitchUserIdByName(t){const s={name:t,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},n=await M.twitchUserIdByName(s);try{return`${(await n.json()).id}`}catch{return""}},async sendSave(){await M.saveUserSettings({user:this.user,twitch_channels:this.twitch_channels}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await M.getPageSettingsData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.user=s.user,this.twitch_channels=s.twitchChannels,this.setUnchanged()}}),Hn={id:"app"},Qn={id:"top",ref:"top"},Kn={id:"actionbar",class:"p-1"},Gn=["disabled"],Yn={id:"main"},Xn={class:"mb-4"},Zn=e("h1",{class:"title mb-2"},"User",-1),jn={class:"table is-striped"},xn=e("td",null,"Name:",-1),ti=e("td",null,"Email:",-1),ei=e("td",null,"Password:",-1),si={key:0,class:"mb-4"},ni=e("h1",{class:"title mb-2"},"Twitch-Bot",-1),ii=e("p",null,[c(" Please refer to "),e("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),c(". ")],-1),ai={class:"table is-striped"},li=e("td",null,"Bot name:",-1),oi=e("td",null,"Bot oauth (pass):",-1),ri=e("td",null,"Bot client_id:",-1),di=e("td",null,"Bot client_secret:",-1),ui={class:"mb-4"},mi=e("h1",{class:"title mb-2"},"Twitch Channels",-1),hi=c(" List of twitch channels where the bot will connect to. "),ci={key:0},pi={key:0,class:"table is-striped"},gi=e("thead",null,[e("tr",null,[e("td",null,"Channel name"),e("td",null,"Chat status updates"),e("td",null,"Channel id*"),e("td",null,"Access Token*"),e("td")])],-1),fi=["onUpdate:modelValue"],vi=["onUpdate:modelValue"],yi=["onClick"],$i=["onUpdate:modelValue"],_i=["onClick"],bi=e("i",{class:"fa fa-remove"},null,-1),wi=[bi],ki={key:1,class:"content"},Ci=e("p",null," Channel Id* and Access Token*: You may not need the client id or access token. They are required for channel point reward redemption triggers only. ",-1),Vi={key:0},Si={key:1,class:"list"},Di=e("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Ui={class:"list-item"},Ii=c(" Click "),Ai=["href"],Ti=c(" to authorize the bot with the channel "),Pi=e("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),Ni={key:2};function Ri(t,s,n,m,f,y){const h=_("navbar"),i=_("checkbox");return a(),l("div",Hn,[e("div",Qn,[b(h),e("div",Kn,[e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[0]||(s[0]=(...r)=>t.sendSave&&t.sendSave(...r))}," Save ",8,Gn)])],512),e("div",Yn,[e("div",Xn,[Zn,e("table",jn,[e("tbody",null,[e("tr",null,[xn,e("td",null,w(t.user.name),1)]),e("tr",null,[ti,e("td",null,[u(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=r=>t.user.email=r)},null,512),[[g,t.user.email]])])]),e("tr",null,[ei,e("td",null,[u(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=r=>t.user.pass=r)},null,512),[[g,t.user.pass]])])])])])]),t.isAdmin?(a(),l("div",si,[ni,ii,e("table",ai,[e("tbody",null,[e("tr",null,[li,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=r=>t.user.tmi_identity_username=r)},null,512),[[g,t.user.tmi_identity_username]])])]),e("tr",null,[oi,e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[4]||(s[4]=r=>t.user.tmi_identity_password=r)},null,512),[[g,t.user.tmi_identity_password]])])]),e("tr",null,[ri,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=r=>t.user.tmi_identity_client_id=r)},null,512),[[g,t.user.tmi_identity_client_id]])])]),e("tr",null,[di,e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[6]||(s[6]=r=>t.user.tmi_identity_client_secret=r)},null,512),[[g,t.user.tmi_identity_client_secret]])])])])])])):v("",!0),e("div",ui,[mi,e("p",null,[hi,t.twitch_channels.length===0?(a(),l("span",ci," Currently no channels are configured. ")):v("",!0)]),t.twitch_channels.length>0?(a(),l("table",pi,[gi,e("tbody",null,[(a(!0),l(U,null,A(t.twitch_channels,(r,o)=>(a(),l("tr",{key:o},[e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":$=>r.channel_name=$},null,8,fi),[[g,r.channel_name]])]),e("td",null,[b(i,{class:"is-small",onValue:1,offValue:0,modelValue:r.bot_status_messages,"onUpdate:modelValue":$=>r.bot_status_messages=$},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[r.channel_id?u((a(),l("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":$=>r.channel_id=$},null,8,vi)),[[g,r.channel_id]]):v("",!0),r.channel_id?v("",!0):(a(),l("button",{key:1,class:"button is-small",onClick:$=>t.loadid(o)}," Load id ",8,yi))]),e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":$=>r.access_token=$},null,8,$i),[[g,r.access_token]])]),e("td",null,[e("button",{class:"button is-small",onClick:$=>t.rmchannel(o)},wi,8,_i)])]))),128))])])):v("",!0),e("button",{class:"button is-small",onClick:s[7]||(s[7]=r=>t.addchannel())}," Add channel ")]),t.twitch_channels.length>0?(a(),l("div",ki,[Ci,t.accessTokenLink?(a(),l("p",Vi,"To get an access token, do the following:")):v("",!0),t.accessTokenLink?(a(),l("ol",Si,[Di,e("li",Ui,[Ii,e("a",{href:t.accessTokenLink,target:"_blank"},"here",8,Ai),Ti]),Pi])):t.isAdmin?(a(),l("p",Ni,' To configure an access token, please configure the "Bot client_id" above. ')):v("",!0)])):v("",!0)])])}var Fi=S(Wn,[["render",Ri]]),x;(function(t){t.MOD="mod",t.SUB="sub",t.BROADCASTER="broadcaster"})(x||(x={}));const N=[x.MOD,x.BROADCASTER],Pt=[{value:x.BROADCASTER,label:"Broadcaster"},{value:x.MOD,label:"Moderators"},{value:x.SUB,label:"Subscribers"}],Ei=t=>{if(t.length===0)return"Everyone";const s=[];return Pt.forEach(n=>{t.includes(n.value)&&s.push(n.label)}),s.join(", ")},vt=()=>"",Nt=()=>({sound:{filename:"",file:"",urlpath:"",volume:100},image:{filename:"",file:"",urlpath:""},minDurationMs:"1s"}),Mi=()=>({type:"delay",value:"1s"}),Oi=()=>({type:"text",value:vt()}),Li=()=>({type:"media",value:Nt()}),Rt=t=>({type:t,data:{command:"",commandExact:!1,minInterval:0,minLines:0,since:"stream"}}),D=(t="",s=!1)=>{const n=Rt("command");return n.data.command=t,n.data.commandExact=s,n},qi=t=>{if(t.type==="command")return!!t.data.command;if(t.type==="timer"){try{ft(t.data.minInterval)}catch{return!1}const s=parseInt(`${t.data.minLines}`,10);return!isNaN(s)}return!0},st={add_stream_tags:{Name:()=>"add_stream_tags command",Description:()=>"Add streamtag",NewCommand:()=>({triggers:[D()],action:"add_stream_tags",restrict_to:N,variables:[],variableChanges:[],data:{tag:""}}),RequiresAccessToken:()=>!0},chatters:{Name:()=>"chatters command",Description:()=>"Outputs the people who chatted during the stream.",NewCommand:()=>({triggers:[D()],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},countdown:{Name:()=>"countdown",Description:()=>"Add a countdown or messages spaced by time intervals.",NewCommand:()=>({triggers:[D()],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:{steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}}),RequiresAccessToken:()=>!1},dict_lookup:{Name:()=>"dictionary lookup",Description:()=>"Outputs the translation for the searched word.",NewCommand:()=>({triggers:[D()],action:"dict_lookup",restrict_to:[],variables:[],variableChanges:[],data:{lang:"ja",phrase:""}}),RequiresAccessToken:()=>!1},madochan_createword:{Name:()=>"madochan",Description:()=>"Creates a word for a definition.",NewCommand:()=>({triggers:[D()],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}}),RequiresAccessToken:()=>!1},media:{Name:()=>"media command",Description:()=>"Display an image and/or play a sound.",NewCommand:()=>({triggers:[D()],action:"media",restrict_to:[],variables:[],variableChanges:[],data:Nt()}),RequiresAccessToken:()=>!1},media_volume:{Name:()=>"media volume command",Description:()=>`Sets the media volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
    <br />
    If no argument is given, just outputs the current volume`,NewCommand:()=>({triggers:[D()],action:"media_volume",restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},text:{Name:()=>"command",Description:()=>"Send a message to chat",NewCommand:()=>({triggers:[D()],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[vt()]}}),RequiresAccessToken:()=>!1},remove_stream_tags:{Name:()=>"remove_stream_tags command",Description:()=>"Remove streamtag",NewCommand:()=>({triggers:[D()],action:"remove_stream_tags",restrict_to:N,variables:[],variableChanges:[],data:{tag:""}}),RequiresAccessToken:()=>!0},set_channel_game_id:{Name:()=>"change stream category command",Description:()=>"Change the stream category",NewCommand:()=>({triggers:[D()],action:"set_channel_game_id",restrict_to:N,variables:[],variableChanges:[],data:{game_id:""}}),RequiresAccessToken:()=>!0},set_channel_title:{Name:()=>"change stream title command",Description:()=>"Change the stream title",NewCommand:()=>({triggers:[D()],action:"set_channel_title",restrict_to:N,variables:[],variableChanges:[],data:{title:""}}),RequiresAccessToken:()=>!0},sr_current:{Name:()=>"sr_current",Description:()=>"Show what song is currently playing",NewCommand:()=>({action:"sr_current",triggers:[D("!sr current",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_undo:{Name:()=>"sr_undo",Description:()=>"Remove the song that was last added by oneself.",NewCommand:()=>({action:"sr_undo",triggers:[D("!sr undo",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_good:{Name:()=>"sr_good",Description:()=>"Vote the current song up",NewCommand:()=>({action:"sr_good",triggers:[D("!sr good",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_bad:{Name:()=>"sr_bad",Description:()=>"Vote the current song down",NewCommand:()=>({action:"sr_bad",triggers:[D("!sr bad",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_stats:{Name:()=>"sr_stats",Description:()=>"Show stats about the playlist",NewCommand:()=>({action:"sr_stats",triggers:[D("!sr stats",!0),D("!sr stat",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_prev:{Name:()=>"sr_prev",Description:()=>"Skip to the previous song",NewCommand:()=>({action:"sr_prev",triggers:[D("!sr prev",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_next:{Name:()=>"sr_next",Description:()=>"Skip to the next song",NewCommand:()=>({action:"sr_next",triggers:[D("!sr next",!0),D("!sr skip",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_jumptonew:{Name:()=>"sr_jumptonew",Description:()=>"Jump to the next unplayed song",NewCommand:()=>({action:"sr_jumptonew",triggers:[D("!sr jumptonew",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_clear:{Name:()=>"sr_clear",Description:()=>"Clear the playlist",NewCommand:()=>({action:"sr_clear",triggers:[D("!sr clear",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_rm:{Name:()=>"sr_rm",Description:()=>"Remove the current song from the playlist",NewCommand:()=>({action:"sr_rm",triggers:[D("!sr rm",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_shuffle:{Name:()=>"sr_shuffle",Description:()=>`Shuffle the playlist (current song unaffected).
    <br />
    Non-played and played songs will be shuffled separately and non-played
    songs will be put after currently playing song.`,NewCommand:()=>({action:"sr_shuffle",triggers:[D("!sr shuffle",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_reset_stats:{Name:()=>"sr_reset_stats",Description:()=>"Reset all statistics of all songs",NewCommand:()=>({action:"sr_reset_stats",triggers:[D("!sr resetStats",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_loop:{Name:()=>"sr_loop",Description:()=>"Loop the current song",NewCommand:()=>({action:"sr_loop",triggers:[D("!sr loop",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_noloop:{Name:()=>"sr_noloop",Description:()=>"Stop looping the current song",NewCommand:()=>({action:"sr_noloop",triggers:[D("!sr noloop",!0),D("!sr unloop",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_pause:{Name:()=>"sr_pause",Description:()=>"Pause currently playing song",NewCommand:()=>({action:"sr_pause",triggers:[D("!sr pause",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_unpause:{Name:()=>"sr_unpause",Description:()=>"Unpause currently paused song",NewCommand:()=>({action:"sr_unpause",triggers:[D("!sr nopause",!0),D("!sr unpause",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_hidevideo:{Name:()=>"sr_hidevideo",Description:()=>"Hide video for current song",NewCommand:()=>({action:"sr_hidevideo",triggers:[D("!sr hidevideo",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_showvideo:{Name:()=>"sr_showvideo",Description:()=>"Show video for current song",NewCommand:()=>({action:"sr_showvideo",triggers:[D("!sr showvideo",!0)],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_request:{Name:()=>"sr_request",Description:()=>`
    Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
    at youtube (by id or by title)
    and queue the first result in the playlist (after the first found
    batch of unplayed songs).`,NewCommand:()=>({action:"sr_request",triggers:[D("!sr")],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_re_request:{Name:()=>"sr_re_request",Description:()=>`
    Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
    in the current playlist and queue the first result in the playlist
    (after the first found batch of unplayed songs).`,NewCommand:()=>({action:"sr_re_request",triggers:[D("!resr")],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_addtag:{Name:()=>"sr_addtag",Description:()=>"Add tag <code>&lt;TAG&gt;</code> (argument to this command) to the current song",NewCommand:()=>({action:"sr_addtag",triggers:[D("!sr tag"),D("!sr addtag")],restrict_to:N,variables:[],variableChanges:[],data:{tag:""}}),RequiresAccessToken:()=>!1},sr_rmtag:{Name:()=>"sr_rmtag",Description:()=>"Remove tag <code>&lt;TAG&gt;</code> (argument to this command) from the current song",NewCommand:()=>({action:"sr_rmtag",triggers:[D("!sr rmtag")],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_volume:{Name:()=>"sr_volume",Description:()=>`Sets the song request volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
    <br />
    If no argument is given, just outputs the current volume`,NewCommand:()=>({action:"sr_volume",triggers:[D("!sr volume")],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_filter:{Name:()=>"sr_filter",Description:()=>`Play only songs with the given tag <code>&lt;TAG&gt;</code> (argument to this command). If no tag
  is given, play all songs.`,NewCommand:()=>({action:"sr_filter",triggers:[D("!sr filter")],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_preset:{Name:()=>"sr_preset",Description:()=>`Switches to the preset <code>&lt;PRESET&gt;</code> (argument to this command) if it exists.
  If no arguments are given, outputs all available presets.`,NewCommand:()=>({action:"sr_preset",triggers:[D("!sr preset")],restrict_to:N,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_queue:{Name:()=>"sr_queue",Description:()=>"Shows the next 3 songs that will play.",NewCommand:()=>({action:"sr_queue",triggers:[D("!sr queue")],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1}},zi=(t=null)=>({name:(t==null?void 0:t.name)||"",css:(t==null?void 0:t.css)||"",showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}),Ft=(t=null)=>{var s,n,m,f;return{volume:typeof(t==null?void 0:t.volume)=="undefined"?100:t.volume,initAutoplay:typeof(t==null?void 0:t.initAutoplay)=="undefined"?!0:t.initAutoplay,hideVideoImage:{file:((s=t==null?void 0:t.hideVideoImage)==null?void 0:s.file)||"",filename:((n=t==null?void 0:t.hideVideoImage)==null?void 0:n.filename)||"",urlpath:((m=t==null?void 0:t.hideVideoImage)==null?void 0:m.urlpath)?t.hideVideoImage.urlpath:((f=t==null?void 0:t.hideVideoImage)==null?void 0:f.file)?`/uploads/${encodeURIComponent(t.hideVideoImage.file)}`:""},maxSongLength:{viewer:typeof(t==null?void 0:t.maxSongLength)=="undefined"?0:t==null?void 0:t.maxSongLength.viewer,mod:typeof(t==null?void 0:t.maxSongLength)=="undefined"?0:t==null?void 0:t.maxSongLength.mod,sub:typeof(t==null?void 0:t.maxSongLength)=="undefined"?0:t==null?void 0:t.maxSongLength.sub},maxSongsQueued:{viewer:typeof(t==null?void 0:t.maxSongsQueued)=="undefined"?0:parseInt(t==null?void 0:t.maxSongsQueued.viewer,10),mod:typeof(t==null?void 0:t.maxSongsQueued)=="undefined"?0:parseInt(t==null?void 0:t.maxSongsQueued.mod,10),sub:typeof(t==null?void 0:t.maxSongsQueued)=="undefined"?0:parseInt(t==null?void 0:t.maxSongsQueued.sub,10)},customCss:(t==null?void 0:t.customCss)||"",customCssPresets:typeof(t==null?void 0:t.customCssPresets)=="undefined"?[]:t.customCssPresets.map(zi),showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}};const Ji=V({data:()=>({playerVisible:!1,playlist:[],commands:[],globalVariables:[],channelPointsCustomRewards:{},settings:Ft(),filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:"",toast:zt(),controlDefinitions:[{title:"Reset stats",ctrl:"resetStats",icon:"fa-eraser"},{title:"Clear playlist",ctrl:"clear",icon:"fa-eject"},{title:"Shuffle",ctrl:"shuffle",icon:"fa-random"},{title:"Play",ctrl:"unpause",icon:"fa-play"},{title:"Pause",ctrl:"pause",icon:"fa-pause"},{title:"Prev",ctrl:"prev",icon:"fa-step-backward"},{title:"Next",ctrl:"skip",icon:"fa-step-forward"}],tabDefinitions:[{tab:"playlist",title:"Playlist"},{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"},{tab:"tags",title:"Tags"},{tab:"import",title:"Import/Export"}],possibleActions:["sr_current","sr_undo","sr_good","sr_bad","sr_stats","sr_prev","sr_next","sr_jumptonew","sr_clear","sr_rm","sr_shuffle","sr_reset_stats","sr_loop","sr_noloop","sr_pause","sr_unpause","sr_hidevideo","sr_showvideo","sr_request","sr_re_request","sr_addtag","sr_rmtag","sr_volume","sr_filter","sr_preset","sr_queue"]}),computed:{tags(){const t=[];return this.playlist.forEach(s=>{s.tags.forEach(n=>{const m=t.findIndex(f=>f.value===n);m===-1?t.push({value:n,count:1}):t[m].count++})}),t},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(t=>t.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},exportPlaylistUrl(){return`${location.protocol}//${location.host}/api/sr/export`},widgetUrl(){return z.widgetUrl("sr")}},methods:{sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings})},onTagUpdated(t){this.updateTag(t[0],t[1])},onPlaylistCtrl(t){this.sendCtrl(t[0],t[1])},applyFilter(t){this.sendCtrl("filter",[{tag:t}])},async doImportPlaylist(){(await M.importPlaylist(this.importPlaylist)).status===200?(this.tab="playlist",this.toast.success("Import successful")):this.toast.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(t,s){this.sendMsg({event:"ctrl",ctrl:t,args:s})},ended(){this.sendMsg({event:"ended"})},sendMsg(t){this.ws?this.ws.send(JSON.stringify(t)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(t){this.player.setVolume(t)},updateTag(t,s){t!==s&&this.sendCtrl("updatetag",[t,s])}},async mounted(){this.$nextTick(()=>{this.ws=z.wsClient("sr"),this.ws.onMessage("save",t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards}),this.ws.onMessage(["pause"],t=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],t=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],t=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],t=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","move","tags"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist;const n=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;s!==n&&this.play()}),this.ws.onMessage(["filter"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist,this.filteredPlaylist.find(n=>n.id===s)||this.play()}),this.ws.onMessage(["stats","video","playIdx","shuffle"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards,this.filter=t.filter,this.playlist=t.playlist}),this.ws.onMessage(["add","init"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards,this.filter=t.filter,this.playlist=t.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),nt=t=>(W("data-v-333c48c3"),t=t(),H(),t),Bi={id:"app"},Wi={id:"top",ref:"top"},Hi={id:"actionbar",class:"p-1"},Qi=["disabled","onClick","title"],Ki=["disabled"],Gi=nt(()=>e("span",{class:"txt"},"Set all to played",-1)),Yi=[Gi],Xi=["disabled","title"],Zi=nt(()=>e("i",{class:"fa fa-tv mr-1"},null,-1)),ji={class:"txt"},xi={class:"field has-addons mr-1"},ta={class:"control"},ea=["disabled"],sa={class:"control"},na=["disabled"],ia=nt(()=>e("i",{class:"fa fa-search mr-1"},null,-1)),aa=c(" from playlist "),la=[ia,aa],oa={class:"field has-addons mr-1"},ra={class:"control"},da=["disabled"],ua={class:"control"},ma=["disabled"],ha=nt(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),ca=c(" from YouTube "),pa=[ha,ca],ga=["disabled","href"],fa={id:"main",ref:"main"},va={style:{width:"640px","max-width":"100%"}},ya={class:"tabs"},$a=["onClick"],_a={key:0},ba={class:"mb-1"},wa=["href"],ka=nt(()=>e("i",{class:"fa fa-download mr-1"},null,-1)),Ca=c(" Export playlist"),Va=[ka,Ca],Sa=nt(()=>e("i",{class:"fa fa-upload mr-1"},null,-1)),Da=c(" Import playlist "),Ua=[Sa,Da],Ia={key:1,id:"tags"},Aa={key:3,id:"playlist",class:"table-container"};function Ta(t,s,n,m,f,y){const h=_("navbar"),i=_("youtube"),r=_("tags-editor"),o=_("song-request-settings"),$=_("playlist-editor"),k=_("commands-editor");return a(),l("div",Bi,[e("div",Wi,[b(h),e("div",Hi,[(a(!0),l(U,null,A(t.controlDefinitions,(d,p)=>(a(),l("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:C=>t.sendCtrl(d.ctrl,[]),title:d.title,key:p},[e("i",{class:P(["fa",d.icon])},null,2)],8,Qi))),128)),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[0]||(s[0]=d=>t.sendCtrl("setAllToPlayed",[])),title:"Sets all songs to at least 1x played"},Yi,8,Ki),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[1]||(s[1]=(...d)=>t.togglePlayer&&t.togglePlayer(...d)),title:t.togglePlayerButtonText},[Zi,e("span",ji,w(t.togglePlayerButtonText),1)],8,Xi),e("div",xi,[e("div",ta,[u(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[2]||(s[2]=d=>t.resrinput=d),onKeyup:s[3]||(s[3]=G((...d)=>t.resr&&t.resr(...d),["enter"]))},null,40,ea),[[g,t.resrinput]])]),e("div",sa,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[4]||(s[4]=(...d)=>t.resr&&t.resr(...d))},la,8,na)])]),e("div",oa,[e("div",ra,[u(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[5]||(s[5]=d=>t.srinput=d),onKeyup:s[6]||(s[6]=G((...d)=>t.sr&&t.sr(...d),["enter"]))},null,40,da),[[g,t.srinput]])]),e("div",ua,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[7]||(s[7]=(...d)=>t.sr&&t.sr(...d))},pa,8,ma)])]),e("a",{class:"button is-small mr-1",disabled:t.inited?null:!0,href:t.widgetUrl,target:"_blank"},"Open SR widget",8,ga)])],512),e("div",fa,[e("div",va,[e("div",{id:"player",class:"video-16-9",style:Y(t.playerstyle)},[b(i,{ref:"youtube",onEnded:t.ended,visible:t.playerVisible},null,8,["onEnded","visible"])],4)]),e("div",ya,[e("ul",null,[(a(!0),l(U,null,A(t.tabDefinitions,(d,p)=>(a(),l("li",{key:p,class:P({"is-active":t.tab===d.tab}),onClick:C=>t.tab=d.tab},[e("a",null,w(d.title),1)],10,$a))),128))])]),t.inited&&t.tab==="import"?(a(),l("div",_a,[e("div",ba,[e("a",{class:"button is-small mr-1",href:t.exportPlaylistUrl,target:"_blank"},Va,8,wa),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(...d)=>t.doImportPlaylist&&t.doImportPlaylist(...d))},Ua)]),u(e("textarea",{class:"textarea mb-1","onUpdate:modelValue":s[9]||(s[9]=d=>t.importPlaylist=d)},null,512),[[g,t.importPlaylist]])])):v("",!0),t.inited&&t.tab==="tags"?(a(),l("div",Ia,[b(r,{tags:t.tags,onUpdateTag:t.onTagUpdated},null,8,["tags","onUpdateTag"])])):v("",!0),t.inited&&t.tab==="settings"?(a(),F(o,{key:2,id:"settings",modelValue:t.settings,"onUpdate:modelValue":[s[10]||(s[10]=d=>t.settings=d),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),t.inited&&t.tab==="playlist"?(a(),l("div",Aa,[b($,{playlist:t.playlist,filter:t.filter,onStopPlayer:s[11]||(s[11]=d=>t.player.stop()),onFilterChange:t.applyFilter,onCtrl:t.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):v("",!0),t.inited&&t.tab==="commands"?(a(),F(k,{key:4,modelValue:t.commands,"onUpdate:modelValue":[s[12]||(s[12]=d=>t.commands=d),t.sendSave],globalVariables:t.globalVariables,channelPointsCustomRewards:t.channelPointsCustomRewards,possibleActions:t.possibleActions,baseVolume:100},null,8,["modelValue","onUpdate:modelValue","globalVariables","channelPointsCustomRewards","possibleActions"])):v("",!0)],512)])}var Pa=S(Ji,[["render",Ta],["__scopeId","data-v-333c48c3"]]);const Na=()=>({volume:100}),Ra=()=>({showImages:!0}),Fa=V({data:()=>({commands:[],settings:Na(),adminSettings:Ra(),globalVariables:[],channelPointsCustomRewards:{},ws:null,possibleActions:["text","media","media_volume","countdown","dict_lookup","madochan_createword","chatters","set_channel_title","set_channel_game_id","add_stream_tags","remove_stream_tags"],tabDefinitions:[{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"}],inited:!1,tab:"commands"}),computed:{baseVolume(){return this.settings.volume},widgetUrl(){return z.widgetUrl("media")}},methods:{updateShowImages(t){this.adminSettings.showImages=t,this.sendSave()},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings,adminSettings:this.adminSettings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=z.wsClient("general"),this.ws.onMessage("init",t=>{this.commands=t.commands,this.settings=t.settings,this.adminSettings=t.adminSettings,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Ea={id:"app"},Ma={id:"top",ref:"top"},Oa={id:"main",ref:"main"},La={class:"tabs"},qa=["onClick"],za=["href"],Ja={key:1},Ba={key:0,class:"table is-striped",ref:"table"},Wa=e("td",null,[e("code",null,"settings.volume")],-1),Ha=e("td",null,"Base volume for all media playing from commands",-1);function Qa(t,s,n,m,f,y){const h=_("navbar"),i=_("commands-editor"),r=_("volume-slider");return a(),l("div",Ea,[e("div",Ma,[b(h)],512),e("div",Oa,[e("div",La,[e("ul",null,[(a(!0),l(U,null,A(t.tabDefinitions,(o,$)=>(a(),l("li",{key:$,class:P({"is-active":t.tab===o.tab}),onClick:k=>t.tab=o.tab},[e("a",null,w(o.title),1)],10,qa))),128)),e("li",null,[e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open Media widget",8,za)])])]),t.inited&&t.tab==="commands"?(a(),F(i,{key:0,modelValue:t.commands,"onUpdate:modelValue":[s[0]||(s[0]=o=>t.commands=o),t.sendSave],globalVariables:t.globalVariables,channelPointsCustomRewards:t.channelPointsCustomRewards,possibleActions:t.possibleActions,baseVolume:t.baseVolume,showToggleImages:!0,showFilterActions:!0,showImages:t.adminSettings.showImages,onShowImagesChange:t.updateShowImages},null,8,["modelValue","onUpdate:modelValue","globalVariables","channelPointsCustomRewards","possibleActions","baseVolume","showImages","onShowImagesChange"])):v("",!0),t.inited&&t.tab==="settings"?(a(),l("div",Ja,[t.settings?(a(),l("table",Ba,[e("tbody",null,[e("tr",null,[Wa,e("td",null,[b(r,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[1]||(s[1]=o=>t.settings.volume=o),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])]),Ha])])],512)):v("",!0)])):v("",!0)],512)])}var Ka=S(Fa,[["render",Qa]]);const Et=()=>({status:{enabled:!1},styles:{bgColor:"#ff00ff",vAlign:"bottom",recognition:{fontFamily:"sans-serif",fontSize:"30",fontWeight:"400",strokeWidth:"8",strokeColor:"#292929",color:"#ffff00"},translation:{fontFamily:"sans-serif",fontSize:"30",fontWeight:"400",strokeWidth:"8",strokeColor:"#292929",color:"#cbcbcb"}},recognition:{display:!0,lang:"ja",synthesize:!1,synthesizeLang:""},translation:{enabled:!0,langSrc:"ja",langDst:"en",synthesize:!1,synthesizeLang:""}}),Ga=V({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:Et(),defaultSettings:Et(),ws:null,inited:!1}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return z.widgetUrl("speech-to-text")}},methods:{sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=z.wsClient("speech-to-text"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Ya={id:"app"},Xa={id:"top",ref:"top"},Za={id:"actionbar",class:"p-1"},ja=["disabled"],xa=["href"],tl={id:"main",ref:"main"},el={key:0,class:"table is-striped",ref:"table"},sl=e("tr",null,[e("td",{colspan:"3"},"General")],-1),nl=e("td",null,[e("code",null,"settings.style.bgColor")],-1),il=["disabled"],al=e("i",{class:"fa fa-remove"},null,-1),ll=[al],ol=e("td",null,[e("code",null,"settings.style.vAlign")],-1),rl={class:"select is-small"},dl=e("option",{value:"top"},"top",-1),ul=e("option",{value:"bottom"},"bottom",-1),ml=[dl,ul],hl=["disabled"],cl=e("i",{class:"fa fa-remove"},null,-1),pl=[cl],gl=e("tr",null,[e("td",{colspan:"3"},"Recognition")],-1),fl=e("td",null,[e("code",null,"settings.recognition.lang")],-1),vl=["disabled"],yl=e("i",{class:"fa fa-remove"},null,-1),$l=[yl],_l=e("td",null,[e("code",null,"settings.recognition.synthesize")],-1),bl=["disabled"],wl=e("i",{class:"fa fa-remove"},null,-1),kl=[wl],Cl=e("td",null,[e("code",null,"settings.recognition.synthesizeLang")],-1),Vl=["disabled"],Sl=e("i",{class:"fa fa-remove"},null,-1),Dl=[Sl],Ul=e("td",null,[e("code",null,"settings.recognition.display")],-1),Il=["disabled"],Al=e("i",{class:"fa fa-remove"},null,-1),Tl=[Al],Pl=e("td",null,[e("code",null,"settings.styles.recognition.color")],-1),Nl=["disabled"],Rl=e("i",{class:"fa fa-remove"},null,-1),Fl=[Rl],El=e("td",null,[e("code",null,"settings.styles.recognition.strokeWidth")],-1),Ml=["disabled"],Ol=e("i",{class:"fa fa-remove"},null,-1),Ll=[Ol],ql=e("td",null,[e("code",null,"settings.styles.recognition.strokeColor")],-1),zl=["disabled"],Jl=e("i",{class:"fa fa-remove"},null,-1),Bl=[Jl],Wl=e("td",null,[e("code",null,"settings.styles.recognition.fontFamily")],-1),Hl=["disabled"],Ql=e("i",{class:"fa fa-remove"},null,-1),Kl=[Ql],Gl=e("td",null,[e("code",null,"settings.styles.recognition.fontSize")],-1),Yl=["disabled"],Xl=e("i",{class:"fa fa-remove"},null,-1),Zl=[Xl],jl=e("td",null,[e("code",null,"settings.styles.recognition.fontWeight")],-1),xl=["disabled"],to=e("i",{class:"fa fa-remove"},null,-1),eo=[to],so=e("tr",null,[e("td",{colspan:"3"},"Translation")],-1),no=e("td",null,[e("code",null,"settings.translation.enabled")],-1),io=["disabled"],ao=e("i",{class:"fa fa-remove"},null,-1),lo=[ao],oo=e("td",null,[e("code",null,"settings.translation.synthesize")],-1),ro=["disabled"],uo=e("i",{class:"fa fa-remove"},null,-1),mo=[uo],ho=e("td",null,[e("code",null,"settings.translation.synthesizeLang")],-1),co=["disabled"],po=e("i",{class:"fa fa-remove"},null,-1),go=[po],fo=e("td",null,[e("code",null,"settings.translation.langSrc")],-1),vo=["disabled"],yo=e("i",{class:"fa fa-remove"},null,-1),$o=[yo],_o=e("td",null,[e("code",null,"settings.translation.langDst")],-1),bo=["disabled"],wo=e("i",{class:"fa fa-remove"},null,-1),ko=[wo],Co=e("td",null,[e("code",null,"settings.styles.translation.color")],-1),Vo=["disabled"],So=e("i",{class:"fa fa-remove"},null,-1),Do=[So],Uo=e("td",null,[e("code",null,"settings.styles.translation.strokeWidth")],-1),Io=["disabled"],Ao=e("i",{class:"fa fa-remove"},null,-1),To=[Ao],Po=e("td",null,[e("code",null,"settings.styles.translation.strokeColor")],-1),No=["disabled"],Ro=e("i",{class:"fa fa-remove"},null,-1),Fo=[Ro],Eo=e("td",null,[e("code",null,"settings.styles.translation.fontFamily")],-1),Mo=["disabled"],Oo=e("i",{class:"fa fa-remove"},null,-1),Lo=[Oo],qo=e("td",null,[e("code",null,"settings.styles.translation.fontSize")],-1),zo=["disabled"],Jo=e("i",{class:"fa fa-remove"},null,-1),Bo=[Jo],Wo=e("td",null,[e("code",null,"settings.styles.translation.fontWeight")],-1),Ho=["disabled"],Qo=e("i",{class:"fa fa-remove"},null,-1),Ko=[Qo],Go=e("tr",null,[e("td",{colspan:"3"},"Debug")],-1),Yo=e("td",null,[e("code",null,"settings.status.enabled")],-1),Xo=["disabled"],Zo=e("i",{class:"fa fa-remove"},null,-1),jo=[Zo];function xo(t,s,n,m,f,y){const h=_("navbar");return a(),l("div",Ya,[e("div",Xa,[b(h),e("div",Za,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...i)=>t.sendSave&&t.sendSave(...i))}," Save ",8,ja),e("a",{class:"button is-small",href:t.widgetUrl,target:"_blank"},"Open widget",8,xa)])],512),e("div",tl,[t.inited?(a(),l("table",el,[e("tbody",null,[sl,e("tr",null,[nl,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=i=>t.settings.styles.bgColor=i)},null,512),[[g,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=i=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},ll,8,il)])]),e("tr",null,[ol,e("td",null,[e("div",rl,[u(e("select",{"onUpdate:modelValue":s[3]||(s[3]=i=>t.settings.styles.vAlign=i)},ml,512),[[_t,t.settings.styles.vAlign]])])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.vAlign===t.defaultSettings.styles.vAlign,onClick:s[4]||(s[4]=i=>t.settings.styles.vAlign=t.defaultSettings.styles.vAlign)},pl,8,hl)])]),gl,e("tr",null,[fl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=i=>t.settings.recognition.lang=i)},null,512),[[g,t.settings.recognition.lang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.lang===t.defaultSettings.recognition.lang,onClick:s[6]||(s[6]=i=>t.settings.recognition.lang=t.defaultSettings.recognition.lang)},$l,8,vl)])]),e("tr",null,[_l,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=i=>t.settings.recognition.synthesize=i)},null,512),[[O,t.settings.recognition.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesize===t.defaultSettings.recognition.synthesize,onClick:s[8]||(s[8]=i=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},kl,8,bl)])]),e("tr",null,[Cl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=i=>t.settings.recognition.synthesizeLang=i)},null,512),[[g,t.settings.recognition.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesizeLang===t.defaultSettings.recognition.synthesizeLang,onClick:s[10]||(s[10]=i=>t.settings.recognition.synthesizeLang=t.defaultSettings.recognition.synthesizeLang)},Dl,8,Vl)])]),e("tr",null,[Ul,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=i=>t.settings.recognition.display=i)},null,512),[[O,t.settings.recognition.display]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.display===t.defaultSettings.recognition.display,onClick:s[12]||(s[12]=i=>t.settings.recognition.display=t.defaultSettings.recognition.display)},Tl,8,Il)])]),e("tr",null,[Pl,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[13]||(s[13]=i=>t.settings.styles.recognition.color=i)},null,512),[[g,t.settings.styles.recognition.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.color===t.defaultSettings.styles.recognition.color,onClick:s[14]||(s[14]=i=>t.settings.styles.recognition.color=t.defaultSettings.styles.recognition.color)},Fl,8,Nl)])]),e("tr",null,[El,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[15]||(s[15]=i=>t.settings.styles.recognition.strokeWidth=i)},null,512),[[g,t.settings.styles.recognition.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeWidth===t.defaultSettings.styles.recognition.strokeWidth,onClick:s[16]||(s[16]=i=>t.settings.styles.recognition.strokeWidth=t.defaultSettings.styles.recognition.strokeWidth)},Ll,8,Ml)])]),e("tr",null,[ql,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[17]||(s[17]=i=>t.settings.styles.recognition.strokeColor=i)},null,512),[[g,t.settings.styles.recognition.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeColor===t.defaultSettings.styles.recognition.strokeColor,onClick:s[18]||(s[18]=i=>t.settings.styles.recognition.strokeColor=t.defaultSettings.styles.recognition.strokeColor)},Bl,8,zl)])]),e("tr",null,[Wl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[19]||(s[19]=i=>t.settings.styles.recognition.fontFamily=i)},null,512),[[g,t.settings.styles.recognition.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontFamily===t.defaultSettings.styles.recognition.fontFamily,onClick:s[20]||(s[20]=i=>t.settings.styles.recognition.fontFamily=t.defaultSettings.styles.recognition.fontFamily)},Kl,8,Hl)])]),e("tr",null,[Gl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[21]||(s[21]=i=>t.settings.styles.recognition.fontSize=i)},null,512),[[g,t.settings.styles.recognition.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontSize===t.defaultSettings.styles.recognition.fontSize,onClick:s[22]||(s[22]=i=>t.settings.styles.recognition.fontSize=t.defaultSettings.styles.recognition.fontSize)},Zl,8,Yl)])]),e("tr",null,[jl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[23]||(s[23]=i=>t.settings.styles.recognition.fontWeight=i)},null,512),[[g,t.settings.styles.recognition.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontWeight===t.defaultSettings.styles.recognition.fontWeight,onClick:s[24]||(s[24]=i=>t.settings.styles.weight=t.defaultSettings.styles.weight)},eo,8,xl)])]),so,e("tr",null,[no,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=i=>t.settings.translation.enabled=i)},null,512),[[O,t.settings.translation.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.enabled===t.defaultSettings.translation.enabled,onClick:s[26]||(s[26]=i=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},lo,8,io)])]),e("tr",null,[oo,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=i=>t.settings.translation.synthesize=i)},null,512),[[O,t.settings.translation.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesize===t.defaultSettings.translation.synthesize,onClick:s[28]||(s[28]=i=>t.settings.translation.synthesize=t.defaultSettings.translation.synthesize)},mo,8,ro)])]),e("tr",null,[ho,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[29]||(s[29]=i=>t.settings.translation.synthesizeLang=i)},null,512),[[g,t.settings.translation.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesizeLang===t.defaultSettings.translation.synthesizeLang,onClick:s[30]||(s[30]=i=>t.settings.translation.synthesizeLang=t.defaultSettings.translation.synthesizeLang)},go,8,co)])]),e("tr",null,[fo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[31]||(s[31]=i=>t.settings.translation.langSrc=i)},null,512),[[g,t.settings.translation.langSrc]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langSrc===t.defaultSettings.translation.langSrc,onClick:s[32]||(s[32]=i=>t.settings.translation.langSrc=t.defaultSettings.translation.langSrc)},$o,8,vo)])]),e("tr",null,[_o,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[33]||(s[33]=i=>t.settings.translation.langDst=i)},null,512),[[g,t.settings.translation.langDst]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langDst===t.defaultSettings.translation.langDst,onClick:s[34]||(s[34]=i=>t.settings.translation.langDst=t.defaultSettings.translation.langDst)},ko,8,bo)])]),e("tr",null,[Co,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[35]||(s[35]=i=>t.settings.styles.translation.color=i)},null,512),[[g,t.settings.styles.translation.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.color===t.defaultSettings.styles.translation.color,onClick:s[36]||(s[36]=i=>t.settings.styles.translation.color=t.defaultSettings.styles.translation.color)},Do,8,Vo)])]),e("tr",null,[Uo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[37]||(s[37]=i=>t.settings.styles.translation.strokeWidth=i)},null,512),[[g,t.settings.styles.translation.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeWidth===t.defaultSettings.styles.translation.strokeWidth,onClick:s[38]||(s[38]=i=>t.settings.styles.translation.strokeWidth=t.defaultSettings.styles.translation.strokeWidth)},To,8,Io)])]),e("tr",null,[Po,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[39]||(s[39]=i=>t.settings.styles.translation.strokeColor=i)},null,512),[[g,t.settings.styles.translation.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeColor===t.defaultSettings.styles.translation.strokeColor,onClick:s[40]||(s[40]=i=>t.settings.styles.translation.strokeColor=t.defaultSettings.styles.translation.strokeColor)},Fo,8,No)])]),e("tr",null,[Eo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[41]||(s[41]=i=>t.settings.styles.translation.fontFamily=i)},null,512),[[g,t.settings.styles.translation.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontFamily===t.defaultSettings.styles.translation.fontFamily,onClick:s[42]||(s[42]=i=>t.settings.styles.translation.fontFamily=t.defaultSettings.styles.translation.fontFamily)},Lo,8,Mo)])]),e("tr",null,[qo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[43]||(s[43]=i=>t.settings.styles.translation.fontSize=i)},null,512),[[g,t.settings.styles.translation.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontSize===t.defaultSettings.styles.translation.fontSize,onClick:s[44]||(s[44]=i=>t.settings.styles.translation.fontSize=t.defaultSettings.styles.translation.fontSize)},Bo,8,zo)])]),e("tr",null,[Wo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[45]||(s[45]=i=>t.settings.styles.translation.fontWeight=i)},null,512),[[g,t.settings.styles.translation.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontWeight===t.defaultSettings.styles.translation.fontWeight,onClick:s[46]||(s[46]=i=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Ko,8,Ho)])]),Go,e("tr",null,[Yo,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[47]||(s[47]=i=>t.settings.status.enabled=i)},null,512),[[O,t.settings.status.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.status.enabled===t.defaultSettings.status.enabled,onClick:s[48]||(s[48]=i=>t.settings.status.enabled=t.defaultSettings.status.enabled)},jo,8,Xo)])])])],512)):v("",!0)],512)])}var tr=S(Ga,[["render",xo]]);const er=(t=null)=>{const s=(n,m,f)=>n?typeof n[m]=="undefined"?f:n[m]:f;return{name:s(t,"name",""),width:s(t,"width",64),height:s(t,"height",64),stateDefinitions:s(t,"stateDefinitions",[]),slotDefinitions:s(t,"slotDefinitions",[]),state:s(t,"state",{slots:{},lockedState:""})}},Mt=()=>({styles:{bgColor:"#80ff00"},avatarDefinitions:[]});const sr=V({data:()=>({editIdx:-1,editEntity:null,unchangedJson:"{}",changedJson:"{}",settings:Mt(),defaultSettings:Mt(),ws:null,inited:!1,tabDefinitions:[{tab:"avatars",title:"Avatars"},{tab:"settings",title:"Settings"}],tab:"avatars"}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},controlWidgetUrl(){return z.widgetUrl("avatar")},displayWidgetUrl(){return z.widgetUrl("avatar_receive")}},methods:{edit(t){if(!this.settings){console.warn("edit: this.settings not initialized");return}this.editIdx=t,this.editEntity=this.settings.avatarDefinitions[t]},remove(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.avatarDefinitions=this.settings.avatarDefinitions.filter((s,n)=>n!==t),this.sendSave()},duplicate(t){if(!this.settings){console.warn("duplicate: this.settings not initialized");return}this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=JSON.parse(JSON.stringify(this.settings.avatarDefinitions[t]))},updatedAvatar(t){if(!this.settings){console.warn("updateAvatar: this.settings not initialized");return}this.settings.avatarDefinitions[this.editIdx]=t,this.sendSave()},addAvatar(){if(!this.settings){console.warn("addAvatar: this.settings not initialized");return}const t={name:"Unnamed Avatar",width:64,height:64,stateDefinitions:[{value:"default",deletable:!1},{value:"speaking",deletable:!1}],slotDefinitions:[]};this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=t},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},dragEnd(t){if(!this.settings){console.warn("dragEnd: this.settings not initialized");return}this.settings.avatarDefinitions=X.arrayMove(this.settings.avatarDefinitions,t.oldIndex,t.newIndex),this.sendSave()}},async mounted(){this.ws=z.wsClient("avatar"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),nr={id:"app"},ir={id:"top",ref:"top"},ar={id:"actionbar",class:"p-1"},lr=["href"],or=["href"],rr={key:0,id:"main",ref:"main"},dr={class:"tabs"},ur=["onClick"],mr={key:0,class:"table is-striped"},hr=e("tr",null,[e("td",{colspan:"3"},"General")],-1),cr=e("td",null,[e("code",null,"settings.style.bgColor")],-1),pr=["disabled"],gr=e("i",{class:"fa fa-remove"},null,-1),fr=[gr],vr={key:1},yr={class:"table is-striped"},$r=e("thead",null,[e("tr",null,[e("th"),e("th"),e("th",null,"Preview"),e("th",null,"Name"),e("th",null,"Actions")])],-1),_r=e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1),br={class:"pl-0 pr-0"},wr=["onClick"],kr=e("i",{class:"fa fa-pencil"},null,-1),Cr=[kr],Vr={class:"pl-0 pr-0"},Sr=e("i",{class:"fa fa-trash"},null,-1),Dr=["onClick"],Ur=e("i",{class:"fa fa-clone"},null,-1),Ir=[Ur],Ar=["href"],Tr=e("i",{class:"fa fa-external-link mr-1"},null,-1),Pr=c(" Control widget"),Nr=[Tr,Pr],Rr=["href"],Fr=e("i",{class:"fa fa-external-link mr-1"},null,-1),Er=c(" Display widget"),Mr=[Fr,Er];function Or(t,s,n,m,f,y){const h=_("navbar"),i=_("avatar-preview"),r=_("doubleclick-button"),o=_("draggable"),$=_("avatar-editor");return a(),l("div",nr,[e("div",ir,[b(h),e("div",ar,[e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open control widget",8,lr),e("a",{class:"button is-small mr-1",href:t.displayWidgetUrl,target:"_blank"},"Open display widget",8,or)])],512),t.inited?(a(),l("div",rr,[e("div",dr,[e("ul",null,[(a(!0),l(U,null,A(t.tabDefinitions,(k,d)=>(a(),l("li",{key:d,class:P({"is-active":t.tab===k.tab}),onClick:p=>t.tab=k.tab},[e("a",null,w(k.title),1)],10,ur))),128))])]),t.tab==="settings"?(a(),l("table",mr,[e("tbody",null,[hr,e("tr",null,[cr,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":[s[0]||(s[0]=k=>t.settings.styles.bgColor=k),s[1]||(s[1]=(...k)=>t.sendSave&&t.sendSave(...k))]},null,512),[[g,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=k=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},fr,8,pr)])])])])):v("",!0),t.tab==="avatars"?(a(),l("div",vr,[e("table",yr,[$r,b(o,{modelValue:t.settings.avatarDefinitions,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:q(({element:k,index:d})=>[e("tr",null,[_r,e("td",br,[e("button",{class:"button is-small",onClick:p=>t.edit(d)},Cr,8,wr)]),e("td",null,[b(i,{avatar:k},null,8,["avatar"])]),e("td",null,w(k.name),1),e("td",Vr,[b(r,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:p=>t.remove(d)},{default:q(()=>[Sr]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small mr-1",onClick:p=>t.duplicate(d)},Ir,8,Dr),e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl+"?avatar="+k.name,target:"_blank"},Nr,8,Ar),e("a",{class:"button is-small",href:t.displayWidgetUrl+"?avatar="+k.name,target:"_blank"},Mr,8,Rr)])])]),_:1},8,["modelValue","onEnd"])]),t.editEntity?(a(),F($,{key:0,modelValue:t.editEntity,"onUpdate:modelValue":t.updatedAvatar,onCancel:s[3]||(s[3]=k=>t.editEntity=null)},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),e("span",{class:"button is-small",onClick:s[4]||(s[4]=(...k)=>t.addAvatar&&t.addAvatar(...k))},"Add avatar")])):v("",!0)],512)):v("",!0)])}var Lr=S(sr,[["render",Or]]);const qr=V({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const s=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const n=await M.resetPassword({pass:this.pass,token:s});if(n.status===200)this.success=!0;else try{this.error=(await n.json()).reason}catch{this.error="Unknown error"}}}}),zr={class:"center-screen"},Jr=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Br={key:0,class:"field has-background-success-light has-text-success-dark"},Wr=c(" Password successfully set. Click "),Hr=c("here"),Qr=c(" to login. "),Kr={key:1},Gr={key:0,class:"field has-background-danger-light has-text-danger-dark"},Yr={class:"field"},Xr={class:"control has-icons-left"},Zr=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),jr={class:"field"},xr=["disabled"];function td(t,s,n,m,f,y){const h=_("router-link");return a(),l("div",zr,[Jr,t.success?(a(),l("div",Br,[Wr,b(h,{to:{name:"login"}},{default:q(()=>[Hr]),_:1}),Qr])):(a(),l("div",Kr,[t.error?(a(),l("div",Gr,w(t.error),1)):v("",!0),e("div",Yr,[e("div",Xr,[u(e("input",{class:"input is-small",type:"password",placeholder:"New Password","onUpdate:modelValue":s[0]||(s[0]=i=>t.pass=i),onKeyup:[s[1]||(s[1]=i=>t.error=""),s[2]||(s[2]=G((...i)=>t.submit&&t.submit(...i),["enter"]))]},null,544),[[g,t.pass]]),Zr])]),e("div",jr,[e("button",{class:"button is-small is-primary",disabled:t.canSubmit?null:!0,onClick:s[3]||(s[3]=(...i)=>t.submit&&t.submit(...i))}," Save Password ",8,xr)])]))])}var ed=S(qr,[["render",td]]);const sd=V({data:()=>({email:"",error:"",success:!1}),methods:{async submit(){this.success=!1,this.error="";const t=await M.requestPasswordReset({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),nd={class:"center-screen"},id=e("h1",{class:"title is-6"},"Hyottoko.club",-1),ad={key:0,class:"field has-background-success-light has-text-success-dark"},ld=c(" Password-reset mail sent. Click "),od=c("here"),rd=c(" to login. "),dd={key:1},ud={key:0,class:"field has-background-danger-light has-text-danger-dark"},md={class:"field"},hd={class:"control has-icons-left"},cd=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),pd={class:"field"};function gd(t,s,n,m,f,y){const h=_("router-link");return a(),l("div",nd,[id,t.success?(a(),l("div",ad,[ld,b(h,{to:{name:"login"}},{default:q(()=>[od]),_:1}),rd])):(a(),l("form",dd,[t.error?(a(),l("div",ud,w(t.error),1)):v("",!0),e("div",md,[e("div",hd,[u(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":s[0]||(s[0]=i=>t.email=i),onKeyup:s[1]||(s[1]=i=>t.error="")},null,544),[[g,t.email]]),cd])]),e("div",pd,[e("span",{class:"button is-small is-primary",onClick:s[2]||(s[2]=(...i)=>t.submit&&t.submit(...i))},"Request Password Reset")])]))])}var fd=S(sd,[["render",gd]]);const Z=(t=null)=>({chatMessage:!t||typeof t.chatMessage=="undefined"?"":t.chatMessage,sound:!t||typeof t.sound=="undefined"?{file:"",filename:"",urlpath:"",volume:100}:t.sound}),Ot=(t=null)=>({effect:!t||typeof t.effect=="undefined"?Z():Z(t.effect),offsetMs:!t||typeof t.offsetMs=="undefined"?"":t.offsetMs}),vd=(t=null)=>({fontFamily:!t||typeof t.fontFamily=="undefined"?"":t.fontFamily,fontSize:!t||typeof t.fontSize=="undefined"?"72px":t.fontSize,color:!t||typeof t.color=="undefined"?"":t.color,timerFormat:!t||typeof t.timerFormat=="undefined"?"{mm}:{ss}":t.timerFormat,showTimerWhenFinished:!t||typeof t.showTimerWhenFinished=="undefined"?!0:t.showTimerWhenFinished,finishedText:!t||typeof t.finishedText=="undefined"?"":t.finishedText,startEffect:!t||typeof t.startEffect=="undefined"?Z():Z(t.startEffect),endEffect:!t||typeof t.endEffect=="undefined"?Z():Z(t.endEffect),stopEffect:!t||typeof t.stopEffect=="undefined"?Z():Z(t.stopEffect),notifications:!t||typeof t.notifications=="undefined"?[]:t.notifications.map(Ot)}),yd=V({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:vd(),inited:!1,ws:null}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return z.widgetUrl("pomo")}},methods:{sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},addNotification(){this.settings.notifications.push(Ot())},removeNotification(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.notifications=this.settings.notifications.filter((s,n)=>n!==t)}},async mounted(){this.ws=z.wsClient("pomo"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),$d={id:"app"},_d={id:"top",ref:"top"},bd={id:"actionbar",class:"p-1"},wd=["disabled"],kd=["href"],Cd={id:"main",ref:"main"},Vd={key:0,class:"table is-striped",ref:"table"},Sd=e("tr",null,[e("td",{colspan:"2"},"Pomo")],-1),Dd=e("td",null,[e("code",null,"settings.color")],-1),Ud=e("td",null,[e("code",null,"settings.fontFamily")],-1),Id=e("td",null,[e("code",null,"settings.fontSize")],-1),Ad=e("td",null,[e("code",null,"settings.timerFormat")],-1),Td=e("td",null,[e("code",null,"settings.finishedText")],-1),Pd=e("td",null,[e("code",null,"settings.showTimerWhenFinished")],-1),Nd=e("td",null,[e("code",null,"settings.startEffect.chatMessage")],-1),Rd=e("td",null,[e("code",null,"settings.startEffect.sound")],-1),Fd=e("td",null,[e("code",null,"settings.endEffect.chatMessage")],-1),Ed=e("td",null,[e("code",null,"settings.endEffect.sound")],-1),Md=e("td",null,[e("code",null,"settings.stopEffect.chatMessage")],-1),Od=e("td",null,[e("code",null,"settings.stopEffect.sound")],-1),Ld=e("code",null,"settings.notifications",-1),qd=["onClick"],zd=e("td",null,[e("code",null,"offsetMs")],-1),Jd=e("td",null,[e("code",null,"chatMessage")],-1),Bd=["onUpdate:modelValue"],Wd=e("td",null,[e("code",null,"sound")],-1);function Hd(t,s,n,m,f,y){const h=_("navbar"),i=_("sound-upload"),r=_("duration-input");return a(),l("div",$d,[e("div",_d,[b(h),e("div",bd,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...o)=>t.sendSave&&t.sendSave(...o))}," Save ",8,wd),e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open widget",8,kd)])],512),e("div",Cd,[t.inited?(a(),l("table",Vd,[e("tbody",null,[Sd,e("tr",null,[Dd,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=o=>t.settings.color=o)},null,512),[[g,t.settings.color]])])]),e("tr",null,[Ud,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>t.settings.fontFamily=o)},null,512),[[g,t.settings.fontFamily]])])]),e("tr",null,[Id,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.settings.fontSize=o)},null,512),[[g,t.settings.fontSize]])])]),e("tr",null,[Ad,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[4]||(s[4]=o=>t.settings.timerFormat=o)},null,512),[[g,t.settings.timerFormat]])])]),e("tr",null,[Td,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.settings.finishedText=o)},null,512),[[g,t.settings.finishedText]])])]),e("tr",null,[Pd,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=o=>t.settings.showTimerWhenFinished=o)},null,512),[[O,t.settings.showTimerWhenFinished]])])]),e("tr",null,[Nd,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[7]||(s[7]=o=>t.settings.startEffect.chatMessage=o)},null,512),[[g,t.settings.startEffect.chatMessage]])])]),e("tr",null,[Rd,e("td",null,[b(i,{modelValue:t.settings.startEffect.sound,"onUpdate:modelValue":s[8]||(s[8]=o=>t.settings.startEffect.sound=o),baseVolume:100},null,8,["modelValue"])])]),e("tr",null,[Fd,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=o=>t.settings.endEffect.chatMessage=o)},null,512),[[g,t.settings.endEffect.chatMessage]])])]),e("tr",null,[Ed,e("td",null,[b(i,{modelValue:t.settings.endEffect.sound,"onUpdate:modelValue":s[10]||(s[10]=o=>t.settings.endEffect.sound=o),baseVolume:100},null,8,["modelValue"])])]),e("tr",null,[Md,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[11]||(s[11]=o=>t.settings.stopEffect.chatMessage=o)},null,512),[[g,t.settings.stopEffect.chatMessage]])])]),e("tr",null,[Od,e("td",null,[b(i,{modelValue:t.settings.stopEffect.sound,"onUpdate:modelValue":s[12]||(s[12]=o=>t.settings.stopEffect.sound=o),baseVolume:100},null,8,["modelValue"])])]),e("tr",null,[e("td",null,[Ld,e("span",{class:"button is-small",onClick:s[13]||(s[13]=(...o)=>t.addNotification&&t.addNotification(...o))},"Add notification")]),e("td",null,[(a(!0),l(U,null,A(t.settings.notifications,(o,$)=>(a(),l("div",{key:$},[e("span",{class:"button is-small",onClick:k=>t.removeNotification($)},"Remove",8,qd),e("table",null,[e("tr",null,[zd,e("td",null,[b(r,{modelValue:o.offsetMs,"onUpdate:modelValue":k=>o.offsetMs=k,allowNegative:!0},null,8,["modelValue","onUpdate:modelValue"])])]),e("tr",null,[Jd,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":k=>o.effect.chatMessage=k},null,8,Bd),[[g,o.effect.chatMessage]])])]),e("tr",null,[Wd,e("td",null,[b(i,{modelValue:o.effect.sound,"onUpdate:modelValue":k=>o.effect.sound=k,baseVolume:100},null,8,["modelValue","onUpdate:modelValue"])])])])]))),128))])])])],512)):v("",!0)],512)])}var Qd=S(yd,[["render",Hd]]);const Kd=V({name:"upload",props:{accept:String,label:{type:String,default:"Upload File"}},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?` Uploading (${this.uploadPercent}%)`:this.label?` ${this.label}`:""},progressStyle(){if(!this.uploading)return{};const t=this.uploadPercent,s="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${s} 0%, ${s} ${t}%, transparent ${t}%)`}}},methods:{async uploadFile(t){this.uploading=!0;const s=await M.upload(t,m=>{this.progress=m.loaded/m.total});this.uploading=!1;const n=await s.json();this.$emit("uploaded",n)},async upload(t){const s=t.target.files[0];!s||this.uploadFile(s)}}}),Gd={class:"upload"},Yd=["disabled","accept"],Xd={class:"button is-small"};function Zd(t,s,n,m,f,y){return a(),l("label",Gd,[e("input",{type:"file",disabled:t.uploading,style:{display:"none"},onChange:s[0]||(s[0]=(...h)=>t.upload&&t.upload(...h)),accept:t.accept},null,40,Yd),e("span",Xd,[e("i",{class:P(["fa fa-upload",{"mr-1":t.buttonText}])},null,2),c(w(t.buttonText),1)]),e("span",{class:"progress",style:Y(t.progressStyle)},null,4)])}var jd=S(Kd,[["render",Zd],["__scopeId","data-v-3ff87f77"]]);const xd=V({props:{modelValue:{required:!0},width:{type:String,required:!1,default:"100%"},height:{type:String,required:!1,default:"90px"}},emits:["update:modelValue"],data(){return{value:{file:"",filename:"",urlpath:""},draggingOver:!1}},created(){this.modelValue!==null&&(this.value=JSON.parse(JSON.stringify(this.modelValue)))},methods:{emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={file:"",filename:"",urlpath:""},this.emitUpdate()},onUploaded(t){this.value=Dt(t),this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if(t.dataTransfer.items[n].kind==="file"){s=t.dataTransfer.items[n].getAsFile();break}}else for(var n=0;n<t.dataTransfer.files.length;n++){s=t.dataTransfer.files[n];break}return s&&(this.value.file="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),tu=t=>(W("data-v-2882bcde"),t=t(),H(),t),eu=tu(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),su=c(" Remove "),nu=[eu,su],iu={key:2};function au(t,s,n,m,f,y){const h=_("responsive-image"),i=_("upload");return a(),l("div",{onDrop:s[1]||(s[1]=(...r)=>t.onDrop&&t.onDrop(...r)),onDragover:s[2]||(s[2]=(...r)=>t.onDragover&&t.onDragover(...r)),onDragleave:s[3]||(s[3]=(...r)=>t.onDragleave&&t.onDragleave(...r)),class:P(["image-upload",{"dragging-over":t.draggingOver}])},[t.value.file?(a(),F(h,{key:0,src:t.value.urlpath,title:t.value.filename,width:t.width,height:t.height,style:{display:"block"}},null,8,["src","title","width","height"])):v("",!0),t.value.file?(a(),l("button",{key:1,class:"button is-small",onClick:s[0]||(s[0]=(...r)=>t.onRemove&&t.onRemove(...r))},nu)):v("",!0),t.value.file?(a(),l("br",iu)):v("",!0),b(i,{onUploaded:t.onUploaded,accept:"image/*",label:"Upload Image",class:P({"mt-1":t.value.file}),ref:"uploadComponent"},null,8,["onUploaded","class"])],34)}var lu=S(xd,[["render",au],["__scopeId","data-v-2882bcde"]]);const ou=V({props:{modelValue:{required:!0},baseVolume:{default:100}},emits:["update:modelValue"],data(){return{value:{file:"",filename:"",urlpath:"",volume:100},draggingOver:!1}},created(){this.modelValue!==null&&(this.value=JSON.parse(JSON.stringify(this.modelValue)))},methods:{emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={file:"",filename:"",urlpath:"",volume:100},this.emitUpdate()},onUploaded(t){this.value=Ut(t),this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if(t.dataTransfer.items[n].kind==="file"){s=t.dataTransfer.items[n].getAsFile();break}}else for(var n=0;n<t.dataTransfer.files.length;n++){s=t.dataTransfer.files[n];break}return s&&(this.value.file="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),ru=t=>(W("data-v-7ae97750"),t=t(),H(),t),du=ru(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),uu=c(" Remove "),mu=[du,uu],hu={key:3};function cu(t,s,n,m,f,y){const h=_("player"),i=_("volume-slider"),r=_("upload");return a(),l("div",{onDrop:s[2]||(s[2]=(...o)=>t.onDrop&&t.onDrop(...o)),onDragover:s[3]||(s[3]=(...o)=>t.onDragover&&t.onDragover(...o)),onDragleave:s[4]||(s[4]=(...o)=>t.onDragleave&&t.onDragleave(...o)),class:P(["sound-upload",{"dragging-over":t.draggingOver}])},[t.value.file?(a(),F(h,{key:0,src:t.value.urlpath,name:t.value.filename,volume:t.value.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):v("",!0),t.value.file?(a(),F(i,{key:1,modelValue:t.value.volume,"onUpdate:modelValue":s[0]||(s[0]=o=>{t.value.volume=o,this.emitUpdate()})},null,8,["modelValue"])):v("",!0),t.value.file?(a(),l("button",{key:2,class:"button is-small",onClick:s[1]||(s[1]=(...o)=>t.onRemove&&t.onRemove(...o))},mu)):v("",!0),t.value.file?(a(),l("br",hu)):v("",!0),b(r,{onUploaded:t.onUploaded,accept:"audio/*",label:"Upload Sound",class:P({"mt-1":t.value.file}),ref:"uploadComponent"},null,8,["onUploaded","class"])],34)}var pu=S(ou,[["render",cu],["__scopeId","data-v-7ae97750"]]);const gu=V({props:{modelValue:{required:!0},allowNegative:{type:Boolean,default:!1}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(t){try{const s=X.doDummyReplacements(t,"0");X.mustParseHumanDuration(s,this.allowNegative),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",t)}},modelValue:{handler(t){this.v=`${t}`}}}});function fu(t,s,n,m,f,y){return u((a(),l("input",{class:P(["input is-small spaceinput",t.classes]),"onUpdate:modelValue":s[0]||(s[0]=h=>t.v=h)},null,2)),[[g,t.v]])}var vu=S(gu,[["render",fu]]);const yu=V({props:{modelValue:{type:Object,required:!0},onValue:{type:Object,default:!0},offValue:{type:Object,default:!1}},emits:["update:modelValue"],data(){return{value:!1}},created(){this.value=this.modelValue===this.onValue},methods:{emitUpdate(){this.$emit("update:modelValue",this.value?this.onValue:this.offValue)}}});function $u(t,s,n,m,f,y){return u((a(),l("input",{type:"checkbox","onUpdate:modelValue":[s[0]||(s[0]=h=>t.value=h),s[1]||(s[1]=(...h)=>t.emitUpdate&&t.emitUpdate(...h))]},null,512)),[[O,t.value]])}var _u=S(yu,[["render",$u]]);const bu=V({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const t=parseInt(`${this.baseVolume}`,10)/100,s=parseInt(`${this.volume}`,10)/100;this.audio.volume=t*s,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio(this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function wu(t,s,n,m,f,y){return t.src?(a(),l("span",{key:0,class:"player",onClick:s[0]||(s[0]=(...h)=>t.toggle&&t.toggle(...h))},[c(w(t.name)+" ",1),e("i",{class:P(["fa ml-1",t.cls])},null,2)])):v("",!0)}var ku=S(bu,[["render",wu]]);const Cu=V({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),Vu={class:"columns"},Su={class:"column is-four-fifth"},Du={class:"control has-icons-left has-icons-right range slider"},Uu=["min","max"],Iu={class:"icon is-small is-left"},Au={class:"icon is-small is-right"},Tu={class:"column is-one-fifth"};function Pu(t,s,n,m,f,y){return a(),l("div",Vu,[e("div",Su,[e("div",Du,[u(e("input",{type:"range",class:"input is-small",min:t.min,max:t.max,"onUpdate:modelValue":[s[0]||(s[0]=h=>t.curVal=h),s[1]||(s[1]=(...h)=>t.valChange&&t.valChange(...h))]},null,8,Uu),[[g,t.curVal]]),e("span",Iu,[e("i",{class:P(["fa",t.iconLeft])},null,2)]),e("span",Au,[e("i",{class:P(["fa",t.iconRight])},null,2)])])]),e("div",Tu,[u(e("input",{type:"number",class:"input is-small","onUpdate:modelValue":[s[2]||(s[2]=h=>t.curVal=h),s[3]||(s[3]=(...h)=>t.valChange&&t.valChange(...h))]},null,512),[[g,t.curVal]])])])}var Nu=S(Cu,[["render",Pu],["__scopeId","data-v-0799d56c"]]);const Ru=V({name:"volume-slider",props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.volume}`,10))}},created(){this.volume=parseInt(`${this.modelValue}`,10)}});function Fu(t,s,n,m,f,y){const h=_("slider");return a(),F(h,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:t.volume,"onUpdate:modelValue":[s[0]||(s[0]=i=>t.volume=i),t.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var Eu=S(Ru,[["render",Fu]]);const Mu=V({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(${this.src})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),Ou=["title"];function Lu(t,s,n,m,f,y){return a(),l("div",{class:"responsive-image",style:Y(t.style),title:t.title},null,12,Ou)}var qu=S(Mu,[["render",Lu]]);const pt=$t();let it,yt={problems:[]};function zu(){it=z.wsClient("core"),it.onMessage(["status"],t=>{JSON.stringify(yt)!==JSON.stringify(t)&&(yt=t,pt.emit("status",yt))}),it.connect()}function Ju(){it&&(it.disconnect(),it=null)}var Lt={init:zu,stop:Ju,eventBus:pt},Bu="/assets/hyottoko.30d2bcb9.png";const Wu=V({name:"navbar",computed:{user(){var t,s;return((s=(t=this.$me)==null?void 0:t.user)==null?void 0:s.name)||""}},created(){this.$me=Q.getMe(),pt.on("status",this.statusChanged)},beforeUnmount(){pt.off("status",this.statusChanged)},data:()=>({$me:null,linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"avatar"},text:"Avatar"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"pomo"},text:"Pomo"},{to:{name:"settings"},text:"Settings"}],problems:[],burgerActive:!1}),methods:{statusChanged(t){this.problems=t.problems},toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){const t=await Q.logout();if(t.error)throw new Error(t.error);this.$router.push({name:"login"})}}}),Hu={class:"navbar",role:"navigation","aria-label":"main navigation"},Qu={class:"navbar-brand"},Ku=e("img",{src:Bu,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),Gu={class:"greeting"},Yu=e("span",{"aria-hidden":"true"},null,-1),Xu=e("span",{"aria-hidden":"true"},null,-1),Zu=e("span",{"aria-hidden":"true"},null,-1),ju=[Yu,Xu,Zu],xu={class:"navbar-start"},tm={class:"navbar-end"},em=["title"],sm=e("i",{class:"fa fa-warning mr-1"},null,-1);function nm(t,s,n,m,f,y){const h=_("router-link");return a(),l("nav",Hu,[e("div",Qu,[b(h,{class:"navbar-item",to:{name:"index"}},{default:q(()=>[Ku,e("span",Gu,"Welcome back, "+w(t.user),1)]),_:1}),e("a",{role:"button",class:P(["navbar-burger",{"is-active":t.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:s[0]||(s[0]=(...i)=>t.toggleBurgerMenu&&t.toggleBurgerMenu(...i))},ju,2)]),e("div",{id:"navbarBasicExample",class:P(["navbar-menu",{"is-active":t.burgerActive}])},[e("div",xu,[(a(!0),l(U,null,A(t.linksStart,(i,r)=>(a(),F(h,{class:"navbar-item",key:r,to:i.to},{default:q(()=>[c(w(i.text),1)]),_:2},1032,["to"]))),128))]),e("div",tm,[t.problems.length?(a(),l("a",{key:0,class:"navbar-item has-text-danger",title:t.problems.join(" ---- ")},[sm,c(" "+w(t.problems.length)+" Problem"+w(t.problems.length>1?"s":""),1)],8,em)):v("",!0),e("a",{class:"navbar-item",onClick:s[1]||(s[1]=(...i)=>t.onLogoutClick&&t.onLogoutClick(...i))},"Logout")])],2)])}var im=S(Wu,[["render",nm]]);const am=V({props:{value:{required:!0}},computed:{tag(){try{return X.mustParseHumanDuration(`${this.value}`),"span"}catch{return"code"}},humanReadable(){try{return X.humanDuration(X.mustParseHumanDuration(`${this.value}`))}catch{return this.value}}}}),lm={key:0},om={key:1};function rm(t,s,n,m,f,y){return t.tag==="span"?(a(),l("span",lm,w(t.humanReadable),1)):(a(),l("code",om,w(t.humanReadable),1))}var dm=S(am,[["render",rm]]);const um=V({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null||this.time===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time&&(this.time-=10),(!this.time||this.time<=0)&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),mm={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function hm(t,s,n,m,f,y){return a(),l("button",{class:"doubleclick-button",onClick:s[0]||(s[0]=(...h)=>t.onClick&&t.onClick(...h))},[Jt(t.$slots,"default",{},void 0,!0),t.timer?(a(),l("span",mm,[c(w(t.message)+" ",1),e("span",{class:"doubleclick-button-timout-indicator",style:Y(t.indicatorStyle)},null,4)])):v("",!0)])}var cm=S(um,[["render",hm],["__scopeId","data-v-621de3e2"]]);const pm=V({props:{label:{type:String,required:!0},actions:{type:Array,required:!0}},emits:["click"],data(){return{active:!1}},methods:{onActionClick(t){this.closeDropdown(),this.$emit("click",t)},openDropdown(){this.active=!0},closeDropdown(){this.active=!1},hideDropdown(t){!this.$refs.dropdown||this.$refs.dropdown.contains(t.target)||this.closeDropdown()}},mounted(){window.addEventListener("click",this.hideDropdown)},unmounted(){window.removeEventListener("click",this.hideDropdown)}}),gm=t=>(W("data-v-56f27a9a"),t=t(),H(),t),fm={class:"dropdown-trigger"},vm=gm(()=>e("span",{class:"icon is-small"},[e("i",{class:"fa fa-angle-down","aria-hidden":"true"})],-1)),ym={class:"dropdown-menu",id:"dropdown-menu",role:"menu"},$m={class:"dropdown-content"},_m=["onClick","title"];function bm(t,s,n,m,f,y){return a(),l("div",{class:P(["dropdown mr-1",{"is-active":t.active}]),ref:"dropdown"},[e("div",fm,[e("button",{class:"button is-small mr-1","aria-haspopup":"true","aria-controls":"dropdown-menu",onClick:s[0]||(s[0]=(...h)=>t.openDropdown&&t.openDropdown(...h))},[e("span",null,w(t.label),1),vm])]),e("div",ym,[e("div",$m,[(a(!0),l(U,null,A(t.actions,(h,i)=>(a(),l("span",{class:"dropdown-item is-clickable",key:i,onClick:r=>t.onActionClick(h),title:h.title},w(h.label),9,_m))),128))])])],2)}var wm=S(pm,[["render",bm],["__scopeId","data-v-56f27a9a"]]);const tt=(...t)=>console.log("[youtube.js]",...t);let qt=!1;function km(){return qt?(tt("ytapi ALREADY ready"),Promise.resolve()):new Promise(t=>{const s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",document.head.append(s),window.onYouTubeIframeAPIReady=()=>{qt=!0,tt("ytapi ready"),t()}})}function Cm(t){return new Promise(s=>{tt("create player on "+t);const n=new YT.Player(t,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{tt("player ready"),s(n)}}})})}async function Vm(t){return await km(),await Cm(t)}const Sm=V({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const t=this.getDuration(),s=this.getCurrentTime();return t?s/t:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let t=20;this.tryPlayInterval=setInterval(()=>{if(tt("playing",this.playing(),"triesRemaining",t),--t,this.playing()||t<0){tt("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(t){this.yt?(this.yt.cueVideoById(t),this.tryPlay()):this.toplay=t},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(t){this.yt?this.yt.setVolume(t):this.tovolume=t},setLoop(t){this.loop=t},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await Vm(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(tt("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",t=>{t.data===YT.PlayerState.CUED?this.tryPlay():t.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),Dm=["id"];function Um(t,s,n,m,f,y){return a(),l("div",{id:t.id},null,8,Dm)}var Im=S(Sm,[["render",Um]]);const Am=V({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},channelPointsCustomRewards:{type:Object,required:!0},baseVolume:{default:100}},emits:["update:modelValue","cancel"],data:()=>({item:null,variableChangeFocusIdx:-1,dictLangs:[{value:"ja",flag:"\u{1F1EF}\u{1F1F5}",title:"Japanese"},{value:"ru",flag:"\u{1F1F7}\u{1F1FA}",title:"Russian"},{value:"de",flag:"\u{1F1E9}\u{1F1EA}",title:"German"},{value:"es",flag:"\u{1F1EA}\u{1F1F8}",title:"Spanish"},{value:"fr",flag:"\u{1F1EB}\u{1F1F7}",title:"French"},{value:"it",flag:"\u{1F1EE}\u{1F1F9}",title:"Italian"},{value:"pt",flag:"\u{1F1F5}\u{1F1F9}/\u{1F1E7}\u{1F1F7}",title:"Portuguese"}],possiblePermissions:Pt}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(t){this.item=JSON.parse(JSON.stringify(t))}}},methods:{addtxt(){if(!this.item){console.warn("addtxt: this.item not initialized");return}this.item.data.text.push(vt())},addtrigger(t){if(!this.item){console.warn("addtrigger: this.item not initialized");return}this.item.triggers.push(Rt(t.type))},onAddVariableChange(){if(!this.item){console.warn("onAddVariableChange: this.item not initialized");return}this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(t){if(!this.item){console.warn("rmVariableChange: this.item not initialized");return}this.item.variableChanges=this.item.variableChanges.filter((s,n)=>n!==t)},onAddVariable(){if(!this.item){console.warn("onAddVariable: this.item not initialized");return}this.item.variables.push({name:"",value:""})},rmVariable(t){if(!this.item){console.warn("rmVariable: this.item not initialized");return}this.item.variables=this.item.variables.filter((s,n)=>n!==t)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndChanged(t){if(!this.item){console.warn("mediaSndChanged: this.item not initialized");return}this.item.data.sound=t},mediaImgChanged(t){if(!this.item){console.warn("mediaImgUploaded: this.item not initialized");return}this.item.data.image=t},rmtxt(t){if(!this.item){console.warn("rmtxt: this.item not initialized");return}this.item.data.text=this.item.data.text.filter((s,n)=>n!==t)},rmtrigger(t){if(!this.item){console.warn("rmtrigger: this.item not initialized");return}this.item.triggers=this.item.triggers.filter((s,n)=>n!==t)},autocompletableVariables(t){if(!this.item){console.warn("autocompletableVariables: this.item not initialized");return}const s=this.item.variables.slice().map(n=>({var:n,type:"local"}));return this.globalVariables.forEach(n=>{s.find(m=>m.var.name===n.name)||s.push({var:n,type:"global"})}),s.filter(n=>n.var.name.startsWith(t)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{requiresAccessToken(){return this.item?st[this.item.action].RequiresAccessToken():!1},possibleTriggerActions(){return[{type:"command",label:"Add Command",title:"Command"},{type:"first_chat",label:"Add First Chat",title:"First Chat"},{type:"reward_redemption",label:"Add Reward Redemption",title:"Reward Redemption"},{type:"timer",label:"Add Timer",title:"Timer"}]},valid(){if(!this.item)return!1;for(const t of this.item.triggers)if(!qi(t))return!1;if(this.item.action==="text"){for(const t of this.item.data.text)if(t==="")return!1}return!0},actionDescription(){return this.item?st[this.item.action].Description():""},title(){return this.item?`${{create:"Create new ",edit:"Edit "}[this.mode]}${st[this.item.action].Name()}`:""}}}),I=t=>(W("data-v-afb8c9e2"),t=t(),H(),t),Tm={key:0,class:"modal is-active"},Pm={class:"modal-card"},Nm={class:"modal-card-head"},Rm={class:"modal-card-title"},Fm={class:"modal-card-body"},Em={class:"table is-striped"},Mm=I(()=>e("td",null,"Triggers:",-1)),Om={key:0},Lm=I(()=>e("td",null,"Description:",-1)),qm=["innerHTML"],zm={key:1},Jm=I(()=>e("td",null,"Attention:",-1)),Bm=I(()=>e("td",null,[e("div",{class:"help"},[c(" This requires "),e("code",null,"Access Token"),c(" to be set in the user settings. ")])],-1)),Wm=[Jm,Bm],Hm={key:2},Qm=I(()=>e("td",null,"Stream title:",-1)),Km={key:3},Gm=I(()=>e("td",null,"Stream category:",-1)),Ym={key:4},Xm=I(()=>e("td",null,"Tag to add:",-1)),Zm={key:5},jm=I(()=>e("td",null,"Tag to remove:",-1)),xm={key:6},th=I(()=>e("td",null,"Tag:",-1)),eh=I(()=>e("td",null,"Language:",-1)),sh=["onClick","title"],nh=I(()=>e("code",null,"$args(0)",-1)),ih=[nh],ah=I(()=>e("td",null,"Phrase:",-1)),lh=I(()=>e("code",null,"$args(1:)",-1)),oh=[lh],rh=I(()=>e("tr",null,[e("td",null,"Response:"),e("td",null,[e("div",{class:"help"},[c(" Outputs the translation for the input phrase. The translation is always from/to english. "),e("br"),c(" To let the user decide on the language use "),e("code",null,"$args(0)"),c(" as language, and "),e("code",null,"$args(1:)"),c(" as phrase. "),e("br"),c(" If phrase is left empty, all arguments to the command will be used as the phrase. ")])])],-1)),dh=I(()=>e("td",null,"Model:",-1)),uh={class:"control"},mh=I(()=>e("div",{class:"help"},[c(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),hh=I(()=>e("td",null,"Weirdness:",-1)),ch={class:"control"},ph=I(()=>e("div",{class:"help"},[c(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),gh={key:9},fh=I(()=>e("td",null,"Response:",-1)),vh=I(()=>e("td",null,"Outputs the people who chatted during the stream.",-1)),yh=[fh,vh],$h={key:10},_h=I(()=>e("td",null,"Response:",-1)),bh=["onUpdate:modelValue"],wh=["disabled","onClick"],kh=I(()=>e("i",{class:"fa fa-remove"},null,-1)),Ch=[kh],Vh={class:"field"},Sh=I(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),Dh=c(" Add response "),Uh=[Sh,Dh],Ih=I(()=>e("div",null,[e("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),Ah={key:11},Th=I(()=>e("td",null,"Image:",-1)),Ph={key:12},Nh=I(()=>e("td",null,"Sound:",-1)),Rh={key:13},Fh=I(()=>e("td",null,"Duration:",-1)),Eh={class:"control has-icons-left"},Mh=I(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),Oh={key:14},Lh=I(()=>e("td",null,"Settings",-1)),qh=I(()=>e("td",null,"Variables:",-1)),zh={key:0},Jh=I(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Value")])],-1)),Bh=["onUpdate:modelValue"],Wh=["onUpdate:modelValue"],Hh=["onClick"],Qh=I(()=>e("i",{class:"fa fa-remove"},null,-1)),Kh=[Qh],Gh=I(()=>e("div",{class:"help"},[c(" Variables can be used from the command with "),e("code",null,"$var(variable_name)"),c(". If the referenced variable is not defined here, "),e("a",{href:"/variables/",target:"_blank"},"global variables"),c(" are used. ")],-1)),Yh=I(()=>e("td",null,"Variable changes:",-1)),Xh={key:0},Zh=I(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Change"),e("td",null,"Value"),e("td")])],-1)),jh={class:"dropdown is-active is-up"},xh={class:"dropdown-trigger"},tc=["onUpdate:modelValue","onFocus"],ec={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},sc={class:"dropdown-content"},nc=["onClick"],ic=c(") "),ac={class:"select is-small"},lc=["onUpdate:modelValue"],oc=I(()=>e("option",{value:"set"},"set",-1)),rc=I(()=>e("option",{value:"increase_by"},"increase by",-1)),dc=I(()=>e("option",{value:"decrease_by"},"decrease by",-1)),uc=[oc,rc,dc],mc=["onUpdate:modelValue"],hc=["onClick"],cc=I(()=>e("i",{class:"fa fa-remove"},null,-1)),pc=[cc],gc=I(()=>e("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),fc=I(()=>e("td",null,"Permissions:",-1)),vc=["value"],yc={class:"modal-card-foot"},$c=["disabled"];function _c(t,s,n,m,f,y){const h=_("trigger-editor"),i=_("dropdown-button"),r=_("image-upload"),o=_("sound-upload"),$=_("duration-input"),k=_("countdown-editor");return t.item?(a(),l("div",Tm,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...d)=>t.onOverlayClick&&t.onOverlayClick(...d))}),e("div",Pm,[e("header",Nm,[e("p",Rm,w(t.title),1),e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...d)=>t.onCloseClick&&t.onCloseClick(...d))})]),e("section",Fm,[e("table",Em,[e("tbody",null,[e("tr",null,[Mm,e("td",null,[(a(!0),l(U,null,A(t.item.triggers,(d,p)=>(a(),F(h,{key:p,class:"spacerow",modelValue:d,channelPointsCustomRewards:t.channelPointsCustomRewards,removable:t.item.triggers.length>1,"onUpdate:modelValue":C=>t.item.triggers[p]=C,onRemove:C=>t.rmtrigger(p)},null,8,["modelValue","channelPointsCustomRewards","removable","onUpdate:modelValue","onRemove"]))),128)),b(i,{actions:t.possibleTriggerActions,label:"Add trigger",onClick:t.addtrigger},null,8,["actions","onClick"])])]),t.actionDescription?(a(),l("tr",Om,[Lm,e("td",{innerHTML:t.actionDescription},null,8,qm)])):v("",!0),t.requiresAccessToken?(a(),l("tr",zm,Wm)):v("",!0),t.item.action==="set_channel_title"?(a(),l("tr",Hm,[Qm,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[2]||(s[2]=d=>t.item.data.title=d)},null,512),[[g,t.item.data.title]]),e("span",{class:"button is-small mr-1",onClick:s[3]||(s[3]=d=>t.item.data.title="")},"All args")])])):v("",!0),t.item.action==="set_channel_game_id"?(a(),l("tr",Km,[Gm,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[4]||(s[4]=d=>t.item.data.game_id=d)},null,512),[[g,t.item.data.game_id]]),e("span",{class:"button is-small mr-1",onClick:s[5]||(s[5]=d=>t.item.data.game_id="")},"All args")])])):v("",!0),t.item.action==="add_stream_tags"?(a(),l("tr",Ym,[Xm,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[6]||(s[6]=d=>t.item.data.tag=d)},null,512),[[g,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[7]||(s[7]=d=>t.item.data.tag="")},"All args")])])):v("",!0),t.item.action==="remove_stream_tags"?(a(),l("tr",Zm,[jm,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[8]||(s[8]=d=>t.item.data.tag=d)},null,512),[[g,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[9]||(s[9]=d=>t.item.data.tag="")},"All args")])])):v("",!0),t.item.action==="sr_addtag"?(a(),l("tr",xm,[th,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[10]||(s[10]=d=>t.item.data.tag=d)},null,512),[[g,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[11]||(s[11]=d=>t.item.data.tag="")},"All args")])])):v("",!0),t.item.action==="dict_lookup"?(a(),l(U,{key:7},[e("tr",null,[eh,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[12]||(s[12]=d=>t.item.data.lang=d)},null,512),[[g,t.item.data.lang]]),(a(!0),l(U,null,A(t.dictLangs,(d,p)=>(a(),l("span",{key:p,class:"button is-small mr-1",onClick:C=>t.item.data.lang=d.value,title:d.title},w(d.flag),9,sh))),128)),e("span",{class:"button is-small mr-1",onClick:s[13]||(s[13]=d=>t.item.data.lang="$args(0)")},ih)])]),e("tr",null,[ah,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[14]||(s[14]=d=>t.item.data.phrase=d)},null,512),[[g,t.item.data.phrase]]),e("span",{class:"button is-small mr-1",onClick:s[15]||(s[15]=d=>t.item.data.phrase="")},"All args"),e("span",{class:"button is-small mr-1",onClick:s[16]||(s[16]=d=>t.item.data.phrase="$args(1:)")},oh)])]),rh],64)):v("",!0),t.item.action==="madochan_createword"?(a(),l(U,{key:8},[e("tr",null,[dh,e("td",null,[e("div",uh,[u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[17]||(s[17]=d=>t.item.data.model=d)},null,512),[[g,t.item.data.model]])]),mh])]),e("tr",null,[hh,e("td",null,[e("div",ch,[u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[18]||(s[18]=d=>t.item.data.weirdness=d)},null,512),[[g,t.item.data.weirdness]])]),ph])])],64)):v("",!0),t.item.action==="chatters"?(a(),l("tr",gh,yh)):v("",!0),t.item.action==="text"?(a(),l("tr",$h,[_h,e("td",null,[(a(!0),l(U,null,A(t.item.data.text,(d,p)=>(a(),l("div",{key:p,class:"field textarea-holder"},[u(e("textarea",{class:P(["textarea",{"has-background-danger-light":!t.item.data.text[p],"has-text-danger-dark":!t.item.data.text[p]}]),type:"text","onUpdate:modelValue":C=>t.item.data.text[p]=C},null,10,bh),[[g,t.item.data.text[p]]]),e("button",{class:"button is-small",disabled:t.item.data.text.length<=1,onClick:C=>t.rmtxt(p)},Ch,8,wh)]))),128)),e("div",Vh,[e("button",{class:"button is-small",onClick:s[19]||(s[19]=(...d)=>t.addtxt&&t.addtxt(...d))},Uh)]),Ih])])):v("",!0),t.item.action==="media"?(a(),l("tr",Ah,[Th,e("td",null,[b(r,{modelValue:t.item.data.image,"onUpdate:modelValue":[s[20]||(s[20]=d=>t.item.data.image=d),t.mediaImgChanged]},null,8,["modelValue","onUpdate:modelValue"])])])):v("",!0),t.item.action==="media"?(a(),l("tr",Ph,[Nh,e("td",null,[b(o,{modelValue:t.item.data.sound,"onUpdate:modelValue":[s[21]||(s[21]=d=>t.item.data.sound=d),t.mediaSndChanged],baseVolume:t.baseVolume},null,8,["modelValue","baseVolume","onUpdate:modelValue"])])])):v("",!0),t.item.action==="media"?(a(),l("tr",Rh,[Fh,e("td",null,[e("div",Eh,[b($,{modelValue:t.item.data.minDurationMs,"onUpdate:modelValue":s[22]||(s[22]=d=>t.item.data.minDurationMs=d)},null,8,["modelValue"]),Mh])])])):v("",!0),t.item.action==="countdown"?(a(),l("tr",Oh,[Lh,e("td",null,[b(k,{modelValue:t.item.data,"onUpdate:modelValue":s[23]||(s[23]=d=>t.item.data=d),baseVolume:t.baseVolume},null,8,["modelValue","baseVolume"])])])):v("",!0),e("tr",null,[qh,e("td",null,[t.item.variables.length>0?(a(),l("table",zh,[Jh,e("tbody",null,[(a(!0),l(U,null,A(t.item.variables,(d,p)=>(a(),l("tr",{key:p},[e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":C=>d.name=C},null,8,Bh),[[g,d.name]])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":C=>d.value=C},null,8,Wh),[[g,d.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:C=>t.rmVariable(p)},Kh,8,Hh)])]))),128))])])):v("",!0),e("span",{class:"button is-small",onClick:s[24]||(s[24]=(...d)=>t.onAddVariable&&t.onAddVariable(...d))},"Add Variable"),Gh])]),e("tr",null,[Yh,e("td",null,[t.item.variableChanges.length>0?(a(),l("table",Xh,[Zh,e("tbody",null,[(a(!0),l(U,null,A(t.item.variableChanges,(d,p)=>(a(),l("tr",{key:p},[e("td",null,[e("div",jh,[e("div",xh,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":C=>d.name=C,onFocus:C=>t.variableChangeFocusIdx=p,onBlur:s[25]||(s[25]=(...C)=>t.onVarChangeInputBlur&&t.onVarChangeInputBlur(...C))},null,40,tc),[[g,d.name]])]),t.variableChangeFocusIdx===p?(a(),l("div",ec,[e("div",sc,[(a(!0),l(U,null,A(t.autocompletableVariables(d.name),(C,R)=>(a(),l("a",{class:"dropdown-item",key:R,onClick:E=>d.name=C.var.name},[c(w(C.var.name)+" ("+w(C.type)+", ",1),e("code",null,w(C.var.value),1),ic],8,nc))),128))])])):v("",!0)])]),e("td",null,[e("div",ac,[u(e("select",{"onUpdate:modelValue":C=>d.change=C},uc,8,lc),[[_t,d.change]])])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":C=>d.value=C},null,8,mc),[[g,d.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:C=>t.rmVariableChange(p)},pc,8,hc)])]))),128))])])):v("",!0),e("span",{class:"button is-small",onClick:s[26]||(s[26]=(...d)=>t.onAddVariableChange&&t.onAddVariableChange(...d))},"Add Variable Change"),gc])]),e("tr",null,[fc,e("td",null,[(a(!0),l(U,null,A(t.possiblePermissions,(d,p)=>(a(),l("label",{key:p,class:"mr-1"},[u(e("input",{type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=C=>t.item.restrict_to=C),value:d.value},null,8,vc),[[O,t.item.restrict_to]]),c(" "+w(d.label),1)]))),128))])])])])]),e("footer",yc,[e("button",{class:"button is-small is-primary",disabled:!t.valid,onClick:s[28]||(s[28]=(...d)=>t.onSaveClick&&t.onSaveClick(...d))}," Save changes ",8,$c),e("button",{class:"button is-small",onClick:s[29]||(s[29]=(...d)=>t.onCancelClick&&t.onCancelClick(...d))},"Cancel")])])])):v("",!0)}var bc=S(Am,[["render",_c],["__scopeId","data-v-afb8c9e2"]]);const wc=V({props:{globalVariables:{type:Array,required:!0},channelPointsCustomRewards:{type:Object,required:!0},possibleActions:{type:Array,required:!0},baseVolume:{type:Number,required:!0},modelValue:{type:Array,required:!0},showToggleImages:{type:Boolean,required:!1,default:!1},showFilterActions:{type:Boolean,required:!1,default:!1},showImages:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue","showImagesChange"],data(){return{commands:[],editIdx:null,editCommand:null,filter:{search:"",actions:[]},imagesVisible:!1}},computed:{possibleActionsMapped(){return this.possibleActions.map(t=>({type:t,title:this.actionDescription(t),label:`Add ${this.actionName(t)}`}))},possibleActionsWithCount(){return this.possibleActions.map(t=>({action:t,count:this.commandCount(t)})).filter(t=>t.count>0)}},methods:{onImageVisibleChange(){this.$emit("showImagesChange",this.imagesVisible)},emitChange(){this.$emit("update:modelValue",this.commands)},commandCount(t){let s=0;for(const n of this.commands)n.action===t&&s++;return s},filteredOut(t){if(this.filter.actions.length>0&&!this.filter.actions.includes(t.action))return!0;if(!this.filter.search)return!1;const s=this.filter.search.toLowerCase();return!t.triggers.find(({type:n,data:m})=>n==="command"&&m.command.toLowerCase().indexOf(s)>=0)},permissionsStr(t){return Ei(t.restrict_to)},remove(t){this.commands=this.commands.filter((s,n)=>n!==t),this.emitChange()},add(t){const s=t.type;this.editIdx=this.commands.length,this.editCommand=st[s].NewCommand()},edit(t){this.editIdx=t,this.editCommand=this.commands[t]},duplicate(t){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[t]))},editedCommand(t){this.editIdx!==null&&(this.commands[this.editIdx]=t,this.emitChange(),this.editIdx=null,this.editCommand=null)},dragEnd(t){this.commands=X.arrayMove(this.commands,t.oldIndex,t.newIndex),this.emitChange()},actionDescription(t){return st[t].Description()},actionName(t){return st[t].Name()}},created(){this.commands=JSON.parse(JSON.stringify(this.modelValue)),this.imagesVisible=this.showImages}}),L=t=>(W("data-v-7da20538"),t=t(),H(),t),kc={class:"actions"},Cc=L(()=>e("div",{class:"mr-1"},"Filter:",-1)),Vc={class:"field has-addons mr-1 mb-0"},Sc={class:"control"},Dc={key:0,class:"field"},Uc=["value"],Ic={key:0,class:"table-container"},Ac={class:"table is-striped",ref:"table"},Tc=L(()=>e("th",null,null,-1)),Pc=L(()=>e("th",null,null,-1)),Nc=L(()=>e("th",null,"Trigger",-1)),Rc=c(" Response "),Fc={key:0},Ec=c(" Show images "),Mc=L(()=>e("th",null,"Type",-1)),Oc=L(()=>e("th",null,"Permissions",-1)),Lc=L(()=>e("th",null,null,-1)),qc=L(()=>e("th",null,null,-1)),zc=L(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Jc={class:"pl-0 pr-0"},Bc=["onClick"],Wc=L(()=>e("i",{class:"fa fa-pencil"},null,-1)),Hc=[Wc],Qc={class:"col-triggers"},Kc={key:0},Gc=c(" First chat: "),Yc={key:0},Xc={key:1},Zc={key:1},jc={key:2},xc=L(()=>e("span",{class:"is-small",title:"Channel Point Reward"},[e("i",{class:"fa fa-bullseye"}),c(": ")],-1)),tp={key:3},ep=L(()=>e("span",{class:"is-small"},"Timer: ",-1)),sp={key:0},np={key:0},ip={key:0,class:"spacerow media-holder media-holder-inline"},ap={key:1},lp={key:2,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},op={key:3,class:"ml-2"},rp=c("for at least "),dp={key:4,class:"ml-2"},up=c("for "),mp={key:2},hp={key:0},cp=L(()=>e("span",null,"\u2192",-1)),pp=c(" \u2715 "),gp=L(()=>e("span",null,"\u2192",-1)),fp={key:1},vp={key:1},yp={key:2},$p=c(" Media("),_p={key:0},bp={key:1},wp={key:2},kp=c(") "),Cp={key:3},Vp=["innerHTML"],Sp={class:"pl-0 pr-0"},Dp=L(()=>e("i",{class:"fa fa-trash"},null,-1)),Up=["onClick"],Ip=L(()=>e("i",{class:"fa fa-clone"},null,-1)),Ap=[Ip],Tp={key:1};function Pp(t,s,n,m,f,y){const h=_("dropdown-button"),i=_("duration"),r=_("responsive-image"),o=_("player"),$=_("doubleclick-button"),k=_("draggable"),d=_("command-editor");return a(),l("div",null,[e("div",kc,[b(h,{actions:t.possibleActionsMapped,label:"Add command",onClick:t.add},null,8,["actions","onClick"]),Cc,e("div",Vc,[e("div",Sc,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=p=>t.filter.search=p)},null,512),[[g,t.filter.search]])])]),t.showFilterActions?(a(),l("div",Dc,[(a(!0),l(U,null,A(t.possibleActionsWithCount,(p,C)=>(a(),l("label",{class:"mr-1",key:C},[u(e("input",{class:"mr-1",type:"checkbox",value:p.action,"onUpdate:modelValue":s[1]||(s[1]=R=>t.filter.actions=R)},null,8,Uc),[[O,t.filter.actions]]),c(w(p.action)+" ("+w(p.count)+")",1)]))),128))])):v("",!0)]),t.commands.length>0?(a(),l("div",Ic,[e("table",Ac,[e("thead",null,[e("tr",null,[Tc,Pc,Nc,e("th",null,[Rc,t.showToggleImages?(a(),l("label",Fc,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[2]||(s[2]=p=>t.imagesVisible=p),s[3]||(s[3]=(...p)=>t.onImageVisibleChange&&t.onImageVisibleChange(...p))]},null,512),[[O,t.imagesVisible]]),Ec])):v("",!0)]),Mc,Oc,Lc,qc])]),b(k,{modelValue:t.commands,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:q(({element:p,index:C})=>[u(e("tr",null,[zc,e("td",Jc,[e("button",{class:"button is-small",onClick:R=>t.edit(C)},Hc,8,Bc)]),e("td",Qc,[(a(!0),l(U,null,A(p.triggers,(R,E)=>(a(),l("div",{key:E,class:"spacerow"},[p.triggers[E].type==="first_chat"?(a(),l("div",Kc,[Gc,p.triggers[E].data.since==="alltime"?(a(),l("code",Yc,"alltime")):v("",!0),p.triggers[E].data.since==="stream"?(a(),l("code",Xc,"current stream")):v("",!0)])):v("",!0),p.triggers[E].type==="command"?(a(),l("div",Zc,[e("code",null,w(p.triggers[E].data.command),1)])):v("",!0),p.triggers[E].type==="reward_redemption"?(a(),l("div",jc,[xc,e("code",null,w(p.triggers[E].data.command),1)])):v("",!0),p.triggers[E].type==="timer"?(a(),l("div",tp,[ep,e("code",null,[c(w(p.triggers[E].data.minLines)+" lines, ",1),b(i,{value:p.triggers[E].data.minInterval},null,8,["value"])])])):v("",!0)]))),128))]),e("td",null,[p.action==="text"?(a(),l("div",sp,[(a(!0),l(U,null,A(p.data.text,(R,E)=>(a(),l(U,{key:E},[e("code",null,w(p.data.text[E]),1),E<p.data.text.length-1?(a(),l("span",np,"or")):v("",!0)],64))),128))])):p.action==="media"?(a(),l("div",{key:1,class:P(p.action)},[p.data.image.file||p.data.sound.file?(a(),l("div",ip,[p.data.image.file&&t.imagesVisible?(a(),F(r,{key:0,src:p.data.image.urlpath,title:p.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):p.data.image.file?(a(),l("code",ap,w(p.data.image.filename),1)):v("",!0),p.data.image.file&&p.data.sound.file?(a(),l("i",lp)):v("",!0),b(o,{src:p.data.sound.urlpath,name:p.data.sound.filename,volume:p.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),p.data.image.file&&p.data.sound.file?(a(),l("span",op,[rp,b(i,{value:p.data.minDurationMs},null,8,["value"])])):p.data.image.file?(a(),l("span",dp,[up,b(i,{value:p.data.minDurationMs},null,8,["value"])])):v("",!0)])):v("",!0)],2)):p.action==="countdown"?(a(),l("div",mp,[(p.data.type||"auto")==="auto"?(a(),l("div",hp,[e("code",null,w(p.data.intro),1),cp,e("code",null,w(p.data.steps),1),pp,b(i,{value:p.data.interval},null,8,["value"]),gp,e("code",null,w(p.data.outro),1)])):(a(),l("div",fp,[(a(!0),l(U,null,A(p.data.actions,(R,E)=>(a(),l(U,{key:E},[R.type==="delay"?(a(),F(i,{key:0,value:R.value},null,8,["value"])):v("",!0),R.type==="text"?(a(),l("code",vp,w(R.value),1)):v("",!0),R.type==="media"?(a(),l("code",yp,[$p,R.value.image.file?(a(),l("span",_p,w(R.value.image.filename),1)):v("",!0),R.value.image.file&&R.value.sound.file?(a(),l("span",bp,"+")):v("",!0),R.value.sound.file?(a(),l("span",wp,w(R.value.sound.filename),1)):v("",!0),kp])):v("",!0),E<p.data.actions.length-1?(a(),l("span",Cp,"\u2192")):v("",!0)],64))),128))]))])):t.actionDescription(p.action)?(a(),l("div",{key:3,innerHTML:t.actionDescription(p.action)},null,8,Vp)):v("",!0)]),e("td",null,w(p.action),1),e("td",null,w(t.permissionsStr(p)),1),e("td",Sp,[b($,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:R=>t.remove(C)},{default:q(()=>[Dp]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:R=>t.duplicate(C)},Ap,8,Up)])],512),[[dt,!t.filteredOut(p)]])]),_:1},8,["modelValue","onEnd"])],512)])):(a(),l("div",Tp,"No commands set up")),t.editCommand?(a(),F(d,{key:2,globalVariables:t.globalVariables,channelPointsCustomRewards:t.channelPointsCustomRewards,modelValue:t.editCommand,mode:t.editIdx>=t.commands.length?"create":"edit",baseVolume:t.baseVolume,"onUpdate:modelValue":t.editedCommand,onCancel:s[4]||(s[4]=p=>t.editCommand=null)},null,8,["globalVariables","channelPointsCustomRewards","modelValue","mode","baseVolume","onUpdate:modelValue"])):v("",!0)])}var Np=S(wc,[["render",Pp],["__scopeId","data-v-7da20538"]]);const Rp=V({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(t){this.countdown.actions=X.arrayMove(this.countdown.actions,t.oldIndex,t.newIndex)},onAddDelay(){this.countdown.actions.push(Mi())},onAddText(){this.countdown.actions.push(Oi())},onAddMedia(){this.countdown.actions.push(Li())},rmaction(t){this.countdown.actions=this.countdown.actions.filter((s,n)=>n!==t)},mediaSndChanged(t,s){this.countdown.actions[t].value.sound=s},mediaImgChanged(t,s){this.countdown.actions[t].value.image=s}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),Fp={class:"control"},Ep={class:"radio"},Mp=c(" Manual "),Op={class:"radio"},Lp=c(" Auto "),qp={key:0},zp={class:"spacerow"},Jp=e("label",{class:"spacelabel"},"Steps ",-1),Bp={class:"spacerow"},Wp=e("label",{class:"spacelabel"},"Interval ",-1),Hp={class:"spacerow"},Qp=e("label",{class:"spacelabel"},"Intro ",-1),Kp={class:"spacerow"},Gp=e("label",{class:"spacelabel"},"Outro ",-1),Yp={key:1},Xp={class:"field has-addons mr-1"},Zp=e("span",{class:"handle p-2"},[e("i",{class:"fa fa-arrows"})],-1),jp={key:0,class:"control has-icons-left"},xp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),tg={key:1,class:"control has-icons-left"},eg=["onUpdate:modelValue"],sg=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),ng={key:2,class:"control has-icons-left"},ig=e("td",null,"Image:",-1),ag=e("td",null,"Sound:",-1),lg=e("td",null,"Duration:",-1),og={class:"control has-icons-left"},rg=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),dg={class:"control"},ug=["onClick"],mg=e("i",{class:"fa fa-remove"},null,-1),hg=[mg],cg=e("i",{class:"fa fa-hourglass mr-1"},null,-1),pg=c(" Add Delay "),gg=[cg,pg],fg=e("i",{class:"fa fa-comments-o mr-1"},null,-1),vg=c(" Add Chat "),yg=[fg,vg],$g=e("i",{class:"fa fa-picture-o mr-1"},null,-1),_g=c(" Add Media "),bg=[$g,_g];function wg(t,s,n,m,f,y){const h=_("duration-input"),i=_("image-upload"),r=_("sound-upload"),o=_("draggable");return a(),l("div",null,[e("div",Fp,[e("label",Ep,[u(e("input",{type:"radio",value:"manual","onUpdate:modelValue":s[0]||(s[0]=$=>t.countdown.type=$)},null,512),[[j,t.countdown.type]]),Mp]),e("label",Op,[u(e("input",{type:"radio",value:"auto","onUpdate:modelValue":s[1]||(s[1]=$=>t.countdown.type=$)},null,512),[[j,t.countdown.type]]),Lp])]),t.countdown.type==="auto"?(a(),l("div",qp,[e("div",zp,[Jp,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[2]||(s[2]=$=>t.countdown.steps=$)},null,512),[[g,t.countdown.steps]])]),e("div",Bp,[Wp,b(h,{modelValue:t.countdown.interval,"onUpdate:modelValue":s[3]||(s[3]=$=>t.countdown.interval=$)},null,8,["modelValue"])]),e("div",Hp,[Qp,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[4]||(s[4]=$=>t.countdown.intro=$)},null,512),[[g,t.countdown.intro]])]),e("div",Kp,[Gp,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[5]||(s[5]=$=>t.countdown.outro=$)},null,512),[[g,t.countdown.outro]])])])):(a(),l("div",Yp,[b(o,{modelValue:t.countdown.actions,onEnd:t.dragEnd,handle:".handle","item-key":"id"},{item:q(({element:$,index:k})=>[e("div",Xp,[Zp,$.type==="delay"?(a(),l("div",jp,[b(h,{modelValue:$.value,"onUpdate:modelValue":d=>$.value=d},null,8,["modelValue","onUpdate:modelValue"]),xp])):$.type==="text"?(a(),l("div",tg,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":d=>$.value=d},null,8,eg),[[g,$.value]]),sg])):$.type==="media"?(a(),l("div",ng,[e("table",null,[e("tr",null,[ig,e("td",null,[b(i,{modelValue:$.value.image,"onUpdate:modelValue":[d=>$.value.image=d,d=>t.mediaImgChanged(k,d)]},null,8,["modelValue","onUpdate:modelValue"])])]),e("tr",null,[ag,e("td",null,[b(r,{modelValue:$.value.sound,"onUpdate:modelValue":[d=>$.value.sound=d,d=>t.mediaSndChanged(k,d)],baseVolume:t.baseVolume},null,8,["modelValue","onUpdate:modelValue","baseVolume"])])]),e("tr",null,[lg,e("td",null,[e("div",og,[b(h,{modelValue:$.value.minDurationMs,"onUpdate:modelValue":d=>$.value.minDurationMs=d},null,8,["modelValue","onUpdate:modelValue"]),rg])])])])])):v("",!0),e("div",dg,[e("button",{class:"button is-small",onClick:d=>t.rmaction(k)},hg,8,ug)])])]),_:1},8,["modelValue","onEnd"]),e("button",{class:"button is-small",onClick:s[6]||(s[6]=(...$)=>t.onAddDelay&&t.onAddDelay(...$))},gg),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...$)=>t.onAddText&&t.onAddText(...$))},yg),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(...$)=>t.onAddMedia&&t.onAddMedia(...$))},bg)]))])}var kg=S(Rp,[["render",wg]]);const Cg=V({props:{modelValue:{type:Object,required:!0},removable:{type:Boolean,required:!0},channelPointsCustomRewards:{type:Object,required:!0}},emits:["update:modelValue","remove"],data(){return{value:{type:"",data:{command:"",commandExact:!1,minInterval:0,minLines:0}}}},created(){this.apply(this.modelValue)},computed:{rewardRedemptionActions(){const t=[];for(let s in this.channelPointsCustomRewards)t.push(...this.channelPointsCustomRewards[s].map(n=>({type:n,title:n,label:n})));return t.sort((s,n)=>s.title===n.title?0:s.title<n.title?-1:1),t}},methods:{emitRemove(){this.$emit("remove")},emitUpdate(){this.$emit("update:modelValue",this.value)},apply(t){this.value=JSON.parse(JSON.stringify(t))}},watch:{modelValue(t,s){this.apply(t)}}}),B=t=>(W("data-v-52273960"),t=t(),H(),t),Vg={class:"trigger-editor"},Sg={key:0,class:"field has-addons"},Dg=B(()=>e("span",{class:"mr-1"},"First chat by user",-1)),Ug={class:"control"},Ig={class:"mr-1"},Ag=c(" Alltime "),Tg={class:"mr-1"},Pg=c(" Current Stream "),Ng={class:"control"},Rg=["disabled"],Fg=B(()=>e("i",{class:"fa fa-remove"},null,-1)),Eg=[Fg],Mg={key:1,class:"field has-addons"},Og={class:"control has-icons-left mr-1"},Lg=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),qg={class:"control mr-1",title:"Check if command should only be executed if it matches exactly (= no arguments come after it)."},zg=B(()=>e("span",{class:"is-small is-left"},"exact",-1)),Jg={class:"control"},Bg=["disabled"],Wg=B(()=>e("i",{class:"fa fa-remove"},null,-1)),Hg=[Wg],Qg={key:2,class:"field has-addons"},Kg={class:"control has-icons-left"},Gg=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-bullseye"})],-1)),Yg={class:"control"},Xg=["disabled"],Zg=B(()=>e("i",{class:"fa fa-remove"},null,-1)),jg=[Zg],xg={key:3,class:"timer-trigger"},tf={class:"control remove-control"},ef=["disabled"],sf=B(()=>e("i",{class:"fa fa-remove"},null,-1)),nf=[sf],af={class:"timer-trigger-inner"},lf=B(()=>e("label",{class:"mr-1"},"Messages \u2265",-1)),of={class:"control has-icons-left mr-1"},rf=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),df=B(()=>e("label",{class:"mr-1"},"Interval \u2265",-1)),uf={class:"control has-icons-left has-icons-right mr-1"},mf=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),hf=B(()=>e("p",{class:"help"},[c(" Command will be triggered when at least "),e("code",null,"Messages"),c(" chat messages arrived AND "),e("code",null,"Interval"),c(" have passed. ")],-1));function cf(t,s,n,m,f,y){const h=_("dropdown-button"),i=_("duration-input");return a(),l("div",Vg,[t.value.type==="first_chat"?(a(),l("div",Sg,[Dg,e("div",Ug,[e("label",Ig,[u(e("input",{type:"radio",class:"checkbox mr-1","onUpdate:modelValue":[s[0]||(s[0]=r=>t.value.data.since=r),s[1]||(s[1]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))],value:"alltime"},null,512),[[j,t.value.data.since]]),Ag]),e("label",Tg,[u(e("input",{type:"radio",class:"checkbox mr-1","onUpdate:modelValue":[s[2]||(s[2]=r=>t.value.data.since=r),s[3]||(s[3]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))],value:"stream"},null,512),[[j,t.value.data.since]]),Pg])]),e("div",Ng,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[4]||(s[4]=(...r)=>t.emitRemove&&t.emitRemove(...r))},Eg,8,Rg)])])):v("",!0),t.value.type==="command"?(a(),l("div",Mg,[e("div",Og,[u(e("input",{class:P(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[5]||(s[5]=r=>t.value.data.command=r),s[6]||(s[6]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,2),[[g,t.value.data.command]]),Lg]),e("div",qg,[e("label",null,[u(e("input",{type:"checkbox",class:"checkbox mr-1","onUpdate:modelValue":[s[7]||(s[7]=r=>t.value.data.commandExact=r),s[8]||(s[8]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,512),[[O,t.value.data.commandExact]]),zg])]),e("div",Jg,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[9]||(s[9]=(...r)=>t.emitRemove&&t.emitRemove(...r))},Hg,8,Bg)])])):v("",!0),t.value.type==="reward_redemption"?(a(),l("div",Qg,[e("div",Kg,[u(e("input",{class:P(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[10]||(s[10]=r=>t.value.data.command=r),s[11]||(s[11]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,2),[[g,t.value.data.command]]),t.rewardRedemptionActions.length?(a(),F(h,{key:0,label:"Pick a reward",actions:t.rewardRedemptionActions,onClick:s[12]||(s[12]=r=>{t.value.data.command=r.type,t.emitUpdate()})},null,8,["actions"])):v("",!0),Gg]),e("div",Yg,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[13]||(s[13]=(...r)=>t.emitRemove&&t.emitRemove(...r))},jg,8,Xg)])])):v("",!0),t.value.type==="timer"?(a(),l("div",xg,[e("div",tf,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[14]||(s[14]=(...r)=>t.emitRemove&&t.emitRemove(...r))},nf,8,ef)]),e("div",af,[lf,e("div",of,[u(e("input",{class:"input is-small","onUpdate:modelValue":[s[15]||(s[15]=r=>t.value.data.minLines=r),s[16]||(s[16]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,512),[[g,t.value.data.minLines]]),rf]),df,e("div",uf,[b(i,{modelValue:t.value.data.minInterval,"onUpdate:modelValue":s[17]||(s[17]=r=>{t.value.data.minInterval=r,t.emitUpdate()})},null,8,["modelValue"]),mf])]),hf])):v("",!0)])}var pf=S(Cg,[["render",cf],["__scopeId","data-v-52273960"]]);const gf=V({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1}),methods:{toggleVisibility(t,s){t.hidevideo?this.sendCtrl("videoVisibility",[!0,s]):this.sendCtrl("videoVisibility",[!1,s])},dragEnd(t){this.sendCtrl("move",[t.oldIndex,t.newIndex])},applyFilter(t){this.$emit("filterChange",t)},sendCtrl(t,s){this.$emit("ctrl",[t,s])},isFilteredOut(t){return this.filter.tag!==""&&!t.tags.includes(this.filter.tag)},startAddTag(t){this.tagInputIdx=t,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(t=>(t.filteredOut=this.isFilteredOut(t),t))},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(t=>t.tags.includes(this.filter.tag))}},watch:{playlist:function(t,s){t.find(n=>!this.isFilteredOut(n))||this.$emit("stopPlayer")},filter:function(t,s){this.playlist.find(n=>!this.isFilteredOut(n))||this.$emit("stopPlayer")}}}),J=t=>(W("data-v-012039d8"),t=t(),H(),t),ff={class:"filters"},vf={class:"currentfilter"},yf=J(()=>e("div",{class:"mr-1"},"Filter:",-1)),$f=J(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),_f={key:1,class:"field has-addons mr-1 mb-0"},bf={class:"control"},wf={class:"control"},kf={class:"pt-1"},Cf=c(" Hide filtered out"),Vf={key:0,class:"table is-striped"},Sf=J(()=>e("thead",null,[e("tr",null,[e("th"),e("th"),e("th"),e("th",null,"Title"),e("th",null,"User"),e("th",null,"Plays"),e("th"),e("th"),e("th"),e("th")])],-1)),Df=J(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Uf=["disabled","onClick"],If=J(()=>e("i",{class:"fa fa-play"},null,-1)),Af=[If],Tf=["href"],Pf=J(()=>e("i",{class:"fa fa-external-link"},null,-1)),Nf=["onClick"],Rf=J(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),Ff=["onClick"],Ef=J(()=>e("i",{class:"fa fa-plus"},null,-1)),Mf=[Ef],Of={key:0,class:"field has-addons"},Lf={class:"control"},qf=["onKeyup"],zf={class:"control"},Jf=["disabled","onClick"],Bf=["onClick"],Wf=J(()=>e("i",{class:"fa fa-eraser"},null,-1)),Hf=[Wf],Qf=["onClick","title"],Kf=["onClick"],Gf=J(()=>e("i",{class:"fa fa-thumbs-up mr-1"},null,-1)),Yf=["onClick"],Xf=J(()=>e("i",{class:"fa fa-eraser"},null,-1)),Zf=[Xf],jf=["onClick"],xf=J(()=>e("i",{class:"fa fa-thumbs-down mr-1"},null,-1)),tv=["onClick"],ev=J(()=>e("i",{class:"fa fa-eraser"},null,-1)),sv=[ev],nv=["onClick"],iv=J(()=>e("i",{class:"fa fa-trash"},null,-1)),av=[iv],lv={key:1};function ov(t,s,n,m,f,y){const h=_("draggable");return a(),l("div",null,[e("div",ff,[e("div",vf,[yf,t.filter.tag?(a(),l("span",{key:0,class:"tag mr-1",onClick:s[0]||(s[0]=i=>t.applyFilter(""))},[c(w(t.filter.tag)+" ",1),$f])):(a(),l("div",_f,[e("div",bf,[u(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>t.filterTagInput=i),onKeyup:s[2]||(s[2]=G(i=>t.applyFilter(t.filterTagInput),["enter"]))},null,544),[[g,t.filterTagInput]])]),e("div",wf,[e("span",{class:"button is-small",onClick:s[3]||(s[3]=i=>t.applyFilter(t.filterTagInput))},"Apply filter")])])),e("label",kf,[u(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=i=>t.hideFilteredOut=i)},null,512),[[O,t.hideFilteredOut]]),Cf])])]),t.playlist.length>0?(a(),l("table",Vf,[Sf,b(h,{modelValue:t.enhancedPlaylist,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:q(({element:i,index:r})=>[u(e("tr",null,[Df,e("td",null,w(r+1),1),e("td",null,[r!==t.firstIndex?(a(),l("button",{key:0,class:"button is-small",disabled:i.filteredOut?!0:null,onClick:o=>t.sendCtrl("playIdx",[r]),title:"Play"},Af,8,Uf)):v("",!0)]),e("td",null,[e("a",{href:"https://www.youtube.com/watch?v="+i.yt,target:"_blank"},[c(w(i.title||i.yt)+" ",1),Pf],8,Tf),e("div",null,[(a(!0),l(U,null,A(i.tags,(o,$)=>(a(),l("span",{key:$,class:"tag",onClick:k=>t.sendCtrl("rmtag",[o,r])},[c(w(o)+" ",1),Rf],8,Nf))),128)),e("span",{class:"button is-small",onClick:o=>t.startAddTag(r)},Mf,8,Ff)]),t.tagInputIdx===r?(a(),l("div",Of,[e("div",Lf,[u(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.tagInput=o),onKeyup:G(o=>{t.sendCtrl("addtag",[t.tagInput,r]),t.tagInput=""},["enter"])},null,40,qf),[[g,t.tagInput]])]),e("div",zf,[e("span",{class:"button is-small",disabled:t.tagInput?null:!0,onClick:o=>{t.sendCtrl("addtag",[t.tagInput,r]),t.tagInput=""}},"Add tag",8,Jf)])])):v("",!0)]),e("td",null,w(i.user),1),e("td",null,[c(w(i.plays)+"x ",1),e("button",{class:"button is-small ml-1",onClick:o=>t.sendCtrl("resetStatIdx",["plays",r]),title:"Reset plays"},Hf,8,Bf)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.toggleVisibility(i,r),title:i.hidevideo?"Video hidden":"Video visible"},[e("i",{class:P(["fa mr-1",{"fa-eye":!i.hidevideo,"fa-eye-slash":i.hidevideo}])},null,2)],8,Qf)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.sendCtrl("goodIdx",[r])},[Gf,c(" "+w(i.goods),1)],8,Kf),e("button",{class:"button is-small ml-1",onClick:o=>t.sendCtrl("resetStatIdx",["goods",r]),title:"Reset upvotes"},Zf,8,Yf)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.sendCtrl("badIdx",[r])},[xf,c(" "+w(i.bads),1)],8,jf),e("button",{class:"button is-small ml-1",onClick:o=>t.sendCtrl("resetStatIdx",["bads",r]),title:"Reset downvotes"},sv,8,tv)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.sendCtrl("rmIdx",[r]),title:"Remove"},av,8,nv)])],512),[[dt,!t.hideFilteredOut||!i.filteredOut]])]),_:1},8,["modelValue","onEnd"])])):(a(),l("div",lv,"Playlist is empty"))])}var rv=S(gf,[["render",ov],["__scopeId","data-v-012039d8"]]);const dv=V({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(t){const s=this.settings.customCssPresets.find(n=>n.name===t);s?(this.settings.customCss=s.css,this.settings.showProgressBar=s.showProgressBar,this.settings.showThumbnails=s.showThumbnails,this.settings.maxItemsShown=s.maxItemsShown):console.warn(`preset not found: ${t}`),this.sendSettings()},removePreset(t){this.settings.customCssPresets=this.settings.customCssPresets.filter(s=>s.name!==t),this.sendSettings()},savePreset(){const t=this.settings.customCssPresets.findIndex(s=>s.name===this.cssPresetName);t>=0?(this.settings.customCssPresets[t].css=this.settings.customCss,this.settings.customCssPresets[t].showProgressBar=this.settings.showProgressBar,this.settings.customCssPresets[t].showThumbnails=this.settings.showThumbnails,this.settings.customCssPresets[t].maxItemsShown=this.settings.maxItemsShown):this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss,showProgressBar:this.settings.showProgressBar,showThumbnails:this.settings.showThumbnails,maxItemsShown:this.settings.maxItemsShown}),this.sendSettings()},hideVideoImageChanged(t){this.settings.hideVideoImage=t,this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:Ft(),css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.title { margin-bottom: 0; }
.meta-left, .meta-right, .thumbnail { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Replace icon for thumbs-up with an image",code:`.meta-right .vote-up { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }
.meta-right .vote-up .fa { display: none; }`},{desc:"Remove text before/after username",code:`.meta-user-text-before,
.meta-user-text-after {display: none}`},{desc:"Add a fontawesome icon before username (\\f075 is the icon unicode, refer to https://fontawesome.com/v4.7/icons/)",code:'.meta-user-name::before { content: "\\f075"; display: inline-block; font: normal normal normal 14px/1 FontAwesome; font-size: inherit; margin-right: .5em; }'},{desc:"Add an image icon before username",code:".meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }"},{desc:"Add an image icon before username for specific user only",code:`[data-user="nc_para_" i] .meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }`},{desc:"Change item display depending on username (this one changes background and makes thumbnails black boxes)",code:`[data-user="nc_para_" i] { background: #dd0066; }
[data-user="nc_para_" i] .thumbnail img { display: none; }
[data-user="nc_para_" i] .thumbnail { background: black; }`},{desc:"Show player left of the playlist (and limit its height to 320px)",code:`.wrapper { display: grid; grid-template-areas: "player playlist"; grid-template-columns: 50% auto; grid-template-rows: 320px; }
.player iframe { height: 320px; }`},{desc:"Show thumbnails only, and display meta info above them",code:`.item { display: block; position: relative; padding: 0; color: white; }
.title, .meta-left, .meta-right { position: absolute; padding: .2em; background: rgba(244,0,90,.9); }
.meta-left { top: 0; left: 0; font-size: 1em; }
.meta-right { top: 0; right: 0; font-size: 1em; }
.title { bottom: 0; left: 0; right: 0; margin-bottom: 0; }
.thumbnail { width: auto; }`},{desc:"Align thumbnails to the bottom",code:".thumbnail { align-self: end; }"},{desc:"Align thumbnails to the center",code:".thumbnail { align-self: center; }"},{desc:"Add a margin/padding to the thumbnails",code:".thumbnail { padding: 20px; }"},{desc:"Show number of plays not at player, but in icon form on the right near votes",code:`.meta-left .meta-user:after,
.meta-left .meta-plays { display: none; }
.meta-right .meta-plays { display: inline-block; }`},{desc:"Show the progress bar only, and no video (progress bar above list)",code:`
.player { height: 5px; padding-bottom: 0; }
.progress { height: 5px; }`},{desc:"Show the progress bar only, and no video (progress bar below list)",code:`
.wrapper { display: grid; grid-template-areas: "list" "player"; }
.player { height: 5px; padding-bottom: 0; grid-area: player }
.list { grid-area: list }
.progress { height: 5px; }`}]}})}),T=t=>(W("data-v-766b21f4"),t=t(),H(),t),uv={key:0,class:"table is-striped",ref:"table"},mv=T(()=>e("tr",null,[e("td",{colspan:"3"},"General")],-1)),hv=T(()=>e("td",null,[e("code",null,"settings.volume")],-1)),cv=T(()=>e("td",null,"Base volume for all songs played.",-1)),pv=T(()=>e("td",null,[e("code",null,"settings.initAutoplay")],-1)),gv=T(()=>e("td",null,"If checked, the widget will autoplay when first opened.",-1)),fv=T(()=>e("td",null,[e("code",null,"settings.hideVideoImage")],-1)),vv=T(()=>e("td",null,"Image to display when a video is hidden.",-1)),yv=T(()=>e("td",null,[e("code",null,"settings.maxSongLength.viewer")],-1)),$v=T(()=>e("td",null,[c(" Limits the maximum duration of songs that viewers can add/request. ("),e("code",null,"0"),c(" = unlimited, for example: "),e("code",null,"5m"),c(", "),e("code",null,"1h"),c(", ...) ")],-1)),_v=T(()=>e("td",null,[e("code",null,"settings.maxSongLength.mod")],-1)),bv=T(()=>e("td",null,[c(" Limits the maximum duration of songs that mods can add/request. ("),e("code",null,"0"),c(" = unlimited, for example: "),e("code",null,"5m"),c(", "),e("code",null,"1h"),c(", ...) ")],-1)),wv=T(()=>e("td",null,[e("code",null,"settings.maxSongLength.sub")],-1)),kv=T(()=>e("td",null,[c(" Limits the maximum duration of songs that subscribers can add/request. ("),e("code",null,"0"),c(" = unlimited, for example: "),e("code",null,"5m"),c(", "),e("code",null,"1h"),c(", ...) ")],-1)),Cv=T(()=>e("td",null,[e("code",null,"settings.maxSongsQueued.viewer")],-1)),Vv=T(()=>e("td",null,"Number of new songs that viewers can request. (0 = unlimited)",-1)),Sv=T(()=>e("td",null,[e("code",null,"settings.maxSongsQueued.mod")],-1)),Dv=T(()=>e("td",null,"Number of new songs that mods can request. (0 = unlimited)",-1)),Uv=T(()=>e("td",null,[e("code",null,"settings.maxSongsQueued.sub")],-1)),Iv=T(()=>e("td",null,"Number of new songs that subscribers can request. (0 = unlimited)",-1)),Av=T(()=>e("tr",null,[e("td",{colspan:"3"},"Visuals")],-1)),Tv=T(()=>e("td",null,[e("code",null,"settings.showProgressBar")],-1)),Pv=T(()=>e("td",null,"Render a progress bar in the bottom part of the video in the widget.",-1)),Nv=T(()=>e("td",null,[e("code",null,"settings.showThumbnails")],-1)),Rv={class:"mr-1"},Fv=c("Off"),Ev={class:"mr-1"},Mv=c("Left"),Ov={class:"mr-1"},Lv=c("Right"),qv=T(()=>e("td",null,"Render video thumbnails in the widget.",-1)),zv=T(()=>e("td",null,[e("code",null,"settings.maxItemsShown")],-1)),Jv=T(()=>e("td",null,"Max. number of items displayed in the playlist. Set to -1 for no limit.",-1)),Bv=T(()=>e("code",null,"settings.customCss",-1)),Wv={class:"field has-addons mr-1"},Hv={class:"control is-expanded"},Qv={class:"control"},Kv=["onClick"],Gv=["onClick"],Yv=T(()=>e("i",{class:"fa fa-remove"},null,-1)),Xv=[Yv],Zv=T(()=>e("p",null,"Classes that can be used for styling:",-1)),jv={class:"table"},xv=T(()=>e("thead",null,[e("tr",null,[e("th",null,"Class"),e("th",null,"Description")])],-1)),t1=T(()=>e("p",null,[e("b",null,"Examples:")],-1));function e1(t,s,n,m,f,y){const h=_("volume-slider"),i=_("image-upload"),r=_("duration-input");return a(),l("div",null,[t.settings?(a(),l("table",uv,[e("tbody",null,[mv,e("tr",null,[hv,e("td",null,[b(h,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[0]||(s[0]=o=>t.settings.volume=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),cv]),e("tr",null,[pv,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[1]||(s[1]=o=>t.settings.initAutoplay=o),s[2]||(s[2]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[O,t.settings.initAutoplay]])]),gv]),e("tr",null,[fv,e("td",null,[b(i,{modelValue:t.settings.hideVideoImage,"onUpdate:modelValue":[s[3]||(s[3]=o=>t.settings.hideVideoImage=o),t.hideVideoImageChanged],width:"100px",height:"50px",class:"mb-1"},null,8,["modelValue","onUpdate:modelValue"])]),vv]),e("tr",null,[yv,e("td",null,[b(r,{modelValue:t.settings.maxSongLength.viewer,"onUpdate:modelValue":[s[4]||(s[4]=o=>t.settings.maxSongLength.viewer=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),$v]),e("tr",null,[_v,e("td",null,[b(r,{modelValue:t.settings.maxSongLength.mod,"onUpdate:modelValue":[s[5]||(s[5]=o=>t.settings.maxSongLength.mod=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),bv]),e("tr",null,[wv,e("td",null,[b(r,{modelValue:t.settings.maxSongLength.sub,"onUpdate:modelValue":[s[6]||(s[6]=o=>t.settings.maxSongLength.sub=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),kv]),e("tr",null,[Cv,e("td",null,[u(e("input",{class:"input is-small",type:"number","onUpdate:modelValue":[s[7]||(s[7]=o=>t.settings.maxSongsQueued.viewer=o),s[8]||(s[8]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[g,t.settings.maxSongsQueued.viewer]])]),Vv]),e("tr",null,[Sv,e("td",null,[u(e("input",{class:"input is-small",type:"number","onUpdate:modelValue":[s[9]||(s[9]=o=>t.settings.maxSongsQueued.mod=o),s[10]||(s[10]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[g,t.settings.maxSongsQueued.mod]])]),Dv]),e("tr",null,[Uv,e("td",null,[u(e("input",{class:"input is-small",type:"number","onUpdate:modelValue":[s[11]||(s[11]=o=>t.settings.maxSongsQueued.sub=o),s[12]||(s[12]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[g,t.settings.maxSongsQueued.sub]])]),Iv]),Av,e("tr",null,[Tv,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[13]||(s[13]=o=>t.settings.showProgressBar=o),s[14]||(s[14]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[O,t.settings.showProgressBar]])]),Pv]),e("tr",null,[Nv,e("td",null,[e("label",Rv,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[15]||(s[15]=o=>t.settings.showThumbnails=o),s[16]||(s[16]=(...o)=>t.sendSettings&&t.sendSettings(...o))],value:!1},null,512),[[j,t.settings.showThumbnails]]),Fv]),e("label",Ev,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[17]||(s[17]=o=>t.settings.showThumbnails=o),s[18]||(s[18]=(...o)=>t.sendSettings&&t.sendSettings(...o))],value:"left"},null,512),[[j,t.settings.showThumbnails]]),Mv]),e("label",Ov,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[19]||(s[19]=o=>t.settings.showThumbnails=o),s[20]||(s[20]=(...o)=>t.sendSettings&&t.sendSettings(...o))],value:"right"},null,512),[[j,t.settings.showThumbnails]]),Lv])]),qv]),e("tr",null,[zv,e("td",null,[u(e("input",{type:"number",min:"-1","onUpdate:modelValue":[s[21]||(s[21]=o=>t.settings.maxItemsShown=o),s[22]||(s[22]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[g,t.settings.maxItemsShown]])]),Jv]),e("tr",null,[e("td",null,[Bv,e("div",Wv,[e("div",Hv,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[23]||(s[23]=o=>t.cssPresetName=o),onFocus:s[24]||(s[24]=o=>t.cssPresetDropdownActive=!0),onBlur:s[25]||(s[25]=o=>t.cssPresetDropdownActive=!1)},null,544),[[g,t.cssPresetName]])]),e("div",Qv,[e("span",{class:"button is-small",onClick:s[26]||(s[26]=(...o)=>t.savePreset&&t.savePreset(...o))},"Save preset")])]),(a(!0),l(U,null,A(t.settings.customCssPresets,(o,$)=>(a(),l("div",{class:"mb-1",key:$},[e("span",{class:"button is-small",onClick:k=>t.loadPreset(o.name)},w(o.name),9,Kv),e("span",{class:"button is-small ml-1",onClick:k=>t.removePreset(o.name)},Xv,8,Gv)]))),128))]),e("td",null,[u(e("textarea",{class:"textarea","onUpdate:modelValue":[s[27]||(s[27]=o=>t.settings.customCss=o),s[28]||(s[28]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[g,t.settings.customCss]])]),e("td",null,[Zv,e("table",jv,[xv,e("tbody",null,[(a(!0),l(U,null,A(t.css.classExamples,(o,$)=>(a(),l("tr",{key:$},[e("td",null,[e("code",null,w(o.class),1)]),e("td",null,w(o.desc),1)]))),128))])]),t1,(a(!0),l(U,null,A(t.css.codeExamples,(o,$)=>(a(),l("p",{key:$},[c(w(o.desc)+" ",1),e("pre",null,[e("code",null,w(o.code),1)])]))),128))])])])],512)):v("",!0)])}var s1=S(dv,[["render",e1],["__scopeId","data-v-766b21f4"]]);const n1=V({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(t,s){this.editTag=t.value,this.tagEditIdx=s},updateTag(t,s){this.$emit("updateTag",[t,s])}}}),i1={class:"table is-striped"},a1=e("tr",null,[e("th",null,"Tag"),e("th"),e("th")],-1),l1=["onKeyup"],o1=["value","onFocus"],r1=["disabled","onClick"];function d1(t,s,n,m,f,y){return a(),l("table",i1,[a1,(a(!0),l(U,null,A(t.tags,(h,i)=>(a(),l("tr",{key:i},[e("td",null,[t.tagEditIdx===i?u((a(),l("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=r=>t.editTag=r),onKeyup:G(r=>t.updateTag(h.value,t.editTag),["enter"])},null,40,l1)),[[g,t.editTag]]):(a(),l("input",{key:1,type:"text",class:"input is-small",value:h.value,onFocus:r=>t.onInputFocus(h,i)},null,40,o1))]),e("td",null,[t.tagEditIdx===i?(a(),l("span",{key:0,class:"button is-small",disabled:h.value===t.editTag?!0:null,onClick:r=>t.updateTag(h.value,t.editTag)},"Save",8,r1)):v("",!0)]),e("td",null,w(h.count)+"x",1)]))),128))])}var u1=S(n1,[["render",d1]]);const m1=V({props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","cancel"],data:()=>({item:null,itemStr:"null",newState:"",newSlotDefinitionName:""}),mounted(){this.itemStr=JSON.stringify(this.modelValue),this.item=JSON.parse(this.itemStr),this.adjustAllImagesDivSize(),window.addEventListener("resize",this.adjustAllImagesDivSize)},unmounted(){window.removeEventListener("resize",this.adjustAllImagesDivSize)},watch:{modelValue:{handler(t){this.item=JSON.parse(this.itemStr)}},item:{handler(t){this.itemStr=JSON.stringify(t)},deep:!0},itemStr:{handler(t){const s=JSON.stringify(this.item);try{const n=JSON.parse(t);s!==n&&(this.item=n)}catch(n){console.warn(n)}}}},computed:{allImages(){var s;const t=[];return(s=this.item)==null||s.slotDefinitions.forEach(n=>{n.items.forEach(m=>{m.states.forEach(f=>{f.frames.forEach(y=>{y.url&&!t.includes(y.url)&&t.push(y.url)})})})}),t},isStateAddable(){return!(!this.item||this.newState===""||this.item.stateDefinitions.find(({value:t})=>t===this.newState))}},methods:{autoDetectDimensions(){if(this.allImages.length===0)return;const t=new Image;t.onload=()=>{!this.item||(this.item.width=t.width,this.item.height=t.height)},t.src=this.allImages[0]},adjustAllImagesDivSize(){this.$nextTick(()=>{if(!this.$refs.cardBody||!this.$refs.allImagesDiv)return;const t=this.$refs.cardBody.clientHeight;this.$refs.allImagesDiv.style.maxHeight=`${t}px`})},imageDragStart(t){t.dataTransfer.setData("avatar-image-url",t.target.getAttribute("data-src"))},emitUpdate(){if(!this.item){console.warn("emitUpdate: this.item not initialized");return}this.$emit("update:modelValue",er({name:this.item.name,width:parseInt(`${this.item.width}`,10),height:parseInt(`${this.item.height}`,10),stateDefinitions:this.item.stateDefinitions,slotDefinitions:this.item.slotDefinitions,state:this.item.state}))},onSaveClick(){this.emitUpdate()},onSaveAndCloseClick(){this.emitUpdate(),this.$emit("cancel")},onCancelClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},addStateDefinition(){if(!this.item){console.warn("addStateDefinition: this.item not initialized");return}const t={value:this.newState,deletable:!0};this.item.stateDefinitions.push(t);for(let s of this.item.slotDefinitions)for(let n of s.items)n.states.push({state:t.value,frames:[]})},removeStateDefinition(t){if(!this.item){console.warn("removeStateDefinition: this.item not initialized");return}const s=[];for(let m in this.item.stateDefinitions)parseInt(m,10)!==parseInt(`${t}`,10)&&s.push(this.item.stateDefinitions[m]);this.item.stateDefinitions=s;const n=s.map(m=>m.value);for(let m of this.item.slotDefinitions)for(let f of m.items)f.states=f.states.filter(y=>n.includes(y.state))},removeSlotDefinition(t){if(!this.item){console.warn("removeSlotDefinition: this.item not initialized");return}const s=[];for(let n in this.item.slotDefinitions)parseInt(n,10)!==parseInt(`${t}`,10)&&s.push(this.item.slotDefinitions[n]);this.item.slotDefinitions=s},updateSlotDefinition(t,s){if(!this.item){console.warn("updateSlotDefinition: this.item not initialized");return}this.item.slotDefinitions[parseInt(`${t}`,10)]=s},addSlotDefinition(){if(!this.item){console.warn("addSlotDefinition: this.item not initialized");return}const t={slot:"Unnamed slot",defaultItemIndex:-1,items:[]};this.item.slotDefinitions.push(t)},moveSlotUp(t){if(!this.item){console.warn("moveSlotUp: this.item not initialized");return}if(t<=0)return;const s=this.item.slotDefinitions[t-1];this.item.slotDefinitions[t-1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s},moveSlotDown(t){if(!this.item){console.warn("moveSlotDown: this.item not initialized");return}if(t>=this.item.slotDefinitions.length-1)return;const s=this.item.slotDefinitions[t+1];this.item.slotDefinitions[t+1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s}}}),h1={key:0,class:"avatar-editor modal is-active"},c1={class:"modal-card"},p1={class:"modal-card-head"},g1=e("p",{class:"modal-card-title"},"Edit Avatar",-1),f1={class:"modal-card-body",ref:"cardBody"},v1={class:"columns"},y1={class:"column is-three-quarters"},$1={class:"table is-striped"},_1=e("td",null,"Name:",-1),b1=e("td",null,"Dimensions:",-1),w1=c("\u2716"),k1=c(" Pixels "),C1=e("td",null,"States:",-1),V1=["onClick"],S1=e("i",{class:"fa fa-trash"},null,-1),D1=[S1],U1=["disabled"],I1=e("td",null,"Slots",-1),A1={class:"column"},T1=e("div",null,"JSON:",-1),P1=e("div",null,"All images in use:",-1),N1={class:"avatar-all-images",ref:"allImagesDiv"},R1=["src","data-src"],F1={class:"modal-card-foot"};function E1(t,s,n,m,f,y){const h=_("avatar-slot-definition-editor");return t.item?(a(),l("div",h1,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...i)=>t.onOverlayClick&&t.onOverlayClick(...i))}),e("div",c1,[e("header",p1,[g1,e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...i)=>t.onCloseClick&&t.onCloseClick(...i))})]),e("section",f1,[e("div",v1,[e("div",y1,[e("table",$1,[e("tbody",null,[e("tr",null,[_1,e("td",null,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[2]||(s[2]=i=>t.item.name=i)},null,512),[[g,t.item.name]])])]),e("tr",null,[b1,e("td",null,[u(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.item.width=i)},null,512),[[g,t.item.width]]),w1,u(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.item.height=i)},null,512),[[g,t.item.height]]),k1,t.allImages.length?(a(),l("span",{key:0,class:"button is-small",onClick:s[5]||(s[5]=(...i)=>t.autoDetectDimensions&&t.autoDetectDimensions(...i))},"Auto-detect")):v("",!0)])]),e("tr",null,[C1,e("td",null,[(a(!0),l(U,null,A(t.item.stateDefinitions,(i,r)=>(a(),l("span",{class:"tag",key:r},[e("span",null,w(i.value),1),i.deletable?(a(),l("span",{key:0,class:"ml-1 is-clickable",onClick:o=>t.removeStateDefinition(r)},D1,8,V1)):v("",!0)]))),128)),u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=i=>t.newState=i),placeholder:"State"},null,512),[[g,t.newState]]),e("span",{class:"button is-small",onClick:s[7]||(s[7]=(...i)=>t.addStateDefinition&&t.addStateDefinition(...i)),disabled:t.isStateAddable?null:!0},"Add custom state",8,U1)])]),e("tr",null,[I1,e("td",null,[(a(!0),l(U,null,A(t.item.slotDefinitions,(i,r)=>(a(),F(h,{class:"card mb-2",key:r,modelValue:i,avatarDef:t.item,"onUpdate:modelValue":o=>t.updateSlotDefinition(r,o),onMoveUp:o=>t.moveSlotUp(r),onMoveDown:o=>t.moveSlotDown(r),onRemove:o=>t.removeSlotDefinition(r)},null,8,["modelValue","avatarDef","onUpdate:modelValue","onMoveUp","onMoveDown","onRemove"]))),128))])])])]),e("span",{class:"button is-small",onClick:s[8]||(s[8]=(...i)=>t.addSlotDefinition&&t.addSlotDefinition(...i))},"Add slot")]),e("div",A1,[T1,u(e("textarea",{class:"textarea mb-2","onUpdate:modelValue":s[9]||(s[9]=i=>t.itemStr=i)},null,512),[[g,t.itemStr]]),P1,e("div",N1,[(a(!0),l(U,null,A(t.allImages,(i,r)=>(a(),l("img",{key:r,src:i,draggable:"true",class:"mr-1 mb-1",onDragstart:s[10]||(s[10]=(...o)=>t.imageDragStart&&t.imageDragStart(...o)),"data-src":i},null,40,R1))),128))],512)])])],512),e("footer",F1,[e("button",{class:"button is-small is-primary",onClick:s[11]||(s[11]=(...i)=>t.onSaveClick&&t.onSaveClick(...i))}," Save "),e("button",{class:"button is-small is-primary",onClick:s[12]||(s[12]=(...i)=>t.onSaveAndCloseClick&&t.onSaveAndCloseClick(...i))}," Save and close "),e("button",{class:"button is-small",onClick:s[13]||(s[13]=(...i)=>t.onCancelClick&&t.onCancelClick(...i))},"Cancel")])])])):v("",!0)}var M1=S(m1,[["render",E1]]);const O1=V({props:{modelValue:{type:Object,required:!0},avatarDef:{type:Object,required:!0}},emits:["update:modelValue","remove","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultItem(){return this.modelValue.defaultItemIndex>=0&&this.modelValue.items.length>this.modelValue.defaultItemIndex?this.modelValue.items[this.modelValue.defaultItemIndex]:null},defaultAnimation(){if(!this.defaultItem)return[];const t=this.defaultItem.states.find(({state:s})=>s==="default");return t?t.frames:[]}},methods:{emitChange(){this.$emit("update:modelValue",this.modelValue)},updateItem(t,s){this.modelValue.items[t]=s,this.emitChange()},removeItem(t,s){this.modelValue.items=this.modelValue.items.filter((n,m)=>m!==t),t<=this.modelValue.defaultItemIndex&&(this.modelValue.defaultItemIndex=this.modelValue.defaultItemIndex-1),this.modelValue.items.length>0&&this.modelValue.defaultItemIndex<0&&(this.modelValue.defaultItemIndex=0),this.emitChange()},makeItemDefault(t,s){this.modelValue.defaultItemIndex=t,this.emitChange()},addItem(){const t={title:`${this.modelValue.slot} item ${this.modelValue.items.length+1}`,states:this.avatarDef.stateDefinitions.map(s=>({state:s.value,frames:[]}))};this.modelValue.items.push(t),this.modelValue.defaultItemIndex===-1&&(this.modelValue.defaultItemIndex=0),this.emitChange()},moveItemUp(t){this.swapItems(t-1,t)},moveItemDown(t){this.swapItems(t+1,t)},swapItems(t,s){if(t<0||t>this.modelValue.items.length-1||s<0||s>this.modelValue.items.length-1)return;const n=this.modelValue.items[t];this.modelValue.items[t]=this.modelValue.items[s],this.modelValue.items[s]=n,this.modelValue.defaultItemIndex===t?this.modelValue.defaultItemIndex=s:this.modelValue.defaultItemIndex===s&&(this.modelValue.defaultItemIndex=t),this.modelValue.items=this.modelValue.items.slice()}}}),L1={class:"avatar-slot-definition-editor"},q1={class:"level avatar-slot-definition-editor-title p-1"},z1={class:"level-left"},J1={class:"level-item"},B1={class:"level-item"},W1={class:"level-right"},H1={class:"level-item"},Q1={class:"level-item"},K1={class:"level-item"},G1=e("i",{class:"fa fa-trash"},null,-1),Y1=[G1],X1={class:"p-1"};function Z1(t,s,n,m,f,y){const h=_("avatar-animation"),i=_("avatar-slot-item-editor");return a(),l("div",L1,[e("div",q1,[e("div",z1,[e("div",J1,[b(h,{frames:t.defaultAnimation,width:32,height:32},null,8,["frames"])]),e("div",B1,[u(e("input",{class:P(["input is-small avatar-slot-definition-editor-title-input",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=r=>t.titleFocused=!0),onBlur:s[1]||(s[1]=r=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=r=>t.modelValue.slot=r)},null,34),[[g,t.modelValue.slot]])])]),e("div",W1,[e("div",H1,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[3]||(s[3]=r=>t.$emit("moveUp"))})]),e("div",Q1,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[4]||(s[4]=r=>t.$emit("moveDown"))})]),e("div",K1,[e("span",{class:"button is-small",onClick:s[5]||(s[5]=r=>t.$emit("remove"))},Y1)])])]),e("div",X1,[(a(!0),l(U,null,A(t.modelValue.items,(r,o)=>(a(),F(i,{class:P(["card mb-1",{"is-default":o===this.modelValue.defaultItemIndex}]),key:o,modelValue:r,isDefault:o===this.modelValue.defaultItemIndex,onMoveUp:$=>t.moveItemUp(o),onMoveDown:$=>t.moveItemDown(o),"onUpdate:modelValue":$=>t.updateItem(o,$),onRemove:$=>t.removeItem(o,$),onMakeDefault:$=>t.makeItemDefault(o,$)},null,8,["class","modelValue","isDefault","onMoveUp","onMoveDown","onUpdate:modelValue","onRemove","onMakeDefault"]))),128))]),e("span",{class:"button is-small",onClick:s[6]||(s[6]=(...r)=>t.addItem&&t.addItem(...r))},"Add item")])}var j1=S(O1,[["render",Z1]]);const x1=V({props:{modelValue:{type:Object,required:!0},isDefault:{type:Boolean,required:!0}},emits:["update:modelValue","makeDefault","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultState(){return this.modelValue.states.find(({state:t})=>t==="default")}},methods:{updateAnimation(t,s){},makeDefault(){this.$emit("makeDefault",this.modelValue)}}}),ty={class:"avatar-slot-item-editor p-1"},ey={class:"level"},sy={class:"level-left"},ny={class:"level-item"},iy={class:"level-item"},ay={key:0,class:"has-text-success mr-1"},ly=e("i",{class:"fa fa-check"},null,-1),oy=c(" Default"),ry=[ly,oy],dy={class:"level-right"},uy={class:"level-item"},my={class:"level-item"},hy={class:"level-item"},cy=e("i",{class:"fa fa-trash"},null,-1),py=[cy];function gy(t,s,n,m,f,y){const h=_("avatar-slot-item-state-editor");return a(),l("div",ty,[e("div",ey,[e("div",sy,[e("div",ny,[u(e("input",{type:"text",class:P(["input is-small avatar-slot-item-editor-title",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=i=>t.titleFocused=!0),onBlur:s[1]||(s[1]=i=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=i=>t.modelValue.title=i)},null,34),[[g,t.modelValue.title]])]),e("div",iy,[t.isDefault?(a(),l("span",ay,ry)):(a(),l("span",{key:1,class:"button is-small",onClick:s[3]||(s[3]=(...i)=>t.makeDefault&&t.makeDefault(...i))},"Make default"))])]),e("div",dy,[e("div",uy,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[4]||(s[4]=i=>t.$emit("moveUp"))})]),e("div",my,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[5]||(s[5]=i=>t.$emit("moveDown"))})]),e("div",hy,[e("span",{class:"button is-small",onClick:s[6]||(s[6]=i=>t.$emit("remove"))},py)])])]),(a(!0),l(U,null,A(t.modelValue.states,(i,r)=>(a(),F(h,{class:"mr-1",modelValue:i,defaultState:t.defaultState,"onUpdate:modelValue":o=>t.updateAnimation(r,o),key:r},null,8,["modelValue","defaultState","onUpdate:modelValue"]))),128))])}var fy=S(x1,[["render",gy]]);const vy=V({props:{avatar:{type:Object,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},computed:{animations(){return this.avatar.slotDefinitions.map(t=>{const s=t.items[t.defaultItemIndex];return s?s.states.find(({state:n})=>n==="default"):{title:"",states:[]}})}}});function yy(t,s,n,m,f,y){const h=_("avatar-animation");return a(),l("div",{class:"avatar-preview",style:Y({width:`${t.width}px`,height:`${t.height}px`})},[(a(!0),l(U,null,A(t.animations,(i,r)=>(a(),F(h,{frames:i.frames,key:r,width:t.width,height:t.height},null,8,["frames","width","height"]))),128))],4)}var $y=S(vy,[["render",yy]]);const _y=V({props:{modelValue:{type:Object,required:!0},defaultState:{type:Object,required:!0}},data(){return{draggingOver:!1,editing:!1}},methods:{onDragOver(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragLeave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1},onDragEnter(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDrop(t){if(this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),t.dataTransfer.getData("avatar-image-url")){const n={url:t.dataTransfer.getData("avatar-image-url"),duration:100};this.modelValue.frames.push(n)}else{let n=null;if(t.dataTransfer.items){for(var s=0;s<t.dataTransfer.items.length;s++)if(t.dataTransfer.items[s].kind==="file"){n=t.dataTransfer.items[s].getAsFile();break}}else for(var s=0;s<t.dataTransfer.files.length;s++){n=t.dataTransfer.files[s];break}n&&this.$refs.uploadComponent.uploadFile(n)}return!1},onUploaded(t){this.modelValue.frames.push({url:t.urlpath,duration:100})},onOverlayClick(){this.editing=!1},frameChanged(t,s){s.url===""?this.modelValue.frames=this.modelValue.frames.filter((n,m)=>m!==t):this.modelValue.frames[t]=s},addFrame(){const t={url:"",duration:100};this.modelValue.frames.push(t)}}}),by={class:"avatar-slot-item-state-editor-title"},wy={class:"avatar-animation-card mr-1"},ky={class:"avatar-animation-frame"},Cy=e("i",{class:"fa fa-plus"},null,-1),Vy=[Cy];function Sy(t,s,n,m,f,y){const h=_("avatar-animation"),i=_("avatar-frame-upload"),r=_("upload");return a(),l("div",{class:P(["avatar-slot-item-state-editor card",{"dragging-over":t.draggingOver}]),onDragover:s[1]||(s[1]=(...o)=>t.onDragOver&&t.onDragOver(...o)),onDragenter:s[2]||(s[2]=(...o)=>t.onDragEnter&&t.onDragEnter(...o)),onDragleave:s[3]||(s[3]=(...o)=>t.onDragLeave&&t.onDragLeave(...o)),onDrop:s[4]||(s[4]=(...o)=>t.onDrop&&t.onDrop(...o))},[e("div",by,w(t.modelValue.state),1),t.modelValue.frames.length?(a(),F(h,{key:0,frames:t.modelValue.frames},null,8,["frames"])):(a(),F(h,{key:1,frames:t.defaultState.frames,class:"avatar-fallback-animation"},null,8,["frames"])),e("div",null,[(a(!0),l(U,null,A(t.modelValue.frames,(o,$)=>(a(),l("div",{class:"avatar-animation-card mr-1",key:$},[b(i,{modelValue:o,"onUpdate:modelValue":k=>t.frameChanged($,k)},null,8,["modelValue","onUpdate:modelValue"])]))),128)),e("div",wy,[e("span",ky,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...o)=>t.addFrame&&t.addFrame(...o))},Vy)])])]),u(b(r,{onUploaded:t.onUploaded,accept:"image/*",label:"",ref:"uploadComponent"},null,8,["onUploaded"]),[[dt,!1]])],34)}var Dy=S(_y,[["render",Sy]]);const Uy=V({props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{value:{url:"",duration:100},draggingOver:!1}},created(){this.applyValue()},watch:{modelValue(){this.applyValue()}},methods:{applyValue(){this.modelValue!==null?this.value=JSON.parse(JSON.stringify(this.modelValue)):this.value={url:"",duration:100}},emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onDurationChange(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={url:"",duration:100},this.emitUpdate()},onUploaded(t){this.value={url:t.urlpath,duration:100},this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if(t.dataTransfer.items[n].kind==="file"){s=t.dataTransfer.items[n].getAsFile();break}}else for(var n=0;n<t.dataTransfer.files.length;n++){s=t.dataTransfer.files[n];break}return s&&(this.value.url="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),Iy=t=>(W("data-v-345011c1"),t=t(),H(),t),Ay={class:"avatar-animation-frame-remove"},Ty=Iy(()=>e("i",{class:"fa fa-trash"},null,-1)),Py=[Ty],Ny=["src"];function Ry(t,s,n,m,f,y){const h=_("upload");return a(),l("span",{onDrop:s[3]||(s[3]=(...i)=>t.onDrop&&t.onDrop(...i)),onDragover:s[4]||(s[4]=(...i)=>t.onDragover&&t.onDragover(...i)),onDragleave:s[5]||(s[5]=(...i)=>t.onDragleave&&t.onDragleave(...i)),class:P(["avatar-animation-frame",{"dragging-over":t.draggingOver}])},[e("div",Ay,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...i)=>t.onRemove&&t.onRemove(...i))},Py)]),t.value.url?(a(),l("img",{key:0,src:t.value.url,width:"64",height:"64"},null,8,Ny)):v("",!0),u(b(h,{onUploaded:t.onUploaded,accept:"image/*",label:"",class:"avatar-animation-frame-upload",ref:"uploadComponent"},null,8,["onUploaded"]),[[dt,!t.value.url]]),u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":[s[1]||(s[1]=i=>t.value.duration=i),s[2]||(s[2]=(...i)=>t.onDurationChange&&t.onDurationChange(...i))]},null,512),[[g,t.value.duration]])],34)}var Fy=S(Uy,[["render",Ry],["__scopeId","data-v-345011c1"]]);const Ey=V({props:{frames:{type:Array,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},data(){return{timeout:null,idx:-1}},computed:{src(){return this.idx>=0&&this.idx<this.frames.length?this.frames[this.idx].url:""}},methods:{nextFrame(){if(this.frames.length===0){this.idx=-1;return}this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.idx++,this.idx>=this.frames.length&&(this.idx=0),this.timeout=setTimeout(()=>{this.nextFrame()},this.frames[this.idx].duration)}},created(){this.nextFrame(),this.$watch("frames",()=>{this.idx=-1,this.nextFrame()},{deep:!0})},unmounted(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}),My=["src","width","height"];function Oy(t,s,n,m,f,y){return a(),l("span",{class:"avatar-animation",style:Y({width:`${t.width}px`,height:`${t.width}px`})},[t.src?(a(),l("img",{key:0,src:t.src,width:t.width,height:t.height},null,8,My)):(a(),l("span",{key:1,style:Y({width:`${t.width}px`,height:`${t.width}px`,display:"inline-block"})},null,4))],4)}var Ly=S(Ey,[["render",Oy]]);const qy=async()=>{const t=Bt({history:Wt(),routes:[{name:"index",path:"/",component:re,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:Ue,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:Bn,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:ed,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:fd,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:Ka,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:mn,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:Pa,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:tr,meta:{title:"Speech to text",protected:!0}},{name:"avatar",path:"/avatar/",component:Lr,meta:{title:"Avatar",protected:!0}},{name:"pomo",path:"/pomo/",component:Qd,meta:{title:"Pomo",protected:!0}},{name:"drawcast",path:"/drawcast/",component:Gs,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:Fi,meta:{title:"Settings",protected:!0}}]});Q.eventBus.on("login",()=>{Lt.init()}),Q.eventBus.on("logout",()=>{Lt.stop()}),await Vt.init(),await Q.init(),t.beforeEach((n,m,f)=>{if(n.meta.protected&&!Q.getMe()){f({name:"login"});return}if(!n.meta.protected&&Q.getMe()){f({name:"index"});return}m.name&&document.documentElement.classList.remove(`view-${String(m.name)}`),document.documentElement.classList.add(`view-${String(n.name)}`),document.title=`${n.meta.title}`,f()});const s=Ht(jt);s.use(t),s.use(Qt,{}),s.component("doubleclick-button",cm),s.component("dropdown-button",wm),s.component("checkbox",_u),s.component("draggable",Kt),s.component("duration-input",vu),s.component("duration",dm),s.component("navbar",im),s.component("player",ku),s.component("responsive-image",qu),s.component("slider",Nu),s.component("upload",jd),s.component("image-upload",lu),s.component("sound-upload",pu),s.component("volume-slider",Eu),s.component("youtube",Im),s.component("commands-editor",Np),s.component("command-editor",bc),s.component("countdown-editor",kg),s.component("trigger-editor",pf),s.component("playlist-editor",rv),s.component("tags-editor",u1),s.component("song-request-settings",s1),s.component("avatar-editor",M1),s.component("avatar-slot-definition-editor",j1),s.component("avatar-slot-item-editor",fy),s.component("avatar-preview",$y),s.component("avatar-slot-item-state-editor",Dy),s.component("avatar-frame-upload",Fy),s.component("avatar-animation",Ly),s.mount("#app")};qy();
