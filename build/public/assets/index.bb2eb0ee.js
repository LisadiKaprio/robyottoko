import{d as S,r as w,o as l,c as i,a as k,b as t,F as I,e as A,t as b,f as p,w as h,v as y,g as z,h as L,i as c,j as F,n as K,k as P,l as O,p as W,m as H,q as nt,s as tt,u as ut,x as lt,y as ct,z as ht,A as pt,B as mt}from"./vendor.149dd147.js";const gt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))r(m);new MutationObserver(m=>{for(const g of m)if(g.type==="childList")for(const u of g.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function a(m){const g={};return m.integrity&&(g.integrity=m.integrity),m.referrerpolicy&&(g.referrerPolicy=m.referrerpolicy),m.crossorigin==="use-credentials"?g.credentials="include":m.crossorigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function r(m){if(m.ep)return;m.ep=!0;const g=a(m);fetch(m.href,g)}};gt();var V=(s,e)=>{for(const[a,r]of e)s[a]=r;return s};const ft=S({name:"app"}),yt={id:"app"};function vt(s,e,a,r,m,g){const u=w("router-view");return l(),i("div",yt,[k(u)])}var _t=V(ft,[["render",vt]]);const $t=S({data:()=>({widgets:null}),async created(){const s=await fetch("/api/page/index");if(s.status!==200){this.$router.push({name:"login"});return}const e=await s.json();this.widgets=e.widgets}}),bt={key:0,id:"app"},wt={id:"top",ref:"top"},kt={id:"main",ref:"main"},Ct={class:"table is-striped is-fullwidth"},St=t("thead",null,[t("tr",null,[t("th",null,"Widget"),t("th",null,"Hint")])],-1),Vt=["href"];function Ut(s,e,a,r,m,g){const u=w("navbar");return s.widgets?(l(),i("div",bt,[t("div",wt,[k(u)],512),t("div",kt,[t("table",Ct,[St,t("tbody",null,[(l(!0),i(I,null,A(s.widgets,(n,_)=>(l(),i("tr",{key:_},[t("td",null,[t("a",{href:n.url,target:"blank"},b(n.title),9,Vt)]),t("td",null,b(n.hint),1)]))),128))])])],512)])):p("",!0)}var It=V($t,[["render",Ut]]);const Pt=S({data:()=>({user:"",pass:"",error:"",success:""}),async mounted(){const e=new URLSearchParams(window.location.search).get("t");if(e){this.success="",this.error="";const a=await fetch("/api/_handle-token",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:e})});a.status===200?(await a.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const s=await fetch("/api/auth",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,pass:this.pass})});s.status===200?this.$router.push({name:"index"}):s.status===401?this.error=(await s.json()).reason:this.error="Unknown error"}}}),At={class:"center-screen"},Tt=t("h1",{class:"title is-6"},"Hyottoko.club",-1),Dt={key:0,class:"field has-background-success-light has-text-success-dark"},Mt={key:1,class:"field has-background-danger-light has-text-danger-dark"},Et={class:"field"},Ft={class:"control has-icons-left"},Lt=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-user"})],-1),Rt={class:"field"},Ot={class:"control has-icons-left"},Nt=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-lock"})],-1),jt={class:"field"},zt={class:"field"},Jt=c("Register an account"),Bt=c(" | "),qt=c("Forgot password?");function Wt(s,e,a,r,m,g){const u=w("router-link");return l(),i("div",At,[Tt,t("form",null,[s.success?(l(),i("div",Dt,b(s.success),1)):p("",!0),s.error?(l(),i("div",Mt,b(s.error),1)):p("",!0),t("div",Et,[t("div",Ft,[h(t("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":e[0]||(e[0]=n=>s.user=n),onKeyup:e[1]||(e[1]=n=>s.error="")},null,544),[[y,s.user]]),Lt])]),t("div",Rt,[t("div",Ot,[h(t("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":e[2]||(e[2]=n=>s.pass=n),onKeyup:[e[3]||(e[3]=n=>s.error=""),e[4]||(e[4]=z((...n)=>s.submit&&s.submit(...n),["enter"]))]},null,544),[[y,s.pass]]),Nt])]),t("div",jt,[t("span",{class:"button is-small is-primary",onClick:e[5]||(e[5]=(...n)=>s.submit&&s.submit(...n))},"Login")]),t("div",zt,[k(u,{to:{name:"register"}},{default:L(()=>[Jt]),_:1}),Bt,k(u,{to:{name:"forgot-password"}},{default:L(()=>[qt]),_:1})])])])}var Ht=V(Pt,[["render",Wt]]);const Kt=1001,it=4e3;class Gt{constructor(e,a){this.handle=null,this.reconnectTimeout=null,this.sendBuffer=[],this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{},this.addr=e,this.protocols=a}send(e){this.handle?this.handle.send(e):this.sendBuffer.push(e)}connect(){let e=new WebSocket(this.addr,this.protocols);e.onopen=a=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=e;this.sendBuffer.length>0;){const r=this.sendBuffer.shift();r&&this.handle.send(r)}this.onopen(a)},e.onmessage=a=>{this.onmessage(a)},e.onclose=a=>{this.handle=null,a.code===it||a.code===Kt||(this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3)),this.onclose(a)}}disconnect(){this.handle&&this.handle.close(it)}}const Yt=(...s)=>console.log("[WsClient.ts]",...s);class Z extends Gt{constructor(e,a){super(e,a);this._on={},this.onopen=r=>{this._dispatch("socket","open",r)},this.onmessage=r=>{if(this._dispatch("socket","message",r),this._on.message){const m=this._parseMessageData(r.data);m.event&&this._dispatch("message",m.event,m.data)}},this.onclose=r=>{this._dispatch("socket","close",r)}}onSocket(e,a){this.addEventListener("socket",e,a)}onMessage(e,a){this.addEventListener("message",e,a)}addEventListener(e,a,r){const m=Array.isArray(a)?a:[a];this._on[e]=this._on[e]||{};for(const g of m)this._on[e][g]=this._on[e][g]||[],this._on[e][g].push(r)}_parseMessageData(e){try{const a=JSON.parse(e);if(a.event)return{event:a.event,data:a.data||null}}catch{}return{event:null,data:null}}_dispatch(e,a,...r){const g=(this._on[e]||{})[a]||[];if(g.length!==0){Yt(`ws dispatch ${e} ${a}`);for(const u of g)u(...r)}}}const st=async(s,e,a)=>new Promise((r,m)=>{const g=new window.XMLHttpRequest;g.open(s,e,!0),g.withCredentials=!0;for(const u in a.headers||{})g.setRequestHeader(u,a.headers[u]);g.addEventListener("load",function(u){r({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),g.addEventListener("error",function(u){m(new Error("xhr error"))}),g.upload&&a.onUploadProgress&&g.upload.addEventListener("progress",function(u){a.onUploadProgress&&a.onUploadProgress(u)}),g.send(a.body)});var et={request:st,get:(s,e)=>st("get",s,e),post:(s,e)=>st("post",s,e)};const Xt=S({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null,drawUrl:"",favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}}}),async created(){this.ws=new Z(this.$conf.wsBase+"/drawcast",this.$me.token),this.ws.onMessage("init",async s=>{this.settings=s.settings,this.defaultSettings=s.defaultSettings,this.unchangedJson=JSON.stringify(s.settings),this.drawUrl=s.drawUrl;const e=await et.get("/api/drawcast/all-images/",{});this.favoriteSelection.items=await e.json()}),this.ws.connect()},watch:{settings:{deep:!0,handler(s){this.changedJson=JSON.stringify(s)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},receiveUrl(){return`${location.protocol}//${location.host}/widget/drawcast_receive/${this.$me.widgetToken}/`},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage==0?0:1)},currentFavoriteSelectionItems(){const s=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(s,s+this.favoriteSelection.pagination.perPage)}},methods:{toggleFavorite(s){if(!this.settings){console.warn("toggleFavorite: this.settings not initialized");return}this.settings.favorites.includes(s)?this.settings.favorites=this.settings.favorites.filter(e=>e!==s):this.settings.favorites.push(s)},soundUploaded(s){if(!this.settings){console.warn("soundUploaded: this.settings not initialized");return}this.settings.notificationSound={filename:s.originalname,file:s.filename,volume:100}},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:{canvasWidth:parseInt(`${this.settings.canvasWidth}`,10)||720,canvasHeight:parseInt(`${this.settings.canvasHeight}`,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,customDescription:this.settings.customDescription,palette:this.settings.palette,displayDuration:parseInt(`${this.settings.displayDuration}`,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,notificationSound:this.settings.notificationSound,favorites:this.settings.favorites}})},sendMsg(s){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(s))}},unmounted(){this.ws&&this.ws.disconnect()}}),Qt={id:"app"},Zt={id:"top",ref:"top"},xt={id:"actionbar",class:"p-1"},ts=["disabled"],ss=["href"],es=["href"],ns={id:"main",ref:"main"},ls={key:0,class:"table is-striped",ref:"table"},is=t("tr",null,[t("td",{colspan:"3"},"General")],-1),os=t("td",null,[t("code",null,"settings.canvasWidth")],-1),as=t("td",null,[c(" Width of the drawing area."),t("br"),c(" Caution: changing this will clear the area for currenty connected users. ")],-1),ds=t("td",null,[t("code",null,"settings.canvasHeight")],-1),rs=t("td",null,[c(" Height of the drawing area."),t("br"),c(" Caution: changing this will clear the area for currenty connected users. ")],-1),us=t("td",null,[t("code",null,"settings.displayDuration")],-1),cs=t("td",null," The duration in Milliseconds that each drawing will be shown ",-1),hs=t("td",null,[t("code",null,"settings.displayLatestForever")],-1),ps=t("td",null,"If checked, the latest drawing will be shown indefinately.",-1),ms=t("td",null,[t("code",null,"settings.displayLatestAutomatically")],-1),gs=t("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),fs=t("td",null,[t("code",null,"settings.submitButtonText")],-1),ys=t("td",null,null,-1),vs=t("td",null,[t("code",null,"settings.submitConfirm")],-1),_s=t("td",null," Leave empty if no confirm is required by user before sending. ",-1),$s=t("td",null,[t("code",null,"settings.customDescription")],-1),bs=t("td",null,"Description text below the drawing panel.",-1),ws=t("td",null,[t("code",null,"settings.palette")],-1),ks=["onUpdate:modelValue"],Cs=t("br",null,null,-1),Ss=t("br",null,null,-1),Vs=t("td",null,[c(" Default colors appearing on the draw page."),t("br"),c(" Caution: Changing this will change selected color for currenty connected users. ")],-1),Us=t("td",null,[t("code",null,"settings.notificationSound")],-1),Is={key:0,class:"spacerow media-holder"},Ps=t("i",{class:"fa fa-remove"},null,-1),As=[Ps],Ts=t("td",null,[c(" Add a sound here that plays when new drawings arrive. "),t("br"),c(" Note: Not played in drawing window, only in widget. ")],-1),Ds=t("code",null,"settings.favorites",-1),Ms={class:"preview"},Es=["src"],Fs=t("div",null,"Currently selected favorites:",-1),Ls={class:"favorites"},Rs=["src","onClick","onMouseover"],Os=t("div",{class:"mt-2"},"Select favorites:",-1),Ns={class:"favorites-select"},js=["src","onClick","onMouseover"],zs=["disabled"],Js=["disabled"],Bs=t("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function qs(s,e,a,r,m,g){const u=w("navbar"),n=w("player"),_=w("volume-slider"),f=w("upload");return l(),i("div",Qt,[t("div",Zt,[k(u),t("div",xt,[t("button",{class:"button is-small is-primary mr-1",disabled:!s.changed,onClick:e[0]||(e[0]=(...v)=>s.sendSave&&s.sendSave(...v))}," Save ",8,ts),t("a",{class:"button is-small mr-1",href:s.receiveUrl,target:"_blank"},"Open widget",8,ss),t("a",{class:"button is-small",href:s.drawUrl,target:"_blank"},"Open draw",8,es)])],512),t("div",ns,[s.settings?(l(),i("table",ls,[t("tbody",null,[is,t("tr",null,[os,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[1]||(e[1]=v=>s.settings.canvasWidth=v)},null,512),[[y,s.settings.canvasWidth]])]),as]),t("tr",null,[ds,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[2]||(e[2]=v=>s.settings.canvasHeight=v)},null,512),[[y,s.settings.canvasHeight]])]),rs]),t("tr",null,[us,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[3]||(e[3]=v=>s.settings.displayDuration=v)},null,512),[[y,s.settings.displayDuration]])]),cs]),t("tr",null,[hs,t("td",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=v=>s.settings.displayLatestForever=v)},null,512),[[F,s.settings.displayLatestForever]])]),ps]),t("tr",null,[ms,t("td",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=v=>s.settings.displayLatestAutomatically=v)},null,512),[[F,s.settings.displayLatestAutomatically]])]),gs]),t("tr",null,[fs,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[6]||(e[6]=v=>s.settings.submitButtonText=v)},null,512),[[y,s.settings.submitButtonText]])]),ys]),t("tr",null,[vs,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[7]||(e[7]=v=>s.settings.submitConfirm=v)},null,512),[[y,s.settings.submitConfirm]])]),_s]),t("tr",null,[$s,t("td",null,[h(t("textarea",{class:"textarea","onUpdate:modelValue":e[8]||(e[8]=v=>s.settings.customDescription=v)},null,512),[[y,s.settings.customDescription]])]),bs]),t("tr",null,[ws,t("td",null,[(l(!0),i(I,null,A(s.settings.palette,(v,U)=>(l(),i("label",{class:"square",key:U},[h(t("input",{type:"color","onUpdate:modelValue":o=>s.settings.palette[U]=o},null,8,ks),[[y,s.settings.palette[U]]]),t("span",{class:"square-inner",style:K({backgroundColor:v})},null,4)]))),128)),Cs,Ss,t("button",{class:"button is-small",onClick:e[9]||(e[9]=v=>s.settings.palette=s.defaultSettings.palette)}," Reset to default palette ")]),Vs]),t("tr",null,[Us,t("td",null,[s.settings.notificationSound?(l(),i("div",Is,[k(n,{src:s.settings.notificationSound.file,name:s.settings.notificationSound.filename,volume:s.settings.notificationSound.volume,class:"button is-small"},null,8,["src","name","volume"]),k(_,{modelValue:s.settings.notificationSound.volume,"onUpdate:modelValue":e[10]||(e[10]=v=>s.settings.notificationSound.volume=v)},null,8,["modelValue"]),t("button",{class:"button is-small",onClick:e[11]||(e[11]=v=>s.settings.notificationSound=null)},As)])):p("",!0),k(f,{onUploaded:s.soundUploaded,accept:"audio/*",label:"Upload Audio"},null,8,["onUploaded"])]),Ts]),t("tr",null,[t("td",null,[Ds,t("div",Ms,[s.favoriteSelection.hovered?(l(),i("img",{key:0,src:s.favoriteSelection.hovered},null,8,Es)):p("",!0)])]),t("td",null,[Fs,t("div",Ls,[(l(!0),i(I,null,A(s.settings.favorites,(v,U)=>(l(),i("img",{src:v,key:U,width:"50",height:"50",onClick:o=>s.toggleFavorite(v),onMouseover:o=>s.favoriteSelection.hovered=v,onMouseleave:e[12]||(e[12]=o=>s.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,Rs))),128))]),Os,t("div",Ns,[(l(!0),i(I,null,A(s.currentFavoriteSelectionItems,(v,U)=>(l(),i("img",{src:v,key:U,width:"50",height:"50",onClick:o=>s.toggleFavorite(v),onMouseover:o=>s.favoriteSelection.hovered=v,onMouseleave:e[13]||(e[13]=o=>s.favoriteSelection.hovered=""),class:P(["thumbnail mr-1",{"is-favorited":s.settings.favorites.includes(v)}])},null,42,js))),128))]),t("span",{class:"button is-small",onClick:e[14]||(e[14]=v=>s.favoriteSelection.pagination.page=s.favoriteSelection.pagination.page-1),disabled:s.favoriteSelection.pagination.page>1?null:!0},"Prev",8,zs),t("span",{class:"button is-small",onClick:e[15]||(e[15]=v=>s.favoriteSelection.pagination.page=s.favoriteSelection.pagination.page+1),disabled:s.favoriteSelection.pagination.page<s.favoriteSelectionTotalPages?null:!0},"Next",8,Js)]),Bs])])],512)):p("",!0)],512)])}var Ws=V(Xt,[["render",qs]]);const Hs=S({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(s){this.variables=this.variables.filter((e,a)=>a!==s)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await fetch("/save-variables",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({variables:this.variables})}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const s=await fetch("/api/page/variables");if(s.status!==200){this.$router.push({name:"login"});return}const e=await s.json();this.variables=e.variables,this.setUnchanged()}}),Ks={id:"app"},Gs={id:"top",ref:"top"},Ys={id:"actionbar",class:"p-1"},Xs=["disabled"],Qs={id:"main"},Zs={class:"mb-4"},xs=t("h1",{class:"title mb-2"},"Global Variables",-1),te=t("div",{class:"help"},[c(" Variables can be used from commands with "),t("code",null,"$var(variable_name)"),c(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),se={class:"table is-striped"},ee=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Value"),t("th")])],-1),ne=["onUpdate:modelValue"],le=["onUpdate:modelValue"],ie=t("i",{class:"fa fa-trash"},null,-1);function oe(s,e,a,r,m,g){const u=w("navbar"),n=w("doubleclick-button");return l(),i("div",Ks,[t("div",Gs,[k(u),t("div",Ys,[t("button",{class:"button is-small",onClick:e[0]||(e[0]=(..._)=>s.onAdd&&s.onAdd(..._))},"Add"),t("button",{class:"button is-small is-primary",disabled:!s.changed,onClick:e[1]||(e[1]=(..._)=>s.sendSave&&s.sendSave(..._))}," Save ",8,Xs)])],512),t("div",Qs,[t("div",Zs,[xs,te,t("table",se,[ee,t("tbody",null,[(l(!0),i(I,null,A(s.variables,(_,f)=>(l(),i("tr",{key:f},[t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":v=>_.name=v},null,8,ne),[[y,_.name]])]),t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":v=>_.value=v},null,8,le),[[y,_.value]])]),t("td",null,[k(n,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:v=>s.remove(f)},{default:L(()=>[ie]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var ae=V(Hs,[["render",oe]]);const de=S({data:()=>({user:"",pass:"",email:"",error:"",success:!1}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const s=await fetch("/api/user/_resend_verification_mail",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.email})});if(s.status===200)this.success=!0;else try{this.error=(await s.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const s=await fetch("/api/user/_register",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,pass:this.pass,email:this.email})});if(s.status===200)this.success=!0;else try{this.error=(await s.json()).reason}catch{this.error="Unknown error"}}}}),re={class:"center-screen"},ue=t("h1",{class:"title is-6"},"Hyottoko.club",-1),ce={key:0,class:"field has-background-success-light has-text-success-dark"},he=c(" Account registered. Please check your mail. Click "),pe=c("here"),me=c(" to login. "),ge={key:1},fe={key:0,class:"field has-background-danger-light has-text-danger-dark"},ye={key:0},ve=c(" A user with this email is already registered. "),_e=t("br",null,null,-1),$e=c("Request a password reset."),be={key:1},we=c(" A user with this email is already registered. "),ke=t("br",null,null,-1),Ce={key:2},Se={key:3},Ve={key:4},Ue={class:"field"},Ie={class:"control has-icons-left"},Pe=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-user"})],-1),Ae={class:"field"},Te={class:"control has-icons-left"},De=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-envelope"})],-1),Me={class:"field"},Ee={class:"control has-icons-left"},Fe=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-lock"})],-1),Le={class:"field"},Re=["disabled"];function Oe(s,e,a,r,m,g){const u=w("router-link");return l(),i("div",re,[ue,s.success?(l(),i("div",ce,[he,k(u,{to:{name:"login"}},{default:L(()=>[pe]),_:1}),me])):(l(),i("div",ge,[s.error?(l(),i("div",fe,[s.error==="verified_mail_already_exists"?(l(),i("div",ye,[ve,_e,k(u,{to:{name:"forgot-password"}},{default:L(()=>[$e]),_:1})])):s.error==="unverified_mail_already_exists"?(l(),i("div",be,[we,ke,t("span",{class:"button is-small",onClick:e[0]||(e[0]=(...n)=>s.onRequestVerificationEmail&&s.onRequestVerificationEmail(...n))},"Resend verification email")])):s.error==="verified_name_already_exists"?(l(),i("div",Ce," A user with this name is already registered. ")):s.error==="unverified_name_already_exists"?(l(),i("div",Se," A user with this name is already registered. ")):(l(),i("span",Ve,b(s.error),1))])):p("",!0),t("div",Ue,[t("div",Ie,[h(t("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":[e[1]||(e[1]=n=>s.user=n),e[2]||(e[2]=n=>s.error="")]},null,512),[[y,s.user]]),Pe])]),t("div",Ae,[t("div",Te,[h(t("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":[e[3]||(e[3]=n=>s.email=n),e[4]||(e[4]=n=>s.error="")]},null,512),[[y,s.email]]),De])]),t("div",Me,[t("div",Ee,[h(t("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":[e[5]||(e[5]=n=>s.pass=n),e[6]||(e[6]=n=>s.error="")],onKeyup:e[7]||(e[7]=z((...n)=>s.submit&&s.submit(...n),["enter"]))},null,544),[[y,s.pass]]),Fe])]),t("div",Le,[t("button",{class:"button is-small is-primary",disabled:s.canRegister?null:!0,onClick:e[8]||(e[8]=(...n)=>s.submit&&s.submit(...n))}," Register ",8,Re)])]))])}var Ne=V(de,[["render",Oe]]);const je=S({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[],tmi_identity_client_id:"",tmi_identity_client_secret:""},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const s=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],e=document.location,a=`${e.protocol}//${e.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${a}&scope=${s.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(s){this.twitch_channels=this.twitch_channels.filter((e,a)=>a!==s)},addchannel(){this.twitch_channels.push({user_id:this.user.id,channel_id:"",channel_name:"",access_token:""})},async loadid(s){this.twitch_channels[s].channel_id=await this.getTwitchUserIdByName(this.twitch_channels[s].channel_name)},async getTwitchUserIdByName(s){const e={name:s,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},a=await fetch("/twitch/user-id-by-name",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});try{return`${(await a.json()).id}`}catch{return""}},async sendSave(){await fetch("/api/save-settings",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const s=await fetch("/api/page/settings");if(s.status!==200){this.$router.push({name:"login"});return}const e=await s.json();this.user=e.user,this.twitch_channels=e.twitchChannels,this.setUnchanged()}}),ze={id:"app"},Je={id:"top",ref:"top"},Be={id:"actionbar",class:"p-1"},qe=["disabled"],We={id:"main"},He={class:"mb-4"},Ke=t("h1",{class:"title mb-2"},"User",-1),Ge={class:"table is-striped"},Ye=t("td",null,"Name:",-1),Xe=t("td",null,"Email:",-1),Qe=t("td",null,"Password:",-1),Ze={key:0,class:"mb-4"},xe=t("h1",{class:"title mb-2"},"Twitch-Bot",-1),tn=t("p",null,[c(" Please refer to "),t("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),c(". ")],-1),sn={class:"table is-striped"},en=t("td",null,"Bot name:",-1),nn=t("td",null,"Bot oauth (pass):",-1),ln=t("td",null,"Bot client_id:",-1),on=t("td",null,"Bot client_secret:",-1),an={class:"mb-4"},dn=t("h1",{class:"title mb-2"},"Twitch Channels",-1),rn=c(" List of twitch channels where the bot will connect to. "),un={key:0},cn={key:0,class:"table is-striped"},hn=t("thead",null,[t("tr",null,[t("td",null,"Channel name"),t("td",null,"Channel id*"),t("td",null,"Access Token*"),t("td")])],-1),pn=["onUpdate:modelValue"],mn=["onUpdate:modelValue"],gn=["onClick"],fn=["onUpdate:modelValue"],yn=["onClick"],vn=t("i",{class:"fa fa-remove"},null,-1),_n=[vn],$n={key:1,class:"content"},bn=t("p",null," Channel Id* and Access Token*: You may not need the client id or access token. No public feature currently uses them. ",-1),wn={key:0},kn={key:1,class:"list"},Cn=t("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Sn={class:"list-item"},Vn=c(" Click "),Un=["href"],In=c(" to authorize the bot with the channel "),Pn=t("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),An={key:2};function Tn(s,e,a,r,m,g){const u=w("navbar");return l(),i("div",ze,[t("div",Je,[k(u),t("div",Be,[t("button",{class:"button is-small is-primary",disabled:!s.changed,onClick:e[0]||(e[0]=(...n)=>s.sendSave&&s.sendSave(...n))}," Save ",8,qe)])],512),t("div",We,[t("div",He,[Ke,t("table",Ge,[t("tbody",null,[t("tr",null,[Ye,t("td",null,b(s.user.name),1)]),t("tr",null,[Xe,t("td",null,[h(t("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=n=>s.user.email=n)},null,512),[[y,s.user.email]])])]),t("tr",null,[Qe,t("td",null,[h(t("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=n=>s.user.pass=n)},null,512),[[y,s.user.pass]])])])])])]),s.isAdmin?(l(),i("div",Ze,[xe,tn,t("table",sn,[t("tbody",null,[t("tr",null,[en,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>s.user.tmi_identity_username=n)},null,512),[[y,s.user.tmi_identity_username]])])]),t("tr",null,[nn,t("td",null,[h(t("input",{class:"input is-small",type:"password","onUpdate:modelValue":e[4]||(e[4]=n=>s.user.tmi_identity_password=n)},null,512),[[y,s.user.tmi_identity_password]])])]),t("tr",null,[ln,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[5]||(e[5]=n=>s.user.tmi_identity_client_id=n)},null,512),[[y,s.user.tmi_identity_client_id]])])]),t("tr",null,[on,t("td",null,[h(t("input",{class:"input is-small",type:"password","onUpdate:modelValue":e[6]||(e[6]=n=>s.user.tmi_identity_client_secret=n)},null,512),[[y,s.user.tmi_identity_client_secret]])])])])])])):p("",!0),t("div",an,[dn,t("p",null,[rn,s.twitch_channels.length===0?(l(),i("span",un," Currently no channels are configured. ")):p("",!0)]),s.twitch_channels.length>0?(l(),i("table",cn,[hn,t("tbody",null,[(l(!0),i(I,null,A(s.twitch_channels,(n,_)=>(l(),i("tr",{key:n.channel_name},[t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":f=>n.channel_name=f},null,8,pn),[[y,n.channel_name]])]),t("td",null,[n.channel_id?h((l(),i("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":f=>n.channel_id=f},null,8,mn)),[[y,n.channel_id]]):p("",!0),n.channel_id?p("",!0):(l(),i("button",{key:1,class:"button is-small",onClick:f=>s.loadid(_)}," Load id ",8,gn))]),t("td",null,[h(t("input",{class:"input is-small",type:"password","onUpdate:modelValue":f=>n.access_token=f},null,8,fn),[[y,n.access_token]])]),t("td",null,[t("button",{class:"button is-small",onClick:f=>s.rmchannel(_)},_n,8,yn)])]))),128))])])):p("",!0),t("button",{class:"button is-small",onClick:e[7]||(e[7]=n=>s.addchannel())}," Add channel ")]),s.twitch_channels.length>0?(l(),i("div",$n,[bn,s.accessTokenLink?(l(),i("p",wn,"To get an access token, do the following:")):p("",!0),s.accessTokenLink?(l(),i("ol",kn,[Cn,t("li",Sn,[Vn,t("a",{href:s.accessTokenLink,target:"_blank"},"here",8,Un),In]),Pn])):s.isAdmin?(l(),i("p",An,' To configure an access token, please configure the "Bot client_id" above. ')):p("",!0)])):p("",!0)])])}var Dn=V(je,[["render",Tn]]);const Mn=S({data:()=>({playerVisible:!1,playlist:[],settings:{volume:100,hideVideoImage:{file:"",filename:""},showProgressBar:!1,customCss:"",customCssPresets:[]},filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:""}),computed:{tags(){const s=[];return this.playlist.forEach(e=>{e.tags.forEach(a=>{const r=s.findIndex(m=>m.value===a);r===-1?s.push({value:a,count:1}):s[r].count++})}),s},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(s=>s.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},importPlaylistUrl(){return`${location.protocol}//${location.host}/sr/import`},exportPlaylistUrl(){return`${location.protocol}//${location.host}/sr/export`},widgetUrl(){return`${location.protocol}//${location.host}/widget/sr/${this.$me.widgetToken}/`}},methods:{sendSettings(){this.sendCtrl("settings",[this.settings])},onTagUpdated(s){this.updateTag(s[0],s[1])},onPlaylistCtrl(s){this.sendCtrl(s[0],s[1])},applyFilter(s){this.sendCtrl("filter",[{tag:s}])},async doImportPlaylist(){(await et.post(this.importPlaylistUrl,{headers:{Accept:"application/json","Content-Type":"application/json"},body:this.importPlaylist})).status===200?(this.tab="playlist",this.$toasted.success("Import successful")):this.$toasted.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(s,e){this.sendMsg({event:"ctrl",ctrl:s,args:e})},ended(){this.sendMsg({event:"ended"})},sendMsg(s){this.ws?this.ws.send(JSON.stringify(s)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(s){this.player.setVolume(s)},updateTag(s,e){s!==e&&this.sendCtrl("updatetag",[s,e])}},async mounted(){this.$nextTick(()=>{this.ws=new Z(this.$conf.wsBase+"/sr",this.$me.token),this.ws.onMessage("settings",s=>{this.settings=s.settings}),this.ws.onMessage(["pause"],s=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],s=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],s=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],s=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","clear","move","tags"],s=>{this.settings=s.settings;const e=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=s.filter,this.playlist=s.playlist;const a=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;e!==a&&this.play()}),this.ws.onMessage(["filter"],s=>{this.settings=s.settings;const e=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=s.filter,this.playlist=s.playlist,this.filteredPlaylist.find(a=>a.id===e)||this.play()}),this.ws.onMessage(["dislike","like","video","playIdx","resetStats","shuffle"],s=>{this.settings=s.settings,this.filter=s.filter,this.playlist=s.playlist}),this.ws.onMessage(["add","init"],s=>{this.settings=s.settings,this.filter=s.filter,this.playlist=s.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),M=s=>(W("data-v-e685a1fa"),s=s(),H(),s),En={id:"app"},Fn={id:"top",ref:"top"},Ln={id:"actionbar",class:"p-1"},Rn=["disabled"],On=M(()=>t("i",{class:"fa fa-eraser mr-1"},null,-1)),Nn=M(()=>t("span",{class:"txt"}," Reset stats",-1)),jn=[On,Nn],zn=["disabled"],Jn=M(()=>t("i",{class:"fa fa-eject mr-1"},null,-1)),Bn=M(()=>t("span",{class:"txt"}," Clear",-1)),qn=[Jn,Bn],Wn=["disabled"],Hn=M(()=>t("i",{class:"fa fa-random mr-1"},null,-1)),Kn=M(()=>t("span",{class:"txt"}," Shuffle",-1)),Gn=[Hn,Kn],Yn=["disabled","title"],Xn=M(()=>t("i",{class:"fa fa-tv mr-1"},null,-1)),Qn={class:"txt"},Zn={class:"field has-addons mr-1"},xn={class:"control"},tl=["disabled"],sl={class:"control"},el=["disabled"],nl=M(()=>t("i",{class:"fa fa-search mr-1"},null,-1)),ll=c(" from playlist "),il=[nl,ll],ol={class:"field has-addons mr-1"},al={class:"control"},dl=["disabled"],rl={class:"control"},ul=["disabled"],cl=M(()=>t("i",{class:"fa fa-plus mr-1"},null,-1)),hl=c(" from YouTube "),pl=[cl,hl],ml=["disabled","href"],gl={id:"main",ref:"main"},fl={style:{width:"640px","max-width":"100%"}},yl={class:"tabs"},vl=M(()=>t("a",null,"Playlist",-1)),_l=[vl],$l=M(()=>t("a",null,"Settings",-1)),bl=[$l],wl=M(()=>t("a",null,"Help",-1)),kl=[wl],Cl=M(()=>t("a",null,"Tags",-1)),Sl=[Cl],Vl=M(()=>t("a",null,"Import/Export",-1)),Ul=[Vl],Il={key:0},Pl={class:"mb-1"},Al=["href"],Tl=M(()=>t("i",{class:"fa fa-download mr-1"},null,-1)),Dl=c(" Export playlist"),Ml=[Tl,Dl],El=M(()=>t("i",{class:"fa fa-upload mr-1"},null,-1)),Fl=c(" Import playlist "),Ll=[El,Fl],Rl={key:1,id:"help"},Ol={key:2,id:"tags"},Nl={key:4,id:"playlist",class:"table-container"};function jl(s,e,a,r,m,g){const u=w("navbar"),n=w("youtube"),_=w("help"),f=w("tags-editor"),v=w("song-request-settings"),U=w("playlist-editor");return l(),i("div",En,[t("div",Fn,[k(u),t("div",Ln,[t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[0]||(e[0]=o=>s.sendCtrl("resetStats",[])),title:"Reset stats"},jn,8,Rn),t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[1]||(e[1]=o=>s.sendCtrl("clear",[])),title:"Clear"},qn,8,zn),t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[2]||(e[2]=o=>s.sendCtrl("shuffle",[])),title:"Shuffle"},Gn,8,Wn),t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[3]||(e[3]=(...o)=>s.togglePlayer&&s.togglePlayer(...o)),title:s.togglePlayerButtonText},[Xn,t("span",Qn,b(s.togglePlayerButtonText),1)],8,Yn),t("div",Zn,[t("div",xn,[h(t("input",{class:"input is-small",disabled:s.inited?null:!0,"onUpdate:modelValue":e[4]||(e[4]=o=>s.resrinput=o),onKeyup:e[5]||(e[5]=z((...o)=>s.resr&&s.resr(...o),["enter"]))},null,40,tl),[[y,s.resrinput]])]),t("div",sl,[t("button",{class:"button is-small",disabled:s.inited?null:!0,onClick:e[6]||(e[6]=(...o)=>s.resr&&s.resr(...o))},il,8,el)])]),t("div",ol,[t("div",al,[h(t("input",{class:"input is-small",disabled:s.inited?null:!0,"onUpdate:modelValue":e[7]||(e[7]=o=>s.srinput=o),onKeyup:e[8]||(e[8]=z((...o)=>s.sr&&s.sr(...o),["enter"]))},null,40,dl),[[y,s.srinput]])]),t("div",rl,[t("button",{class:"button is-small",disabled:s.inited?null:!0,onClick:e[9]||(e[9]=(...o)=>s.sr&&s.sr(...o))},pl,8,ul)])]),t("a",{class:"button is-small mr-1",disabled:s.inited?null:!0,href:s.widgetUrl,target:"_blank"},"Open SR widget",8,ml)])],512),t("div",gl,[t("div",fl,[t("div",{id:"player",class:"video-16-9",style:K(s.playerstyle)},[k(n,{ref:"youtube",onEnded:s.ended,visible:s.playerVisible},null,8,["onEnded","visible"])],4)]),t("div",yl,[t("ul",null,[t("li",{class:P({"is-active":s.tab==="playlist"}),onClick:e[10]||(e[10]=o=>s.tab="playlist")},_l,2),t("li",{class:P({"is-active":s.tab==="settings"}),onClick:e[11]||(e[11]=o=>s.tab="settings")},bl,2),t("li",{class:P({"is-active":s.tab==="help"}),onClick:e[12]||(e[12]=o=>s.tab="help")},kl,2),t("li",{class:P({"is-active":s.tab==="tags"}),onClick:e[13]||(e[13]=o=>s.tab="tags")},Sl,2),t("li",{class:P({"is-active":s.tab==="import"}),onClick:e[14]||(e[14]=o=>s.tab="import")},Ul,2)])]),s.inited&&s.tab==="import"?(l(),i("div",Il,[t("div",Pl,[t("a",{class:"button is-small mr-1",href:s.exportPlaylistUrl,target:"_blank"},Ml,8,Al),t("button",{class:"button is-small",onClick:e[15]||(e[15]=(...o)=>s.doImportPlaylist&&s.doImportPlaylist(...o))},Ll)]),h(t("textarea",{class:"textarea mb-1","onUpdate:modelValue":e[16]||(e[16]=o=>s.importPlaylist=o)},null,512),[[y,s.importPlaylist]])])):p("",!0),s.inited&&s.tab==="help"?(l(),i("div",Rl,[k(_)])):p("",!0),s.inited&&s.tab==="tags"?(l(),i("div",Ol,[k(f,{tags:s.tags,onUpdateTag:s.onTagUpdated},null,8,["tags","onUpdateTag"])])):p("",!0),s.inited&&s.tab==="settings"?(l(),O(v,{key:3,id:"settings",modelValue:s.settings,"onUpdate:modelValue":[e[17]||(e[17]=o=>s.settings=o),s.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])):p("",!0),s.inited&&s.tab==="playlist"?(l(),i("div",Nl,[k(U,{playlist:s.playlist,filter:s.filter,onStopPlayer:e[18]||(e[18]=o=>s.player.stop()),onFilterChange:s.applyFilter,onCtrl:s.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):p("",!0)],512)])}var zl=V(Mn,[["render",jl],["__scopeId","data-v-e685a1fa"]]);const B=s=>({type:s,data:{command:"",minInterval:0,minLines:0}}),ot=()=>"",at=()=>({sound:{filename:"",file:"",volume:100},image:{filename:"",file:""},minDurationMs:"1s"}),Jl=()=>({steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}),Bl=s=>{switch(s){case"text":return{triggers:[B("command")],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[ot()]}};case"media":return{triggers:[B("command")],action:"media",restrict_to:[],variables:[],variableChanges:[],data:at()};case"countdown":return{triggers:[B("command")],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:Jl()};case"dict_lookup":return{triggers:[B("command")],action:"dict_lookup",restrict_to:[],variables:[],variableChanges:[],data:{lang:"ja",phrase:""}};case"madochan_createword":return{triggers:[B("command")],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}};case"chatters":return{triggers:[B("command")],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}};default:return null}};var G={newTrigger:B,newText:ot,newMedia:at,newCmd:Bl};const ql=1,Y=1e3*ql,X=60*Y,Q=60*X,x=24*Q,dt=s=>{if(s==="")throw new Error("unable to parse duration");const e=`${s}`.trim();if(!e)throw new Error("unable to parse duration");if(e.match(/^\d+$/))return parseInt(e,10);const a=e.match(/^((?:\d*)\.(?:\d*))(d|h|m|s)$/);if(a){const f=parseFloat(a[1]);if(isNaN(f))throw new Error("unable to parse duration");const v=a[2];let U=0;return v==="d"?U=f*x:v==="h"?U=f*Q:v==="m"?U=f*X:v==="s"&&(U=f*Y),Math.round(U)}const r=e.match(/^(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!r)throw new Error("unable to parse duration");const m=r[1]?parseInt(r[1],10):0,g=r[2]?parseInt(r[2],10):0,u=r[3]?parseInt(r[3],10):0,n=r[4]?parseInt(r[4],10):0,_=r[5]?parseInt(r[5],10):0;return n*Y+u*X+g*Q+m*x+_},Wl=s=>{try{return dt(s)}catch{return 0}},Hl=s=>{let e=s;const a=Math.floor(e/x);e=e%x;const r=Math.floor(e/Q);e=e%Q;const m=Math.floor(e/X);e=e%X;const g=Math.floor(e/Y);e=e%Y;const u=e,n=["ms","s","m","h","d"],_=[u,g,m,r,a];let f=0;for(;f<_.length&&_[f]===0;)f++;let v=_.length-1;for(;v>=0&&_[v]===0;)v--;const U=[];for(let o=f;o<=v;o++)U.unshift(`${_[o]}${n[o]}`);return U.join(" ")};function Kl(s,e,a){if(a>=s.length)for(var r=a-s.length+1;r--;)s.push(void 0);return s.splice(a,0,s.splice(e,1)[0]),s}const Gl=(s,e)=>{const a=[{regex:/\$args\((\d*)(:?)(\d*)\)/g,replacer:(g,u)=>e},{regex:/\$var\(([^)]+)\)/g,replacer:(g,u)=>e},{regex:/\$user\.name/g,replacer:()=>e},{regex:/\$([a-z][a-z0-9]*)(?!\()/g,replacer:(g,u)=>g},{regex:/\$customapi\(([^$\)]*)\)\[\'([A-Za-z0-9_ -]+)\'\]/g,replacer:(g,u,n)=>e},{regex:/\$customapi\(([^$\)]*)\)/g,replacer:(g,u)=>e},{regex:/\$urlencode\(([^$\)]*)\)/g,replacer:(g,u)=>e},{regex:/\$calc\((\d+)([*/+-])(\d+)\)/g,replacer:(g,u,n,_)=>e}];let r=s,m;do{m=r;for(let g of a)r=r.replace(g.regex,g.replacer)}while(m!==r);return r},Yl=(s,e=",",a=-1)=>{const r=s.split(e);return a===-1||r.length<=a?r:[...r.slice(0,a-1),r.slice(a-1).join(e)]},Xl=s=>{let e=s.length;for(;e>0;){let a=Math.floor(Math.random()*e);e--;let r=s[e];s[e]=s[a],s[a]=r}return s};var J={arrayMove:Kl,humanDuration:Hl,parseHumanDuration:Wl,mustParseHumanDuration:dt,doDummyReplacements:Gl,split:Yl,shuffle:Xl};const Ql=S({data:()=>({commands:[],settings:{volume:100},adminSettings:{showImages:!0},globalVariables:[],ws:null,editIdx:null,editCommand:null,addDropdownActive:!1,possibleCommands:[{action:"text",title:"Send a message to chat",text:"Add text"},{action:"media",title:"Display an image and/or play a sound",text:"Add media"},{action:"countdown",title:"Add a countdown or messages spaced by time intervals",text:"Add countdown"},{action:"dict_lookup",title:"Lookup a translation of a word",text:"Add dict_lookup"},{action:"madochan_createword",title:"Create a word with madochan",text:"Add madochan"},{action:"chatters",title:"Displays users who chatted during the stream",text:"Add chatters"}],possibleActions:["text","media","countdown","dict_lookup","madochan_createword","chatters"],filter:{search:"",actions:[]},inited:!1,tab:"commands"}),computed:{baseVolume(){return this.settings.volume},widgetUrl(){return`${location.protocol}//${location.host}/widget/media/${this.$me.widgetToken}/`}},methods:{commandCount(s){let e=0;for(const a of this.commands)a.action===s&&e++;return e},filteredOut(s){if(this.filter.actions.length===0)return!1;if(!this.filter.actions.includes(s.action))return!0;if(this.filter.search){const e=this.filter.search.toLowerCase();if(!s.triggers.find(({type:a,data:r})=>a==="command"&&r.command.toLowerCase().indexOf(e)>=0))return!0}return!1},permissionsStr(s){if(!s.restrict_to||s.restrict_to.length===0)return"Everyone";const e=[];return s.restrict_to.includes("broadcaster")&&e.push("Broadcaster"),s.restrict_to.includes("mod")&&e.push("Moderators"),s.restrict_to.includes("sub")&&e.push("Subscribers"),e.join(", ")},add(s){const e=G.newCmd(s);!e||(this.editIdx=this.commands.length,this.editCommand=e)},remove(s){this.commands=this.commands.filter((e,a)=>a!==s),this.sendSave()},edit(s){this.editIdx=s,this.editCommand=this.commands[s]},duplicate(s){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[s]))},editedCommand(s){this.editIdx!==null&&(this.commands[this.editIdx]=s,this.sendSave(),this.editIdx=null,this.editCommand=null)},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings,adminSettings:this.adminSettings})},sendMsg(s){this.ws?this.ws.send(JSON.stringify(s)):console.warn("sendMsg: this.ws not initialized")},dragEnd(s){this.commands=J.arrayMove(this.commands,s.oldIndex,s.newIndex),this.sendSave()},openDropdown(){this.addDropdownActive=!0},closeDropdown(){this.addDropdownActive=!1},hideAddDropdown(s){!this.$refs.addDropdown||this.$refs.addDropdown.contains(s.target)||this.closeDropdown()}},async mounted(){this.ws=new Z(this.$conf.wsBase+"/general",this.$me.token),this.ws.onMessage("init",s=>{this.commands=s.commands,this.settings=s.settings,this.adminSettings=s.adminSettings,this.globalVariables=s.globalVariables,this.inited=!0}),this.ws.connect(),window.addEventListener("click",this.hideAddDropdown)},unmounted(){this.ws&&this.ws.disconnect(),window.removeEventListener("click",this.hideAddDropdown)}}),T=s=>(W("data-v-be0a4a66"),s=s(),H(),s),Zl={id:"app"},xl={id:"top",ref:"top"},ti={id:"main",ref:"main"},si={class:"tabs"},ei=T(()=>t("a",null,"Commands",-1)),ni=[ei],li=T(()=>t("a",null,"Settings",-1)),ii=[li],oi={key:1},ai={class:"actions"},di={class:"dropdown-trigger"},ri=["disabled"],ui=T(()=>t("span",null,"Add command",-1)),ci=T(()=>t("span",{class:"icon is-small"},[t("i",{class:"fa fa-angle-down","aria-hidden":"true"})],-1)),hi=[ui,ci],pi={class:"dropdown-menu",id:"dropdown-menu",role:"menu"},mi={class:"dropdown-content"},gi=["onClick","title"],fi=["href"],yi=T(()=>t("div",{class:"mr-1"},"Filter:",-1)),vi={class:"field has-addons mr-1 mb-0"},_i={class:"control"},$i=["value"],bi={key:0,class:"table-container"},wi={class:"table is-striped",ref:"table"},ki=T(()=>t("th",null,null,-1)),Ci=T(()=>t("th",null,null,-1)),Si=T(()=>t("th",null,"Trigger",-1)),Vi=c(" Response "),Ui=c(" Show images "),Ii=T(()=>t("th",null,"Type",-1)),Pi=T(()=>t("th",null,"Permissions",-1)),Ai=T(()=>t("th",null,null,-1)),Ti=T(()=>t("th",null,null,-1)),Di=T(()=>t("td",{class:"pt-4 handle"},[t("i",{class:"fa fa-arrows"})],-1)),Mi={class:"pl-0 pr-0"},Ei=["onClick"],Fi=T(()=>t("i",{class:"fa fa-pencil"},null,-1)),Li=[Fi],Ri={class:"col-triggers"},Oi={key:0},Ni={key:1},ji=T(()=>t("span",{class:"is-small",title:"Channel Point Reward"},[t("i",{class:"fa fa-bullseye"}),c(": ")],-1)),zi={key:2},Ji=T(()=>t("span",{class:"is-small"},"Timer: ",-1)),Bi={key:0},qi={key:1},Wi={key:2},Hi={key:3},Ki={key:0},Gi={key:0,class:"spacerow media-holder media-holder-inline"},Yi={key:1},Xi={key:2,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},Qi={key:3,class:"ml-2"},Zi=c("for at least "),xi={key:4,class:"ml-2"},to=c("for "),so={key:5},eo={key:0},no=T(()=>t("span",null,"\u2192",-1)),lo=c(" \u2715 "),io=T(()=>t("span",null,"\u2192",-1)),oo={key:1},ao={key:1},ro={key:2},uo=c(" Media("),co={key:0},ho={key:1},po={key:2},mo=c(") "),go={key:3},fo={class:"pl-0 pr-0"},yo=T(()=>t("i",{class:"fa fa-trash"},null,-1)),vo=["onClick"],_o=T(()=>t("i",{class:"fa fa-clone"},null,-1)),$o=[_o],bo={key:1},wo={key:2},ko={key:0,class:"table is-striped",ref:"table"},Co=T(()=>t("td",null,[t("code",null,"settings.volume")],-1)),So=T(()=>t("td",null,"Base volume for all media playing from commands",-1));function Vo(s,e,a,r,m,g){const u=w("navbar"),n=w("command-edit"),_=w("duration"),f=w("responsive-image"),v=w("player"),U=w("doubleclick-button"),o=w("draggable"),C=w("volume-slider");return l(),i("div",Zl,[t("div",xl,[k(u)],512),t("div",ti,[s.editCommand?(l(),O(n,{key:0,globalVariables:s.globalVariables,modelValue:s.editCommand,mode:s.editIdx>=s.commands.length?"create":"edit",baseVolume:s.baseVolume,"onUpdate:modelValue":s.editedCommand,onCancel:e[0]||(e[0]=d=>s.editCommand=null)},null,8,["globalVariables","modelValue","mode","baseVolume","onUpdate:modelValue"])):p("",!0),t("div",si,[t("ul",null,[t("li",{class:P({"is-active":s.tab==="commands"}),onClick:e[1]||(e[1]=d=>s.tab="commands")},ni,2),t("li",{class:P({"is-active":s.tab==="settings"}),onClick:e[2]||(e[2]=d=>s.tab="settings")},ii,2)])]),s.inited&&s.tab==="commands"?(l(),i("div",oi,[t("div",ai,[t("div",{class:P(["dropdown mr-1",{"is-active":s.addDropdownActive}]),ref:"addDropdown"},[t("div",di,[t("button",{class:"button is-small mr-1","aria-haspopup":"true","aria-controls":"dropdown-menu",disabled:s.inited?null:!0,onClick:e[3]||(e[3]=(...d)=>s.openDropdown&&s.openDropdown(...d))},hi,8,ri)]),t("div",pi,[t("div",mi,[(l(!0),i(I,null,A(s.possibleCommands,(d,j)=>(l(),i("a",{href:"#",class:"dropdown-item",key:j,onClick:D=>{s.closeDropdown(),s.add(d.action)},title:d.title},b(d.text),9,gi))),128))])])],2),t("a",{class:"button is-small mr-1",href:s.widgetUrl,target:"_blank"},"Open Media widget",8,fi),yi,t("div",vi,[t("div",_i,[h(t("input",{class:"input is-small","onUpdate:modelValue":e[4]||(e[4]=d=>s.filter.search=d)},null,512),[[y,s.filter.search]])])]),(l(!0),i(I,null,A(s.possibleActions,(d,j)=>(l(),i("label",{class:"mr-1",key:j},[h(t("input",{class:"mr-1",type:"checkbox",value:d,"onUpdate:modelValue":e[5]||(e[5]=D=>s.filter.actions=D)},null,8,$i),[[F,s.filter.actions]]),c(b(d)+" ("+b(s.commandCount(d))+")",1)]))),128))]),s.commands.length>0?(l(),i("div",bi,[t("table",wi,[t("thead",null,[t("tr",null,[ki,Ci,Si,t("th",null,[Vi,t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":[e[6]||(e[6]=d=>s.adminSettings.showImages=d),e[7]||(e[7]=(...d)=>s.sendSave&&s.sendSave(...d))]},null,512),[[F,s.adminSettings.showImages]]),Ui])]),Ii,Pi,Ai,Ti])]),k(o,{modelValue:s.commands,onEnd:s.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:L(({element:d,index:j})=>[h(t("tr",null,[Di,t("td",Mi,[t("button",{class:"button is-small",onClick:D=>s.edit(j)},Li,8,Ei)]),t("td",Ri,[(l(!0),i(I,null,A(d.triggers,(D,E)=>(l(),i("div",{key:E,class:"spacerow"},[d.triggers[E].type==="command"?(l(),i("div",Oi,[t("code",null,b(d.triggers[E].data.command),1)])):p("",!0),d.triggers[E].type==="reward_redemption"?(l(),i("div",Ni,[ji,t("code",null,b(d.triggers[E].data.command),1)])):p("",!0),d.triggers[E].type==="timer"?(l(),i("div",zi,[Ji,t("code",null,[c(b(d.triggers[E].data.minLines)+" lines, ",1),k(_,{value:d.triggers[E].data.minInterval},null,8,["value"])])])):p("",!0)]))),128))]),t("td",null,[d.action==="dict_lookup"?(l(),i("div",Bi," Outputs the translation for the searched word. ")):p("",!0),d.action==="madochan_createword"?(l(),i("div",qi," Creates a word for a definition. ")):p("",!0),d.action==="chatters"?(l(),i("div",Wi," Outputs the people who chatted during the stream. ")):p("",!0),d.action==="text"?(l(),i("div",Hi,[(l(!0),i(I,null,A(d.data.text,(D,E)=>(l(),i(I,{key:E},[t("code",null,b(d.data.text[E]),1),E<d.data.text.length-1?(l(),i("span",Ki,"or")):p("",!0)],64))),128))])):p("",!0),d.action==="media"?(l(),i("div",{key:4,class:P(d.action)},[d.data.image.file||d.data.sound.file?(l(),i("div",Gi,[d.data.image.file&&s.adminSettings.showImages?(l(),O(f,{key:0,src:d.data.image.file,title:d.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):d.data.image.file?(l(),i("code",Yi,b(d.data.image.filename),1)):p("",!0),d.data.image.file&&d.data.sound.file?(l(),i("i",Xi)):p("",!0),k(v,{src:d.data.sound.file,name:d.data.sound.filename,volume:d.data.sound.volume,baseVolume:s.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),d.data.image.file&&d.data.sound.file?(l(),i("span",Qi,[Zi,k(_,{value:d.data.minDurationMs},null,8,["value"])])):d.data.image.file?(l(),i("span",xi,[to,k(_,{value:d.data.minDurationMs},null,8,["value"])])):p("",!0)])):p("",!0)],2)):p("",!0),d.action==="countdown"?(l(),i("div",so,[(d.data.type||"auto")==="auto"?(l(),i("div",eo,[t("code",null,b(d.data.intro),1),no,t("code",null,b(d.data.steps),1),lo,k(_,{value:d.data.interval},null,8,["value"]),io,t("code",null,b(d.data.outro),1)])):(l(),i("div",oo,[(l(!0),i(I,null,A(d.data.actions,(D,E)=>(l(),i(I,{key:E},[D.type==="delay"?(l(),O(_,{key:0,value:D.value},null,8,["value"])):p("",!0),D.type==="text"?(l(),i("code",ao,b(D.value),1)):p("",!0),D.type==="media"?(l(),i("code",ro,[uo,D.value.image.file?(l(),i("span",co,b(D.value.image.filename),1)):p("",!0),D.value.image.file&&D.value.sound.file?(l(),i("span",ho,"+")):p("",!0),D.value.sound.file?(l(),i("span",po,b(D.value.sound.filename),1)):p("",!0),mo])):p("",!0),E<d.data.actions.length-1?(l(),i("span",go,"\u2192")):p("",!0)],64))),128))]))])):p("",!0)]),t("td",null,b(d.action),1),t("td",null,b(s.permissionsStr(d)),1),t("td",fo,[k(U,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:D=>s.remove(j)},{default:L(()=>[yo]),_:2},1032,["onDoubleclick"]),t("button",{class:"button is-small",onClick:D=>s.duplicate(j)},$o,8,vo)])],512),[[nt,!s.filteredOut(d)]])]),_:1},8,["modelValue","onEnd"])],512)])):(l(),i("div",bo,"No commands set up"))])):p("",!0),s.inited&&s.tab==="settings"?(l(),i("div",wo,[s.settings?(l(),i("table",ko,[t("tbody",null,[t("tr",null,[Co,t("td",null,[k(C,{modelValue:s.settings.volume,"onUpdate:modelValue":[e[8]||(e[8]=d=>s.settings.volume=d),s.sendSave]},null,8,["modelValue","onUpdate:modelValue"])]),So])])],512)):p("",!0)])):p("",!0)],512)])}var Uo=V(Ql,[["render",Vo],["__scopeId","data-v-be0a4a66"]]);const Io=S({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null}),watch:{settings:{deep:!0,handler(s){this.changedJson=JSON.stringify(s)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return`${location.protocol}//${location.host}/widget/speech-to-text/${this.$me.widgetToken}/`}},methods:{sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(s){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(s))}},async mounted(){this.ws=new Z(this.$conf.wsBase+"/speech-to-text",this.$me.token),this.ws.onMessage("init",s=>{this.settings=s.settings,this.defaultSettings=s.defaultSettings,this.unchangedJson=JSON.stringify(s.settings)}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Po={id:"app"},Ao={id:"top",ref:"top"},To={id:"actionbar",class:"p-1"},Do=["disabled"],Mo=["href"],Eo={id:"main",ref:"main"},Fo={key:0,class:"table is-striped",ref:"table"},Lo=t("tr",null,[t("td",{colspan:"3"},"General")],-1),Ro=t("td",null,[t("code",null,"settings.style.bgColor")],-1),Oo=["disabled"],No=t("i",{class:"fa fa-remove"},null,-1),jo=[No],zo=t("td",null,[t("code",null,"settings.style.vAlign")],-1),Jo={class:"select is-small"},Bo=t("option",{value:"top"},"top",-1),qo=t("option",{value:"bottom"},"bottom",-1),Wo=[Bo,qo],Ho=["disabled"],Ko=t("i",{class:"fa fa-remove"},null,-1),Go=[Ko],Yo=t("tr",null,[t("td",{colspan:"3"},"Recognition")],-1),Xo=t("td",null,[t("code",null,"settings.recognition.lang")],-1),Qo=["disabled"],Zo=t("i",{class:"fa fa-remove"},null,-1),xo=[Zo],ta=t("td",null,[t("code",null,"settings.recognition.synthesize")],-1),sa=["disabled"],ea=t("i",{class:"fa fa-remove"},null,-1),na=[ea],la=t("td",null,[t("code",null,"settings.recognition.synthesizeLang")],-1),ia=["disabled"],oa=t("i",{class:"fa fa-remove"},null,-1),aa=[oa],da=t("td",null,[t("code",null,"settings.recognition.display")],-1),ra=["disabled"],ua=t("i",{class:"fa fa-remove"},null,-1),ca=[ua],ha=t("td",null,[t("code",null,"settings.styles.recognition.color")],-1),pa=["disabled"],ma=t("i",{class:"fa fa-remove"},null,-1),ga=[ma],fa=t("td",null,[t("code",null,"settings.styles.recognition.strokeWidth")],-1),ya=["disabled"],va=t("i",{class:"fa fa-remove"},null,-1),_a=[va],$a=t("td",null,[t("code",null,"settings.styles.recognition.strokeColor")],-1),ba=["disabled"],wa=t("i",{class:"fa fa-remove"},null,-1),ka=[wa],Ca=t("td",null,[t("code",null,"settings.styles.recognition.fontFamily")],-1),Sa=["disabled"],Va=t("i",{class:"fa fa-remove"},null,-1),Ua=[Va],Ia=t("td",null,[t("code",null,"settings.styles.recognition.fontSize")],-1),Pa=["disabled"],Aa=t("i",{class:"fa fa-remove"},null,-1),Ta=[Aa],Da=t("td",null,[t("code",null,"settings.styles.recognition.fontWeight")],-1),Ma=["disabled"],Ea=t("i",{class:"fa fa-remove"},null,-1),Fa=[Ea],La=t("tr",null,[t("td",{colspan:"3"},"Translation")],-1),Ra=t("td",null,[t("code",null,"settings.translation.enabled")],-1),Oa=["disabled"],Na=t("i",{class:"fa fa-remove"},null,-1),ja=[Na],za=t("td",null,[t("code",null,"settings.translation.synthesize")],-1),Ja=["disabled"],Ba=t("i",{class:"fa fa-remove"},null,-1),qa=[Ba],Wa=t("td",null,[t("code",null,"settings.translation.synthesizeLang")],-1),Ha=["disabled"],Ka=t("i",{class:"fa fa-remove"},null,-1),Ga=[Ka],Ya=t("td",null,[t("code",null,"settings.translation.langSrc")],-1),Xa=["disabled"],Qa=t("i",{class:"fa fa-remove"},null,-1),Za=[Qa],xa=t("td",null,[t("code",null,"settings.translation.langDst")],-1),td=["disabled"],sd=t("i",{class:"fa fa-remove"},null,-1),ed=[sd],nd=t("td",null,[t("code",null,"settings.styles.translation.color")],-1),ld=["disabled"],id=t("i",{class:"fa fa-remove"},null,-1),od=[id],ad=t("td",null,[t("code",null,"settings.styles.translation.strokeWidth")],-1),dd=["disabled"],rd=t("i",{class:"fa fa-remove"},null,-1),ud=[rd],cd=t("td",null,[t("code",null,"settings.styles.translation.strokeColor")],-1),hd=["disabled"],pd=t("i",{class:"fa fa-remove"},null,-1),md=[pd],gd=t("td",null,[t("code",null,"settings.styles.translation.fontFamily")],-1),fd=["disabled"],yd=t("i",{class:"fa fa-remove"},null,-1),vd=[yd],_d=t("td",null,[t("code",null,"settings.styles.translation.fontSize")],-1),$d=["disabled"],bd=t("i",{class:"fa fa-remove"},null,-1),wd=[bd],kd=t("td",null,[t("code",null,"settings.styles.translation.fontWeight")],-1),Cd=["disabled"],Sd=t("i",{class:"fa fa-remove"},null,-1),Vd=[Sd],Ud=t("tr",null,[t("td",{colspan:"3"},"Debug")],-1),Id=t("td",null,[t("code",null,"settings.status.enabled")],-1),Pd=["disabled"],Ad=t("i",{class:"fa fa-remove"},null,-1),Td=[Ad];function Dd(s,e,a,r,m,g){const u=w("navbar");return l(),i("div",Po,[t("div",Ao,[k(u),t("div",To,[t("button",{class:"button is-small is-primary mr-1",disabled:!s.changed,onClick:e[0]||(e[0]=(...n)=>s.sendSave&&s.sendSave(...n))}," Save ",8,Do),t("a",{class:"button is-small",href:s.widgetUrl,target:"_blank"},"Open widget",8,Mo)])],512),t("div",Eo,[s.settings?(l(),i("table",Fo,[t("tbody",null,[Lo,t("tr",null,[Ro,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[1]||(e[1]=n=>s.settings.styles.bgColor=n)},null,512),[[y,s.settings.styles.bgColor]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.bgColor===s.defaultSettings.styles.bgColor,onClick:e[2]||(e[2]=n=>s.settings.styles.bgColor=s.defaultSettings.styles.bgColor)},jo,8,Oo)])]),t("tr",null,[zo,t("td",null,[t("div",Jo,[h(t("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.settings.styles.vAlign=n)},Wo,512),[[tt,s.settings.styles.vAlign]])])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.vAlign===s.defaultSettings.styles.vAlign,onClick:e[4]||(e[4]=n=>s.settings.styles.vAlign=s.defaultSettings.styles.vAlign)},Go,8,Ho)])]),Yo,t("tr",null,[Xo,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[5]||(e[5]=n=>s.settings.recognition.lang=n)},null,512),[[y,s.settings.recognition.lang]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.lang===s.defaultSettings.recognition.lang,onClick:e[6]||(e[6]=n=>s.settings.recognition.lang=s.defaultSettings.recognition.lang)},xo,8,Qo)])]),t("tr",null,[ta,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=n=>s.settings.recognition.synthesize=n)},null,512),[[F,s.settings.recognition.synthesize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.synthesize===s.defaultSettings.recognition.synthesize,onClick:e[8]||(e[8]=n=>s.settings.translation.enabled=s.defaultSettings.translation.enabled)},na,8,sa)])]),t("tr",null,[la,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[9]||(e[9]=n=>s.settings.recognition.synthesizeLang=n)},null,512),[[y,s.settings.recognition.synthesizeLang]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.synthesizeLang===s.defaultSettings.recognition.synthesizeLang,onClick:e[10]||(e[10]=n=>s.settings.recognition.synthesizeLang=s.defaultSettings.recognition.synthesizeLang)},aa,8,ia)])]),t("tr",null,[da,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=n=>s.settings.recognition.display=n)},null,512),[[F,s.settings.recognition.display]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.display===s.defaultSettings.recognition.display,onClick:e[12]||(e[12]=n=>s.settings.recognition.display=s.defaultSettings.recognition.display)},ca,8,ra)])]),t("tr",null,[ha,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[13]||(e[13]=n=>s.settings.styles.recognition.color=n)},null,512),[[y,s.settings.styles.recognition.color]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.color===s.defaultSettings.styles.recognition.color,onClick:e[14]||(e[14]=n=>s.settings.styles.recognition.color=s.defaultSettings.styles.recognition.color)},ga,8,pa)])]),t("tr",null,[fa,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[15]||(e[15]=n=>s.settings.styles.recognition.strokeWidth=n)},null,512),[[y,s.settings.styles.recognition.strokeWidth]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.strokeWidth===s.defaultSettings.styles.recognition.strokeWidth,onClick:e[16]||(e[16]=n=>s.settings.styles.recognition.strokeWidth=s.defaultSettings.styles.recognition.strokeWidth)},_a,8,ya)])]),t("tr",null,[$a,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[17]||(e[17]=n=>s.settings.styles.recognition.strokeColor=n)},null,512),[[y,s.settings.styles.recognition.strokeColor]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.strokeColor===s.defaultSettings.styles.recognition.strokeColor,onClick:e[18]||(e[18]=n=>s.settings.styles.recognition.strokeColor=s.defaultSettings.styles.recognition.strokeColor)},ka,8,ba)])]),t("tr",null,[Ca,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[19]||(e[19]=n=>s.settings.styles.recognition.fontFamily=n)},null,512),[[y,s.settings.styles.recognition.fontFamily]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.fontFamily===s.defaultSettings.styles.recognition.fontFamily,onClick:e[20]||(e[20]=n=>s.settings.styles.recognition.fontFamily=s.defaultSettings.styles.recognition.fontFamily)},Ua,8,Sa)])]),t("tr",null,[Ia,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[21]||(e[21]=n=>s.settings.styles.recognition.fontSize=n)},null,512),[[y,s.settings.styles.recognition.fontSize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.fontSize===s.defaultSettings.styles.recognition.fontSize,onClick:e[22]||(e[22]=n=>s.settings.styles.recognition.fontSize=s.defaultSettings.styles.recognition.fontSize)},Ta,8,Pa)])]),t("tr",null,[Da,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[23]||(e[23]=n=>s.settings.styles.recognition.fontWeight=n)},null,512),[[y,s.settings.styles.recognition.fontWeight]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.fontWeight===s.defaultSettings.styles.recognition.fontWeight,onClick:e[24]||(e[24]=n=>s.settings.styles.weight=s.defaultSettings.styles.weight)},Fa,8,Ma)])]),La,t("tr",null,[Ra,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[25]||(e[25]=n=>s.settings.translation.enabled=n)},null,512),[[F,s.settings.translation.enabled]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.enabled===s.defaultSettings.translation.enabled,onClick:e[26]||(e[26]=n=>s.settings.translation.enabled=s.defaultSettings.translation.enabled)},ja,8,Oa)])]),t("tr",null,[za,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[27]||(e[27]=n=>s.settings.translation.synthesize=n)},null,512),[[F,s.settings.translation.synthesize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.synthesize===s.defaultSettings.translation.synthesize,onClick:e[28]||(e[28]=n=>s.settings.translation.synthesize=s.defaultSettings.translation.synthesize)},qa,8,Ja)])]),t("tr",null,[Wa,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[29]||(e[29]=n=>s.settings.translation.synthesizeLang=n)},null,512),[[y,s.settings.translation.synthesizeLang]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.synthesizeLang===s.defaultSettings.translation.synthesizeLang,onClick:e[30]||(e[30]=n=>s.settings.translation.synthesizeLang=s.defaultSettings.translation.synthesizeLang)},Ga,8,Ha)])]),t("tr",null,[Ya,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[31]||(e[31]=n=>s.settings.translation.langSrc=n)},null,512),[[y,s.settings.translation.langSrc]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.langSrc===s.defaultSettings.translation.langSrc,onClick:e[32]||(e[32]=n=>s.settings.translation.langSrc=s.defaultSettings.translation.langSrc)},Za,8,Xa)])]),t("tr",null,[xa,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[33]||(e[33]=n=>s.settings.translation.langDst=n)},null,512),[[y,s.settings.translation.langDst]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.langDst===s.defaultSettings.translation.langDst,onClick:e[34]||(e[34]=n=>s.settings.translation.langDst=s.defaultSettings.translation.langDst)},ed,8,td)])]),t("tr",null,[nd,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[35]||(e[35]=n=>s.settings.styles.translation.color=n)},null,512),[[y,s.settings.styles.translation.color]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.color===s.defaultSettings.styles.translation.color,onClick:e[36]||(e[36]=n=>s.settings.styles.translation.color=s.defaultSettings.styles.translation.color)},od,8,ld)])]),t("tr",null,[ad,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[37]||(e[37]=n=>s.settings.styles.translation.strokeWidth=n)},null,512),[[y,s.settings.styles.translation.strokeWidth]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.strokeWidth===s.defaultSettings.styles.translation.strokeWidth,onClick:e[38]||(e[38]=n=>s.settings.styles.translation.strokeWidth=s.defaultSettings.styles.translation.strokeWidth)},ud,8,dd)])]),t("tr",null,[cd,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[39]||(e[39]=n=>s.settings.styles.translation.strokeColor=n)},null,512),[[y,s.settings.styles.translation.strokeColor]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.strokeColor===s.defaultSettings.styles.translation.strokeColor,onClick:e[40]||(e[40]=n=>s.settings.styles.translation.strokeColor=s.defaultSettings.styles.translation.strokeColor)},md,8,hd)])]),t("tr",null,[gd,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[41]||(e[41]=n=>s.settings.styles.translation.fontFamily=n)},null,512),[[y,s.settings.styles.translation.fontFamily]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.fontFamily===s.defaultSettings.styles.translation.fontFamily,onClick:e[42]||(e[42]=n=>s.settings.styles.translation.fontFamily=s.defaultSettings.styles.translation.fontFamily)},vd,8,fd)])]),t("tr",null,[_d,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[43]||(e[43]=n=>s.settings.styles.translation.fontSize=n)},null,512),[[y,s.settings.styles.translation.fontSize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.fontSize===s.defaultSettings.styles.translation.fontSize,onClick:e[44]||(e[44]=n=>s.settings.styles.translation.fontSize=s.defaultSettings.styles.translation.fontSize)},wd,8,$d)])]),t("tr",null,[kd,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[45]||(e[45]=n=>s.settings.styles.translation.fontWeight=n)},null,512),[[y,s.settings.styles.translation.fontWeight]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.fontWeight===s.defaultSettings.styles.translation.fontWeight,onClick:e[46]||(e[46]=n=>s.settings.styles.weight=s.defaultSettings.styles.weight)},Vd,8,Cd)])]),Ud,t("tr",null,[Id,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[47]||(e[47]=n=>s.settings.status.enabled=n)},null,512),[[F,s.settings.status.enabled]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.status.enabled===s.defaultSettings.status.enabled,onClick:e[48]||(e[48]=n=>s.settings.status.enabled=s.defaultSettings.status.enabled)},Td,8,Pd)])])])],512)):p("",!0)],512)])}var Md=V(Io,[["render",Dd]]);const Ed=S({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const e=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const a=await fetch("/api/user/_reset_password",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({pass:this.pass,token:e})});if(a.status===200)this.success=!0;else try{this.error=(await a.json()).reason}catch{this.error="Unknown error"}}}}),Fd={class:"center-screen"},Ld=t("h1",{class:"title is-6"},"Hyottoko.club",-1),Rd={key:0,class:"field has-background-success-light has-text-success-dark"},Od=c(" Password successfully set. Click "),Nd=c("here"),jd=c(" to login. "),zd={key:1},Jd={key:0,class:"field has-background-danger-light has-text-danger-dark"},Bd={class:"field"},qd={class:"control has-icons-left"},Wd=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-lock"})],-1),Hd={class:"field"},Kd=["disabled"];function Gd(s,e,a,r,m,g){const u=w("router-link");return l(),i("div",Fd,[Ld,s.success?(l(),i("div",Rd,[Od,k(u,{to:{name:"login"}},{default:L(()=>[Nd]),_:1}),jd])):(l(),i("div",zd,[s.error?(l(),i("div",Jd,b(s.error),1)):p("",!0),t("div",Bd,[t("div",qd,[h(t("input",{class:"input is-small",type:"password",placeholder:"New Password","onUpdate:modelValue":e[0]||(e[0]=n=>s.pass=n),onKeyup:[e[1]||(e[1]=n=>s.error=""),e[2]||(e[2]=z((...n)=>s.submit&&s.submit(...n),["enter"]))]},null,544),[[y,s.pass]]),Wd])]),t("div",Hd,[t("button",{class:"button is-small is-primary",disabled:s.canSubmit?null:!0,onClick:e[3]||(e[3]=(...n)=>s.submit&&s.submit(...n))}," Save Password ",8,Kd)])]))])}var Yd=V(Ed,[["render",Gd]]);const Xd=S({data:()=>({email:"",error:"",success:!1}),methods:{async submit(){this.success=!1,this.error="";const s=await fetch("/api/user/_request_password_reset",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.email})});if(s.status===200)this.success=!0;else try{this.error=(await s.json()).reason}catch{this.error="Unknown error"}}}}),Qd={class:"center-screen"},Zd=t("h1",{class:"title is-6"},"Hyottoko.club",-1),xd={key:0,class:"field has-background-success-light has-text-success-dark"},tr=c(" Password-reset mail sent. Click "),sr=c("here"),er=c(" to login. "),nr={key:1},lr={key:0,class:"field has-background-danger-light has-text-danger-dark"},ir={class:"field"},or={class:"control has-icons-left"},ar=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-envelope"})],-1),dr={class:"field"};function rr(s,e,a,r,m,g){const u=w("router-link");return l(),i("div",Qd,[Zd,s.success?(l(),i("div",xd,[tr,k(u,{to:{name:"login"}},{default:L(()=>[sr]),_:1}),er])):(l(),i("form",nr,[s.error?(l(),i("div",lr,b(s.error),1)):p("",!0),t("div",ir,[t("div",or,[h(t("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":e[0]||(e[0]=n=>s.email=n),onKeyup:e[1]||(e[1]=n=>s.error="")},null,544),[[y,s.email]]),ar])]),t("div",dr,[t("span",{class:"button is-small is-primary",onClick:e[2]||(e[2]=(...n)=>s.submit&&s.submit(...n))},"Request Password Reset")])]))])}var ur=V(Xd,[["render",rr]]);const cr=S({name:"upload",props:{accept:String,label:String},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?`Uploading (${this.uploadPercent}%)`:this.label||"Upload File"},progressStyle(){if(!this.uploading)return{};const s=this.uploadPercent,e="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${e} 0%, ${e} ${s}%, transparent ${s}%)`}}},methods:{async upload(s){const e=s.target.files[0];if(!e)return;this.uploading=!0;const a=new FormData;a.append("file",e,e.name);const r=await et.post("/api/upload",{body:a,onUploadProgress:g=>{this.progress=g.loaded/g.total}});this.uploading=!1;const m=await r.json();this.$emit("uploaded",m)}}}),hr=s=>(W("data-v-dba32568"),s=s(),H(),s),pr={class:"upload"},mr=["disabled","accept"],gr={class:"button is-small"},fr=hr(()=>t("i",{class:"fa fa-upload mr-1"},null,-1));function yr(s,e,a,r,m,g){return l(),i("label",pr,[t("input",{type:"file",disabled:s.uploading,style:{display:"none"},onChange:e[0]||(e[0]=(...u)=>s.upload&&s.upload(...u)),accept:s.accept},null,40,mr),t("span",gr,[fr,c(" "+b(s.buttonText),1)]),t("span",{class:"progress",style:K(s.progressStyle)},null,4)])}var vr=V(cr,[["render",yr],["__scopeId","data-v-dba32568"]]);const _r=S({props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(s){try{const e=J.doDummyReplacements(s,"0");J.mustParseHumanDuration(e),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",s)}},modelValue:{handler(s){this.v=`${s}`}}}});function $r(s,e,a,r,m,g){return h((l(),i("input",{class:P(["input is-small spaceinput",s.classes]),"onUpdate:modelValue":e[0]||(e[0]=u=>s.v=u)},null,2)),[[y,s.v]])}var br=V(_r,[["render",$r]]);const wr=S({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const s=parseInt(`${this.baseVolume}`,10)/100,e=parseInt(`${this.volume}`,10)/100;this.audio.volume=s*e,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio("/uploads/"+this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function kr(s,e,a,r,m,g){return s.src?(l(),i("span",{key:0,class:"player",onClick:e[0]||(e[0]=(...u)=>s.toggle&&s.toggle(...u))},[c(b(s.name)+" ",1),t("i",{class:P(["fa ml-1",s.cls])},null,2)])):p("",!0)}var Cr=V(wr,[["render",kr]]);const Sr=S({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),Vr={class:"columns"},Ur={class:"column is-four-fifth"},Ir={class:"control has-icons-left has-icons-right range slider"},Pr=["min","max"],Ar={class:"icon is-small is-left"},Tr={class:"icon is-small is-right"},Dr={class:"column is-one-fifth"};function Mr(s,e,a,r,m,g){return l(),i("div",Vr,[t("div",Ur,[t("div",Ir,[h(t("input",{type:"range",class:"input is-small",min:s.min,max:s.max,"onUpdate:modelValue":[e[0]||(e[0]=u=>s.curVal=u),e[1]||(e[1]=(...u)=>s.valChange&&s.valChange(...u))]},null,8,Pr),[[y,s.curVal]]),t("span",Ar,[t("i",{class:P(["fa",s.iconLeft])},null,2)]),t("span",Tr,[t("i",{class:P(["fa",s.iconRight])},null,2)])])]),t("div",Dr,[h(t("input",{type:"number",class:"input is-small","onUpdate:modelValue":[e[2]||(e[2]=u=>s.curVal=u),e[3]||(e[3]=(...u)=>s.valChange&&s.valChange(...u))]},null,512),[[y,s.curVal]])])])}var Er=V(Sr,[["render",Mr],["__scopeId","data-v-0799d56c"]]);const Fr=S({name:"volume-slider",props:{modelValue:{required:!0}},data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",this.volume)}},created(){this.volume=parseInt(this.modelValue,10)}});function Lr(s,e,a,r,m,g){const u=w("slider");return l(),O(u,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:s.volume,"onUpdate:modelValue":[e[0]||(e[0]=n=>s.volume=n),s.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var Rr=V(Fr,[["render",Lr]]);const Or=S({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(/uploads/${encodeURIComponent(this.src)})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),Nr=["title"];function jr(s,e,a,r,m,g){return l(),i("div",{class:"responsive-image",style:K(s.style),title:s.title},null,12,Nr)}var zr=V(Or,[["render",jr]]),Jr="/assets/hyottoko.30d2bcb9.png";const Br=S({name:"navbar",computed:{user(){var s,e;return((e=(s=this.$me)==null?void 0:s.user)==null?void 0:e.name)||""}},data:()=>({linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"settings"},text:"Settings"}],burgerActive:!1}),methods:{toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){if((await(await fetch("/api/logout",{method:"POST"})).json()).success)this.$router.push({name:"login"});else throw new Error("[2021-09-25 18:36]")}}}),qr={class:"navbar",role:"navigation","aria-label":"main navigation"},Wr={class:"navbar-brand"},Hr=t("img",{src:Jr,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),Kr={class:"greeting"},Gr=t("span",{"aria-hidden":"true"},null,-1),Yr=t("span",{"aria-hidden":"true"},null,-1),Xr=t("span",{"aria-hidden":"true"},null,-1),Qr=[Gr,Yr,Xr],Zr={class:"navbar-start"},xr={class:"navbar-end"};function tu(s,e,a,r,m,g){const u=w("router-link");return l(),i("nav",qr,[t("div",Wr,[k(u,{class:"navbar-item",to:{name:"index"}},{default:L(()=>[Hr,t("span",Kr,"Welcome back, "+b(s.user),1)]),_:1}),t("a",{role:"button",class:P(["navbar-burger",{"is-active":s.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:e[0]||(e[0]=(...n)=>s.toggleBurgerMenu&&s.toggleBurgerMenu(...n))},Qr,2)]),t("div",{id:"navbarBasicExample",class:P(["navbar-menu",{"is-active":s.burgerActive}])},[t("div",Zr,[(l(!0),i(I,null,A(s.linksStart,(n,_)=>(l(),O(u,{class:"navbar-item",key:_,to:n.to},{default:L(()=>[c(b(n.text),1)]),_:2},1032,["to"]))),128))]),t("div",xr,[t("a",{class:"navbar-item",onClick:e[1]||(e[1]=(...n)=>s.onLogoutClick&&s.onLogoutClick(...n))},"Logout")])],2)])}var su=V(Br,[["render",tu]]);const eu=S({props:{value:{required:!0}},computed:{tag(){try{return J.mustParseHumanDuration(this.value),"span"}catch{return"code"}},humanReadable(){try{return J.humanDuration(J.mustParseHumanDuration(this.value))}catch{return this.value}}}}),nu={key:0},lu={key:1};function iu(s,e,a,r,m,g){return s.tag==="span"?(l(),i("span",nu,b(s.humanReadable),1)):(l(),i("code",lu,b(s.humanReadable),1))}var ou=V(eu,[["render",iu]]);const au=S({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(s){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time-=10,this.time<=0&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),du={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function ru(s,e,a,r,m,g){return l(),i("button",{class:"doubleclick-button",onClick:e[0]||(e[0]=(...u)=>s.onClick&&s.onClick(...u))},[ut(s.$slots,"default",{},void 0,!0),s.timer?(l(),i("span",du,[c(b(s.message)+" ",1),t("span",{class:"doubleclick-button-timout-indicator",style:K(s.indicatorStyle)},null,4)])):p("",!0)])}var uu=V(au,[["render",ru],["__scopeId","data-v-72e9e0bd"]]);const q=(...s)=>console.log("[youtube.js]",...s);let rt=!1;function cu(){return rt?(q("ytapi ALREADY ready"),Promise.resolve()):new Promise(s=>{const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api",document.head.append(e),window.onYouTubeIframeAPIReady=()=>{rt=!0,q("ytapi ready"),s()}})}function hu(s){return new Promise(e=>{q("create player on "+s);const a=new YT.Player(s,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{q("player ready"),e(a)}}})})}async function pu(s){return await cu(),await hu(s)}const mu=S({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const s=this.getDuration(),e=this.getCurrentTime();return s?e/s:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let s=20;this.tryPlayInterval=setInterval(()=>{if(q("playing",this.playing(),"triesRemaining",s),--s,this.playing()||s<0){q("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(s){this.yt?(this.yt.cueVideoById(s),this.tryPlay()):this.toplay=s},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(s){this.yt?this.yt.setVolume(s):this.tovolume=s},setLoop(s){this.loop=s},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await pu(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(q("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",s=>{s.data===YT.PlayerState.CUED?this.tryPlay():s.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),gu=["id"];function fu(s,e,a,r,m,g){return l(),i("div",{id:s.id},null,8,gu)}var yu=V(mu,[["render",fu]]);const vu=S({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},baseVolume:{default:100}},emits:["update:modelValue","cancel"],data:()=>({item:null,newtrigger:"command",variableChangeFocusIdx:-1,dictLangs:[{value:"ja",flag:"\u{1F1EF}\u{1F1F5}",title:"Japanese"},{value:"ru",flag:"\u{1F1F7}\u{1F1FA}",title:"Russian"},{value:"de",flag:"\u{1F1E9}\u{1F1EA}",title:"German"},{value:"es",flag:"\u{1F1EA}\u{1F1F8}",title:"Spanish"},{value:"fr",flag:"\u{1F1EB}\u{1F1F7}",title:"French"},{value:"it",flag:"\u{1F1EE}\u{1F1F9}",title:"Italian"}]}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(s){this.item=JSON.parse(JSON.stringify(s))}}},methods:{addtxt(){this.item.data.text.push(G.newText())},addtrigger(){this.item.triggers.push(G.newTrigger(this.newtrigger))},onAddVariableChange(){this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(s){this.item.variableChanges=this.item.variableChanges.filter((e,a)=>a!==s)},onAddVariable(){this.item.variables.push({name:"",value:""})},rmVariable(s){this.item.variables=this.item.variables.filter((e,a)=>a!==s)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndUploaded(s){this.item.data.sound.filename=s.originalname,this.item.data.sound.file=s.filename},mediaImgUploaded(s){this.item.data.image.filename=s.originalname,this.item.data.image.file=s.filename},rmtxt(s){this.item.data.text=this.item.data.text.filter((e,a)=>a!==s)},rmtrigger(s){this.item.triggers=this.item.triggers.filter((e,a)=>a!==s)},autocompletableVariables(s){const e=this.item.variables.slice().map(a=>({var:a,type:"local"}));return this.globalVariables.forEach(a=>{e.find(r=>r.var.name===a.name)||e.push({var:a,type:"global"})}),e.filter(a=>a.var.name.startsWith(s)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{valid(){for(const s of this.item.triggers)if(s.type==="command"){if(!s.data.command)return!1}else if(s.type==="timer"){try{J.mustParseHumanDuration(s.data.minInterval)}catch{return!1}const e=parseInt(s.data.minLines,10);if(isNaN(e))return!1}if(this.item.action==="text"){for(const s of this.item.data.text)if(s==="")return!1}return!0},title(){const s={create:"Create new ",edit:"Edit "},e={dict_lookup:"dictionary lookup",madochan_createword:"madochan",chatters:"chatters command",media:"media command",countdown:"countdown",text:"command"};return`${s[this.mode]}${e[this.item.action]}`}}}),$=s=>(W("data-v-256b355f"),s=s(),H(),s),_u={key:0,class:"modal is-active"},$u={class:"modal-card"},bu={class:"modal-card-head"},wu={class:"modal-card-title"},ku={class:"modal-card-body"},Cu={class:"table is-striped"},Su=$(()=>t("td",null,"Triggers:",-1)),Vu={key:0,class:"field has-addons"},Uu={class:"control has-icons-left"},Iu=["onUpdate:modelValue"],Pu=$(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-comments-o"})],-1)),Au={class:"control"},Tu=["disabled","onClick"],Du=$(()=>t("i",{class:"fa fa-remove"},null,-1)),Mu=[Du],Eu={key:1,class:"field has-addons"},Fu={class:"control has-icons-left"},Lu=["onUpdate:modelValue"],Ru=$(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-bullseye"})],-1)),Ou={class:"control"},Nu=["disabled","onClick"],ju=$(()=>t("i",{class:"fa fa-remove"},null,-1)),zu=[ju],Ju={key:2,class:"timer-trigger"},Bu={class:"control"},qu=["disabled","onClick"],Wu=$(()=>t("i",{class:"fa fa-remove"},null,-1)),Hu=[Wu],Ku={class:"columns"},Gu=$(()=>t("div",{class:"column is-one-third"},[t("label",null,"Min. Lines")],-1)),Yu={class:"column is-two-third"},Xu={class:"control has-icons-left"},Qu=["onUpdate:modelValue"],Zu=$(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-comments-o"})],-1)),xu={class:"columns"},tc=$(()=>t("div",{class:"column is-one-third"},[t("label",null,"Min. Interval")],-1)),sc={class:"column is-two-third"},ec={class:"control has-icons-left has-icons-right"},nc=$(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1)),lc=$(()=>t("p",{class:"help"}," Command will be triggered when at least min. lines chat messages arrived AND time interval have passed. ",-1)),ic={class:"field has-addons mr-1"},oc={class:"control has-icons-left"},ac={key:0,class:"select is-small"},dc=$(()=>t("option",{value:"command"},"Command",-1)),rc=$(()=>t("option",{value:"reward_redemption"}," Reward Redemption ",-1)),uc=$(()=>t("option",{value:"timer"},"Timer",-1)),cc=[dc,rc,uc],hc=$(()=>t("i",{class:"fa fa-plus mr-1"},null,-1)),pc=c(" Add "),mc=[hc,pc],gc={key:0},fc=$(()=>t("td",null,"Language:",-1)),yc=["onClick","title"],vc=$(()=>t("code",null,"$args(0)",-1)),_c=[vc],$c={key:1},bc=$(()=>t("td",null,"Phrase:",-1)),wc=$(()=>t("code",null,"$args(1:)",-1)),kc=[wc],Cc={key:2},Sc=$(()=>t("td",null,"Response:",-1)),Vc=$(()=>t("td",null,[t("div",{class:"help"},[c(" Outputs the translation for the input phrase. The translation is always from/to english. "),t("br"),c(" To let the user decide on the language use "),t("code",null,"$args(0)"),c(" as language, and "),t("code",null,"$args(1:)"),c(" as phrase. "),t("br"),c(" If phrase is left empty, all arguments to the command will be used as the phrase. ")])],-1)),Uc=[Sc,Vc],Ic={key:3},Pc=$(()=>t("td",null,"Response:",-1)),Ac=$(()=>t("td",null,"Creates a word for a definition.",-1)),Tc=[Pc,Ac],Dc={key:4},Mc=$(()=>t("td",null,"Model:",-1)),Ec={class:"control"},Fc=$(()=>t("div",{class:"help"},[c(" For possible values refer to "),t("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),Lc={key:5},Rc=$(()=>t("td",null,"Weirdness:",-1)),Oc={class:"control"},Nc=$(()=>t("div",{class:"help"},[c(" For possible values refer to "),t("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),jc={key:6},zc=$(()=>t("td",null,"Response:",-1)),Jc=$(()=>t("td",null,"Outputs the people who chatted during the stream.",-1)),Bc=[zc,Jc],qc={key:7},Wc=$(()=>t("td",null,"Response:",-1)),Hc=["onUpdate:modelValue"],Kc=["disabled","onClick"],Gc=$(()=>t("i",{class:"fa fa-remove"},null,-1)),Yc=[Gc],Xc={class:"field"},Qc=$(()=>t("i",{class:"fa fa-plus mr-1"},null,-1)),Zc=c(" Add response "),xc=[Qc,Zc],th=$(()=>t("div",null,[t("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),sh={key:8},eh=$(()=>t("td",null,"Image:",-1)),nh=$(()=>t("i",{class:"fa fa-remove mr-1"},null,-1)),lh=c(" Remove "),ih=[nh,lh],oh={key:2},ah={key:9},dh=$(()=>t("td",null,"Sound:",-1)),rh=$(()=>t("i",{class:"fa fa-remove mr-1"},null,-1)),uh=c(" Remove "),ch=[rh,uh],hh={key:3},ph={key:10},mh=$(()=>t("td",null,"Duration:",-1)),gh={class:"control has-icons-left"},fh=$(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1)),yh={key:11},vh=$(()=>t("td",null,"Settings",-1)),_h=$(()=>t("td",null,"Variables:",-1)),$h={key:0},bh=$(()=>t("thead",null,[t("tr",null,[t("td",null,"Name"),t("td",null,"Value")])],-1)),wh=["onUpdate:modelValue"],kh=["onUpdate:modelValue"],Ch=["onClick"],Sh=$(()=>t("i",{class:"fa fa-remove"},null,-1)),Vh=[Sh],Uh=$(()=>t("div",{class:"help"},[c(" Variables can be used from the command with "),t("code",null,"$var(variable_name)"),c(". If the referenced variable is not defined here, "),t("a",{href:"/variables/",target:"_blank"},"global variables"),c(" are used. ")],-1)),Ih=$(()=>t("td",null,"Variable changes:",-1)),Ph={key:0},Ah=$(()=>t("thead",null,[t("tr",null,[t("td",null,"Name"),t("td",null,"Change"),t("td",null,"Value"),t("td")])],-1)),Th={class:"dropdown is-active is-up"},Dh={class:"dropdown-trigger"},Mh=["onUpdate:modelValue","onFocus"],Eh={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},Fh={class:"dropdown-content"},Lh=["onClick"],Rh=c(") "),Oh={class:"select is-small"},Nh=["onUpdate:modelValue"],jh=$(()=>t("option",{value:"set"},"set",-1)),zh=$(()=>t("option",{value:"increase_by"},"increase by",-1)),Jh=$(()=>t("option",{value:"decrease_by"},"decrease by",-1)),Bh=[jh,zh,Jh],qh=["onUpdate:modelValue"],Wh=["onClick"],Hh=$(()=>t("i",{class:"fa fa-remove"},null,-1)),Kh=[Hh],Gh=$(()=>t("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),Yh=$(()=>t("td",null,"Permissions:",-1)),Xh=c(" Broadcaster "),Qh=c(" Moderators "),Zh=c(" Subscribers "),xh={class:"modal-card-foot"},tp=["disabled"];function sp(s,e,a,r,m,g){const u=w("duration-input"),n=w("responsive-image"),_=w("upload"),f=w("player"),v=w("volume-slider"),U=w("countdown-edit");return s.item?(l(),i("div",_u,[t("div",{class:"modal-background",onClick:e[0]||(e[0]=(...o)=>s.onOverlayClick&&s.onOverlayClick(...o))}),t("div",$u,[t("header",bu,[t("p",wu,b(s.title),1),t("button",{class:"delete","aria-label":"close",onClick:e[1]||(e[1]=(...o)=>s.onCloseClick&&s.onCloseClick(...o))})]),t("section",ku,[t("table",Cu,[t("tbody",null,[t("tr",null,[Su,t("td",null,[(l(!0),i(I,null,A(s.item.triggers,(o,C)=>(l(),i("div",{key:C,class:"spacerow"},[s.item.triggers[C].type==="command"?(l(),i("div",Vu,[t("div",Uu,[h(t("input",{class:P(["input is-small",{"has-background-danger-light":!s.item.triggers[C].data.command,"has-text-danger-dark":!s.item.triggers[C].data.command}]),type:"text","onUpdate:modelValue":d=>s.item.triggers[C].data.command=d},null,10,Iu),[[y,s.item.triggers[C].data.command]]),Pu]),t("div",Au,[t("button",{class:"button is-small",disabled:s.item.triggers.length<=1,onClick:d=>s.rmtrigger(C)},Mu,8,Tu)])])):p("",!0),s.item.triggers[C].type==="reward_redemption"?(l(),i("div",Eu,[t("div",Fu,[h(t("input",{class:P(["input is-small",{"has-background-danger-light":!s.item.triggers[C].data.command,"has-text-danger-dark":!s.item.triggers[C].data.command}]),type:"text","onUpdate:modelValue":d=>s.item.triggers[C].data.command=d},null,10,Lu),[[y,s.item.triggers[C].data.command]]),Ru]),t("div",Ou,[t("button",{class:"button is-small",disabled:s.item.triggers.length<=1,onClick:d=>s.rmtrigger(C)},zu,8,Nu)])])):p("",!0),s.item.triggers[C].type==="timer"?(l(),i("div",Ju,[t("div",Bu,[t("button",{class:"button is-small",disabled:s.item.triggers.length<=1,onClick:d=>s.rmtrigger(C)},Hu,8,qu)]),t("div",Ku,[Gu,t("div",Yu,[t("div",Xu,[h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":d=>s.item.triggers[C].data.minLines=d},null,8,Qu),[[y,s.item.triggers[C].data.minLines]]),Zu])])]),t("div",xu,[tc,t("div",sc,[t("div",ec,[k(u,{modelValue:s.item.triggers[C].data.minInterval,"onUpdate:modelValue":d=>s.item.triggers[C].data.minInterval=d},null,8,["modelValue","onUpdate:modelValue"]),nc])])]),lc])):p("",!0)]))),128)),t("div",ic,[t("div",oc,[s.item.action!=="dict_lookup"?(l(),i("div",ac,[h(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.newtrigger=o)},cc,512),[[tt,s.newtrigger]])])):p("",!0)]),t("button",{class:"button is-small",onClick:e[3]||(e[3]=o=>s.addtrigger())},mc)])])]),s.item.action==="dict_lookup"?(l(),i("tr",gc,[fc,t("td",null,[h(t("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":e[4]||(e[4]=o=>s.item.data.lang=o)},null,512),[[y,s.item.data.lang]]),(l(!0),i(I,null,A(s.dictLangs,(o,C)=>(l(),i("span",{key:C,class:"button is-small mr-1",onClick:d=>s.item.data.lang=o.value,title:o.title},b(o.flag),9,yc))),128)),t("span",{class:"button is-small mr-1",onClick:e[5]||(e[5]=o=>s.item.data.lang="$args(0)")},_c)])])):p("",!0),s.item.action==="dict_lookup"?(l(),i("tr",$c,[bc,t("td",null,[h(t("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":e[6]||(e[6]=o=>s.item.data.phrase=o)},null,512),[[y,s.item.data.phrase]]),t("span",{class:"button is-small mr-1",onClick:e[7]||(e[7]=o=>s.item.data.phrase="")},"All args"),t("span",{class:"button is-small mr-1",onClick:e[8]||(e[8]=o=>s.item.data.phrase="$args(1:)")},kc)])])):p("",!0),s.item.action==="dict_lookup"?(l(),i("tr",Cc,Uc)):p("",!0),s.item.action==="madochan_createword"?(l(),i("tr",Ic,Tc)):p("",!0),s.item.action==="madochan_createword"?(l(),i("tr",Dc,[Mc,t("td",null,[t("div",Ec,[h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[9]||(e[9]=o=>s.item.data.model=o)},null,512),[[y,s.item.data.model]])]),Fc])])):p("",!0),s.item.action==="madochan_createword"?(l(),i("tr",Lc,[Rc,t("td",null,[t("div",Oc,[h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[10]||(e[10]=o=>s.item.data.weirdness=o)},null,512),[[y,s.item.data.weirdness]])]),Nc])])):p("",!0),s.item.action==="chatters"?(l(),i("tr",jc,Bc)):p("",!0),s.item.action==="text"?(l(),i("tr",qc,[Wc,t("td",null,[(l(!0),i(I,null,A(s.item.data.text,(o,C)=>(l(),i("div",{key:C,class:"field textarea-holder"},[h(t("textarea",{class:P(["textarea",{"has-background-danger-light":!s.item.data.text[C],"has-text-danger-dark":!s.item.data.text[C]}]),type:"text","onUpdate:modelValue":d=>s.item.data.text[C]=d},null,10,Hc),[[y,s.item.data.text[C]]]),t("button",{class:"button is-small",disabled:s.item.data.text.length<=1,onClick:d=>s.rmtxt(C)},Yc,8,Kc)]))),128)),t("div",Xc,[t("button",{class:"button is-small",onClick:e[11]||(e[11]=(...o)=>s.addtxt&&s.addtxt(...o))},xc)]),th])])):p("",!0),s.item.action==="media"?(l(),i("tr",sh,[eh,t("td",null,[s.item.data.image.file?(l(),O(n,{key:0,src:s.item.data.image.file,title:s.item.data.image.filename,width:"100%",height:"90",style:{display:"block"}},null,8,["src","title"])):p("",!0),s.item.data.image.file?(l(),i("button",{key:1,class:"button is-small",onClick:e[12]||(e[12]=o=>s.item.data.image.file=null)},ih)):p("",!0),s.item.data.image.file?(l(),i("br",oh)):p("",!0),k(_,{onUploaded:s.mediaImgUploaded,accept:"image/*",label:"Upload Image",class:P({"mt-1":s.item.data.image.file})},null,8,["onUploaded","class"])])])):p("",!0),s.item.action==="media"?(l(),i("tr",ah,[dh,t("td",null,[s.item.data.sound.file?(l(),O(f,{key:0,src:s.item.data.sound.file,name:s.item.data.sound.filename,volume:s.item.data.sound.volume,baseVolume:s.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):p("",!0),s.item.data.sound.file?(l(),O(v,{key:1,modelValue:s.item.data.sound.volume,"onUpdate:modelValue":e[13]||(e[13]=o=>s.item.data.sound.volume=o)},null,8,["modelValue"])):p("",!0),s.item.data.sound.file?(l(),i("button",{key:2,class:"button is-small",onClick:e[14]||(e[14]=o=>s.item.data.sound.file=null)},ch)):p("",!0),s.item.data.sound.file?(l(),i("br",hh)):p("",!0),k(_,{onUploaded:s.mediaSndUploaded,accept:"audio/*",label:"Upload Sound",class:P({"mt-1":s.item.data.sound.file})},null,8,["onUploaded","class"])])])):p("",!0),s.item.action==="media"?(l(),i("tr",ph,[mh,t("td",null,[t("div",gh,[k(u,{modelValue:s.item.data.minDurationMs,"onUpdate:modelValue":e[15]||(e[15]=o=>s.item.data.minDurationMs=o)},null,8,["modelValue"]),fh])])])):p("",!0),s.item.action==="countdown"?(l(),i("tr",yh,[vh,t("td",null,[k(U,{modelValue:s.item.data,"onUpdate:modelValue":e[16]||(e[16]=o=>s.item.data=o),baseVolume:s.baseVolume},null,8,["modelValue","baseVolume"])])])):p("",!0),t("tr",null,[_h,t("td",null,[s.item.variables.length>0?(l(),i("table",$h,[bh,t("tbody",null,[(l(!0),i(I,null,A(s.item.variables,(o,C)=>(l(),i("tr",{key:C},[t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>o.name=d},null,8,wh),[[y,o.name]])]),t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>o.value=d},null,8,kh),[[y,o.value]])]),t("td",null,[t("button",{class:"button is-small",onClick:d=>s.rmVariable(C)},Vh,8,Ch)])]))),128))])])):p("",!0),t("span",{class:"button is-small",onClick:e[17]||(e[17]=(...o)=>s.onAddVariable&&s.onAddVariable(...o))},"Add Variable"),Uh])]),t("tr",null,[Ih,t("td",null,[s.item.variableChanges.length>0?(l(),i("table",Ph,[Ah,t("tbody",null,[(l(!0),i(I,null,A(s.item.variableChanges,(o,C)=>(l(),i("tr",{key:C},[t("td",null,[t("div",Th,[t("div",Dh,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>o.name=d,onFocus:d=>s.variableChangeFocusIdx=C,onBlur:e[18]||(e[18]=(...d)=>s.onVarChangeInputBlur&&s.onVarChangeInputBlur(...d))},null,40,Mh),[[y,o.name]])]),s.variableChangeFocusIdx===C?(l(),i("div",Eh,[t("div",Fh,[(l(!0),i(I,null,A(s.autocompletableVariables(o.name),(d,j)=>(l(),i("a",{class:"dropdown-item",key:j,onClick:D=>o.name=d.var.name},[c(b(d.var.name)+" ("+b(d.type)+", ",1),t("code",null,b(d.var.value),1),Rh],8,Lh))),128))])])):p("",!0)])]),t("td",null,[t("div",Oh,[h(t("select",{"onUpdate:modelValue":d=>o.change=d},Bh,8,Nh),[[tt,o.change]])])]),t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>o.value=d},null,8,qh),[[y,o.value]])]),t("td",null,[t("button",{class:"button is-small",onClick:d=>s.rmVariableChange(C)},Kh,8,Wh)])]))),128))])])):p("",!0),t("span",{class:"button is-small",onClick:e[19]||(e[19]=(...o)=>s.onAddVariableChange&&s.onAddVariableChange(...o))},"Add Variable Change"),Gh])]),t("tr",null,[Yh,t("td",null,[t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[20]||(e[20]=o=>s.item.restrict_to=o),value:"broadcaster"},null,512),[[F,s.item.restrict_to]]),Xh]),t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[21]||(e[21]=o=>s.item.restrict_to=o),value:"mod"},null,512),[[F,s.item.restrict_to]]),Qh]),t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[22]||(e[22]=o=>s.item.restrict_to=o),value:"sub"},null,512),[[F,s.item.restrict_to]]),Zh])])])])])]),t("footer",xh,[t("button",{class:"button is-small is-primary",disabled:!s.valid,onClick:e[23]||(e[23]=(...o)=>s.onSaveClick&&s.onSaveClick(...o))}," Save changes ",8,tp),t("button",{class:"button is-small",onClick:e[24]||(e[24]=(...o)=>s.onCancelClick&&s.onCancelClick(...o))},"Cancel")])])])):p("",!0)}var ep=V(vu,[["render",sp],["__scopeId","data-v-256b355f"]]);const np=S({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(s){this.countdown.actions=J.arrayMove(this.countdown.actions,s.oldIndex,s.newIndex)},onAddDelay(){this.countdown.actions.push({type:"delay",value:"1s"})},onAddText(){this.countdown.actions.push({type:"text",value:G.newText()})},onAddMedia(){this.countdown.actions.push({type:"media",value:G.newMedia()})},rmaction(s){this.countdown.actions=this.countdown.actions.filter((e,a)=>a!==s)},mediaSndUploaded(s,e){this.countdown.actions[s].value.sound.filename=e.originalname,this.countdown.actions[s].value.sound.file=e.filename},mediaImgUploaded(s,e){this.countdown.actions[s].value.image.filename=e.originalname,this.countdown.actions[s].value.image.file=e.filename}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),lp={class:"control"},ip={class:"radio"},op=c(" Manual "),ap={class:"radio"},dp=c(" Auto "),rp={key:0},up={class:"spacerow"},cp=t("label",{class:"spacelabel"},"Steps ",-1),hp={class:"spacerow"},pp=t("label",{class:"spacelabel"},"Interval ",-1),mp={class:"spacerow"},gp=t("label",{class:"spacelabel"},"Intro ",-1),fp={class:"spacerow"},yp=t("label",{class:"spacelabel"},"Outro ",-1),vp={key:1},_p={class:"field has-addons mr-1"},$p=t("span",{class:"handle p-2"},[t("i",{class:"fa fa-arrows"})],-1),bp={key:0,class:"control has-icons-left"},wp=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1),kp={key:1,class:"control has-icons-left"},Cp=["onUpdate:modelValue"],Sp=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-comments-o"})],-1),Vp={key:2,class:"control has-icons-left"},Up=t("td",null,"Image:",-1),Ip=["onClick"],Pp=t("i",{class:"fa fa-remove mr-1"},null,-1),Ap=c(" Remove "),Tp=[Pp,Ap],Dp={key:2},Mp=t("td",null,"Sound:",-1),Ep=["onClick"],Fp=t("i",{class:"fa fa-remove mr-1"},null,-1),Lp=c(" Remove "),Rp=[Fp,Lp],Op={key:3},Np=t("td",null,"Duration:",-1),jp={class:"control has-icons-left"},zp=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1),Jp={class:"control"},Bp=["onClick"],qp=t("i",{class:"fa fa-remove"},null,-1),Wp=[qp],Hp=t("i",{class:"fa fa-hourglass mr-1"},null,-1),Kp=c(" Add Delay "),Gp=[Hp,Kp],Yp=t("i",{class:"fa fa-comments-o mr-1"},null,-1),Xp=c(" Add Chat "),Qp=[Yp,Xp],Zp=t("i",{class:"fa fa-picture-o mr-1"},null,-1),xp=c(" Add Media "),tm=[Zp,xp];function sm(s,e,a,r,m,g){const u=w("duration-input"),n=w("responsive-image"),_=w("upload"),f=w("player"),v=w("volume-slider"),U=w("draggable");return l(),i("div",null,[t("div",lp,[t("label",ip,[h(t("input",{type:"radio",value:"manual","onUpdate:modelValue":e[0]||(e[0]=o=>s.countdown.type=o)},null,512),[[lt,s.countdown.type]]),op]),t("label",ap,[h(t("input",{type:"radio",value:"auto","onUpdate:modelValue":e[1]||(e[1]=o=>s.countdown.type=o)},null,512),[[lt,s.countdown.type]]),dp])]),s.countdown.type==="auto"?(l(),i("div",rp,[t("div",up,[cp,h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[2]||(e[2]=o=>s.countdown.steps=o)},null,512),[[y,s.countdown.steps]])]),t("div",hp,[pp,k(u,{modelValue:s.countdown.interval,"onUpdate:modelValue":e[3]||(e[3]=o=>s.countdown.interval=o)},null,8,["modelValue"])]),t("div",mp,[gp,h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[4]||(e[4]=o=>s.countdown.intro=o)},null,512),[[y,s.countdown.intro]])]),t("div",fp,[yp,h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[5]||(e[5]=o=>s.countdown.outro=o)},null,512),[[y,s.countdown.outro]])])])):(l(),i("div",vp,[k(U,{modelValue:s.countdown.actions,onEnd:s.dragEnd,handle:".handle","item-key":"id"},{item:L(({element:o,index:C})=>[t("div",_p,[$p,o.type==="delay"?(l(),i("div",bp,[k(u,{modelValue:o.value,"onUpdate:modelValue":d=>o.value=d},null,8,["modelValue","onUpdate:modelValue"]),wp])):o.type==="text"?(l(),i("div",kp,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":d=>o.value=d},null,8,Cp),[[y,o.value]]),Sp])):o.type==="media"?(l(),i("div",Vp,[t("table",null,[t("tr",null,[Up,t("td",null,[o.value.image.file?(l(),O(n,{key:0,src:o.value.image.file,title:o.value.image.filename,width:"100%",height:"90",style:{display:"block"}},null,8,["src","title"])):p("",!0),o.value.image.file?(l(),i("button",{key:1,class:"button is-small",onClick:d=>o.value.image.file=null},Tp,8,Ip)):p("",!0),o.value.image.file?(l(),i("br",Dp)):p("",!0),k(_,{onUploaded:d=>s.mediaImgUploaded(C,d),accept:"image/*",label:"Upload Image",class:P({"mt-1":o.value.image.file})},null,8,["onUploaded","class"])])]),t("tr",null,[Mp,t("td",null,[o.value.sound.file?(l(),O(f,{key:0,src:o.value.sound.file,name:o.value.sound.filename,volume:o.value.sound.volume,baseVolume:s.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):p("",!0),o.value.sound.file?(l(),O(v,{key:1,modelValue:o.value.sound.volume,"onUpdate:modelValue":d=>o.value.sound.volume=d},null,8,["modelValue","onUpdate:modelValue"])):p("",!0),o.value.sound.file?(l(),i("button",{key:2,class:"button is-small",onClick:d=>o.value.sound.file=null},Rp,8,Ep)):p("",!0),o.value.sound.file?(l(),i("br",Op)):p("",!0),k(_,{onUploaded:d=>s.mediaSndUploaded(C,d),accept:"audio/*",label:"Upload Sound",class:P({"mt-1":o.value.sound.file})},null,8,["onUploaded","class"])])]),t("tr",null,[Np,t("td",null,[t("div",jp,[k(u,{modelValue:o.value.minDurationMs,"onUpdate:modelValue":d=>o.value.minDurationMs=d},null,8,["modelValue","onUpdate:modelValue"]),zp])])])])])):p("",!0),t("div",Jp,[t("button",{class:"button is-small",onClick:d=>s.rmaction(C)},Wp,8,Bp)])])]),_:1},8,["modelValue","onEnd"]),t("button",{class:"button is-small",onClick:e[6]||(e[6]=(...o)=>s.onAddDelay&&s.onAddDelay(...o))},Gp),t("button",{class:"button is-small",onClick:e[7]||(e[7]=(...o)=>s.onAddText&&s.onAddText(...o))},Qp),t("button",{class:"button is-small",onClick:e[8]||(e[8]=(...o)=>s.onAddMedia&&s.onAddMedia(...o))},tm)]))])}var em=V(np,[["render",sm]]);const nm=S({setup(){}}),lm={class:"table is-striped"},im=t("thead",null,[t("tr",null,[t("th",null,"Chat command"),t("th",null,"Viewer"),t("th",null,"Mod"),t("th",null,"Explanation")])],-1),om=t("tbody",null,[t("tr",null,[t("td",null,[t("code",null,"!sr <SEARCH>")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[c(" Search for "),t("code",null,"<SEARCH>"),c(" at youtube (by id or by title) and queue the first result in the playlist (after the first found batch of unplayed songs)."),t("br"),c(" This only executes if "),t("code",null,"<SEARCH>"),c(" does not match one of the commands below. ")])]),t("tr",null,[t("td",null,[t("code",null,"!sr undo")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Remove the song that was last added by oneself.")]),t("tr",null,[t("td",null,[t("code",null,"!sr current")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Show what song is currently playing")]),t("tr",null,[t("td",null,[t("code",null,"!sr good")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Vote the current song up")]),t("tr",null,[t("td",null,[t("code",null,"!sr bad")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Vote the current song down")]),t("tr",null,[t("td",null,[t("code",null,"!sr stats")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Show stats about the playlist")]),t("tr",null,[t("td",null,[t("code",null,"!sr stat")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Alias for stats")]),t("tr",null,[t("td",null,[t("code",null,"!sr rm")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Remove the current song from the playlist")]),t("tr",null,[t("td",null,[t("code",null,"!sr next")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Skip to the next song")]),t("tr",null,[t("td",null,[t("code",null,"!sr prev")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Skip to the previous song")]),t("tr",null,[t("td",null,[t("code",null,"!sr skip")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Alias for next")]),t("tr",null,[t("td",null,[t("code",null,"!sr jumptonew")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Jump to the next unplayed song")]),t("tr",null,[t("td",null,[t("code",null,"!sr shuffle")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[c(" Shuffle the playlist (current song unaffected). "),t("br"),c(" Non-played and played songs will be shuffled separately and non-played songs will be put after currently playing song. ")])]),t("tr",null,[t("td",null,[t("code",null,"!sr resetStats")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Reset all statistics of all songs")]),t("tr",null,[t("td",null,[t("code",null,"!sr clear")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Clear the playlist")]),t("tr",null,[t("td",null,[t("code",null,"!sr pause")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Pause currently playing song")]),t("tr",null,[t("td",null,[t("code",null,"!sr unpause")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Unpause currently paused song")]),t("tr",null,[t("td",null,[t("code",null,"!sr loop")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Loop the current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr noloop")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Stop looping the current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr unloop")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Alias for noloop")]),t("tr",null,[t("td",null,[t("code",null,"!sr hidevideo")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Hide video for current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr showvideo")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Show video for current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr tag <TAG>")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[c("Add tag "),t("code",null,"<TAG>"),c(" to the current song")])]),t("tr",null,[t("td",null,[t("code",null,"!sr rmtag <TAG>")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[c("Remove tag "),t("code",null,"<TAG>"),c(" from the current song")])]),t("tr",null,[t("td",null,[t("code",null,"!sr filter [<TAG>]")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[c(" Play only songs with the given tag "),t("code",null,"<TAG>"),c(". If no tag is given, play all songs. ")])])],-1),am=[im,om];function dm(s,e,a,r,m,g){return l(),i("table",lm,am)}var rm=V(nm,[["render",dm]]);const um=S({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1}),methods:{toggleVisibility(s,e){s.hidevideo?this.sendCtrl("videoVisibility",[!0,e]):this.sendCtrl("videoVisibility",[!1,e])},dragEnd(s){this.sendCtrl("move",[s.oldIndex,s.newIndex])},applyFilter(s){this.$emit("filterChange",s)},sendCtrl(s,e){this.$emit("ctrl",[s,e])},isFilteredOut(s){return this.filter.tag!==""&&!s.tags.includes(this.filter.tag)},startAddTag(s){this.tagInputIdx=s,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(s=>(s.filteredOut=this.isFilteredOut(s),s))},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(s=>s.tags.includes(this.filter.tag))}},watch:{playlist:function(s,e){s.find(a=>!this.isFilteredOut(a))||this.$emit("stopPlayer")},filter:function(s,e){this.playlist.find(a=>!this.isFilteredOut(a))||this.$emit("stopPlayer")}}}),N=s=>(W("data-v-c0843896"),s=s(),H(),s),cm={class:"filters"},hm={class:"currentfilter"},pm=N(()=>t("div",{class:"mr-1"},"Filter:",-1)),mm=N(()=>t("i",{class:"fa fa-remove ml-1"},null,-1)),gm={key:1,class:"field has-addons mr-1 mb-0"},fm={class:"control"},ym={class:"control"},vm={class:"pt-1"},_m=c(" Hide filtered out"),$m={key:0,class:"table is-striped"},bm=N(()=>t("thead",null,[t("tr",null,[t("th"),t("th"),t("th"),t("th",null,"Title"),t("th",null,"User"),t("th",null,"Plays"),t("th"),t("th"),t("th"),t("th")])],-1)),wm=N(()=>t("td",{class:"pt-4 handle"},[t("i",{class:"fa fa-arrows"})],-1)),km=["disabled","onClick"],Cm=N(()=>t("i",{class:"fa fa-play"},null,-1)),Sm=[Cm],Vm=["href"],Um=N(()=>t("i",{class:"fa fa-external-link"},null,-1)),Im=["onClick"],Pm=N(()=>t("i",{class:"fa fa-remove ml-1"},null,-1)),Am=["onClick"],Tm=N(()=>t("i",{class:"fa fa-plus"},null,-1)),Dm=[Tm],Mm={key:0,class:"field has-addons"},Em={class:"control"},Fm=["onKeyup"],Lm={class:"control"},Rm=["disabled","onClick"],Om=["onClick","title"],Nm=["onClick"],jm=N(()=>t("i",{class:"fa fa-thumbs-up mr-1"},null,-1)),zm=["onClick"],Jm=N(()=>t("i",{class:"fa fa-thumbs-down mr-1"},null,-1)),Bm=["onClick"],qm=N(()=>t("i",{class:"fa fa-trash"},null,-1)),Wm=[qm],Hm={key:1};function Km(s,e,a,r,m,g){const u=w("draggable");return l(),i("div",null,[t("div",cm,[t("div",hm,[pm,s.filter.tag?(l(),i("span",{key:0,class:"tag mr-1",onClick:e[0]||(e[0]=n=>s.applyFilter(""))},[c(b(s.filter.tag)+" ",1),mm])):(l(),i("div",gm,[t("div",fm,[h(t("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":e[1]||(e[1]=n=>s.filterTagInput=n),onKeyup:e[2]||(e[2]=z(n=>s.applyFilter(s.filterTagInput),["enter"]))},null,544),[[y,s.filterTagInput]])]),t("div",ym,[t("span",{class:"button is-small",onClick:e[3]||(e[3]=n=>s.applyFilter(s.filterTagInput))},"Apply filter")])])),t("label",vm,[h(t("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=n=>s.hideFilteredOut=n)},null,512),[[F,s.hideFilteredOut]]),_m])])]),s.playlist.length>0?(l(),i("table",$m,[bm,k(u,{modelValue:s.enhancedPlaylist,onEnd:s.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:L(({element:n,index:_})=>[h(t("tr",null,[wm,t("td",null,b(_+1),1),t("td",null,[_!==s.firstIndex?(l(),i("button",{key:0,class:"button is-small",disabled:n.filteredOut?!0:null,onClick:f=>s.sendCtrl("playIdx",[_]),title:"Play"},Sm,8,km)):p("",!0)]),t("td",null,[t("a",{href:"https://www.youtube.com/watch?v="+n.yt,target:"_blank"},[c(b(n.title||n.yt)+" ",1),Um],8,Vm),t("div",null,[(l(!0),i(I,null,A(n.tags,(f,v)=>(l(),i("span",{key:v,class:"tag",onClick:U=>s.sendCtrl("rmtag",[f,_])},[c(b(f)+" ",1),Pm],8,Im))),128)),t("span",{class:"button is-small",onClick:f=>s.startAddTag(_)},Dm,8,Am)]),s.tagInputIdx===_?(l(),i("div",Mm,[t("div",Em,[h(t("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":e[5]||(e[5]=f=>s.tagInput=f),onKeyup:z(f=>{s.sendCtrl("addtag",[s.tagInput,_]),s.tagInput=""},["enter"])},null,40,Fm),[[y,s.tagInput]])]),t("div",Lm,[t("span",{class:"button is-small",disabled:s.tagInput?null:!0,onClick:f=>{s.sendCtrl("addtag",[s.tagInput,_]),s.tagInput=""}},"Add tag",8,Rm)])])):p("",!0)]),t("td",null,b(n.user),1),t("td",null,b(n.plays)+"x",1),t("td",null,[t("button",{class:"button is-small",onClick:f=>s.toggleVisibility(n,_),title:n.hidevideo?"Video hidden":"Video visible"},[t("i",{class:P(["fa mr-1",{"fa-eye":!n.hidevideo,"fa-eye-slash":n.hidevideo}])},null,2)],8,Om)]),t("td",null,[t("button",{class:"button is-small",onClick:f=>s.sendCtrl("goodIdx",[_])},[jm,c(" "+b(n.goods),1)],8,Nm)]),t("td",null,[t("button",{class:"button is-small",onClick:f=>s.sendCtrl("badIdx",[_])},[Jm,c(" "+b(n.bads),1)],8,zm)]),t("td",null,[t("button",{class:"button is-small",onClick:f=>s.sendCtrl("rmIdx",[_]),title:"Remove"},Wm,8,Bm)])],512),[[nt,!s.hideFilteredOut||!n.filteredOut]])]),_:1},8,["modelValue","onEnd"])])):(l(),i("div",Hm,"Playlist is empty"))])}var Gm=V(um,[["render",Km],["__scopeId","data-v-c0843896"]]);const Ym=S({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(s){const e=this.settings.customCssPresets.find(a=>a.name===s);e?this.settings.customCss=e.css:console.warn(`preset not found: ${s}`),this.sendSettings()},removePreset(s){this.settings.customCssPresets=this.settings.customCssPresets.filter(e=>e.name!==s),this.sendSettings()},savePreset(){const s=this.settings.customCssPresets.findIndex(e=>e.name===this.cssPresetName);s>=0?this.settings.customCssPresets[s].css=this.settings.customCss:this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss}),this.sendSettings()},hideVideoImageRemoved(){this.settings.hideVideoImage={filename:"",file:""},this.sendSettings()},hideVideoImageUploaded(s){this.settings.hideVideoImage={filename:s.originalname,file:s.filename},this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:{volume:100,hideVideoImage:{file:"",filename:""},showProgressBar:!1,customCssPresets:[],customCss:""},css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { animation: init 10s linear forwards, back 10s 0s linear infinite; }
.title { margin: 1em 0; white-space: nowrap; }
.not-playing .title { text-overflow: ellipsis; overflow: hidden; }
.meta, .vote { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Show only titles and marquee the current song (better version):",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.vote, .meta { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`}]}})}),R=s=>(W("data-v-d79e7668"),s=s(),H(),s),Xm={key:0,class:"table is-striped",ref:"table"},Qm=R(()=>t("td",null,[t("code",null,"settings.volume")],-1)),Zm=R(()=>t("td",null,"Base volume for all songs played",-1)),xm=R(()=>t("td",null,[t("code",null,"settings.hideVideoImage")],-1)),tg={key:0,class:"mb-1"},sg=R(()=>t("br",null,null,-1)),eg=R(()=>t("i",{class:"fa fa-remove mr-1"},null,-1)),ng=c(" Remove Image "),lg=[eg,ng],ig=R(()=>t("td",null,"Image to display when a video is hidden.",-1)),og=R(()=>t("td",null,[t("code",null,"settings.showProgressBar")],-1)),ag=R(()=>t("td",null,"Show a progress bar in the bottom part of the video in the widget.",-1)),dg=R(()=>t("code",null,"settings.customCss",-1)),rg={class:"field has-addons mr-1"},ug={class:"control is-expanded"},cg={class:"control"},hg=["onClick"],pg=["onClick"],mg=R(()=>t("i",{class:"fa fa-remove"},null,-1)),gg=[mg],fg=R(()=>t("p",null,"Classes that can be used for styling:",-1)),yg={class:"table"},vg=R(()=>t("thead",null,[t("tr",null,[t("th",null,"Class"),t("th",null,"Description")])],-1)),_g=R(()=>t("p",null,[t("b",null,"Examples:")],-1));function $g(s,e,a,r,m,g){const u=w("volume-slider"),n=w("responsive-image"),_=w("upload");return l(),i("div",null,[s.settings?(l(),i("table",Xm,[t("tbody",null,[t("tr",null,[Qm,t("td",null,[k(u,{modelValue:s.settings.volume,"onUpdate:modelValue":[e[0]||(e[0]=f=>s.settings.volume=f),s.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),Zm]),t("tr",null,[xm,t("td",null,[s.settings.hideVideoImage.file?(l(),i("div",tg,[k(n,{src:s.settings.hideVideoImage.file,title:s.settings.hideVideoImage.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"]),sg,t("button",{class:"button is-small",onClick:e[1]||(e[1]=(...f)=>s.hideVideoImageRemoved&&s.hideVideoImageRemoved(...f))},lg)])):p("",!0),k(_,{onUploaded:s.hideVideoImageUploaded,accept:"image/*",label:"Upload Image"},null,8,["onUploaded"])]),ig]),t("tr",null,[og,t("td",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":[e[2]||(e[2]=f=>s.settings.showProgressBar=f),e[3]||(e[3]=(...f)=>s.sendSettings&&s.sendSettings(...f))]},null,512),[[F,s.settings.showProgressBar]])]),ag]),t("tr",null,[t("td",null,[dg,t("div",rg,[t("div",ug,[h(t("input",{class:"input is-small","onUpdate:modelValue":e[4]||(e[4]=f=>s.cssPresetName=f),onFocus:e[5]||(e[5]=f=>s.cssPresetDropdownActive=!0),onBlur:e[6]||(e[6]=f=>s.cssPresetDropdownActive=!1)},null,544),[[y,s.cssPresetName]])]),t("div",cg,[t("span",{class:"button is-small",onClick:e[7]||(e[7]=(...f)=>s.savePreset&&s.savePreset(...f))},"Save preset")])]),(l(!0),i(I,null,A(s.settings.customCssPresets,(f,v)=>(l(),i("div",{class:"mb-1",key:v},[t("span",{class:"button is-small",onClick:U=>s.loadPreset(f.name)},b(f.name),9,hg),t("span",{class:"button is-small ml-1",onClick:U=>s.removePreset(f.name)},gg,8,pg)]))),128))]),t("td",null,[h(t("textarea",{class:"textarea","onUpdate:modelValue":[e[8]||(e[8]=f=>s.settings.customCss=f),e[9]||(e[9]=(...f)=>s.sendSettings&&s.sendSettings(...f))]},null,512),[[y,s.settings.customCss]])]),t("td",null,[fg,t("table",yg,[vg,t("tbody",null,[(l(!0),i(I,null,A(s.css.classExamples,(f,v)=>(l(),i("tr",{key:v},[t("td",null,[t("code",null,b(f.class),1)]),t("td",null,b(f.desc),1)]))),128))])]),_g,(l(!0),i(I,null,A(s.css.codeExamples,(f,v)=>(l(),i("p",{key:v},[c(b(f.desc)+" ",1),t("pre",null,[t("code",null,b(f.code),1)])]))),128))])])])],512)):p("",!0)])}var bg=V(Ym,[["render",$g],["__scopeId","data-v-d79e7668"]]);const wg=S({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(s,e){this.editTag=s.value,this.tagEditIdx=e},updateTag(s,e){this.$emit("updateTag",[s,e])}}}),kg={class:"table is-striped"},Cg=t("tr",null,[t("th",null,"Tag"),t("th"),t("th")],-1),Sg=["onKeyup"],Vg=["value","onFocus"],Ug=["disabled","onClick"];function Ig(s,e,a,r,m,g){return l(),i("table",kg,[Cg,(l(!0),i(I,null,A(s.tags,(u,n)=>(l(),i("tr",{key:n},[t("td",null,[s.tagEditIdx===n?h((l(),i("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":e[0]||(e[0]=_=>s.editTag=_),onKeyup:z(_=>s.updateTag(u.value,s.editTag),["enter"])},null,40,Sg)),[[y,s.editTag]]):(l(),i("input",{key:1,type:"text",class:"input is-small",value:u.value,onFocus:_=>s.onInputFocus(u,n)},null,40,Vg))]),t("td",null,[s.tagEditIdx===n?(l(),i("span",{key:0,class:"button is-small",disabled:u.value===s.editTag?!0:null,onClick:_=>s.updateTag(u.value,s.editTag)},"Save",8,Ug)):p("",!0)]),t("td",null,b(u.count)+"x",1)]))),128))])}var Pg=V(wg,[["render",Ig]]);const Ag=async()=>{const s=ct({history:ht(),routes:[{name:"index",path:"/",component:It,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:Ht,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:Ne,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:Yd,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:ur,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:Uo,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:ae,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:zl,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:Md,meta:{title:"Speech to text",protected:!0}},{name:"drawcast",path:"/drawcast/",component:Ws,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:Dn,meta:{title:"Settings",protected:!0}}]}),e=async g=>{const u=await fetch(g);return u.status===200?await u.json():null},a=await e("/api/conf"),r=await e("/api/user/me");s.beforeEach((g,u,n)=>{if(g.meta.protected&&!r){n({name:"login"});return}if(!g.meta.protected&&r){n({name:"index"});return}u.name&&document.documentElement.classList.remove(`view-${String(u.name)}`),document.documentElement.classList.add(`view-${String(g.name)}`),document.title=`${g.meta.title}`,n()});const m=pt(_t);m.config.globalProperties.$conf=a,m.config.globalProperties.$me=r,m.use(s),m.component("doubleclick-button",uu),m.component("draggable",mt),m.component("duration-input",br),m.component("duration",ou),m.component("navbar",su),m.component("player",Cr),m.component("responsive-image",zr),m.component("slider",Er),m.component("upload",vr),m.component("volume-slider",Rr),m.component("youtube",yu),m.component("command-edit",ep),m.component("countdown-edit",em),m.component("playlist-editor",Gm),m.component("tags-editor",Pg),m.component("song-request-settings",bg),m.component("help",rm),m.mount("#app")};Ag();
