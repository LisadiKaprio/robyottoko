import{d as U,r as $,o as i,c as o,a as k,b as e,F as A,e as P,t as w,f as h,w as m,v as _,g as q,h as N,i as g,j as z,n as J,k as T,u as vt,l as E,p as H,m as K,q as tt,s as bt,x as at,y as lt,z as _t,A as $t,B as yt,C as wt,D as kt}from"./vendor.9d1ac5c8.js";const Ct=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const p of f)if(p.type==="childList")for(const u of p.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function a(f){const p={};return f.integrity&&(p.integrity=f.integrity),f.referrerpolicy&&(p.referrerPolicy=f.referrerpolicy),f.crossorigin==="use-credentials"?p.credentials="include":f.crossorigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function d(f){if(f.ep)return;f.ep=!0;const p=a(f);fetch(f.href,p)}};Ct();var D=(t,s)=>{const a=t.__vccOpts||t;for(const[d,f]of s)a[d]=f;return a};const Vt=U({name:"app"}),St={id:"app"};function It(t,s,a,d,f,p){const u=$("router-view");return i(),o("div",St,[k(u)])}var Ut=D(Vt,[["render",It]]);const Dt=U({data:()=>({widgets:null}),async created(){const t=await fetch("/api/page/index");if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.widgets=s.widgets}}),At={key:0,id:"app"},Pt={id:"top",ref:"top"},Tt={id:"main",ref:"main"},Et={class:"table is-striped is-fullwidth"},Mt=e("thead",null,[e("tr",null,[e("th",null,"Widget"),e("th",null,"Hint")])],-1),Ft=["href"];function Ot(t,s,a,d,f,p){const u=$("navbar");return t.widgets?(i(),o("div",At,[e("div",Pt,[k(u)],512),e("div",Tt,[e("table",Et,[Mt,e("tbody",null,[(i(!0),o(A,null,P(t.widgets,(n,c)=>(i(),o("tr",{key:c},[e("td",null,[e("a",{href:n.url,target:"blank"},w(n.title),9,Ft)]),e("td",null,w(n.hint),1)]))),128))])])],512)])):h("",!0)}var zt=D(Dt,[["render",Ot]]);let et=null;const Nt=async t=>{const s=await fetch(t);return s.status===200?await s.json():null};async function rt(){et=await Nt("/api/user/me")}async function Rt(){return(await(await fetch("/api/logout",{method:"POST"})).json()).success?(et=null,{error:!1}):{error:"[2021-09-25 18:36]"}}async function jt(t,s){const a=await fetch("/api/auth",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:t,pass:s})});return a.status===200?(await rt(),{error:!1}):a.status===401?{error:(await a.json()).reason}:{error:"Unknown error"}}var R={getMe:()=>et,logout:Rt,login:jt,init:rt};const Lt=U({data:()=>({user:"",pass:"",error:"",success:""}),async mounted(){const s=new URLSearchParams(window.location.search).get("t");if(s){this.success="",this.error="";const a=await fetch("/api/_handle-token",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:s})});a.status===200?(await a.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const t=await R.login(this.user,this.pass);t.error?this.error=t.error:this.$router.push({name:"index"})}}}),qt={class:"center-screen"},Jt=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Bt={key:0,class:"field has-background-success-light has-text-success-dark"},Wt={key:1,class:"field has-background-danger-light has-text-danger-dark"},Ht={class:"field"},Kt={class:"control has-icons-left"},Gt=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),Yt={class:"field"},Xt={class:"control has-icons-left"},Qt=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Zt={class:"field"},xt={class:"field"},te=g("Register an account"),ee=g(" | "),se=g("Forgot password?");function ne(t,s,a,d,f,p){const u=$("router-link");return i(),o("div",qt,[Jt,e("form",null,[t.success?(i(),o("div",Bt,w(t.success),1)):h("",!0),t.error?(i(),o("div",Wt,w(t.error),1)):h("",!0),e("div",Ht,[e("div",Kt,[m(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":s[0]||(s[0]=n=>t.user=n),onKeyup:s[1]||(s[1]=n=>t.error="")},null,544),[[_,t.user]]),Gt])]),e("div",Yt,[e("div",Xt,[m(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":s[2]||(s[2]=n=>t.pass=n),onKeyup:[s[3]||(s[3]=n=>t.error=""),s[4]||(s[4]=q((...n)=>t.submit&&t.submit(...n),["enter"]))]},null,544),[[_,t.pass]]),Qt])]),e("div",Zt,[e("span",{class:"button is-small is-primary",onClick:s[5]||(s[5]=(...n)=>t.submit&&t.submit(...n))},"Login")]),e("div",xt,[k(u,{to:{name:"register"}},{default:N(()=>[te]),_:1}),ee,k(u,{to:{name:"forgot-password"}},{default:N(()=>[se]),_:1})])])])}var ie=D(Lt,[["render",ne]]);let dt=null;const oe=async t=>{const s=await fetch(t);return s.status===200?await s.json():null},ae=async()=>{dt=await oe("/api/conf")};var W={init:ae,getConf:()=>dt};const le=1001,ut=4e3;class re{constructor(s,a){this.handle=null,this.reconnectTimeout=null,this.sendBuffer=[],this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{},this.addr=s,this.protocols=a}send(s){this.handle?this.handle.send(s):this.sendBuffer.push(s)}connect(){let s=new WebSocket(this.addr,this.protocols);s.onopen=a=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=s;this.sendBuffer.length>0;){const d=this.sendBuffer.shift();d&&this.handle.send(d)}this.onopen(a)},s.onmessage=a=>{this.onmessage(a)},s.onclose=a=>{this.handle=null,a.code===ut||a.code===le||(this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3)),this.onclose(a)}}disconnect(){this.handle&&this.handle.close(ut)}}const de=(...t)=>console.log("[WsClient.ts]",...t);class G extends re{constructor(s,a){super(s,a);this._on={},this.onopen=d=>{this._dispatch("socket","open",d)},this.onmessage=d=>{if(this._dispatch("socket","message",d),this._on.message){const f=this._parseMessageData(d.data);f.event&&this._dispatch("message",f.event,f.data)}},this.onclose=d=>{this._dispatch("socket","close",d)}}onSocket(s,a){this.addEventListener("socket",s,a)}onMessage(s,a){this.addEventListener("message",s,a)}addEventListener(s,a,d){const f=Array.isArray(a)?a:[a];this._on[s]=this._on[s]||{};for(const p of f)this._on[s][p]=this._on[s][p]||[],this._on[s][p].push(d)}_parseMessageData(s){try{const a=JSON.parse(s);if(a.event)return{event:a.event,data:a.data||null}}catch{}return{event:null,data:null}}_dispatch(s,a,...d){const p=(this._on[s]||{})[a]||[];if(p.length!==0){de(`ws dispatch ${s} ${a}`);for(const u of p)u(...d)}}}const st=async(t,s,a)=>new Promise((d,f)=>{const p=new window.XMLHttpRequest;p.open(t,s,!0),p.withCredentials=!0;const u=a.headers||{};for(const n in u)p.setRequestHeader(n,u[n]);p.addEventListener("load",function(n){d({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),p.addEventListener("error",function(n){f(new Error("xhr error"))}),p.upload&&a.onUploadProgress&&p.upload.addEventListener("progress",function(n){a.onUploadProgress&&a.onUploadProgress(n)}),p.send(a.body)});var nt={request:st,get:(t,s)=>st("get",t,s),post:(t,s)=>st("post",t,s)};const ue=U({data:()=>({$me:null,$conf:null,unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null,drawUrl:"",favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}}}),async created(){this.$me=R.getMe(),this.$conf=W.getConf(),this.ws=new G(this.$conf.wsBase+"/drawcast",this.$me.token),this.ws.onMessage("init",async t=>{this.settings=t.settings,this.defaultSettings=t.defaultSettings,this.unchangedJson=JSON.stringify(t.settings),this.drawUrl=t.drawUrl;const s=await nt.get("/api/drawcast/all-images/",{});this.favoriteSelection.items=await s.json()}),this.ws.connect()},watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},receiveUrl(){return`${location.protocol}//${location.host}/widget/drawcast_receive/${this.$me.widgetToken}/`},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage==0?0:1)},currentFavoriteSelectionItems(){const t=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(t,t+this.favoriteSelection.pagination.perPage)}},methods:{toggleFavorite(t){if(!this.settings){console.warn("toggleFavorite: this.settings not initialized");return}this.settings.favorites.includes(t)?this.settings.favorites=this.settings.favorites.filter(s=>s!==t):this.settings.favorites.push(t)},soundUploaded(t){if(!this.settings){console.warn("soundUploaded: this.settings not initialized");return}this.settings.notificationSound={filename:t.originalname,file:t.filename,volume:100}},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:{canvasWidth:parseInt(`${this.settings.canvasWidth}`,10)||720,canvasHeight:parseInt(`${this.settings.canvasHeight}`,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,customDescription:this.settings.customDescription,palette:this.settings.palette,displayDuration:parseInt(`${this.settings.displayDuration}`,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,notificationSound:this.settings.notificationSound,favorites:this.settings.favorites}})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},unmounted(){this.ws&&this.ws.disconnect()}}),me={id:"app"},ce={id:"top",ref:"top"},he={id:"actionbar",class:"p-1"},pe=["disabled"],ge=["href"],fe=["href"],ve={id:"main",ref:"main"},be={key:0,class:"table is-striped",ref:"table"},_e=e("tr",null,[e("td",{colspan:"3"},"General")],-1),$e=e("td",null,[e("code",null,"settings.canvasWidth")],-1),ye=e("td",null,[g(" Width of the drawing area."),e("br"),g(" Caution: changing this will clear the area for currenty connected users. ")],-1),we=e("td",null,[e("code",null,"settings.canvasHeight")],-1),ke=e("td",null,[g(" Height of the drawing area."),e("br"),g(" Caution: changing this will clear the area for currenty connected users. ")],-1),Ce=e("td",null,[e("code",null,"settings.displayDuration")],-1),Ve=e("td",null," The duration in Milliseconds that each drawing will be shown ",-1),Se=e("td",null,[e("code",null,"settings.displayLatestForever")],-1),Ie=e("td",null,"If checked, the latest drawing will be shown indefinately.",-1),Ue=e("td",null,[e("code",null,"settings.displayLatestAutomatically")],-1),De=e("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),Ae=e("td",null,[e("code",null,"settings.submitButtonText")],-1),Pe=e("td",null,null,-1),Te=e("td",null,[e("code",null,"settings.submitConfirm")],-1),Ee=e("td",null," Leave empty if no confirm is required by user before sending. ",-1),Me=e("td",null,[e("code",null,"settings.customDescription")],-1),Fe=e("td",null,"Description text below the drawing panel.",-1),Oe=e("td",null,[e("code",null,"settings.palette")],-1),ze=["onUpdate:modelValue"],Ne=e("br",null,null,-1),Re=e("br",null,null,-1),je=e("td",null,[g(" Default colors appearing on the draw page."),e("br"),g(" Caution: Changing this will change selected color for currenty connected users. ")],-1),Le=e("td",null,[e("code",null,"settings.notificationSound")],-1),qe={key:0,class:"spacerow media-holder"},Je=e("i",{class:"fa fa-remove"},null,-1),Be=[Je],We=e("td",null,[g(" Add a sound here that plays when new drawings arrive. "),e("br"),g(" Note: Not played in drawing window, only in widget. ")],-1),He=e("code",null,"settings.favorites",-1),Ke={class:"preview"},Ge=["src"],Ye=e("div",null,"Currently selected favorites:",-1),Xe={class:"favorites"},Qe=["src","onClick","onMouseover"],Ze=e("div",{class:"mt-2"},"Select favorites:",-1),xe={class:"favorites-select"},ts=["src","onClick","onMouseover"],es=["disabled"],ss=["disabled"],ns=e("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function is(t,s,a,d,f,p){const u=$("navbar"),n=$("player"),c=$("volume-slider"),r=$("upload");return i(),o("div",me,[e("div",ce,[k(u),e("div",he,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...v)=>t.sendSave&&t.sendSave(...v))}," Save ",8,pe),e("a",{class:"button is-small mr-1",href:t.receiveUrl,target:"_blank"},"Open widget",8,ge),e("a",{class:"button is-small",href:t.drawUrl,target:"_blank"},"Open draw",8,fe)])],512),e("div",ve,[t.settings?(i(),o("table",be,[e("tbody",null,[_e,e("tr",null,[$e,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[1]||(s[1]=v=>t.settings.canvasWidth=v)},null,512),[[_,t.settings.canvasWidth]])]),ye]),e("tr",null,[we,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=v=>t.settings.canvasHeight=v)},null,512),[[_,t.settings.canvasHeight]])]),ke]),e("tr",null,[Ce,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=v=>t.settings.displayDuration=v)},null,512),[[_,t.settings.displayDuration]])]),Ve]),e("tr",null,[Se,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=v=>t.settings.displayLatestForever=v)},null,512),[[z,t.settings.displayLatestForever]])]),Ie]),e("tr",null,[Ue,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=v=>t.settings.displayLatestAutomatically=v)},null,512),[[z,t.settings.displayLatestAutomatically]])]),De]),e("tr",null,[Ae,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=v=>t.settings.submitButtonText=v)},null,512),[[_,t.settings.submitButtonText]])]),Pe]),e("tr",null,[Te,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[7]||(s[7]=v=>t.settings.submitConfirm=v)},null,512),[[_,t.settings.submitConfirm]])]),Ee]),e("tr",null,[Me,e("td",null,[m(e("textarea",{class:"textarea","onUpdate:modelValue":s[8]||(s[8]=v=>t.settings.customDescription=v)},null,512),[[_,t.settings.customDescription]])]),Fe]),e("tr",null,[Oe,e("td",null,[(i(!0),o(A,null,P(t.settings.palette,(v,S)=>(i(),o("label",{class:"square",key:S},[m(e("input",{type:"color","onUpdate:modelValue":l=>t.settings.palette[S]=l},null,8,ze),[[_,t.settings.palette[S]]]),e("span",{class:"square-inner",style:J({backgroundColor:v})},null,4)]))),128)),Ne,Re,e("button",{class:"button is-small",onClick:s[9]||(s[9]=v=>t.settings.palette=t.defaultSettings.palette)}," Reset to default palette ")]),je]),e("tr",null,[Le,e("td",null,[t.settings.notificationSound?(i(),o("div",qe,[k(n,{src:t.settings.notificationSound.file,name:t.settings.notificationSound.filename,volume:t.settings.notificationSound.volume,class:"button is-small"},null,8,["src","name","volume"]),k(c,{modelValue:t.settings.notificationSound.volume,"onUpdate:modelValue":s[10]||(s[10]=v=>t.settings.notificationSound.volume=v)},null,8,["modelValue"]),e("button",{class:"button is-small",onClick:s[11]||(s[11]=v=>t.settings.notificationSound=null)},Be)])):h("",!0),k(r,{onUploaded:t.soundUploaded,accept:"audio/*",label:"Upload Audio"},null,8,["onUploaded"])]),We]),e("tr",null,[e("td",null,[He,e("div",Ke,[t.favoriteSelection.hovered?(i(),o("img",{key:0,src:t.favoriteSelection.hovered},null,8,Ge)):h("",!0)])]),e("td",null,[Ye,e("div",Xe,[(i(!0),o(A,null,P(t.settings.favorites,(v,S)=>(i(),o("img",{src:v,key:S,width:"50",height:"50",onClick:l=>t.toggleFavorite(v),onMouseover:l=>t.favoriteSelection.hovered=v,onMouseleave:s[12]||(s[12]=l=>t.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,Qe))),128))]),Ze,e("div",xe,[(i(!0),o(A,null,P(t.currentFavoriteSelectionItems,(v,S)=>(i(),o("img",{src:v,key:S,width:"50",height:"50",onClick:l=>t.toggleFavorite(v),onMouseover:l=>t.favoriteSelection.hovered=v,onMouseleave:s[13]||(s[13]=l=>t.favoriteSelection.hovered=""),class:T(["thumbnail mr-1",{"is-favorited":t.settings.favorites.includes(v)}])},null,42,ts))),128))]),e("span",{class:"button is-small",onClick:s[14]||(s[14]=v=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page-1),disabled:t.favoriteSelection.pagination.page>1?null:!0},"Prev",8,es),e("span",{class:"button is-small",onClick:s[15]||(s[15]=v=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page+1),disabled:t.favoriteSelection.pagination.page<t.favoriteSelectionTotalPages?null:!0},"Next",8,ss)]),ns])])],512)):h("",!0)],512)])}var os=D(ue,[["render",is]]);const as=U({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(t){this.variables=this.variables.filter((s,a)=>a!==t)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await fetch("/save-variables",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({variables:this.variables})}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await fetch("/api/page/variables");if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.variables=s.variables,this.setUnchanged()}}),ls={id:"app"},rs={id:"top",ref:"top"},ds={id:"actionbar",class:"p-1"},us=["disabled"],ms={id:"main"},cs={class:"mb-4"},hs=e("h1",{class:"title mb-2"},"Global Variables",-1),ps=e("div",{class:"help"},[g(" Variables can be used from commands with "),e("code",null,"$var(variable_name)"),g(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),gs={class:"table is-striped"},fs=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Value"),e("th")])],-1),vs=["onUpdate:modelValue"],bs=["onUpdate:modelValue"],_s=e("i",{class:"fa fa-trash"},null,-1);function $s(t,s,a,d,f,p){const u=$("navbar"),n=$("doubleclick-button");return i(),o("div",ls,[e("div",rs,[k(u),e("div",ds,[e("button",{class:"button is-small",onClick:s[0]||(s[0]=(...c)=>t.onAdd&&t.onAdd(...c))},"Add"),e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[1]||(s[1]=(...c)=>t.sendSave&&t.sendSave(...c))}," Save ",8,us)])],512),e("div",ms,[e("div",cs,[hs,ps,e("table",gs,[fs,e("tbody",null,[(i(!0),o(A,null,P(t.variables,(c,r)=>(i(),o("tr",{key:r},[e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":v=>c.name=v},null,8,vs),[[_,c.name]])]),e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":v=>c.value=v},null,8,bs),[[_,c.value]])]),e("td",null,[k(n,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:v=>t.remove(r)},{default:N(()=>[_s]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var ys=D(as,[["render",$s]]);const ws=U({data:()=>({user:"",pass:"",email:"",error:"",success:!1}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const t=await fetch("/api/user/_resend_verification_mail",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.email})});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const t=await fetch("/api/user/_register",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,pass:this.pass,email:this.email})});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),ks={class:"center-screen"},Cs=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Vs={key:0,class:"field has-background-success-light has-text-success-dark"},Ss=g(" Account registered. Please check your mail. Click "),Is=g("here"),Us=g(" to login. "),Ds={key:1},As={key:0,class:"field has-background-danger-light has-text-danger-dark"},Ps={key:0},Ts=g(" A user with this email is already registered. "),Es=e("br",null,null,-1),Ms=g("Request a password reset."),Fs={key:1},Os=g(" A user with this email is already registered. "),zs=e("br",null,null,-1),Ns={key:2},Rs={key:3},js={key:4},Ls={class:"field"},qs={class:"control has-icons-left"},Js=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),Bs={class:"field"},Ws={class:"control has-icons-left"},Hs=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),Ks={class:"field"},Gs={class:"control has-icons-left"},Ys=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Xs={class:"field"},Qs=["disabled"];function Zs(t,s,a,d,f,p){const u=$("router-link");return i(),o("div",ks,[Cs,t.success?(i(),o("div",Vs,[Ss,k(u,{to:{name:"login"}},{default:N(()=>[Is]),_:1}),Us])):(i(),o("div",Ds,[t.error?(i(),o("div",As,[t.error==="verified_mail_already_exists"?(i(),o("div",Ps,[Ts,Es,k(u,{to:{name:"forgot-password"}},{default:N(()=>[Ms]),_:1})])):t.error==="unverified_mail_already_exists"?(i(),o("div",Fs,[Os,zs,e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...n)=>t.onRequestVerificationEmail&&t.onRequestVerificationEmail(...n))},"Resend verification email")])):t.error==="verified_name_already_exists"?(i(),o("div",Ns," A user with this name is already registered. ")):t.error==="unverified_name_already_exists"?(i(),o("div",Rs," A user with this name is already registered. ")):(i(),o("span",js,w(t.error),1))])):h("",!0),e("div",Ls,[e("div",qs,[m(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":[s[1]||(s[1]=n=>t.user=n),s[2]||(s[2]=n=>t.error="")]},null,512),[[_,t.user]]),Js])]),e("div",Bs,[e("div",Ws,[m(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":[s[3]||(s[3]=n=>t.email=n),s[4]||(s[4]=n=>t.error="")]},null,512),[[_,t.email]]),Hs])]),e("div",Ks,[e("div",Gs,[m(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":[s[5]||(s[5]=n=>t.pass=n),s[6]||(s[6]=n=>t.error="")],onKeyup:s[7]||(s[7]=q((...n)=>t.submit&&t.submit(...n),["enter"]))},null,544),[[_,t.pass]]),Ys])]),e("div",Xs,[e("button",{class:"button is-small is-primary",disabled:t.canRegister?null:!0,onClick:s[8]||(s[8]=(...n)=>t.submit&&t.submit(...n))}," Register ",8,Qs)])]))])}var xs=D(ws,[["render",Zs]]);const tn=U({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[],tmi_identity_client_id:"",tmi_identity_client_secret:""},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const t=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],s=document.location,a=`${s.protocol}//${s.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${a}&scope=${t.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(t){this.twitch_channels=this.twitch_channels.filter((s,a)=>a!==t)},addchannel(){this.twitch_channels.push({user_id:this.user.id,channel_id:"",channel_name:"",access_token:""})},async loadid(t){this.twitch_channels[t].channel_id=await this.getTwitchUserIdByName(this.twitch_channels[t].channel_name)},async getTwitchUserIdByName(t){const s={name:t,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},a=await fetch("/twitch/user-id-by-name",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)});try{return`${(await a.json()).id}`}catch{return""}},async sendSave(){await fetch("/api/save-settings",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await fetch("/api/page/settings");if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.user=s.user,this.twitch_channels=s.twitchChannels,this.setUnchanged()}}),en={id:"app"},sn={id:"top",ref:"top"},nn={id:"actionbar",class:"p-1"},on=["disabled"],an={id:"main"},ln={class:"mb-4"},rn=e("h1",{class:"title mb-2"},"User",-1),dn={class:"table is-striped"},un=e("td",null,"Name:",-1),mn=e("td",null,"Email:",-1),cn=e("td",null,"Password:",-1),hn={key:0,class:"mb-4"},pn=e("h1",{class:"title mb-2"},"Twitch-Bot",-1),gn=e("p",null,[g(" Please refer to "),e("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),g(". ")],-1),fn={class:"table is-striped"},vn=e("td",null,"Bot name:",-1),bn=e("td",null,"Bot oauth (pass):",-1),_n=e("td",null,"Bot client_id:",-1),$n=e("td",null,"Bot client_secret:",-1),yn={class:"mb-4"},wn=e("h1",{class:"title mb-2"},"Twitch Channels",-1),kn=g(" List of twitch channels where the bot will connect to. "),Cn={key:0},Vn={key:0,class:"table is-striped"},Sn=e("thead",null,[e("tr",null,[e("td",null,"Channel name"),e("td",null,"Channel id*"),e("td",null,"Access Token*"),e("td")])],-1),In=["onUpdate:modelValue"],Un=["onUpdate:modelValue"],Dn=["onClick"],An=["onUpdate:modelValue"],Pn=["onClick"],Tn=e("i",{class:"fa fa-remove"},null,-1),En=[Tn],Mn={key:1,class:"content"},Fn=e("p",null," Channel Id* and Access Token*: You may not need the client id or access token. No public feature currently uses them. ",-1),On={key:0},zn={key:1,class:"list"},Nn=e("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Rn={class:"list-item"},jn=g(" Click "),Ln=["href"],qn=g(" to authorize the bot with the channel "),Jn=e("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),Bn={key:2};function Wn(t,s,a,d,f,p){const u=$("navbar");return i(),o("div",en,[e("div",sn,[k(u),e("div",nn,[e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[0]||(s[0]=(...n)=>t.sendSave&&t.sendSave(...n))}," Save ",8,on)])],512),e("div",an,[e("div",ln,[rn,e("table",dn,[e("tbody",null,[e("tr",null,[un,e("td",null,w(t.user.name),1)]),e("tr",null,[mn,e("td",null,[m(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=n=>t.user.email=n)},null,512),[[_,t.user.email]])])]),e("tr",null,[cn,e("td",null,[m(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=n=>t.user.pass=n)},null,512),[[_,t.user.pass]])])])])])]),t.isAdmin?(i(),o("div",hn,[pn,gn,e("table",fn,[e("tbody",null,[e("tr",null,[vn,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=n=>t.user.tmi_identity_username=n)},null,512),[[_,t.user.tmi_identity_username]])])]),e("tr",null,[bn,e("td",null,[m(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[4]||(s[4]=n=>t.user.tmi_identity_password=n)},null,512),[[_,t.user.tmi_identity_password]])])]),e("tr",null,[_n,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=n=>t.user.tmi_identity_client_id=n)},null,512),[[_,t.user.tmi_identity_client_id]])])]),e("tr",null,[$n,e("td",null,[m(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[6]||(s[6]=n=>t.user.tmi_identity_client_secret=n)},null,512),[[_,t.user.tmi_identity_client_secret]])])])])])])):h("",!0),e("div",yn,[wn,e("p",null,[kn,t.twitch_channels.length===0?(i(),o("span",Cn," Currently no channels are configured. ")):h("",!0)]),t.twitch_channels.length>0?(i(),o("table",Vn,[Sn,e("tbody",null,[(i(!0),o(A,null,P(t.twitch_channels,(n,c)=>(i(),o("tr",{key:c},[e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":r=>n.channel_name=r},null,8,In),[[_,n.channel_name]])]),e("td",null,[n.channel_id?m((i(),o("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":r=>n.channel_id=r},null,8,Un)),[[_,n.channel_id]]):h("",!0),n.channel_id?h("",!0):(i(),o("button",{key:1,class:"button is-small",onClick:r=>t.loadid(c)}," Load id ",8,Dn))]),e("td",null,[m(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":r=>n.access_token=r},null,8,An),[[_,n.access_token]])]),e("td",null,[e("button",{class:"button is-small",onClick:r=>t.rmchannel(c)},En,8,Pn)])]))),128))])])):h("",!0),e("button",{class:"button is-small",onClick:s[7]||(s[7]=n=>t.addchannel())}," Add channel ")]),t.twitch_channels.length>0?(i(),o("div",Mn,[Fn,t.accessTokenLink?(i(),o("p",On,"To get an access token, do the following:")):h("",!0),t.accessTokenLink?(i(),o("ol",zn,[Nn,e("li",Rn,[jn,e("a",{href:t.accessTokenLink,target:"_blank"},"here",8,Ln),qn]),Jn])):t.isAdmin?(i(),o("p",Bn,' To configure an access token, please configure the "Bot client_id" above. ')):h("",!0)])):h("",!0)])])}var Hn=D(tn,[["render",Wn]]);const Kn=U({data:()=>({$me:null,$conf:null,playerVisible:!1,playlist:[],commands:[],globalVariables:[],settings:{volume:100,hideVideoImage:{file:"",filename:""},initAutoplay:!0,customCss:"",showProgressBar:!1,showThumbnails:!0,maxItemsShown:-1,customCssPresets:[]},filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:"",toast:vt(),controlDefinitions:[{title:"Reset stats",ctrl:"resetStats",icon:"fa-eraser"},{title:"Clear playlist",ctrl:"clear",icon:"fa-eject"},{title:"Shuffle",ctrl:"shuffle",icon:"fa-random"},{title:"Play",ctrl:"unpause",icon:"fa-play"},{title:"Pause",ctrl:"pause",icon:"fa-pause"},{title:"Prev",ctrl:"prev",icon:"fa-step-backward"},{title:"Next",ctrl:"skip",icon:"fa-step-forward"}],tabDefinitions:[{tab:"playlist",title:"Playlist"},{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"},{tab:"tags",title:"Tags"},{tab:"import",title:"Import/Export"}],possibleActions:["sr_current","sr_undo","sr_good","sr_bad","sr_stats","sr_prev","sr_next","sr_jumptonew","sr_clear","sr_rm","sr_shuffle","sr_reset_stats","sr_loop","sr_noloop","sr_pause","sr_unpause","sr_hidevideo","sr_showvideo","sr_request","sr_re_request","sr_addtag","sr_rmtag","sr_volume","sr_filter","sr_preset"]}),computed:{tags(){const t=[];return this.playlist.forEach(s=>{s.tags.forEach(a=>{const d=t.findIndex(f=>f.value===a);d===-1?t.push({value:a,count:1}):t[d].count++})}),t},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(t=>t.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},importPlaylistUrl(){return`${location.protocol}//${location.host}/api/sr/import`},exportPlaylistUrl(){return`${location.protocol}//${location.host}/api/sr/export`},widgetUrl(){return`${location.protocol}//${location.host}/widget/sr/${this.$me.widgetToken}/`}},methods:{sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings})},onTagUpdated(t){this.updateTag(t[0],t[1])},onPlaylistCtrl(t){this.sendCtrl(t[0],t[1])},applyFilter(t){this.sendCtrl("filter",[{tag:t}])},async doImportPlaylist(){(await nt.post(this.importPlaylistUrl,{headers:{Accept:"application/json","Content-Type":"application/json"},body:this.importPlaylist})).status===200?(this.tab="playlist",this.toast.success("Import successful")):this.toast.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(t,s){this.sendMsg({event:"ctrl",ctrl:t,args:s})},ended(){this.sendMsg({event:"ended"})},sendMsg(t){this.ws?this.ws.send(JSON.stringify(t)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(t){this.player.setVolume(t)},updateTag(t,s){t!==s&&this.sendCtrl("updatetag",[t,s])}},created(){this.$me=R.getMe(),this.$conf=W.getConf()},async mounted(){this.$nextTick(()=>{this.ws=new G(this.$conf.wsBase+"/sr",this.$me.token),this.ws.onMessage("save",t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables}),this.ws.onMessage(["pause"],t=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],t=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],t=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],t=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","clear","move","tags"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist;const a=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;s!==a&&this.play()}),this.ws.onMessage(["filter"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist,this.filteredPlaylist.find(a=>a.id===s)||this.play()}),this.ws.onMessage(["dislike","like","video","playIdx","resetStats","shuffle"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.filter=t.filter,this.playlist=t.playlist}),this.ws.onMessage(["add","init"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.filter=t.filter,this.playlist=t.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),Y=t=>(H("data-v-5bdbf170"),t=t(),K(),t),Gn={id:"app"},Yn={id:"top",ref:"top"},Xn={id:"actionbar",class:"p-1"},Qn=["disabled","onClick","title"],Zn=["disabled","title"],xn=Y(()=>e("i",{class:"fa fa-tv mr-1"},null,-1)),ti={class:"txt"},ei={class:"field has-addons mr-1"},si={class:"control"},ni=["disabled"],ii={class:"control"},oi=["disabled"],ai=Y(()=>e("i",{class:"fa fa-search mr-1"},null,-1)),li=g(" from playlist "),ri=[ai,li],di={class:"field has-addons mr-1"},ui={class:"control"},mi=["disabled"],ci={class:"control"},hi=["disabled"],pi=Y(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),gi=g(" from YouTube "),fi=[pi,gi],vi=["disabled","href"],bi={id:"main",ref:"main"},_i={style:{width:"640px","max-width":"100%"}},$i={class:"tabs"},yi=["onClick"],wi={key:0},ki={class:"mb-1"},Ci=["href"],Vi=Y(()=>e("i",{class:"fa fa-download mr-1"},null,-1)),Si=g(" Export playlist"),Ii=[Vi,Si],Ui=Y(()=>e("i",{class:"fa fa-upload mr-1"},null,-1)),Di=g(" Import playlist "),Ai=[Ui,Di],Pi={key:1,id:"tags"},Ti={key:3,id:"playlist",class:"table-container"};function Ei(t,s,a,d,f,p){const u=$("navbar"),n=$("youtube"),c=$("tags-editor"),r=$("song-request-settings"),v=$("playlist-editor"),S=$("commands-editor");return i(),o("div",Gn,[e("div",Yn,[k(u),e("div",Xn,[(i(!0),o(A,null,P(t.controlDefinitions,(l,b)=>(i(),o("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:y=>t.sendCtrl(l.ctrl,[]),title:l.title,key:b},[e("i",{class:T(["fa",l.icon])},null,2)],8,Qn))),128)),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[0]||(s[0]=(...l)=>t.togglePlayer&&t.togglePlayer(...l)),title:t.togglePlayerButtonText},[xn,e("span",ti,w(t.togglePlayerButtonText),1)],8,Zn),e("div",ei,[e("div",si,[m(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[1]||(s[1]=l=>t.resrinput=l),onKeyup:s[2]||(s[2]=q((...l)=>t.resr&&t.resr(...l),["enter"]))},null,40,ni),[[_,t.resrinput]])]),e("div",ii,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[3]||(s[3]=(...l)=>t.resr&&t.resr(...l))},ri,8,oi)])]),e("div",di,[e("div",ui,[m(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[4]||(s[4]=l=>t.srinput=l),onKeyup:s[5]||(s[5]=q((...l)=>t.sr&&t.sr(...l),["enter"]))},null,40,mi),[[_,t.srinput]])]),e("div",ci,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[6]||(s[6]=(...l)=>t.sr&&t.sr(...l))},fi,8,hi)])]),e("a",{class:"button is-small mr-1",disabled:t.inited?null:!0,href:t.widgetUrl,target:"_blank"},"Open SR widget",8,vi)])],512),e("div",bi,[e("div",_i,[e("div",{id:"player",class:"video-16-9",style:J(t.playerstyle)},[k(n,{ref:"youtube",onEnded:t.ended,visible:t.playerVisible},null,8,["onEnded","visible"])],4)]),e("div",$i,[e("ul",null,[(i(!0),o(A,null,P(t.tabDefinitions,(l,b)=>(i(),o("li",{key:b,class:T({"is-active":t.tab===l.tab}),onClick:y=>t.tab=l.tab},[e("a",null,w(l.title),1)],10,yi))),128))])]),t.inited&&t.tab==="import"?(i(),o("div",wi,[e("div",ki,[e("a",{class:"button is-small mr-1",href:t.exportPlaylistUrl,target:"_blank"},Ii,8,Ci),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...l)=>t.doImportPlaylist&&t.doImportPlaylist(...l))},Ai)]),m(e("textarea",{class:"textarea mb-1","onUpdate:modelValue":s[8]||(s[8]=l=>t.importPlaylist=l)},null,512),[[_,t.importPlaylist]])])):h("",!0),t.inited&&t.tab==="tags"?(i(),o("div",Pi,[k(c,{tags:t.tags,onUpdateTag:t.onTagUpdated},null,8,["tags","onUpdateTag"])])):h("",!0),t.inited&&t.tab==="settings"?(i(),E(r,{key:2,id:"settings",modelValue:t.settings,"onUpdate:modelValue":[s[9]||(s[9]=l=>t.settings=l),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),t.inited&&t.tab==="playlist"?(i(),o("div",Ti,[k(v,{playlist:t.playlist,filter:t.filter,onStopPlayer:s[10]||(s[10]=l=>t.player.stop()),onFilterChange:t.applyFilter,onCtrl:t.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):h("",!0),t.inited&&t.tab==="commands"?(i(),E(S,{key:4,modelValue:t.commands,"onUpdate:modelValue":[s[11]||(s[11]=l=>t.commands=l),t.sendSave],globalVariables:t.globalVariables,possibleActions:t.possibleActions,baseVolume:100},null,8,["modelValue","onUpdate:modelValue","globalVariables","possibleActions"])):h("",!0)],512)])}var Mi=D(Kn,[["render",Ei],["__scopeId","data-v-5bdbf170"]]);const Fi=U({created(){this.$me=R.getMe(),this.$conf=W.getConf()},data:()=>({$me:null,$conf:null,commands:[],settings:{volume:100},adminSettings:{showImages:!0},globalVariables:[],ws:null,possibleActions:["text","media","media_volume","countdown","dict_lookup","madochan_createword","chatters"],tabDefinitions:[{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"}],inited:!1,tab:"commands"}),computed:{baseVolume(){return this.settings.volume},widgetUrl(){return`${location.protocol}//${location.host}/widget/media/${this.$me.widgetToken}/`}},methods:{updateShowImages(t){this.adminSettings.showImages=t,this.sendSave()},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings,adminSettings:this.adminSettings})},sendMsg(t){this.ws?this.ws.send(JSON.stringify(t)):console.warn("sendMsg: this.ws not initialized")}},async mounted(){this.ws=new G(this.$conf.wsBase+"/general",this.$me.token),this.ws.onMessage("init",t=>{this.commands=t.commands,this.settings=t.settings,this.adminSettings=t.adminSettings,this.globalVariables=t.globalVariables,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Oi={id:"app"},zi={id:"top",ref:"top"},Ni={id:"main",ref:"main"},Ri={class:"tabs"},ji=["onClick"],Li=["href"],qi={key:1},Ji={key:0,class:"table is-striped",ref:"table"},Bi=e("td",null,[e("code",null,"settings.volume")],-1),Wi=e("td",null,"Base volume for all media playing from commands",-1);function Hi(t,s,a,d,f,p){const u=$("navbar"),n=$("commands-editor"),c=$("volume-slider");return i(),o("div",Oi,[e("div",zi,[k(u)],512),e("div",Ni,[e("div",Ri,[e("ul",null,[(i(!0),o(A,null,P(t.tabDefinitions,(r,v)=>(i(),o("li",{key:v,class:T({"is-active":t.tab===r.tab}),onClick:S=>t.tab=r.tab},[e("a",null,w(r.title),1)],10,ji))),128)),e("li",null,[e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open Media widget",8,Li)])])]),t.inited&&t.tab==="commands"?(i(),E(n,{key:0,modelValue:t.commands,"onUpdate:modelValue":[s[0]||(s[0]=r=>t.commands=r),t.sendSave],globalVariables:t.globalVariables,possibleActions:t.possibleActions,baseVolume:t.baseVolume,showToggleImages:!0,showFilterActions:!0,showImages:t.adminSettings.showImages,onShowImagesChange:t.updateShowImages},null,8,["modelValue","onUpdate:modelValue","globalVariables","possibleActions","baseVolume","showImages","onShowImagesChange"])):h("",!0),t.inited&&t.tab==="settings"?(i(),o("div",qi,[t.settings?(i(),o("table",Ji,[e("tbody",null,[e("tr",null,[Bi,e("td",null,[k(c,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[1]||(s[1]=r=>t.settings.volume=r),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])]),Wi])])],512)):h("",!0)])):h("",!0)],512)])}var Ki=D(Fi,[["render",Hi]]);const Gi=U({created(){this.$me=R.getMe(),this.$conf=W.getConf()},data:()=>({$me:null,$conf:null,unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return`${location.protocol}//${location.host}/widget/speech-to-text/${this.$me.widgetToken}/`}},methods:{sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=new G(this.$conf.wsBase+"/speech-to-text",this.$me.token),this.ws.onMessage("init",t=>{this.settings=t.settings,this.defaultSettings=t.defaultSettings,this.unchangedJson=JSON.stringify(t.settings)}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Yi={id:"app"},Xi={id:"top",ref:"top"},Qi={id:"actionbar",class:"p-1"},Zi=["disabled"],xi=["href"],to={id:"main",ref:"main"},eo={key:0,class:"table is-striped",ref:"table"},so=e("tr",null,[e("td",{colspan:"3"},"General")],-1),no=e("td",null,[e("code",null,"settings.style.bgColor")],-1),io=["disabled"],oo=e("i",{class:"fa fa-remove"},null,-1),ao=[oo],lo=e("td",null,[e("code",null,"settings.style.vAlign")],-1),ro={class:"select is-small"},uo=e("option",{value:"top"},"top",-1),mo=e("option",{value:"bottom"},"bottom",-1),co=[uo,mo],ho=["disabled"],po=e("i",{class:"fa fa-remove"},null,-1),go=[po],fo=e("tr",null,[e("td",{colspan:"3"},"Recognition")],-1),vo=e("td",null,[e("code",null,"settings.recognition.lang")],-1),bo=["disabled"],_o=e("i",{class:"fa fa-remove"},null,-1),$o=[_o],yo=e("td",null,[e("code",null,"settings.recognition.synthesize")],-1),wo=["disabled"],ko=e("i",{class:"fa fa-remove"},null,-1),Co=[ko],Vo=e("td",null,[e("code",null,"settings.recognition.synthesizeLang")],-1),So=["disabled"],Io=e("i",{class:"fa fa-remove"},null,-1),Uo=[Io],Do=e("td",null,[e("code",null,"settings.recognition.display")],-1),Ao=["disabled"],Po=e("i",{class:"fa fa-remove"},null,-1),To=[Po],Eo=e("td",null,[e("code",null,"settings.styles.recognition.color")],-1),Mo=["disabled"],Fo=e("i",{class:"fa fa-remove"},null,-1),Oo=[Fo],zo=e("td",null,[e("code",null,"settings.styles.recognition.strokeWidth")],-1),No=["disabled"],Ro=e("i",{class:"fa fa-remove"},null,-1),jo=[Ro],Lo=e("td",null,[e("code",null,"settings.styles.recognition.strokeColor")],-1),qo=["disabled"],Jo=e("i",{class:"fa fa-remove"},null,-1),Bo=[Jo],Wo=e("td",null,[e("code",null,"settings.styles.recognition.fontFamily")],-1),Ho=["disabled"],Ko=e("i",{class:"fa fa-remove"},null,-1),Go=[Ko],Yo=e("td",null,[e("code",null,"settings.styles.recognition.fontSize")],-1),Xo=["disabled"],Qo=e("i",{class:"fa fa-remove"},null,-1),Zo=[Qo],xo=e("td",null,[e("code",null,"settings.styles.recognition.fontWeight")],-1),ta=["disabled"],ea=e("i",{class:"fa fa-remove"},null,-1),sa=[ea],na=e("tr",null,[e("td",{colspan:"3"},"Translation")],-1),ia=e("td",null,[e("code",null,"settings.translation.enabled")],-1),oa=["disabled"],aa=e("i",{class:"fa fa-remove"},null,-1),la=[aa],ra=e("td",null,[e("code",null,"settings.translation.synthesize")],-1),da=["disabled"],ua=e("i",{class:"fa fa-remove"},null,-1),ma=[ua],ca=e("td",null,[e("code",null,"settings.translation.synthesizeLang")],-1),ha=["disabled"],pa=e("i",{class:"fa fa-remove"},null,-1),ga=[pa],fa=e("td",null,[e("code",null,"settings.translation.langSrc")],-1),va=["disabled"],ba=e("i",{class:"fa fa-remove"},null,-1),_a=[ba],$a=e("td",null,[e("code",null,"settings.translation.langDst")],-1),ya=["disabled"],wa=e("i",{class:"fa fa-remove"},null,-1),ka=[wa],Ca=e("td",null,[e("code",null,"settings.styles.translation.color")],-1),Va=["disabled"],Sa=e("i",{class:"fa fa-remove"},null,-1),Ia=[Sa],Ua=e("td",null,[e("code",null,"settings.styles.translation.strokeWidth")],-1),Da=["disabled"],Aa=e("i",{class:"fa fa-remove"},null,-1),Pa=[Aa],Ta=e("td",null,[e("code",null,"settings.styles.translation.strokeColor")],-1),Ea=["disabled"],Ma=e("i",{class:"fa fa-remove"},null,-1),Fa=[Ma],Oa=e("td",null,[e("code",null,"settings.styles.translation.fontFamily")],-1),za=["disabled"],Na=e("i",{class:"fa fa-remove"},null,-1),Ra=[Na],ja=e("td",null,[e("code",null,"settings.styles.translation.fontSize")],-1),La=["disabled"],qa=e("i",{class:"fa fa-remove"},null,-1),Ja=[qa],Ba=e("td",null,[e("code",null,"settings.styles.translation.fontWeight")],-1),Wa=["disabled"],Ha=e("i",{class:"fa fa-remove"},null,-1),Ka=[Ha],Ga=e("tr",null,[e("td",{colspan:"3"},"Debug")],-1),Ya=e("td",null,[e("code",null,"settings.status.enabled")],-1),Xa=["disabled"],Qa=e("i",{class:"fa fa-remove"},null,-1),Za=[Qa];function xa(t,s,a,d,f,p){const u=$("navbar");return i(),o("div",Yi,[e("div",Xi,[k(u),e("div",Qi,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...n)=>t.sendSave&&t.sendSave(...n))}," Save ",8,Zi),e("a",{class:"button is-small",href:t.widgetUrl,target:"_blank"},"Open widget",8,xi)])],512),e("div",to,[t.settings?(i(),o("table",eo,[e("tbody",null,[so,e("tr",null,[no,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=n=>t.settings.styles.bgColor=n)},null,512),[[_,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=n=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},ao,8,io)])]),e("tr",null,[lo,e("td",null,[e("div",ro,[m(e("select",{"onUpdate:modelValue":s[3]||(s[3]=n=>t.settings.styles.vAlign=n)},co,512),[[tt,t.settings.styles.vAlign]])])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.vAlign===t.defaultSettings.styles.vAlign,onClick:s[4]||(s[4]=n=>t.settings.styles.vAlign=t.defaultSettings.styles.vAlign)},go,8,ho)])]),fo,e("tr",null,[vo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=n=>t.settings.recognition.lang=n)},null,512),[[_,t.settings.recognition.lang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.lang===t.defaultSettings.recognition.lang,onClick:s[6]||(s[6]=n=>t.settings.recognition.lang=t.defaultSettings.recognition.lang)},$o,8,bo)])]),e("tr",null,[yo,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=n=>t.settings.recognition.synthesize=n)},null,512),[[z,t.settings.recognition.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesize===t.defaultSettings.recognition.synthesize,onClick:s[8]||(s[8]=n=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},Co,8,wo)])]),e("tr",null,[Vo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=n=>t.settings.recognition.synthesizeLang=n)},null,512),[[_,t.settings.recognition.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesizeLang===t.defaultSettings.recognition.synthesizeLang,onClick:s[10]||(s[10]=n=>t.settings.recognition.synthesizeLang=t.defaultSettings.recognition.synthesizeLang)},Uo,8,So)])]),e("tr",null,[Do,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=n=>t.settings.recognition.display=n)},null,512),[[z,t.settings.recognition.display]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.display===t.defaultSettings.recognition.display,onClick:s[12]||(s[12]=n=>t.settings.recognition.display=t.defaultSettings.recognition.display)},To,8,Ao)])]),e("tr",null,[Eo,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[13]||(s[13]=n=>t.settings.styles.recognition.color=n)},null,512),[[_,t.settings.styles.recognition.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.color===t.defaultSettings.styles.recognition.color,onClick:s[14]||(s[14]=n=>t.settings.styles.recognition.color=t.defaultSettings.styles.recognition.color)},Oo,8,Mo)])]),e("tr",null,[zo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[15]||(s[15]=n=>t.settings.styles.recognition.strokeWidth=n)},null,512),[[_,t.settings.styles.recognition.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeWidth===t.defaultSettings.styles.recognition.strokeWidth,onClick:s[16]||(s[16]=n=>t.settings.styles.recognition.strokeWidth=t.defaultSettings.styles.recognition.strokeWidth)},jo,8,No)])]),e("tr",null,[Lo,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[17]||(s[17]=n=>t.settings.styles.recognition.strokeColor=n)},null,512),[[_,t.settings.styles.recognition.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeColor===t.defaultSettings.styles.recognition.strokeColor,onClick:s[18]||(s[18]=n=>t.settings.styles.recognition.strokeColor=t.defaultSettings.styles.recognition.strokeColor)},Bo,8,qo)])]),e("tr",null,[Wo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[19]||(s[19]=n=>t.settings.styles.recognition.fontFamily=n)},null,512),[[_,t.settings.styles.recognition.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontFamily===t.defaultSettings.styles.recognition.fontFamily,onClick:s[20]||(s[20]=n=>t.settings.styles.recognition.fontFamily=t.defaultSettings.styles.recognition.fontFamily)},Go,8,Ho)])]),e("tr",null,[Yo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[21]||(s[21]=n=>t.settings.styles.recognition.fontSize=n)},null,512),[[_,t.settings.styles.recognition.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontSize===t.defaultSettings.styles.recognition.fontSize,onClick:s[22]||(s[22]=n=>t.settings.styles.recognition.fontSize=t.defaultSettings.styles.recognition.fontSize)},Zo,8,Xo)])]),e("tr",null,[xo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[23]||(s[23]=n=>t.settings.styles.recognition.fontWeight=n)},null,512),[[_,t.settings.styles.recognition.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontWeight===t.defaultSettings.styles.recognition.fontWeight,onClick:s[24]||(s[24]=n=>t.settings.styles.weight=t.defaultSettings.styles.weight)},sa,8,ta)])]),na,e("tr",null,[ia,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=n=>t.settings.translation.enabled=n)},null,512),[[z,t.settings.translation.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.enabled===t.defaultSettings.translation.enabled,onClick:s[26]||(s[26]=n=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},la,8,oa)])]),e("tr",null,[ra,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=n=>t.settings.translation.synthesize=n)},null,512),[[z,t.settings.translation.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesize===t.defaultSettings.translation.synthesize,onClick:s[28]||(s[28]=n=>t.settings.translation.synthesize=t.defaultSettings.translation.synthesize)},ma,8,da)])]),e("tr",null,[ca,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[29]||(s[29]=n=>t.settings.translation.synthesizeLang=n)},null,512),[[_,t.settings.translation.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesizeLang===t.defaultSettings.translation.synthesizeLang,onClick:s[30]||(s[30]=n=>t.settings.translation.synthesizeLang=t.defaultSettings.translation.synthesizeLang)},ga,8,ha)])]),e("tr",null,[fa,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[31]||(s[31]=n=>t.settings.translation.langSrc=n)},null,512),[[_,t.settings.translation.langSrc]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langSrc===t.defaultSettings.translation.langSrc,onClick:s[32]||(s[32]=n=>t.settings.translation.langSrc=t.defaultSettings.translation.langSrc)},_a,8,va)])]),e("tr",null,[$a,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[33]||(s[33]=n=>t.settings.translation.langDst=n)},null,512),[[_,t.settings.translation.langDst]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langDst===t.defaultSettings.translation.langDst,onClick:s[34]||(s[34]=n=>t.settings.translation.langDst=t.defaultSettings.translation.langDst)},ka,8,ya)])]),e("tr",null,[Ca,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[35]||(s[35]=n=>t.settings.styles.translation.color=n)},null,512),[[_,t.settings.styles.translation.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.color===t.defaultSettings.styles.translation.color,onClick:s[36]||(s[36]=n=>t.settings.styles.translation.color=t.defaultSettings.styles.translation.color)},Ia,8,Va)])]),e("tr",null,[Ua,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[37]||(s[37]=n=>t.settings.styles.translation.strokeWidth=n)},null,512),[[_,t.settings.styles.translation.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeWidth===t.defaultSettings.styles.translation.strokeWidth,onClick:s[38]||(s[38]=n=>t.settings.styles.translation.strokeWidth=t.defaultSettings.styles.translation.strokeWidth)},Pa,8,Da)])]),e("tr",null,[Ta,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[39]||(s[39]=n=>t.settings.styles.translation.strokeColor=n)},null,512),[[_,t.settings.styles.translation.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeColor===t.defaultSettings.styles.translation.strokeColor,onClick:s[40]||(s[40]=n=>t.settings.styles.translation.strokeColor=t.defaultSettings.styles.translation.strokeColor)},Fa,8,Ea)])]),e("tr",null,[Oa,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[41]||(s[41]=n=>t.settings.styles.translation.fontFamily=n)},null,512),[[_,t.settings.styles.translation.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontFamily===t.defaultSettings.styles.translation.fontFamily,onClick:s[42]||(s[42]=n=>t.settings.styles.translation.fontFamily=t.defaultSettings.styles.translation.fontFamily)},Ra,8,za)])]),e("tr",null,[ja,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[43]||(s[43]=n=>t.settings.styles.translation.fontSize=n)},null,512),[[_,t.settings.styles.translation.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontSize===t.defaultSettings.styles.translation.fontSize,onClick:s[44]||(s[44]=n=>t.settings.styles.translation.fontSize=t.defaultSettings.styles.translation.fontSize)},Ja,8,La)])]),e("tr",null,[Ba,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[45]||(s[45]=n=>t.settings.styles.translation.fontWeight=n)},null,512),[[_,t.settings.styles.translation.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontWeight===t.defaultSettings.styles.translation.fontWeight,onClick:s[46]||(s[46]=n=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Ka,8,Wa)])]),Ga,e("tr",null,[Ya,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[47]||(s[47]=n=>t.settings.status.enabled=n)},null,512),[[z,t.settings.status.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.status.enabled===t.defaultSettings.status.enabled,onClick:s[48]||(s[48]=n=>t.settings.status.enabled=t.defaultSettings.status.enabled)},Za,8,Xa)])])])],512)):h("",!0)],512)])}var tl=D(Gi,[["render",xa]]);const el=1,X=1e3*el,Q=60*X,Z=60*Q,x=24*Z,mt=t=>{if(t==="")throw new Error("unable to parse duration");const s=`${t}`.trim();if(!s)throw new Error("unable to parse duration");if(s.match(/^\d+$/))return parseInt(s,10);const a=s.match(/^((?:\d*)\.(?:\d*))(d|h|m|s)$/);if(a){const r=parseFloat(a[1]);if(isNaN(r))throw new Error("unable to parse duration");const v=a[2];let S=0;return v==="d"?S=r*x:v==="h"?S=r*Z:v==="m"?S=r*Q:v==="s"&&(S=r*X),Math.round(S)}const d=s.match(/^(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!d)throw new Error("unable to parse duration");const f=d[1]?parseInt(d[1],10):0,p=d[2]?parseInt(d[2],10):0,u=d[3]?parseInt(d[3],10):0,n=d[4]?parseInt(d[4],10):0,c=d[5]?parseInt(d[5],10):0;return n*X+u*Q+p*Z+f*x+c},sl=t=>{try{return mt(t)}catch{return 0}},nl=t=>{let s=t;const a=Math.floor(s/x);s=s%x;const d=Math.floor(s/Z);s=s%Z;const f=Math.floor(s/Q);s=s%Q;const p=Math.floor(s/X);s=s%X;const u=s,n=["ms","s","m","h","d"],c=[u,p,f,d,a];let r=0;for(;r<c.length&&c[r]===0;)r++;let v=c.length-1;for(;v>=0&&c[v]===0;)v--;const S=[];for(let l=r;l<=v;l++)S.unshift(`${c[l]}${n[l]}`);return S.join(" ")};function il(t,s,a){if(a>=t.length)for(var d=a-t.length+1;d--;)t.push(void 0);return t.splice(a,0,t.splice(s,1)[0]),t}const ol=(t,s)=>{const a=[{regex:/\$args\((\d*)(:?)(\d*)\)/g,replacer:(p,u)=>s},{regex:/\$rand\((\d+),(\d+)\)/g,replacer:(p,u,n)=>s},{regex:/\$var\(([^)]+)\)/g,replacer:(p,u)=>s},{regex:/\$user\.name/g,replacer:()=>s},{regex:/\$([a-z][a-z0-9]*)(?!\()/g,replacer:(p,u)=>p},{regex:/\$customapi\(([^$\)]*)\)\[\'([A-Za-z0-9_ -]+)\'\]/g,replacer:(p,u,n)=>s},{regex:/\$customapi\(([^$\)]*)\)/g,replacer:(p,u)=>s},{regex:/\$urlencode\(([^$\)]*)\)/g,replacer:(p,u)=>s},{regex:/\$calc\((\d+)([*/+-])(\d+)\)/g,replacer:(p,u,n,c)=>s}];let d=t,f;do{f=d;for(let p of a)d=d.replace(p.regex,p.replacer)}while(f!==d);return d},al=(t,s=",",a=-1)=>{const d=t.split(s);return a===-1||d.length<=a?d:[...d.slice(0,a-1),d.slice(a-1).join(s)]},ll=t=>{let s=t.length;for(;s>0;){let a=Math.floor(Math.random()*s);s--;let d=t[s];t[s]=t[a],t[a]=d}return t};var L={arrayMove:il,humanDuration:nl,parseHumanDuration:sl,mustParseHumanDuration:mt,doDummyReplacements:ol,split:al,shuffle:ll};const rl=U({data:()=>({editIdx:-1,editEntity:null,unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null,tab:"avatars",$me:null,$conf:null}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},controlWidgetUrl(){return`${location.protocol}//${location.host}/widget/avatar/${this.$me.widgetToken}/`},displayWidgetUrl(){return`${location.protocol}//${location.host}/widget/avatar_receive/${this.$me.widgetToken}/`}},methods:{edit(t){if(!this.settings){console.warn("edit: this.settings not initialized");return}this.editIdx=t,this.editEntity=this.settings.avatarDefinitions[t]},remove(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.avatarDefinitions=this.settings.avatarDefinitions.filter((s,a)=>a!==t),this.sendSave()},duplicate(t){if(!this.settings){console.warn("duplicate: this.settings not initialized");return}this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=JSON.parse(JSON.stringify(this.settings.avatarDefinitions[t]))},updatedAvatar(t){if(!this.settings){console.warn("updateAvatar: this.settings not initialized");return}this.settings.avatarDefinitions[this.editIdx]=t,this.sendSave()},addAvatar(){if(!this.settings){console.warn("addAvatar: this.settings not initialized");return}const t={name:"Unnamed Avatar",stateDefinitions:[{value:"default",deletable:!1},{value:"speaking",deletable:!1}],slotDefinitions:[]};this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=t},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},dragEnd(t){if(!this.settings){console.warn("dragEnd: this.settings not initialized");return}this.settings.avatarDefinitions=L.arrayMove(this.settings.avatarDefinitions,t.oldIndex,t.newIndex),this.sendSave()}},created(){this.$me=R.getMe(),this.$conf=W.getConf()},async mounted(){this.ws=new G(this.$conf.wsBase+"/avatar",this.$me.token),this.ws.onMessage("init",t=>{this.settings=t.settings,this.defaultSettings=t.defaultSettings,this.unchangedJson=JSON.stringify(t.settings)}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),dl={id:"app"},ul={id:"top",ref:"top"},ml={id:"actionbar",class:"p-1"},cl=["href"],hl=["href"],pl={key:0,id:"main",ref:"main"},gl={class:"tabs"},fl=e("a",null,"Avatars",-1),vl=[fl],bl=e("a",null,"Settings",-1),_l=[bl],$l={key:0,class:"table is-striped"},yl=e("tr",null,[e("td",{colspan:"3"},"General")],-1),wl=e("td",null,[e("code",null,"settings.style.bgColor")],-1),kl=["disabled"],Cl=e("i",{class:"fa fa-remove"},null,-1),Vl=[Cl],Sl={key:1},Il={class:"table is-striped"},Ul=e("thead",null,[e("tr",null,[e("th"),e("th"),e("th",null,"Preview"),e("th",null,"Name"),e("th")])],-1),Dl=e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1),Al={class:"pl-0 pr-0"},Pl=["onClick"],Tl=e("i",{class:"fa fa-pencil"},null,-1),El=[Tl],Ml={class:"pl-0 pr-0"},Fl=e("i",{class:"fa fa-trash"},null,-1),Ol=["onClick"],zl=e("i",{class:"fa fa-clone"},null,-1),Nl=[zl];function Rl(t,s,a,d,f,p){const u=$("navbar"),n=$("avatar-preview"),c=$("doubleclick-button"),r=$("draggable"),v=$("avatar-editor");return i(),o("div",dl,[e("div",ul,[k(u),e("div",ml,[e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open control widget",8,cl),e("a",{class:"button is-small mr-1",href:t.displayWidgetUrl,target:"_blank"},"Open display widget",8,hl)])],512),t.settings?(i(),o("div",pl,[e("div",gl,[e("ul",null,[e("li",{class:T({"is-active":t.tab==="avatars"}),onClick:s[0]||(s[0]=S=>t.tab="avatars")},vl,2),e("li",{class:T({"is-active":t.tab==="settings"}),onClick:s[1]||(s[1]=S=>t.tab="settings")},_l,2)])]),t.tab==="settings"?(i(),o("table",$l,[e("tbody",null,[yl,e("tr",null,[wl,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":[s[2]||(s[2]=S=>t.settings.styles.bgColor=S),s[3]||(s[3]=(...S)=>t.sendSave&&t.sendSave(...S))]},null,512),[[_,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[4]||(s[4]=S=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},Vl,8,kl)])])])])):h("",!0),t.tab==="avatars"?(i(),o("div",Sl,[e("table",Il,[Ul,k(r,{modelValue:t.settings.avatarDefinitions,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:N(({element:S,index:l})=>[e("tr",null,[Dl,e("td",Al,[e("button",{class:"button is-small",onClick:b=>t.edit(l)},El,8,Pl)]),e("td",null,[k(n,{avatar:S},null,8,["avatar"])]),e("td",null,w(S.name),1),e("td",Ml,[k(c,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:b=>t.remove(l)},{default:N(()=>[Fl]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:b=>t.duplicate(l)},Nl,8,Ol)])])]),_:1},8,["modelValue","onEnd"])]),t.editEntity?(i(),E(v,{key:0,modelValue:t.editEntity,"onUpdate:modelValue":t.updatedAvatar,onCancel:s[5]||(s[5]=S=>t.editEntity=null)},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),e("span",{class:"button is-small",onClick:s[6]||(s[6]=(...S)=>t.addAvatar&&t.addAvatar(...S))},"Add avatar")])):h("",!0)],512)):h("",!0)])}var jl=D(rl,[["render",Rl]]);const Ll=U({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const s=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const a=await fetch("/api/user/_reset_password",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({pass:this.pass,token:s})});if(a.status===200)this.success=!0;else try{this.error=(await a.json()).reason}catch{this.error="Unknown error"}}}}),ql={class:"center-screen"},Jl=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Bl={key:0,class:"field has-background-success-light has-text-success-dark"},Wl=g(" Password successfully set. Click "),Hl=g("here"),Kl=g(" to login. "),Gl={key:1},Yl={key:0,class:"field has-background-danger-light has-text-danger-dark"},Xl={class:"field"},Ql={class:"control has-icons-left"},Zl=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),xl={class:"field"},tr=["disabled"];function er(t,s,a,d,f,p){const u=$("router-link");return i(),o("div",ql,[Jl,t.success?(i(),o("div",Bl,[Wl,k(u,{to:{name:"login"}},{default:N(()=>[Hl]),_:1}),Kl])):(i(),o("div",Gl,[t.error?(i(),o("div",Yl,w(t.error),1)):h("",!0),e("div",Xl,[e("div",Ql,[m(e("input",{class:"input is-small",type:"password",placeholder:"New Password","onUpdate:modelValue":s[0]||(s[0]=n=>t.pass=n),onKeyup:[s[1]||(s[1]=n=>t.error=""),s[2]||(s[2]=q((...n)=>t.submit&&t.submit(...n),["enter"]))]},null,544),[[_,t.pass]]),Zl])]),e("div",xl,[e("button",{class:"button is-small is-primary",disabled:t.canSubmit?null:!0,onClick:s[3]||(s[3]=(...n)=>t.submit&&t.submit(...n))}," Save Password ",8,tr)])]))])}var sr=D(Ll,[["render",er]]);const nr=U({data:()=>({email:"",error:"",success:!1}),methods:{async submit(){this.success=!1,this.error="";const t=await fetch("/api/user/_request_password_reset",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.email})});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),ir={class:"center-screen"},or=e("h1",{class:"title is-6"},"Hyottoko.club",-1),ar={key:0,class:"field has-background-success-light has-text-success-dark"},lr=g(" Password-reset mail sent. Click "),rr=g("here"),dr=g(" to login. "),ur={key:1},mr={key:0,class:"field has-background-danger-light has-text-danger-dark"},cr={class:"field"},hr={class:"control has-icons-left"},pr=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),gr={class:"field"};function fr(t,s,a,d,f,p){const u=$("router-link");return i(),o("div",ir,[or,t.success?(i(),o("div",ar,[lr,k(u,{to:{name:"login"}},{default:N(()=>[rr]),_:1}),dr])):(i(),o("form",ur,[t.error?(i(),o("div",mr,w(t.error),1)):h("",!0),e("div",cr,[e("div",hr,[m(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":s[0]||(s[0]=n=>t.email=n),onKeyup:s[1]||(s[1]=n=>t.error="")},null,544),[[_,t.email]]),pr])]),e("div",gr,[e("span",{class:"button is-small is-primary",onClick:s[2]||(s[2]=(...n)=>t.submit&&t.submit(...n))},"Request Password Reset")])]))])}var vr=D(nr,[["render",fr]]);const br=U({name:"upload",props:{accept:String,label:{type:String,default:"Upload File"}},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?` Uploading (${this.uploadPercent}%)`:this.label?` ${this.label}`:""},progressStyle(){if(!this.uploading)return{};const t=this.uploadPercent,s="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${s} 0%, ${s} ${t}%, transparent ${t}%)`}}},methods:{async upload(t){const s=t.target.files[0];if(!s)return;this.uploading=!0;const a=new FormData;a.append("file",s,s.name);const d=await nt.post("/api/upload",{body:a,onUploadProgress:p=>{this.progress=p.loaded/p.total}});this.uploading=!1;const f=await d.json();this.$emit("uploaded",f)}}}),_r={class:"upload"},$r=["disabled","accept"],yr={class:"button is-small"};function wr(t,s,a,d,f,p){return i(),o("label",_r,[e("input",{type:"file",disabled:t.uploading,style:{display:"none"},onChange:s[0]||(s[0]=(...u)=>t.upload&&t.upload(...u)),accept:t.accept},null,40,$r),e("span",yr,[e("i",{class:T(["fa fa-upload",{"mr-1":t.buttonText}])},null,2),g(w(t.buttonText),1)]),e("span",{class:"progress",style:J(t.progressStyle)},null,4)])}var kr=D(br,[["render",wr],["__scopeId","data-v-4e5c4b12"]]);const Cr=U({props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(t){try{const s=L.doDummyReplacements(t,"0");L.mustParseHumanDuration(s),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",t)}},modelValue:{handler(t){this.v=`${t}`}}}});function Vr(t,s,a,d,f,p){return m((i(),o("input",{class:T(["input is-small spaceinput",t.classes]),"onUpdate:modelValue":s[0]||(s[0]=u=>t.v=u)},null,2)),[[_,t.v]])}var Sr=D(Cr,[["render",Vr]]);const Ir=U({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const t=parseInt(`${this.baseVolume}`,10)/100,s=parseInt(`${this.volume}`,10)/100;this.audio.volume=t*s,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio("/uploads/"+this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function Ur(t,s,a,d,f,p){return t.src?(i(),o("span",{key:0,class:"player",onClick:s[0]||(s[0]=(...u)=>t.toggle&&t.toggle(...u))},[g(w(t.name)+" ",1),e("i",{class:T(["fa ml-1",t.cls])},null,2)])):h("",!0)}var Dr=D(Ir,[["render",Ur]]);const Ar=U({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),Pr={class:"columns"},Tr={class:"column is-four-fifth"},Er={class:"control has-icons-left has-icons-right range slider"},Mr=["min","max"],Fr={class:"icon is-small is-left"},Or={class:"icon is-small is-right"},zr={class:"column is-one-fifth"};function Nr(t,s,a,d,f,p){return i(),o("div",Pr,[e("div",Tr,[e("div",Er,[m(e("input",{type:"range",class:"input is-small",min:t.min,max:t.max,"onUpdate:modelValue":[s[0]||(s[0]=u=>t.curVal=u),s[1]||(s[1]=(...u)=>t.valChange&&t.valChange(...u))]},null,8,Mr),[[_,t.curVal]]),e("span",Fr,[e("i",{class:T(["fa",t.iconLeft])},null,2)]),e("span",Or,[e("i",{class:T(["fa",t.iconRight])},null,2)])])]),e("div",zr,[m(e("input",{type:"number",class:"input is-small","onUpdate:modelValue":[s[2]||(s[2]=u=>t.curVal=u),s[3]||(s[3]=(...u)=>t.valChange&&t.valChange(...u))]},null,512),[[_,t.curVal]])])])}var Rr=D(Ar,[["render",Nr],["__scopeId","data-v-0799d56c"]]);const jr=U({name:"volume-slider",props:{modelValue:{required:!0}},data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",this.volume)}},created(){this.volume=parseInt(this.modelValue,10)}});function Lr(t,s,a,d,f,p){const u=$("slider");return i(),E(u,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:t.volume,"onUpdate:modelValue":[s[0]||(s[0]=n=>t.volume=n),t.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var qr=D(jr,[["render",Lr]]);const Jr=U({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(/uploads/${encodeURIComponent(this.src)})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),Br=["title"];function Wr(t,s,a,d,f,p){return i(),o("div",{class:"responsive-image",style:J(t.style),title:t.title},null,12,Br)}var Hr=D(Jr,[["render",Wr]]),Kr="/assets/hyottoko.30d2bcb9.png";const Gr=U({name:"navbar",computed:{user(){var t,s;return((s=(t=this.$me)==null?void 0:t.user)==null?void 0:s.name)||""}},created(){this.$me=R.getMe()},data:()=>({$me:null,linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"avatar"},text:"Avatar"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"settings"},text:"Settings"}],burgerActive:!1}),methods:{toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){const t=await R.logout();if(t.error)throw new Error(t.error);this.$router.push({name:"login"})}}}),Yr={class:"navbar",role:"navigation","aria-label":"main navigation"},Xr={class:"navbar-brand"},Qr=e("img",{src:Kr,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),Zr={class:"greeting"},xr=e("span",{"aria-hidden":"true"},null,-1),td=e("span",{"aria-hidden":"true"},null,-1),ed=e("span",{"aria-hidden":"true"},null,-1),sd=[xr,td,ed],nd={class:"navbar-start"},id={class:"navbar-end"};function od(t,s,a,d,f,p){const u=$("router-link");return i(),o("nav",Yr,[e("div",Xr,[k(u,{class:"navbar-item",to:{name:"index"}},{default:N(()=>[Qr,e("span",Zr,"Welcome back, "+w(t.user),1)]),_:1}),e("a",{role:"button",class:T(["navbar-burger",{"is-active":t.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:s[0]||(s[0]=(...n)=>t.toggleBurgerMenu&&t.toggleBurgerMenu(...n))},sd,2)]),e("div",{id:"navbarBasicExample",class:T(["navbar-menu",{"is-active":t.burgerActive}])},[e("div",nd,[(i(!0),o(A,null,P(t.linksStart,(n,c)=>(i(),E(u,{class:"navbar-item",key:c,to:n.to},{default:N(()=>[g(w(n.text),1)]),_:2},1032,["to"]))),128))]),e("div",id,[e("a",{class:"navbar-item",onClick:s[1]||(s[1]=(...n)=>t.onLogoutClick&&t.onLogoutClick(...n))},"Logout")])],2)])}var ad=D(Gr,[["render",od]]);const ld=U({props:{value:{required:!0}},computed:{tag(){try{return L.mustParseHumanDuration(this.value),"span"}catch{return"code"}},humanReadable(){try{return L.humanDuration(L.mustParseHumanDuration(this.value))}catch{return this.value}}}}),rd={key:0},dd={key:1};function ud(t,s,a,d,f,p){return t.tag==="span"?(i(),o("span",rd,w(t.humanReadable),1)):(i(),o("code",dd,w(t.humanReadable),1))}var md=D(ld,[["render",ud]]);const cd=U({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(t){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time-=10,this.time<=0&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),hd={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function pd(t,s,a,d,f,p){return i(),o("button",{class:"doubleclick-button",onClick:s[0]||(s[0]=(...u)=>t.onClick&&t.onClick(...u))},[bt(t.$slots,"default",{},void 0,!0),t.timer?(i(),o("span",hd,[g(w(t.message)+" ",1),e("span",{class:"doubleclick-button-timout-indicator",style:J(t.indicatorStyle)},null,4)])):h("",!0)])}var gd=D(cd,[["render",pd],["__scopeId","data-v-72e9e0bd"]]);const B=(...t)=>console.log("[youtube.js]",...t);let ct=!1;function fd(){return ct?(B("ytapi ALREADY ready"),Promise.resolve()):new Promise(t=>{const s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",document.head.append(s),window.onYouTubeIframeAPIReady=()=>{ct=!0,B("ytapi ready"),t()}})}function vd(t){return new Promise(s=>{B("create player on "+t);const a=new YT.Player(t,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{B("player ready"),s(a)}}})})}async function bd(t){return await fd(),await vd(t)}const _d=U({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const t=this.getDuration(),s=this.getCurrentTime();return t?s/t:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let t=20;this.tryPlayInterval=setInterval(()=>{if(B("playing",this.playing(),"triesRemaining",t),--t,this.playing()||t<0){B("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(t){this.yt?(this.yt.cueVideoById(t),this.tryPlay()):this.toplay=t},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(t){this.yt?this.yt.setVolume(t):this.tovolume=t},setLoop(t){this.loop=t},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await bd(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(B("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",t=>{t.data===YT.PlayerState.CUED?this.tryPlay():t.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),$d=["id"];function yd(t,s,a,d,f,p){return i(),o("div",{id:t.id},null,8,$d)}var wd=D(_d,[["render",yd]]);const F=["mod","broadcaster"],it=()=>"",ht=()=>({sound:{filename:"",file:"",volume:100},image:{filename:"",file:""},minDurationMs:"1s"}),kd=()=>({steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}),pt=t=>({type:t,data:{command:"",commandExact:!1,minInterval:0,minLines:0}}),I=(t="",s=!1)=>{const a=pt("command");return a.data.command=t,a.data.commandExact=s,a},ot={dict_lookup:"Outputs the translation for the searched word.",madochan_createword:"Creates a word for a definition.",chatters:"Outputs the people who chatted during the stream.",media:"Display an image and/or play a sound",media_volume:`Sets the media volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
  <br />
  If no argument is given, just outputs the current volume`,countdown:"Add a countdown or messages spaced by time intervals",text:"Send a message to chat",sr_current:"Show what song is currently playing",sr_undo:"Remove the song that was last added by oneself.",sr_good:"Vote the current song up",sr_bad:"Vote the current song down",sr_stats:"Show stats about the playlist",sr_prev:"Skip to the previous song",sr_next:"Skip to the next song",sr_jumptonew:"Jump to the next unplayed song",sr_clear:"Clear the playlist",sr_rm:"Remove the current song from the playlist",sr_shuffle:`Shuffle the playlist (current song unaffected).
    <br />
    Non-played and played songs will be shuffled separately and non-played
    songs will be put after currently playing song.`,sr_reset_stats:"Reset all statistics of all songs",sr_loop:"Loop the current song",sr_noloop:"Stop looping the current song",sr_pause:"Pause currently playing song",sr_unpause:"Unpause currently paused song",sr_hidevideo:"Hide video for current song",sr_showvideo:"Show video for current song",sr_request:`
  Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
  at youtube (by id or by title)
  and queue the first result in the playlist (after the first found
  batch of unplayed songs).`,sr_re_request:`
  Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
  in the current playlist and queue the first result in the playlist
  (after the first found batch of unplayed songs).`,sr_addtag:"Add tag <code>&lt;TAG&gt;</code> (argument to this command) to the current song",sr_rmtag:"Remove tag <code>&lt;TAG&gt;</code> (argument to this command) from the current song",sr_volume:`Sets the song request volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
  <br />
  If no argument is given, just outputs the current volume`,sr_filter:`Play only songs with the given tag <code>&lt;TAG&gt;</code> (argument to this command). If no tag
  is given, play all songs.`,sr_preset:`Switches to the preset <code>&lt;PRESET&gt;</code> (argument to this command) if it exists.
  If no arguments are given, outputs all available presets.`},gt={dict_lookup:"dictionary lookup",madochan_createword:"madochan",chatters:"chatters command",media:"media command",media_volume:"media volume command",countdown:"countdown",text:"command",sr_current:"sr_current",sr_undo:"sr_undo",sr_good:"sr_good",sr_bad:"sr_bad",sr_stats:"sr_stats",sr_prev:"sr_prev",sr_next:"sr_next",sr_jumptonew:"sr_jumptonew",sr_clear:"sr_clear",sr_rm:"sr_rm",sr_shuffle:"sr_shuffle",sr_reset_stats:"sr_reset_stats",sr_loop:"sr_loop",sr_noloop:"sr_noloop",sr_pause:"sr_pause",sr_unpause:"sr_unpause",sr_hidevideo:"sr_hidevideo",sr_showvideo:"sr_showvideo",sr_request:"sr_request",sr_re_request:"sr_re_request",sr_addtag:"sr_addtag",sr_rmtag:"sr_rmtag",sr_volume:"sr_volume",sr_filter:"sr_filter",sr_preset:"sr_preset"},Cd=t=>{switch(t){case"text":return{triggers:[I()],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[it()]}};case"media":return{triggers:[I()],action:"media",restrict_to:[],variables:[],variableChanges:[],data:ht()};case"media_volume":return{triggers:[I()],action:"media_volume",restrict_to:F,variables:[],variableChanges:[],data:{}};case"countdown":return{triggers:[I()],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:kd()};case"dict_lookup":return{triggers:[I()],action:"dict_lookup",restrict_to:[],variables:[],variableChanges:[],data:{lang:"ja",phrase:""}};case"madochan_createword":return{triggers:[I()],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}};case"chatters":return{triggers:[I()],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_current":return{action:"sr_current",triggers:[I("!sr current",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_undo":return{action:"sr_undo",triggers:[I("!sr undo",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_good":return{action:"sr_good",triggers:[I("!sr good",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_bad":return{action:"sr_bad",triggers:[I("!sr bad",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_stats":return{action:"sr_stats",triggers:[I("!sr stats",!0),I("!sr stat",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_prev":return{action:"sr_prev",triggers:[I("!sr prev",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_next":return{action:"sr_next",triggers:[I("!sr next",!0),I("!sr skip",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_jumptonew":return{action:"sr_jumptonew",triggers:[I("!sr jumptonew",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_clear":return{action:"sr_clear",triggers:[I("!sr clear",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_rm":return{action:"sr_rm",triggers:[I("!sr rm",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_shuffle":return{action:"sr_shuffle",triggers:[I("!sr shuffle",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_reset_stats":return{action:"sr_reset_stats",triggers:[I("!sr resetStats",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_loop":return{action:"sr_loop",triggers:[I("!sr loop",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_noloop":return{action:"sr_noloop",triggers:[I("!sr noloop",!0),I("!sr unloop",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_pause":return{action:"sr_pause",triggers:[I("!sr pause",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_unpause":return{action:"sr_unpause",triggers:[I("!sr nopause",!0),I("!sr unpause",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_hidevideo":return{action:"sr_hidevideo",triggers:[I("!sr hidevideo",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_showvideo":return{action:"sr_showvideo",triggers:[I("!sr showvideo",!0)],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_request":return{action:"sr_request",triggers:[I("!sr")],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_re_request":return{action:"sr_re_request",triggers:[I("!resr")],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_addtag":return{action:"sr_addtag",triggers:[I("!sr tag"),I("!sr addtag")],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_rmtag":return{action:"sr_rmtag",triggers:[I("!sr rmtag")],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_volume":return{action:"sr_volume",triggers:[I("!sr volume")],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_filter":return{action:"sr_filter",triggers:[I("!sr filter")],restrict_to:F,variables:[],variableChanges:[],data:{}};case"sr_preset":return{action:"sr_preset",triggers:[I("!sr preset")],restrict_to:F,variables:[],variableChanges:[],data:{}};default:return null}};const Vd=U({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},baseVolume:{default:100}},emits:["update:modelValue","cancel"],data:()=>({item:null,newtrigger:"command",variableChangeFocusIdx:-1,dictLangs:[{value:"ja",flag:"\u{1F1EF}\u{1F1F5}",title:"Japanese"},{value:"ru",flag:"\u{1F1F7}\u{1F1FA}",title:"Russian"},{value:"de",flag:"\u{1F1E9}\u{1F1EA}",title:"German"},{value:"es",flag:"\u{1F1EA}\u{1F1F8}",title:"Spanish"},{value:"fr",flag:"\u{1F1EB}\u{1F1F7}",title:"French"},{value:"it",flag:"\u{1F1EE}\u{1F1F9}",title:"Italian"},{value:"pt",flag:"\u{1F1F5}\u{1F1F9}/\u{1F1E7}\u{1F1F7}",title:"Portuguese"}]}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(t){this.item=JSON.parse(JSON.stringify(t))}}},methods:{addtxt(){if(!this.item){console.warn("addtxt: this.item not initialized");return}this.item.data.text.push(it())},addtrigger(){if(!this.item){console.warn("addtrigger: this.item not initialized");return}this.item.triggers.push(pt(this.newtrigger))},onAddVariableChange(){if(!this.item){console.warn("onAddVariableChange: this.item not initialized");return}this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(t){if(!this.item){console.warn("rmVariableChange: this.item not initialized");return}this.item.variableChanges=this.item.variableChanges.filter((s,a)=>a!==t)},onAddVariable(){if(!this.item){console.warn("onAddVariable: this.item not initialized");return}this.item.variables.push({name:"",value:""})},rmVariable(t){if(!this.item){console.warn("rmVariable: this.item not initialized");return}this.item.variables=this.item.variables.filter((s,a)=>a!==t)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndUploaded(t){if(!this.item){console.warn("mediaSndUploaded: this.item not initialized");return}this.item.data.sound.filename=t.originalname,this.item.data.sound.file=t.filename},mediaImgUploaded(t){if(!this.item){console.warn("mediaImgUploaded: this.item not initialized");return}this.item.data.image.filename=t.originalname,this.item.data.image.file=t.filename},rmtxt(t){if(!this.item){console.warn("rmtxt: this.item not initialized");return}this.item.data.text=this.item.data.text.filter((s,a)=>a!==t)},rmtrigger(t){if(!this.item){console.warn("rmtrigger: this.item not initialized");return}this.item.triggers=this.item.triggers.filter((s,a)=>a!==t)},autocompletableVariables(t){if(!this.item){console.warn("autocompletableVariables: this.item not initialized");return}const s=this.item.variables.slice().map(a=>({var:a,type:"local"}));return this.globalVariables.forEach(a=>{s.find(d=>d.var.name===a.name)||s.push({var:a,type:"global"})}),s.filter(a=>a.var.name.startsWith(t)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{valid(){if(!this.item)return!1;for(const t of this.item.triggers)if(t.type==="command"){if(!t.data.command)return!1}else if(t.type==="timer"){try{L.mustParseHumanDuration(t.data.minInterval)}catch{return!1}const s=parseInt(`${t.data.minLines}`,10);if(isNaN(s))return!1}if(this.item.action==="text"){for(const t of this.item.data.text)if(t==="")return!1}return!0},actionDescriptions(){return ot},title(){return this.item?`${{create:"Create new ",edit:"Edit "}[this.mode]}${gt[this.item.action]}`:""}}}),C=t=>(H("data-v-fad4890a"),t=t(),K(),t),Sd={key:0,class:"modal is-active"},Id={class:"modal-card"},Ud={class:"modal-card-head"},Dd={class:"modal-card-title"},Ad={class:"modal-card-body"},Pd={class:"table is-striped"},Td=C(()=>e("td",null,"Triggers:",-1)),Ed={class:"field has-addons mr-1"},Md={class:"control has-icons-left"},Fd={key:0,class:"select is-small"},Od=C(()=>e("option",{value:"command"},"Command",-1)),zd=C(()=>e("option",{value:"reward_redemption"}," Reward Redemption ",-1)),Nd=C(()=>e("option",{value:"timer"},"Timer",-1)),Rd=[Od,zd,Nd],jd=C(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),Ld=g(" Add "),qd=[jd,Ld],Jd={key:0},Bd=C(()=>e("td",null,"Description:",-1)),Wd=["innerHTML"],Hd={key:1},Kd=C(()=>e("td",null,"Language:",-1)),Gd=["onClick","title"],Yd=C(()=>e("code",null,"$args(0)",-1)),Xd=[Yd],Qd={key:2},Zd=C(()=>e("td",null,"Phrase:",-1)),xd=C(()=>e("code",null,"$args(1:)",-1)),tu=[xd],eu={key:3},su=C(()=>e("td",null,"Response:",-1)),nu=C(()=>e("td",null,[e("div",{class:"help"},[g(" Outputs the translation for the input phrase. The translation is always from/to english. "),e("br"),g(" To let the user decide on the language use "),e("code",null,"$args(0)"),g(" as language, and "),e("code",null,"$args(1:)"),g(" as phrase. "),e("br"),g(" If phrase is left empty, all arguments to the command will be used as the phrase. ")])],-1)),iu=[su,nu],ou={key:4},au=C(()=>e("td",null,"Response:",-1)),lu=C(()=>e("td",null,"Creates a word for a definition.",-1)),ru=[au,lu],du={key:5},uu=C(()=>e("td",null,"Model:",-1)),mu={class:"control"},cu=C(()=>e("div",{class:"help"},[g(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),hu={key:6},pu=C(()=>e("td",null,"Weirdness:",-1)),gu={class:"control"},fu=C(()=>e("div",{class:"help"},[g(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),vu={key:7},bu=C(()=>e("td",null,"Response:",-1)),_u=C(()=>e("td",null,"Outputs the people who chatted during the stream.",-1)),$u=[bu,_u],yu={key:8},wu=C(()=>e("td",null,"Response:",-1)),ku=["onUpdate:modelValue"],Cu=["disabled","onClick"],Vu=C(()=>e("i",{class:"fa fa-remove"},null,-1)),Su=[Vu],Iu={class:"field"},Uu=C(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),Du=g(" Add response "),Au=[Uu,Du],Pu=C(()=>e("div",null,[e("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),Tu={key:9},Eu=C(()=>e("td",null,"Image:",-1)),Mu=C(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Fu=g(" Remove "),Ou=[Mu,Fu],zu={key:2},Nu={key:10},Ru=C(()=>e("td",null,"Sound:",-1)),ju=C(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Lu=g(" Remove "),qu=[ju,Lu],Ju={key:3},Bu={key:11},Wu=C(()=>e("td",null,"Duration:",-1)),Hu={class:"control has-icons-left"},Ku=C(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),Gu={key:12},Yu=C(()=>e("td",null,"Settings",-1)),Xu=C(()=>e("td",null,"Variables:",-1)),Qu={key:0},Zu=C(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Value")])],-1)),xu=["onUpdate:modelValue"],tm=["onUpdate:modelValue"],em=["onClick"],sm=C(()=>e("i",{class:"fa fa-remove"},null,-1)),nm=[sm],im=C(()=>e("div",{class:"help"},[g(" Variables can be used from the command with "),e("code",null,"$var(variable_name)"),g(". If the referenced variable is not defined here, "),e("a",{href:"/variables/",target:"_blank"},"global variables"),g(" are used. ")],-1)),om=C(()=>e("td",null,"Variable changes:",-1)),am={key:0},lm=C(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Change"),e("td",null,"Value"),e("td")])],-1)),rm={class:"dropdown is-active is-up"},dm={class:"dropdown-trigger"},um=["onUpdate:modelValue","onFocus"],mm={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},cm={class:"dropdown-content"},hm=["onClick"],pm=g(") "),gm={class:"select is-small"},fm=["onUpdate:modelValue"],vm=C(()=>e("option",{value:"set"},"set",-1)),bm=C(()=>e("option",{value:"increase_by"},"increase by",-1)),_m=C(()=>e("option",{value:"decrease_by"},"decrease by",-1)),$m=[vm,bm,_m],ym=["onUpdate:modelValue"],wm=["onClick"],km=C(()=>e("i",{class:"fa fa-remove"},null,-1)),Cm=[km],Vm=C(()=>e("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),Sm=C(()=>e("td",null,"Permissions:",-1)),Im=g(" Broadcaster "),Um=g(" Moderators "),Dm=g(" Subscribers "),Am={class:"modal-card-foot"},Pm=["disabled"];function Tm(t,s,a,d,f,p){const u=$("trigger-editor"),n=$("responsive-image"),c=$("upload"),r=$("player"),v=$("volume-slider"),S=$("duration-input"),l=$("countdown-editor");return t.item?(i(),o("div",Sd,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...b)=>t.onOverlayClick&&t.onOverlayClick(...b))}),e("div",Id,[e("header",Ud,[e("p",Dd,w(t.title),1),e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...b)=>t.onCloseClick&&t.onCloseClick(...b))})]),e("section",Ad,[e("table",Pd,[e("tbody",null,[e("tr",null,[Td,e("td",null,[(i(!0),o(A,null,P(t.item.triggers,(b,y)=>(i(),E(u,{key:y,class:"spacerow",modelValue:b,removable:t.item.triggers.length>1,"onUpdate:modelValue":V=>t.item.triggers[y]=V,onRemove:V=>t.rmtrigger(y)},null,8,["modelValue","removable","onUpdate:modelValue","onRemove"]))),128)),e("div",Ed,[e("div",Md,[t.item.action!=="dict_lookup"?(i(),o("div",Fd,[m(e("select",{"onUpdate:modelValue":s[2]||(s[2]=b=>t.newtrigger=b)},Rd,512),[[tt,t.newtrigger]])])):h("",!0)]),e("button",{class:"button is-small",onClick:s[3]||(s[3]=b=>t.addtrigger())},qd)])])]),t.actionDescriptions[t.item.action]?(i(),o("tr",Jd,[Bd,e("td",{innerHTML:t.actionDescriptions[t.item.action]},null,8,Wd)])):h("",!0),t.item.action==="dict_lookup"?(i(),o("tr",Hd,[Kd,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[4]||(s[4]=b=>t.item.data.lang=b)},null,512),[[_,t.item.data.lang]]),(i(!0),o(A,null,P(t.dictLangs,(b,y)=>(i(),o("span",{key:y,class:"button is-small mr-1",onClick:V=>t.item.data.lang=b.value,title:b.title},w(b.flag),9,Gd))),128)),e("span",{class:"button is-small mr-1",onClick:s[5]||(s[5]=b=>t.item.data.lang="$args(0)")},Xd)])])):h("",!0),t.item.action==="dict_lookup"?(i(),o("tr",Qd,[Zd,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[6]||(s[6]=b=>t.item.data.phrase=b)},null,512),[[_,t.item.data.phrase]]),e("span",{class:"button is-small mr-1",onClick:s[7]||(s[7]=b=>t.item.data.phrase="")},"All args"),e("span",{class:"button is-small mr-1",onClick:s[8]||(s[8]=b=>t.item.data.phrase="$args(1:)")},tu)])])):h("",!0),t.item.action==="dict_lookup"?(i(),o("tr",eu,iu)):h("",!0),t.item.action==="madochan_createword"?(i(),o("tr",ou,ru)):h("",!0),t.item.action==="madochan_createword"?(i(),o("tr",du,[uu,e("td",null,[e("div",mu,[m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[9]||(s[9]=b=>t.item.data.model=b)},null,512),[[_,t.item.data.model]])]),cu])])):h("",!0),t.item.action==="madochan_createword"?(i(),o("tr",hu,[pu,e("td",null,[e("div",gu,[m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[10]||(s[10]=b=>t.item.data.weirdness=b)},null,512),[[_,t.item.data.weirdness]])]),fu])])):h("",!0),t.item.action==="chatters"?(i(),o("tr",vu,$u)):h("",!0),t.item.action==="text"?(i(),o("tr",yu,[wu,e("td",null,[(i(!0),o(A,null,P(t.item.data.text,(b,y)=>(i(),o("div",{key:y,class:"field textarea-holder"},[m(e("textarea",{class:T(["textarea",{"has-background-danger-light":!t.item.data.text[y],"has-text-danger-dark":!t.item.data.text[y]}]),type:"text","onUpdate:modelValue":V=>t.item.data.text[y]=V},null,10,ku),[[_,t.item.data.text[y]]]),e("button",{class:"button is-small",disabled:t.item.data.text.length<=1,onClick:V=>t.rmtxt(y)},Su,8,Cu)]))),128)),e("div",Iu,[e("button",{class:"button is-small",onClick:s[11]||(s[11]=(...b)=>t.addtxt&&t.addtxt(...b))},Au)]),Pu])])):h("",!0),t.item.action==="media"?(i(),o("tr",Tu,[Eu,e("td",null,[t.item.data.image.file?(i(),E(n,{key:0,src:t.item.data.image.file,title:t.item.data.image.filename,width:"100%",height:"90px",style:{display:"block"}},null,8,["src","title"])):h("",!0),t.item.data.image.file?(i(),o("button",{key:1,class:"button is-small",onClick:s[12]||(s[12]=b=>t.item.data.image.file=null)},Ou)):h("",!0),t.item.data.image.file?(i(),o("br",zu)):h("",!0),k(c,{onUploaded:t.mediaImgUploaded,accept:"image/*",label:"Upload Image",class:T({"mt-1":t.item.data.image.file})},null,8,["onUploaded","class"])])])):h("",!0),t.item.action==="media"?(i(),o("tr",Nu,[Ru,e("td",null,[t.item.data.sound.file?(i(),E(r,{key:0,src:t.item.data.sound.file,name:t.item.data.sound.filename,volume:t.item.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):h("",!0),t.item.data.sound.file?(i(),E(v,{key:1,modelValue:t.item.data.sound.volume,"onUpdate:modelValue":s[13]||(s[13]=b=>t.item.data.sound.volume=b)},null,8,["modelValue"])):h("",!0),t.item.data.sound.file?(i(),o("button",{key:2,class:"button is-small",onClick:s[14]||(s[14]=b=>t.item.data.sound.file=null)},qu)):h("",!0),t.item.data.sound.file?(i(),o("br",Ju)):h("",!0),k(c,{onUploaded:t.mediaSndUploaded,accept:"audio/*",label:"Upload Sound",class:T({"mt-1":t.item.data.sound.file})},null,8,["onUploaded","class"])])])):h("",!0),t.item.action==="media"?(i(),o("tr",Bu,[Wu,e("td",null,[e("div",Hu,[k(S,{modelValue:t.item.data.minDurationMs,"onUpdate:modelValue":s[15]||(s[15]=b=>t.item.data.minDurationMs=b)},null,8,["modelValue"]),Ku])])])):h("",!0),t.item.action==="countdown"?(i(),o("tr",Gu,[Yu,e("td",null,[k(l,{modelValue:t.item.data,"onUpdate:modelValue":s[16]||(s[16]=b=>t.item.data=b),baseVolume:t.baseVolume},null,8,["modelValue","baseVolume"])])])):h("",!0),e("tr",null,[Xu,e("td",null,[t.item.variables.length>0?(i(),o("table",Qu,[Zu,e("tbody",null,[(i(!0),o(A,null,P(t.item.variables,(b,y)=>(i(),o("tr",{key:y},[e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>b.name=V},null,8,xu),[[_,b.name]])]),e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>b.value=V},null,8,tm),[[_,b.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:V=>t.rmVariable(y)},nm,8,em)])]))),128))])])):h("",!0),e("span",{class:"button is-small",onClick:s[17]||(s[17]=(...b)=>t.onAddVariable&&t.onAddVariable(...b))},"Add Variable"),im])]),e("tr",null,[om,e("td",null,[t.item.variableChanges.length>0?(i(),o("table",am,[lm,e("tbody",null,[(i(!0),o(A,null,P(t.item.variableChanges,(b,y)=>(i(),o("tr",{key:y},[e("td",null,[e("div",rm,[e("div",dm,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>b.name=V,onFocus:V=>t.variableChangeFocusIdx=y,onBlur:s[18]||(s[18]=(...V)=>t.onVarChangeInputBlur&&t.onVarChangeInputBlur(...V))},null,40,um),[[_,b.name]])]),t.variableChangeFocusIdx===y?(i(),o("div",mm,[e("div",cm,[(i(!0),o(A,null,P(t.autocompletableVariables(b.name),(V,ft)=>(i(),o("a",{class:"dropdown-item",key:ft,onClick:Av=>b.name=V.var.name},[g(w(V.var.name)+" ("+w(V.type)+", ",1),e("code",null,w(V.var.value),1),pm],8,hm))),128))])])):h("",!0)])]),e("td",null,[e("div",gm,[m(e("select",{"onUpdate:modelValue":V=>b.change=V},$m,8,fm),[[tt,b.change]])])]),e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>b.value=V},null,8,ym),[[_,b.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:V=>t.rmVariableChange(y)},Cm,8,wm)])]))),128))])])):h("",!0),e("span",{class:"button is-small",onClick:s[19]||(s[19]=(...b)=>t.onAddVariableChange&&t.onAddVariableChange(...b))},"Add Variable Change"),Vm])]),e("tr",null,[Sm,e("td",null,[e("label",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[20]||(s[20]=b=>t.item.restrict_to=b),value:"broadcaster"},null,512),[[z,t.item.restrict_to]]),Im]),e("label",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[21]||(s[21]=b=>t.item.restrict_to=b),value:"mod"},null,512),[[z,t.item.restrict_to]]),Um]),e("label",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[22]||(s[22]=b=>t.item.restrict_to=b),value:"sub"},null,512),[[z,t.item.restrict_to]]),Dm])])])])])]),e("footer",Am,[e("button",{class:"button is-small is-primary",disabled:!t.valid,onClick:s[23]||(s[23]=(...b)=>t.onSaveClick&&t.onSaveClick(...b))}," Save changes ",8,Pm),e("button",{class:"button is-small",onClick:s[24]||(s[24]=(...b)=>t.onCancelClick&&t.onCancelClick(...b))},"Cancel")])])])):h("",!0)}var Em=D(Vd,[["render",Tm],["__scopeId","data-v-fad4890a"]]);const Mm=U({props:{globalVariables:{type:Array,required:!0},possibleActions:{type:Array,required:!0},baseVolume:{type:Number,required:!0},modelValue:{type:Array,required:!0},showToggleImages:{type:Boolean,required:!1,default:!1},showFilterActions:{type:Boolean,required:!1,default:!1},showImages:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue","showImagesChange"],data(){return{commands:[],editIdx:null,editCommand:null,addDropdownActive:!1,filter:{search:"",actions:[]},imagesVisible:!1}},computed:{actionDescriptions(){return ot}},methods:{onImageVisibleChange(){this.$emit("showImagesChange",this.imagesVisible)},emitChange(){this.$emit("update:modelValue",this.commands)},commandCount(t){let s=0;for(const a of this.commands)a.action===t&&s++;return s},filteredOut(t){if(this.filter.actions.length>0&&!this.filter.actions.includes(t.action))return!0;if(!this.filter.search)return!1;const s=this.filter.search.toLowerCase();return!t.triggers.find(({type:a,data:d})=>a==="command"&&d.command.toLowerCase().indexOf(s)>=0)},permissionsStr(t){if(!t.restrict_to||t.restrict_to.length===0)return"Everyone";const s=[];return t.restrict_to.includes("broadcaster")&&s.push("Broadcaster"),t.restrict_to.includes("mod")&&s.push("Moderators"),t.restrict_to.includes("sub")&&s.push("Subscribers"),s.join(", ")},remove(t){this.commands=this.commands.filter((s,a)=>a!==t),this.emitChange()},add(t){const s=Cd(t);!s||(this.editIdx=this.commands.length,this.editCommand=s)},edit(t){this.editIdx=t,this.editCommand=this.commands[t]},duplicate(t){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[t]))},editedCommand(t){this.editIdx!==null&&(this.commands[this.editIdx]=t,this.emitChange(),this.editIdx=null,this.editCommand=null)},openDropdown(){this.addDropdownActive=!0},closeDropdown(){this.addDropdownActive=!1},hideAddDropdown(t){!this.$refs.addDropdown||this.$refs.addDropdown.contains(t.target)||this.closeDropdown()},dragEnd(t){this.commands=L.arrayMove(this.commands,t.oldIndex,t.newIndex),this.emitChange()},actionDescription(t){return ot[t]},actionName(t){return gt[t]}},created(){this.commands=JSON.parse(JSON.stringify(this.modelValue)),this.imagesVisible=this.showImages},mounted(){window.addEventListener("click",this.hideAddDropdown)},unmounted(){window.removeEventListener("click",this.hideAddDropdown)}}),O=t=>(H("data-v-2f1ff902"),t=t(),K(),t),Fm={class:"actions"},Om={class:"dropdown-trigger"},zm=O(()=>e("span",null,"Add command",-1)),Nm=O(()=>e("span",{class:"icon is-small"},[e("i",{class:"fa fa-angle-down","aria-hidden":"true"})],-1)),Rm=[zm,Nm],jm={class:"dropdown-menu",id:"dropdown-menu",role:"menu"},Lm={class:"dropdown-content"},qm=["onClick","title"],Jm=O(()=>e("div",{class:"mr-1"},"Filter:",-1)),Bm={class:"field has-addons mr-1 mb-0"},Wm={class:"control"},Hm={key:0,class:"field"},Km=["value"],Gm={key:0,class:"table-container"},Ym={class:"table is-striped",ref:"table"},Xm=O(()=>e("th",null,null,-1)),Qm=O(()=>e("th",null,null,-1)),Zm=O(()=>e("th",null,"Trigger",-1)),xm=g(" Response "),tc={key:0},ec=g(" Show images "),sc=O(()=>e("th",null,"Type",-1)),nc=O(()=>e("th",null,"Permissions",-1)),ic=O(()=>e("th",null,null,-1)),oc=O(()=>e("th",null,null,-1)),ac=O(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),lc={class:"pl-0 pr-0"},rc=["onClick"],dc=O(()=>e("i",{class:"fa fa-pencil"},null,-1)),uc=[dc],mc={class:"col-triggers"},cc={key:0},hc={key:1},pc=O(()=>e("span",{class:"is-small",title:"Channel Point Reward"},[e("i",{class:"fa fa-bullseye"}),g(": ")],-1)),gc={key:2},fc=O(()=>e("span",{class:"is-small"},"Timer: ",-1)),vc={key:0},bc={key:0},_c={key:0,class:"spacerow media-holder media-holder-inline"},$c={key:1},yc={key:2,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},wc={key:3,class:"ml-2"},kc=g("for at least "),Cc={key:4,class:"ml-2"},Vc=g("for "),Sc={key:2},Ic={key:0},Uc=O(()=>e("span",null,"\u2192",-1)),Dc=g(" \u2715 "),Ac=O(()=>e("span",null,"\u2192",-1)),Pc={key:1},Tc={key:1},Ec={key:2},Mc=g(" Media("),Fc={key:0},Oc={key:1},zc={key:2},Nc=g(") "),Rc={key:3},jc=["innerHTML"],Lc={class:"pl-0 pr-0"},qc=O(()=>e("i",{class:"fa fa-trash"},null,-1)),Jc=["onClick"],Bc=O(()=>e("i",{class:"fa fa-clone"},null,-1)),Wc=[Bc],Hc={key:1};function Kc(t,s,a,d,f,p){const u=$("duration"),n=$("responsive-image"),c=$("player"),r=$("doubleclick-button"),v=$("draggable"),S=$("command-editor");return i(),o("div",null,[e("div",Fm,[e("div",{class:T(["dropdown mr-1",{"is-active":t.addDropdownActive}]),ref:"addDropdown"},[e("div",Om,[e("button",{class:"button is-small mr-1","aria-haspopup":"true","aria-controls":"dropdown-menu",onClick:s[0]||(s[0]=(...l)=>t.openDropdown&&t.openDropdown(...l))},Rm)]),e("div",jm,[e("div",Lm,[(i(!0),o(A,null,P(t.possibleActions,(l,b)=>(i(),o("a",{href:"#",class:"dropdown-item",key:b,onClick:y=>{t.closeDropdown(),t.add(l)},title:t.actionDescription(l)}," Add "+w(t.actionName(l)),9,qm))),128))])])],2),Jm,e("div",Bm,[e("div",Wm,[m(e("input",{class:"input is-small","onUpdate:modelValue":s[1]||(s[1]=l=>t.filter.search=l)},null,512),[[_,t.filter.search]])])]),t.showFilterActions?(i(),o("div",Hm,[(i(!0),o(A,null,P(t.possibleActions,(l,b)=>(i(),o("label",{class:"mr-1",key:b},[m(e("input",{class:"mr-1",type:"checkbox",value:l,"onUpdate:modelValue":s[2]||(s[2]=y=>t.filter.actions=y)},null,8,Km),[[z,t.filter.actions]]),g(w(l)+" ("+w(t.commandCount(l))+")",1)]))),128))])):h("",!0)]),t.commands.length>0?(i(),o("div",Gm,[e("table",Ym,[e("thead",null,[e("tr",null,[Xm,Qm,Zm,e("th",null,[xm,t.showToggleImages?(i(),o("label",tc,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[3]||(s[3]=l=>t.imagesVisible=l),s[4]||(s[4]=(...l)=>t.onImageVisibleChange&&t.onImageVisibleChange(...l))]},null,512),[[z,t.imagesVisible]]),ec])):h("",!0)]),sc,nc,ic,oc])]),k(v,{modelValue:t.commands,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:N(({element:l,index:b})=>[m(e("tr",null,[ac,e("td",lc,[e("button",{class:"button is-small",onClick:y=>t.edit(b)},uc,8,rc)]),e("td",mc,[(i(!0),o(A,null,P(l.triggers,(y,V)=>(i(),o("div",{key:V,class:"spacerow"},[l.triggers[V].type==="command"?(i(),o("div",cc,[e("code",null,w(l.triggers[V].data.command),1)])):h("",!0),l.triggers[V].type==="reward_redemption"?(i(),o("div",hc,[pc,e("code",null,w(l.triggers[V].data.command),1)])):h("",!0),l.triggers[V].type==="timer"?(i(),o("div",gc,[fc,e("code",null,[g(w(l.triggers[V].data.minLines)+" lines, ",1),k(u,{value:l.triggers[V].data.minInterval},null,8,["value"])])])):h("",!0)]))),128))]),e("td",null,[l.action==="text"?(i(),o("div",vc,[(i(!0),o(A,null,P(l.data.text,(y,V)=>(i(),o(A,{key:V},[e("code",null,w(l.data.text[V]),1),V<l.data.text.length-1?(i(),o("span",bc,"or")):h("",!0)],64))),128))])):l.action==="media"?(i(),o("div",{key:1,class:T(l.action)},[l.data.image.file||l.data.sound.file?(i(),o("div",_c,[l.data.image.file&&t.imagesVisible?(i(),E(n,{key:0,src:l.data.image.file,title:l.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):l.data.image.file?(i(),o("code",$c,w(l.data.image.filename),1)):h("",!0),l.data.image.file&&l.data.sound.file?(i(),o("i",yc)):h("",!0),k(c,{src:l.data.sound.file,name:l.data.sound.filename,volume:l.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),l.data.image.file&&l.data.sound.file?(i(),o("span",wc,[kc,k(u,{value:l.data.minDurationMs},null,8,["value"])])):l.data.image.file?(i(),o("span",Cc,[Vc,k(u,{value:l.data.minDurationMs},null,8,["value"])])):h("",!0)])):h("",!0)],2)):l.action==="countdown"?(i(),o("div",Sc,[(l.data.type||"auto")==="auto"?(i(),o("div",Ic,[e("code",null,w(l.data.intro),1),Uc,e("code",null,w(l.data.steps),1),Dc,k(u,{value:l.data.interval},null,8,["value"]),Ac,e("code",null,w(l.data.outro),1)])):(i(),o("div",Pc,[(i(!0),o(A,null,P(l.data.actions,(y,V)=>(i(),o(A,{key:V},[y.type==="delay"?(i(),E(u,{key:0,value:y.value},null,8,["value"])):h("",!0),y.type==="text"?(i(),o("code",Tc,w(y.value),1)):h("",!0),y.type==="media"?(i(),o("code",Ec,[Mc,y.value.image.file?(i(),o("span",Fc,w(y.value.image.filename),1)):h("",!0),y.value.image.file&&y.value.sound.file?(i(),o("span",Oc,"+")):h("",!0),y.value.sound.file?(i(),o("span",zc,w(y.value.sound.filename),1)):h("",!0),Nc])):h("",!0),V<l.data.actions.length-1?(i(),o("span",Rc,"\u2192")):h("",!0)],64))),128))]))])):t.actionDescriptions[l.action]?(i(),o("div",{key:3,innerHTML:t.actionDescriptions[l.action]},null,8,jc)):h("",!0)]),e("td",null,w(l.action),1),e("td",null,w(t.permissionsStr(l)),1),e("td",Lc,[k(r,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:y=>t.remove(b)},{default:N(()=>[qc]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:y=>t.duplicate(b)},Wc,8,Jc)])],512),[[at,!t.filteredOut(l)]])]),_:1},8,["modelValue","onEnd"])],512)])):(i(),o("div",Hc,"No commands set up")),t.editCommand?(i(),E(S,{key:2,globalVariables:t.globalVariables,modelValue:t.editCommand,mode:t.editIdx>=t.commands.length?"create":"edit",baseVolume:t.baseVolume,"onUpdate:modelValue":t.editedCommand,onCancel:s[5]||(s[5]=l=>t.editCommand=null)},null,8,["globalVariables","modelValue","mode","baseVolume","onUpdate:modelValue"])):h("",!0)])}var Gc=D(Mm,[["render",Kc],["__scopeId","data-v-2f1ff902"]]);const Yc=U({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(t){this.countdown.actions=L.arrayMove(this.countdown.actions,t.oldIndex,t.newIndex)},onAddDelay(){this.countdown.actions.push({type:"delay",value:"1s"})},onAddText(){this.countdown.actions.push({type:"text",value:it()})},onAddMedia(){this.countdown.actions.push({type:"media",value:ht()})},rmaction(t){this.countdown.actions=this.countdown.actions.filter((s,a)=>a!==t)},mediaSndUploaded(t,s){this.countdown.actions[t].value.sound.filename=s.originalname,this.countdown.actions[t].value.sound.file=s.filename},mediaImgUploaded(t,s){this.countdown.actions[t].value.image.filename=s.originalname,this.countdown.actions[t].value.image.file=s.filename}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),Xc={class:"control"},Qc={class:"radio"},Zc=g(" Manual "),xc={class:"radio"},th=g(" Auto "),eh={key:0},sh={class:"spacerow"},nh=e("label",{class:"spacelabel"},"Steps ",-1),ih={class:"spacerow"},oh=e("label",{class:"spacelabel"},"Interval ",-1),ah={class:"spacerow"},lh=e("label",{class:"spacelabel"},"Intro ",-1),rh={class:"spacerow"},dh=e("label",{class:"spacelabel"},"Outro ",-1),uh={key:1},mh={class:"field has-addons mr-1"},ch=e("span",{class:"handle p-2"},[e("i",{class:"fa fa-arrows"})],-1),hh={key:0,class:"control has-icons-left"},ph=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),gh={key:1,class:"control has-icons-left"},fh=["onUpdate:modelValue"],vh=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),bh={key:2,class:"control has-icons-left"},_h=e("td",null,"Image:",-1),$h=["onClick"],yh=e("i",{class:"fa fa-remove mr-1"},null,-1),wh=g(" Remove "),kh=[yh,wh],Ch={key:2},Vh=e("td",null,"Sound:",-1),Sh=["onClick"],Ih=e("i",{class:"fa fa-remove mr-1"},null,-1),Uh=g(" Remove "),Dh=[Ih,Uh],Ah={key:3},Ph=e("td",null,"Duration:",-1),Th={class:"control has-icons-left"},Eh=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),Mh={class:"control"},Fh=["onClick"],Oh=e("i",{class:"fa fa-remove"},null,-1),zh=[Oh],Nh=e("i",{class:"fa fa-hourglass mr-1"},null,-1),Rh=g(" Add Delay "),jh=[Nh,Rh],Lh=e("i",{class:"fa fa-comments-o mr-1"},null,-1),qh=g(" Add Chat "),Jh=[Lh,qh],Bh=e("i",{class:"fa fa-picture-o mr-1"},null,-1),Wh=g(" Add Media "),Hh=[Bh,Wh];function Kh(t,s,a,d,f,p){const u=$("duration-input"),n=$("responsive-image"),c=$("upload"),r=$("player"),v=$("volume-slider"),S=$("draggable");return i(),o("div",null,[e("div",Xc,[e("label",Qc,[m(e("input",{type:"radio",value:"manual","onUpdate:modelValue":s[0]||(s[0]=l=>t.countdown.type=l)},null,512),[[lt,t.countdown.type]]),Zc]),e("label",xc,[m(e("input",{type:"radio",value:"auto","onUpdate:modelValue":s[1]||(s[1]=l=>t.countdown.type=l)},null,512),[[lt,t.countdown.type]]),th])]),t.countdown.type==="auto"?(i(),o("div",eh,[e("div",sh,[nh,m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[2]||(s[2]=l=>t.countdown.steps=l)},null,512),[[_,t.countdown.steps]])]),e("div",ih,[oh,k(u,{modelValue:t.countdown.interval,"onUpdate:modelValue":s[3]||(s[3]=l=>t.countdown.interval=l)},null,8,["modelValue"])]),e("div",ah,[lh,m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[4]||(s[4]=l=>t.countdown.intro=l)},null,512),[[_,t.countdown.intro]])]),e("div",rh,[dh,m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[5]||(s[5]=l=>t.countdown.outro=l)},null,512),[[_,t.countdown.outro]])])])):(i(),o("div",uh,[k(S,{modelValue:t.countdown.actions,onEnd:t.dragEnd,handle:".handle","item-key":"id"},{item:N(({element:l,index:b})=>[e("div",mh,[ch,l.type==="delay"?(i(),o("div",hh,[k(u,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y},null,8,["modelValue","onUpdate:modelValue"]),ph])):l.type==="text"?(i(),o("div",gh,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":y=>l.value=y},null,8,fh),[[_,l.value]]),vh])):l.type==="media"?(i(),o("div",bh,[e("table",null,[e("tr",null,[_h,e("td",null,[l.value.image.file?(i(),E(n,{key:0,src:l.value.image.file,title:l.value.image.filename,width:"100%",height:"90px",style:{display:"block"}},null,8,["src","title"])):h("",!0),l.value.image.file?(i(),o("button",{key:1,class:"button is-small",onClick:y=>l.value.image.file=null},kh,8,$h)):h("",!0),l.value.image.file?(i(),o("br",Ch)):h("",!0),k(c,{onUploaded:y=>t.mediaImgUploaded(b,y),accept:"image/*",label:"Upload Image",class:T({"mt-1":l.value.image.file})},null,8,["onUploaded","class"])])]),e("tr",null,[Vh,e("td",null,[l.value.sound.file?(i(),E(r,{key:0,src:l.value.sound.file,name:l.value.sound.filename,volume:l.value.sound.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):h("",!0),l.value.sound.file?(i(),E(v,{key:1,modelValue:l.value.sound.volume,"onUpdate:modelValue":y=>l.value.sound.volume=y},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),l.value.sound.file?(i(),o("button",{key:2,class:"button is-small",onClick:y=>l.value.sound.file=null},Dh,8,Sh)):h("",!0),l.value.sound.file?(i(),o("br",Ah)):h("",!0),k(c,{onUploaded:y=>t.mediaSndUploaded(b,y),accept:"audio/*",label:"Upload Sound",class:T({"mt-1":l.value.sound.file})},null,8,["onUploaded","class"])])]),e("tr",null,[Ph,e("td",null,[e("div",Th,[k(u,{modelValue:l.value.minDurationMs,"onUpdate:modelValue":y=>l.value.minDurationMs=y},null,8,["modelValue","onUpdate:modelValue"]),Eh])])])])])):h("",!0),e("div",Mh,[e("button",{class:"button is-small",onClick:y=>t.rmaction(b)},zh,8,Fh)])])]),_:1},8,["modelValue","onEnd"]),e("button",{class:"button is-small",onClick:s[6]||(s[6]=(...l)=>t.onAddDelay&&t.onAddDelay(...l))},jh),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...l)=>t.onAddText&&t.onAddText(...l))},Jh),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(...l)=>t.onAddMedia&&t.onAddMedia(...l))},Hh)]))])}var Gh=D(Yc,[["render",Kh]]);const Yh=U({props:{modelValue:{type:Object,required:!0},removable:{type:Boolean,required:!0}},emits:["update:modelValue","remove"],data(){return{value:{type:"",data:{command:"",commandExact:!1,minInterval:0,minLines:0}}}},created(){this.apply(this.modelValue)},methods:{emitRemove(){this.$emit("remove")},emitUpdate(){this.$emit("update:modelValue",this.value)},apply(t){this.value=JSON.parse(JSON.stringify(t))}},watch:{modelValue(t,s){this.apply(t)}}}),Xh={key:0,class:"field has-addons"},Qh={class:"control has-icons-left mr-1"},Zh=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),xh={class:"control mr-1",title:"Check if command should only be executed if it matches exactly (= no arguments come after it)."},tp=e("span",{class:"is-small is-left"},"exact",-1),ep={class:"control"},sp=["disabled"],np=e("i",{class:"fa fa-remove"},null,-1),ip=[np],op={key:1,class:"field has-addons"},ap={class:"control has-icons-left"},lp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-bullseye"})],-1),rp={class:"control"},dp=["disabled"],up=e("i",{class:"fa fa-remove"},null,-1),mp=[up],cp={key:2,class:"timer-trigger"},hp={class:"control"},pp=["disabled"],gp=e("i",{class:"fa fa-remove"},null,-1),fp=[gp],vp={class:"columns"},bp=e("div",{class:"column is-one-third"},[e("label",null,"Min. Lines")],-1),_p={class:"column is-two-third"},$p={class:"control has-icons-left"},yp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),wp={class:"columns"},kp=e("div",{class:"column is-one-third"},[e("label",null,"Min. Interval")],-1),Cp={class:"column is-two-third"},Vp={class:"control has-icons-left has-icons-right"},Sp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),Ip=e("p",{class:"help"}," Command will be triggered when at least min. lines chat messages arrived AND time interval have passed. ",-1);function Up(t,s,a,d,f,p){const u=$("duration-input");return i(),o("div",null,[t.value.type==="command"?(i(),o("div",Xh,[e("div",Qh,[m(e("input",{class:T(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[0]||(s[0]=n=>t.value.data.command=n),s[1]||(s[1]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,2),[[_,t.value.data.command]]),Zh]),e("div",xh,[e("label",null,[m(e("input",{type:"checkbox",class:"checkbox mr-1","onUpdate:modelValue":[s[2]||(s[2]=n=>t.value.data.commandExact=n),s[3]||(s[3]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,512),[[z,t.value.data.commandExact]]),tp])]),e("div",ep,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[4]||(s[4]=(...n)=>t.emitRemove&&t.emitRemove(...n))},ip,8,sp)])])):h("",!0),t.value.type==="reward_redemption"?(i(),o("div",op,[e("div",ap,[m(e("input",{class:T(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[5]||(s[5]=n=>t.value.data.command=n),s[6]||(s[6]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,2),[[_,t.value.data.command]]),lp]),e("div",rp,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[7]||(s[7]=(...n)=>t.emitRemove&&t.emitRemove(...n))},mp,8,dp)])])):h("",!0),t.value.type==="timer"?(i(),o("div",cp,[e("div",hp,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[8]||(s[8]=(...n)=>t.emitRemove&&t.emitRemove(...n))},fp,8,pp)]),e("div",vp,[bp,e("div",_p,[e("div",$p,[m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":[s[9]||(s[9]=n=>t.value.data.minLines=n),s[10]||(s[10]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,512),[[_,t.value.data.minLines]]),yp])])]),e("div",wp,[kp,e("div",Cp,[e("div",Vp,[k(u,{modelValue:t.value.data.minInterval,"onUpdate:modelValue":s[11]||(s[11]=n=>{t.value.data.minInterval=n,t.emitUpdate()})},null,8,["modelValue"]),Sp])])]),Ip])):h("",!0)])}var Dp=D(Yh,[["render",Up]]);const Ap=U({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1}),methods:{toggleVisibility(t,s){t.hidevideo?this.sendCtrl("videoVisibility",[!0,s]):this.sendCtrl("videoVisibility",[!1,s])},dragEnd(t){this.sendCtrl("move",[t.oldIndex,t.newIndex])},applyFilter(t){this.$emit("filterChange",t)},sendCtrl(t,s){this.$emit("ctrl",[t,s])},isFilteredOut(t){return this.filter.tag!==""&&!t.tags.includes(this.filter.tag)},startAddTag(t){this.tagInputIdx=t,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(t=>(t.filteredOut=this.isFilteredOut(t),t))},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(t=>t.tags.includes(this.filter.tag))}},watch:{playlist:function(t,s){t.find(a=>!this.isFilteredOut(a))||this.$emit("stopPlayer")},filter:function(t,s){this.playlist.find(a=>!this.isFilteredOut(a))||this.$emit("stopPlayer")}}}),j=t=>(H("data-v-c0843896"),t=t(),K(),t),Pp={class:"filters"},Tp={class:"currentfilter"},Ep=j(()=>e("div",{class:"mr-1"},"Filter:",-1)),Mp=j(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),Fp={key:1,class:"field has-addons mr-1 mb-0"},Op={class:"control"},zp={class:"control"},Np={class:"pt-1"},Rp=g(" Hide filtered out"),jp={key:0,class:"table is-striped"},Lp=j(()=>e("thead",null,[e("tr",null,[e("th"),e("th"),e("th"),e("th",null,"Title"),e("th",null,"User"),e("th",null,"Plays"),e("th"),e("th"),e("th"),e("th")])],-1)),qp=j(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Jp=["disabled","onClick"],Bp=j(()=>e("i",{class:"fa fa-play"},null,-1)),Wp=[Bp],Hp=["href"],Kp=j(()=>e("i",{class:"fa fa-external-link"},null,-1)),Gp=["onClick"],Yp=j(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),Xp=["onClick"],Qp=j(()=>e("i",{class:"fa fa-plus"},null,-1)),Zp=[Qp],xp={key:0,class:"field has-addons"},tg={class:"control"},eg=["onKeyup"],sg={class:"control"},ng=["disabled","onClick"],ig=["onClick","title"],og=["onClick"],ag=j(()=>e("i",{class:"fa fa-thumbs-up mr-1"},null,-1)),lg=["onClick"],rg=j(()=>e("i",{class:"fa fa-thumbs-down mr-1"},null,-1)),dg=["onClick"],ug=j(()=>e("i",{class:"fa fa-trash"},null,-1)),mg=[ug],cg={key:1};function hg(t,s,a,d,f,p){const u=$("draggable");return i(),o("div",null,[e("div",Pp,[e("div",Tp,[Ep,t.filter.tag?(i(),o("span",{key:0,class:"tag mr-1",onClick:s[0]||(s[0]=n=>t.applyFilter(""))},[g(w(t.filter.tag)+" ",1),Mp])):(i(),o("div",Fp,[e("div",Op,[m(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[1]||(s[1]=n=>t.filterTagInput=n),onKeyup:s[2]||(s[2]=q(n=>t.applyFilter(t.filterTagInput),["enter"]))},null,544),[[_,t.filterTagInput]])]),e("div",zp,[e("span",{class:"button is-small",onClick:s[3]||(s[3]=n=>t.applyFilter(t.filterTagInput))},"Apply filter")])])),e("label",Np,[m(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=n=>t.hideFilteredOut=n)},null,512),[[z,t.hideFilteredOut]]),Rp])])]),t.playlist.length>0?(i(),o("table",jp,[Lp,k(u,{modelValue:t.enhancedPlaylist,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:N(({element:n,index:c})=>[m(e("tr",null,[qp,e("td",null,w(c+1),1),e("td",null,[c!==t.firstIndex?(i(),o("button",{key:0,class:"button is-small",disabled:n.filteredOut?!0:null,onClick:r=>t.sendCtrl("playIdx",[c]),title:"Play"},Wp,8,Jp)):h("",!0)]),e("td",null,[e("a",{href:"https://www.youtube.com/watch?v="+n.yt,target:"_blank"},[g(w(n.title||n.yt)+" ",1),Kp],8,Hp),e("div",null,[(i(!0),o(A,null,P(n.tags,(r,v)=>(i(),o("span",{key:v,class:"tag",onClick:S=>t.sendCtrl("rmtag",[r,c])},[g(w(r)+" ",1),Yp],8,Gp))),128)),e("span",{class:"button is-small",onClick:r=>t.startAddTag(c)},Zp,8,Xp)]),t.tagInputIdx===c?(i(),o("div",xp,[e("div",tg,[m(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[5]||(s[5]=r=>t.tagInput=r),onKeyup:q(r=>{t.sendCtrl("addtag",[t.tagInput,c]),t.tagInput=""},["enter"])},null,40,eg),[[_,t.tagInput]])]),e("div",sg,[e("span",{class:"button is-small",disabled:t.tagInput?null:!0,onClick:r=>{t.sendCtrl("addtag",[t.tagInput,c]),t.tagInput=""}},"Add tag",8,ng)])])):h("",!0)]),e("td",null,w(n.user),1),e("td",null,w(n.plays)+"x",1),e("td",null,[e("button",{class:"button is-small",onClick:r=>t.toggleVisibility(n,c),title:n.hidevideo?"Video hidden":"Video visible"},[e("i",{class:T(["fa mr-1",{"fa-eye":!n.hidevideo,"fa-eye-slash":n.hidevideo}])},null,2)],8,ig)]),e("td",null,[e("button",{class:"button is-small",onClick:r=>t.sendCtrl("goodIdx",[c])},[ag,g(" "+w(n.goods),1)],8,og)]),e("td",null,[e("button",{class:"button is-small",onClick:r=>t.sendCtrl("badIdx",[c])},[rg,g(" "+w(n.bads),1)],8,lg)]),e("td",null,[e("button",{class:"button is-small",onClick:r=>t.sendCtrl("rmIdx",[c]),title:"Remove"},mg,8,dg)])],512),[[at,!t.hideFilteredOut||!n.filteredOut]])]),_:1},8,["modelValue","onEnd"])])):(i(),o("div",cg,"Playlist is empty"))])}var pg=D(Ap,[["render",hg],["__scopeId","data-v-c0843896"]]);const gg=U({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(t){const s=this.settings.customCssPresets.find(a=>a.name===t);s?(this.settings.customCss=s.css,this.settings.showProgressBar=s.showProgressBar,this.settings.showThumbnails=s.showThumbnails,this.settings.maxItemsShown=s.maxItemsShown):console.warn(`preset not found: ${t}`),this.sendSettings()},removePreset(t){this.settings.customCssPresets=this.settings.customCssPresets.filter(s=>s.name!==t),this.sendSettings()},savePreset(){const t=this.settings.customCssPresets.findIndex(s=>s.name===this.cssPresetName);t>=0?(this.settings.customCssPresets[t].css=this.settings.customCss,this.settings.customCssPresets[t].showProgressBar=this.settings.showProgressBar,this.settings.customCssPresets[t].showThumbnails=this.settings.showThumbnails,this.settings.customCssPresets[t].maxItemsShown=this.settings.maxItemsShown):this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss,showProgressBar:this.settings.showProgressBar,showThumbnails:this.settings.showThumbnails,maxItemsShown:this.settings.maxItemsShown}),this.sendSettings()},hideVideoImageRemoved(){this.settings.hideVideoImage={filename:"",file:""},this.sendSettings()},hideVideoImageUploaded(t){this.settings.hideVideoImage={filename:t.originalname,file:t.filename},this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:{volume:100,hideVideoImage:{file:"",filename:""},showProgressBar:!1,customCssPresets:[],customCss:""},css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.title { margin-bottom: 0; }
.meta-left, .meta-right, .thumbnail { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Replace icon for thumbs-up with an image",code:`.meta-right .vote-up { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }
.meta-right .vote-up .fa { display: none; }`},{desc:"Remove text before/after username",code:`.meta-user-text-before,
.meta-user-text-after {display: none}`},{desc:"Add a fontawesome icon before username (\\f075 is the icon unicode, refer to https://fontawesome.com/v4.7/icons/)",code:'.meta-user-name::before { content: "\\f075"; display: inline-block; font: normal normal normal 14px/1 FontAwesome; font-size: inherit; margin-right: .5em; }'},{desc:"Add an image icon before username",code:".meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }"},{desc:"Add an image icon before username for specific user only",code:`[data-user="nc_para_" i] .meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }`},{desc:"Change item display depending on username (this one changes background and makes thumbnails black boxes)",code:`[data-user="nc_para_" i] { background: #dd0066; }
[data-user="nc_para_" i] .thumbnail img { display: none; }
[data-user="nc_para_" i] .thumbnail { background: black; }`},{desc:"Show player left of the playlist (and limit its height to 320px)",code:`.wrapper { display: grid; grid-template-areas: "player playlist"; grid-template-columns: 50% auto; grid-template-rows: 320px; }
.player iframe { height: 320px; }`},{desc:"Show thumbnails only, and display meta info above them",code:`.item { display: block; position: relative; padding: 0; color: white; }
.title, .meta-left, .meta-right { position: absolute; padding: .2em; background: rgba(244,0,90,.9); }
.meta-left { top: 0; left: 0; font-size: 1em; }
.meta-right { top: 0; right: 0; font-size: 1em; }
.title { bottom: 0; left: 0; right: 0; margin-bottom: 0; }
.thumbnail { width: auto; }`},{desc:"Align thumbnails to the bottom",code:".thumbnail { align-self: end; }"},{desc:"Align thumbnails to the center",code:".thumbnail { align-self: center; }"},{desc:"Add a margin/padding to the thumbnails",code:".thumbnail { padding: 20px; }"},{desc:"Show number of plays not at player, but in icon form on the right near votes",code:`.meta-left .meta-user:after,
.meta-left .meta-plays { display: none; }
.meta-right .meta-plays { display: inline-block; }`}]}})}),M=t=>(H("data-v-335293ad"),t=t(),K(),t),fg={key:0,class:"table is-striped",ref:"table"},vg=M(()=>e("tr",null,[e("td",{colspan:"3"},"General")],-1)),bg=M(()=>e("td",null,[e("code",null,"settings.volume")],-1)),_g=M(()=>e("td",null,"Base volume for all songs played.",-1)),$g=M(()=>e("td",null,[e("code",null,"settings.initAutoplay")],-1)),yg=M(()=>e("td",null,"If checked, the widget will autoplay when first opened.",-1)),wg=M(()=>e("td",null,[e("code",null,"settings.hideVideoImage")],-1)),kg={key:0,class:"mb-1"},Cg=M(()=>e("br",null,null,-1)),Vg=M(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Sg=g(" Remove Image "),Ig=[Vg,Sg],Ug=M(()=>e("td",null,"Image to display when a video is hidden.",-1)),Dg=M(()=>e("tr",null,[e("td",{colspan:"3"},"Visuals")],-1)),Ag=M(()=>e("td",null,[e("code",null,"settings.showProgressBar")],-1)),Pg=M(()=>e("td",null,"Render a progress bar in the bottom part of the video in the widget.",-1)),Tg=M(()=>e("td",null,[e("code",null,"settings.showThumbnails")],-1)),Eg=M(()=>e("td",null,"Render video thumbnails in the widget.",-1)),Mg=M(()=>e("td",null,[e("code",null,"settings.maxItemsShown")],-1)),Fg=M(()=>e("td",null,"Max. number of items displayed in the playlist. Set to -1 for no limit.",-1)),Og=M(()=>e("code",null,"settings.customCss",-1)),zg={class:"field has-addons mr-1"},Ng={class:"control is-expanded"},Rg={class:"control"},jg=["onClick"],Lg=["onClick"],qg=M(()=>e("i",{class:"fa fa-remove"},null,-1)),Jg=[qg],Bg=M(()=>e("p",null,"Classes that can be used for styling:",-1)),Wg={class:"table"},Hg=M(()=>e("thead",null,[e("tr",null,[e("th",null,"Class"),e("th",null,"Description")])],-1)),Kg=M(()=>e("p",null,[e("b",null,"Examples:")],-1));function Gg(t,s,a,d,f,p){const u=$("volume-slider"),n=$("responsive-image"),c=$("upload");return i(),o("div",null,[t.settings?(i(),o("table",fg,[e("tbody",null,[vg,e("tr",null,[bg,e("td",null,[k(u,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[0]||(s[0]=r=>t.settings.volume=r),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),_g]),e("tr",null,[$g,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[1]||(s[1]=r=>t.settings.initAutoplay=r),s[2]||(s[2]=(...r)=>t.sendSettings&&t.sendSettings(...r))]},null,512),[[z,t.settings.initAutoplay]])]),yg]),e("tr",null,[wg,e("td",null,[t.settings.hideVideoImage.file?(i(),o("div",kg,[k(n,{src:t.settings.hideVideoImage.file,title:t.settings.hideVideoImage.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"]),Cg,e("button",{class:"button is-small",onClick:s[3]||(s[3]=(...r)=>t.hideVideoImageRemoved&&t.hideVideoImageRemoved(...r))},Ig)])):h("",!0),k(c,{onUploaded:t.hideVideoImageUploaded,accept:"image/*",label:"Upload Image"},null,8,["onUploaded"])]),Ug]),Dg,e("tr",null,[Ag,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[4]||(s[4]=r=>t.settings.showProgressBar=r),s[5]||(s[5]=(...r)=>t.sendSettings&&t.sendSettings(...r))]},null,512),[[z,t.settings.showProgressBar]])]),Pg]),e("tr",null,[Tg,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[6]||(s[6]=r=>t.settings.showThumbnails=r),s[7]||(s[7]=(...r)=>t.sendSettings&&t.sendSettings(...r))]},null,512),[[z,t.settings.showThumbnails]])]),Eg]),e("tr",null,[Mg,e("td",null,[m(e("input",{type:"number",min:"-1","onUpdate:modelValue":[s[8]||(s[8]=r=>t.settings.maxItemsShown=r),s[9]||(s[9]=(...r)=>t.sendSettings&&t.sendSettings(...r))]},null,512),[[_,t.settings.maxItemsShown]])]),Fg]),e("tr",null,[e("td",null,[Og,e("div",zg,[e("div",Ng,[m(e("input",{class:"input is-small","onUpdate:modelValue":s[10]||(s[10]=r=>t.cssPresetName=r),onFocus:s[11]||(s[11]=r=>t.cssPresetDropdownActive=!0),onBlur:s[12]||(s[12]=r=>t.cssPresetDropdownActive=!1)},null,544),[[_,t.cssPresetName]])]),e("div",Rg,[e("span",{class:"button is-small",onClick:s[13]||(s[13]=(...r)=>t.savePreset&&t.savePreset(...r))},"Save preset")])]),(i(!0),o(A,null,P(t.settings.customCssPresets,(r,v)=>(i(),o("div",{class:"mb-1",key:v},[e("span",{class:"button is-small",onClick:S=>t.loadPreset(r.name)},w(r.name),9,jg),e("span",{class:"button is-small ml-1",onClick:S=>t.removePreset(r.name)},Jg,8,Lg)]))),128))]),e("td",null,[m(e("textarea",{class:"textarea","onUpdate:modelValue":[s[14]||(s[14]=r=>t.settings.customCss=r),s[15]||(s[15]=(...r)=>t.sendSettings&&t.sendSettings(...r))]},null,512),[[_,t.settings.customCss]])]),e("td",null,[Bg,e("table",Wg,[Hg,e("tbody",null,[(i(!0),o(A,null,P(t.css.classExamples,(r,v)=>(i(),o("tr",{key:v},[e("td",null,[e("code",null,w(r.class),1)]),e("td",null,w(r.desc),1)]))),128))])]),Kg,(i(!0),o(A,null,P(t.css.codeExamples,(r,v)=>(i(),o("p",{key:v},[g(w(r.desc)+" ",1),e("pre",null,[e("code",null,w(r.code),1)])]))),128))])])])],512)):h("",!0)])}var Yg=D(gg,[["render",Gg],["__scopeId","data-v-335293ad"]]);const Xg=U({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(t,s){this.editTag=t.value,this.tagEditIdx=s},updateTag(t,s){this.$emit("updateTag",[t,s])}}}),Qg={class:"table is-striped"},Zg=e("tr",null,[e("th",null,"Tag"),e("th"),e("th")],-1),xg=["onKeyup"],tf=["value","onFocus"],ef=["disabled","onClick"];function sf(t,s,a,d,f,p){return i(),o("table",Qg,[Zg,(i(!0),o(A,null,P(t.tags,(u,n)=>(i(),o("tr",{key:n},[e("td",null,[t.tagEditIdx===n?m((i(),o("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=c=>t.editTag=c),onKeyup:q(c=>t.updateTag(u.value,t.editTag),["enter"])},null,40,xg)),[[_,t.editTag]]):(i(),o("input",{key:1,type:"text",class:"input is-small",value:u.value,onFocus:c=>t.onInputFocus(u,n)},null,40,tf))]),e("td",null,[t.tagEditIdx===n?(i(),o("span",{key:0,class:"button is-small",disabled:u.value===t.editTag?!0:null,onClick:c=>t.updateTag(u.value,t.editTag)},"Save",8,ef)):h("",!0)]),e("td",null,w(u.count)+"x",1)]))),128))])}var nf=D(Xg,[["render",sf]]);const of=U({props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","cancel"],data:()=>({item:null,newState:"",newSlotDefinitionName:""}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.adjustAllImagesDivSize(),window.addEventListener("resize",this.adjustAllImagesDivSize)},unmounted(){window.removeEventListener("resize",this.adjustAllImagesDivSize)},watch:{modelValue:{handler(t){this.item=JSON.parse(JSON.stringify(t))}}},computed:{allImages(){var s;const t=[];return(s=this.item)==null||s.slotDefinitions.forEach(a=>{a.items.forEach(d=>{d.states.forEach(f=>{f.frames.forEach(p=>{p.url&&!t.includes(p.url)&&t.push(p.url)})})})}),t},isStateAddable(){return!(!this.item||this.newState===""||this.item.stateDefinitions.find(({value:t})=>t===this.newState))}},methods:{adjustAllImagesDivSize(){this.$nextTick(()=>{if(!this.$refs.cardBody||!this.$refs.allImagesDiv)return;const t=this.$refs.cardBody.clientHeight;this.$refs.allImagesDiv.style.maxHeight=`${t}px`})},imageDragStart(t){t.dataTransfer.setData("avatar-image-url",t.target.getAttribute("data-src"))},onSaveClick(){if(!this.item){console.warn("onSaveClick: this.item not initialized");return}this.$emit("update:modelValue",{name:this.item.name,stateDefinitions:this.item.stateDefinitions,slotDefinitions:this.item.slotDefinitions})},onSaveAndCloseClick(){if(!this.item){console.warn("onSaveClick: this.item not initialized");return}this.$emit("update:modelValue",{name:this.item.name,stateDefinitions:this.item.stateDefinitions,slotDefinitions:this.item.slotDefinitions}),this.$emit("cancel")},onCancelClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},addStateDefinition(){if(!this.item){console.warn("addStateDefinition: this.item not initialized");return}const t={value:this.newState,deletable:!0};this.item.stateDefinitions.push(t);for(let s of this.item.slotDefinitions)for(let a of s.items)a.states.push({state:t.value,frames:[]})},removeStateDefinition(t){if(!this.item){console.warn("removeStateDefinition: this.item not initialized");return}const s=[];for(let d in this.item.stateDefinitions)parseInt(d,10)!==parseInt(`${t}`,10)&&s.push(this.item.stateDefinitions[d]);this.item.stateDefinitions=s;const a=s.map(d=>d.value);for(let d of this.item.slotDefinitions)for(let f of d.items)f.states=f.states.filter(p=>a.includes(p.state))},removeSlotDefinition(t){if(!this.item){console.warn("removeSlotDefinition: this.item not initialized");return}const s=[];for(let a in this.item.slotDefinitions)parseInt(a,10)!==parseInt(`${t}`,10)&&s.push(this.item.slotDefinitions[a]);this.item.slotDefinitions=s},updateSlotDefinition(t,s){if(!this.item){console.warn("updateSlotDefinition: this.item not initialized");return}this.item.slotDefinitions[parseInt(`${t}`,10)]=s},addSlotDefinition(){if(!this.item){console.warn("addSlotDefinition: this.item not initialized");return}const t={slot:"Unnamed slot",defaultItemIndex:-1,items:[]};this.item.slotDefinitions.push(t)},moveSlotUp(t){if(!this.item){console.warn("moveSlotUp: this.item not initialized");return}if(t<=0)return;const s=this.item.slotDefinitions[t-1];this.item.slotDefinitions[t-1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s},moveSlotDown(t){if(!this.item){console.warn("moveSlotDown: this.item not initialized");return}if(t>=this.item.slotDefinitions.length-1)return;const s=this.item.slotDefinitions[t+1];this.item.slotDefinitions[t+1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s}}}),af={key:0,class:"avatar-editor modal is-active"},lf={class:"modal-card"},rf={class:"modal-card-head"},df=e("p",{class:"modal-card-title"},"Edit Avatar",-1),uf={class:"modal-card-body",ref:"cardBody"},mf={class:"columns"},cf={class:"column is-three-quarters"},hf={class:"table is-striped"},pf=e("td",null,"Name:",-1),gf=e("td",null,"States:",-1),ff=["onClick"],vf=e("i",{class:"fa fa-trash"},null,-1),bf=[vf],_f=["disabled"],$f=e("td",null,"Slots",-1),yf={class:"column"},wf={class:"avatar-all-images",ref:"allImagesDiv"},kf=["src","data-src"],Cf={class:"modal-card-foot"};function Vf(t,s,a,d,f,p){const u=$("avatar-slot-definition-editor");return t.item?(i(),o("div",af,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...n)=>t.onOverlayClick&&t.onOverlayClick(...n))}),e("div",lf,[e("header",rf,[df,e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...n)=>t.onCloseClick&&t.onCloseClick(...n))})]),e("section",uf,[e("div",mf,[e("div",cf,[e("table",hf,[e("tbody",null,[e("tr",null,[pf,e("td",null,[m(e("input",{class:"input is-small","onUpdate:modelValue":s[2]||(s[2]=n=>t.item.name=n)},null,512),[[_,t.item.name]])])]),e("tr",null,[gf,e("td",null,[(i(!0),o(A,null,P(t.item.stateDefinitions,(n,c)=>(i(),o("span",{class:"tag",key:c},[e("span",null,w(n.value),1),n.deletable?(i(),o("span",{key:0,class:"ml-1 is-clickable",onClick:r=>t.removeStateDefinition(c)},bf,8,ff)):h("",!0)]))),128)),m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=n=>t.newState=n),placeholder:"State"},null,512),[[_,t.newState]]),e("span",{class:"button is-small",onClick:s[4]||(s[4]=(...n)=>t.addStateDefinition&&t.addStateDefinition(...n)),disabled:t.isStateAddable?null:!0},"Add custom state",8,_f)])]),e("tr",null,[$f,e("td",null,[(i(!0),o(A,null,P(t.item.slotDefinitions,(n,c)=>(i(),E(u,{class:"card mb-2",key:c,modelValue:n,avatarDef:t.item,"onUpdate:modelValue":r=>t.updateSlotDefinition(c,r),onMoveUp:r=>t.moveSlotUp(c),onMoveDown:r=>t.moveSlotDown(c),onRemove:r=>t.removeSlotDefinition(c)},null,8,["modelValue","avatarDef","onUpdate:modelValue","onMoveUp","onMoveDown","onRemove"]))),128))])])])]),e("span",{class:"button is-small",onClick:s[5]||(s[5]=(...n)=>t.addSlotDefinition&&t.addSlotDefinition(...n))},"Add slot")]),e("div",yf,[e("div",wf,[(i(!0),o(A,null,P(t.allImages,(n,c)=>(i(),o("img",{key:c,src:n,draggable:"true",class:"mr-1 mb-1",onDragstart:s[6]||(s[6]=(...r)=>t.imageDragStart&&t.imageDragStart(...r)),"data-src":n},null,40,kf))),128))],512)])])],512),e("footer",Cf,[e("button",{class:"button is-small is-primary",onClick:s[7]||(s[7]=(...n)=>t.onSaveClick&&t.onSaveClick(...n))}," Save "),e("button",{class:"button is-small is-primary",onClick:s[8]||(s[8]=(...n)=>t.onSaveAndCloseClick&&t.onSaveAndCloseClick(...n))}," Save and close "),e("button",{class:"button is-small",onClick:s[9]||(s[9]=(...n)=>t.onCancelClick&&t.onCancelClick(...n))},"Cancel")])])])):h("",!0)}var Sf=D(of,[["render",Vf]]);const If=U({props:{modelValue:{type:Object,required:!0},avatarDef:{type:Object,required:!0}},emits:["update:modelValue","remove","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultItem(){return this.modelValue.defaultItemIndex>=0&&this.modelValue.items.length>this.modelValue.defaultItemIndex?this.modelValue.items[this.modelValue.defaultItemIndex]:null},defaultAnimation(){if(!this.defaultItem)return[];const t=this.defaultItem.states.find(({state:s})=>s==="default");return t?t.frames:[]}},methods:{emitChange(){this.$emit("update:modelValue",this.modelValue)},updateItem(t,s){this.modelValue.items[t]=s,this.emitChange()},removeItem(t,s){this.modelValue.items=this.modelValue.items.filter((a,d)=>d!==t),t<=this.modelValue.defaultItemIndex&&(this.modelValue.defaultItemIndex=this.modelValue.defaultItemIndex-1),this.modelValue.items.length>0&&this.modelValue.defaultItemIndex<0&&(this.modelValue.defaultItemIndex=0),this.emitChange()},makeItemDefault(t,s){this.modelValue.defaultItemIndex=t,this.emitChange()},addItem(){const t={title:`${this.modelValue.slot} item ${this.modelValue.items.length+1}`,states:this.avatarDef.stateDefinitions.map(s=>({state:s.value,frames:[]}))};this.modelValue.items.push(t),this.modelValue.defaultItemIndex===-1&&(this.modelValue.defaultItemIndex=0),this.emitChange()},moveItemUp(t){this.swapItems(t-1,t)},moveItemDown(t){this.swapItems(t+1,t)},swapItems(t,s){if(t<0||t>this.modelValue.items.length-1||s<0||s>this.modelValue.items.length-1)return;const a=this.modelValue.items[t];this.modelValue.items[t]=this.modelValue.items[s],this.modelValue.items[s]=a,this.modelValue.defaultItemIndex===t?this.modelValue.defaultItemIndex=s:this.modelValue.defaultItemIndex===s&&(this.modelValue.defaultItemIndex=t),this.modelValue.items=this.modelValue.items.slice()}}}),Uf={class:"avatar-slot-definition-editor"},Df={class:"level avatar-slot-definition-editor-title p-1"},Af={class:"level-left"},Pf={class:"level-item"},Tf={class:"level-item"},Ef={class:"level-right"},Mf={class:"level-item"},Ff={class:"level-item"},Of={class:"level-item"},zf=e("i",{class:"fa fa-trash"},null,-1),Nf=[zf],Rf={class:"p-1"};function jf(t,s,a,d,f,p){const u=$("avatar-animation"),n=$("avatar-slot-item-editor");return i(),o("div",Uf,[e("div",Df,[e("div",Af,[e("div",Pf,[k(u,{frames:t.defaultAnimation,width:32,height:32},null,8,["frames"])]),e("div",Tf,[m(e("input",{class:T(["input is-small avatar-slot-definition-editor-title-input",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=c=>t.titleFocused=!0),onBlur:s[1]||(s[1]=c=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=c=>t.modelValue.slot=c)},null,34),[[_,t.modelValue.slot]])])]),e("div",Ef,[e("div",Mf,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[3]||(s[3]=c=>t.$emit("moveUp"))})]),e("div",Ff,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[4]||(s[4]=c=>t.$emit("moveDown"))})]),e("div",Of,[e("span",{class:"button is-small",onClick:s[5]||(s[5]=c=>t.$emit("remove"))},Nf)])])]),e("div",Rf,[(i(!0),o(A,null,P(t.modelValue.items,(c,r)=>(i(),E(n,{class:T(["card mb-1",{"is-default":r===this.modelValue.defaultItemIndex}]),key:r,modelValue:c,isDefault:r===this.modelValue.defaultItemIndex,onMoveUp:v=>t.moveItemUp(r),onMoveDown:v=>t.moveItemDown(r),"onUpdate:modelValue":v=>t.updateItem(r,v),onRemove:v=>t.removeItem(r,v),onMakeDefault:v=>t.makeItemDefault(r,v)},null,8,["class","modelValue","isDefault","onMoveUp","onMoveDown","onUpdate:modelValue","onRemove","onMakeDefault"]))),128))]),e("span",{class:"button is-small",onClick:s[6]||(s[6]=(...c)=>t.addItem&&t.addItem(...c))},"Add item")])}var Lf=D(If,[["render",jf]]);const qf=U({props:{modelValue:{type:Object,required:!0},isDefault:{type:Boolean,required:!0}},emits:["update:modelValue","makeDefault","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultState(){return this.modelValue.states.find(({state:t})=>t==="default")}},methods:{updateAnimation(t,s){},makeDefault(){this.$emit("makeDefault",this.modelValue)}}}),Jf={class:"avatar-slot-item-editor p-1"},Bf={class:"level"},Wf={class:"level-left"},Hf={class:"level-item"},Kf={class:"level-item"},Gf={key:0,class:"has-text-success mr-1"},Yf=e("i",{class:"fa fa-check"},null,-1),Xf=g(" Default"),Qf=[Yf,Xf],Zf={class:"level-right"},xf={class:"level-item"},tv={class:"level-item"},ev={class:"level-item"},sv=e("i",{class:"fa fa-trash"},null,-1),nv=[sv];function iv(t,s,a,d,f,p){const u=$("avatar-slot-item-state-editor");return i(),o("div",Jf,[e("div",Bf,[e("div",Wf,[e("div",Hf,[m(e("input",{type:"text",class:T(["input is-small avatar-slot-item-editor-title",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=n=>t.titleFocused=!0),onBlur:s[1]||(s[1]=n=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=n=>t.modelValue.title=n)},null,34),[[_,t.modelValue.title]])]),e("div",Kf,[t.isDefault?(i(),o("span",Gf,Qf)):(i(),o("span",{key:1,class:"button is-small",onClick:s[3]||(s[3]=(...n)=>t.makeDefault&&t.makeDefault(...n))},"Make default"))])]),e("div",Zf,[e("div",xf,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[4]||(s[4]=n=>t.$emit("moveUp"))})]),e("div",tv,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[5]||(s[5]=n=>t.$emit("moveDown"))})]),e("div",ev,[e("span",{class:"button is-small",onClick:s[6]||(s[6]=n=>t.$emit("remove"))},nv)])])]),(i(!0),o(A,null,P(t.modelValue.states,(n,c)=>(i(),E(u,{class:"mr-1",modelValue:n,defaultState:t.defaultState,"onUpdate:modelValue":r=>t.updateAnimation(c,r),key:c},null,8,["modelValue","defaultState","onUpdate:modelValue"]))),128))])}var ov=D(qf,[["render",iv]]);const av=U({props:{avatar:{type:Object,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},computed:{animations(){return this.avatar.slotDefinitions.map(t=>t.items[t.defaultItemIndex].states.find(({state:a})=>a==="default"))}}});function lv(t,s,a,d,f,p){const u=$("avatar-animation");return i(),o("div",{class:"avatar-preview",style:J({width:`${t.width}px`,height:`${t.height}px`})},[(i(!0),o(A,null,P(t.animations,(n,c)=>(i(),E(u,{frames:n.frames,key:c,width:t.width,height:t.height},null,8,["frames","width","height"]))),128))],4)}var rv=D(av,[["render",lv]]);const dv=U({props:{modelValue:{type:Object,required:!0},defaultState:{type:Object,required:!0}},data(){return{editing:!1}},methods:{onDragOver(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDragEnter(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDrop(t){if(t.dataTransfer.getData("avatar-image-url")){t.preventDefault();const s={url:t.dataTransfer.getData("avatar-image-url"),duration:100};this.modelValue.frames.push(s)}},onOverlayClick(){this.editing=!1},imageUploaded(t,s){this.modelValue.frames[t].url=`/uploads/${s.filename}`},removeFrame(t){this.modelValue.frames=this.modelValue.frames.filter((s,a)=>a!==t)},addFrame(){const t={url:"",duration:100};this.modelValue.frames.push(t)}}}),uv={class:"avatar-slot-item-state-editor-title"},mv={class:"avatar-animation-frame"},cv={class:"avatar-animation-frame-remove"},hv=["onClick"],pv=e("i",{class:"fa fa-trash"},null,-1),gv=[pv],fv=["src"],vv=["onUpdate:modelValue"],bv={class:"avatar-animation-card mr-1"},_v={class:"avatar-animation-frame"},$v=e("i",{class:"fa fa-plus"},null,-1),yv=[$v];function wv(t,s,a,d,f,p){const u=$("avatar-animation"),n=$("upload");return i(),o("div",{class:"avatar-slot-item-state-editor card",onDragover:s[1]||(s[1]=(...c)=>t.onDragOver&&t.onDragOver(...c)),onDragenter:s[2]||(s[2]=(...c)=>t.onDragEnter&&t.onDragEnter(...c)),onDrop:s[3]||(s[3]=(...c)=>t.onDrop&&t.onDrop(...c))},[e("div",uv,w(t.modelValue.state),1),t.modelValue.frames.length?(i(),E(u,{key:0,frames:t.modelValue.frames},null,8,["frames"])):(i(),E(u,{key:1,frames:t.defaultState.frames,class:"avatar-fallback-animation"},null,8,["frames"])),e("div",null,[(i(!0),o(A,null,P(t.modelValue.frames,(c,r)=>(i(),o("div",{class:"avatar-animation-card mr-1",key:r},[e("span",mv,[e("div",cv,[e("span",{class:"button is-small",onClick:v=>t.removeFrame(r)},gv,8,hv)]),c.url?(i(),o("img",{key:0,src:c.url,width:"64",height:"64"},null,8,fv)):(i(),E(n,{key:1,onUploaded:v=>t.imageUploaded(r,v),accept:"image/*",label:"",class:"avatar-animation-frame-upload"},null,8,["onUploaded"])),m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":v=>c.duration=v},null,8,vv),[[_,c.duration]])])]))),128)),e("div",bv,[e("span",_v,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...c)=>t.addFrame&&t.addFrame(...c))},yv)])])])],32)}var kv=D(dv,[["render",wv]]);const Cv=U({props:{frames:{type:Array,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},data(){return{timeout:null,idx:-1}},watch:{frames:{handler(t,s){this.nextFrame()},deep:!0}},computed:{src(){return this.idx>=0&&this.idx<this.frames.length?this.frames[this.idx].url:""}},methods:{nextFrame(){if(this.frames.length===0){this.idx=-1;return}this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.idx++,this.idx>=this.frames.length&&(this.idx=0),this.timeout=setTimeout(()=>{this.nextFrame()},this.frames[this.idx].duration)}},created(){this.nextFrame()},unmounted(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}),Vv={class:"avatar-animation"},Sv=["src","width","height"];function Iv(t,s,a,d,f,p){return i(),o("span",Vv,[t.src?(i(),o("img",{key:0,src:t.src,width:t.width,height:t.height},null,8,Sv)):(i(),o("span",{key:1,style:J({width:`${t.width}px`,height:`${t.width}px`,display:"inline-block"})},null,4))])}var Uv=D(Cv,[["render",Iv]]);const Dv=async()=>{const t=_t({history:$t(),routes:[{name:"index",path:"/",component:zt,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:ie,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:xs,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:sr,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:vr,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:Ki,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:ys,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:Mi,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:tl,meta:{title:"Speech to text",protected:!0}},{name:"avatar",path:"/avatar/",component:jl,meta:{title:"Avatar",protected:!0}},{name:"drawcast",path:"/drawcast/",component:os,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:Hn,meta:{title:"Settings",protected:!0}}]});await W.init(),await R.init(),t.beforeEach((a,d,f)=>{if(a.meta.protected&&!R.getMe()){f({name:"login"});return}if(!a.meta.protected&&R.getMe()){f({name:"index"});return}d.name&&document.documentElement.classList.remove(`view-${String(d.name)}`),document.documentElement.classList.add(`view-${String(a.name)}`),document.title=`${a.meta.title}`,f()});const s=yt(Ut);s.use(t),s.use(wt,{}),s.component("doubleclick-button",gd),s.component("draggable",kt),s.component("duration-input",Sr),s.component("duration",md),s.component("navbar",ad),s.component("player",Dr),s.component("responsive-image",Hr),s.component("slider",Rr),s.component("upload",kr),s.component("volume-slider",qr),s.component("youtube",wd),s.component("commands-editor",Gc),s.component("command-editor",Em),s.component("countdown-editor",Gh),s.component("trigger-editor",Dp),s.component("playlist-editor",pg),s.component("tags-editor",nf),s.component("song-request-settings",Yg),s.component("avatar-editor",Sf),s.component("avatar-slot-definition-editor",Lf),s.component("avatar-slot-item-editor",ov),s.component("avatar-preview",rv),s.component("avatar-slot-item-state-editor",kv),s.component("avatar-animation",Uv),s.mount("#app")};Dv();
