var rt=Object.defineProperty;var ut=(s,e,i)=>e in s?rt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;var G=(s,e,i)=>(ut(s,typeof e!="symbol"?e+"":e,i),i);import{d as V,r as _,o as l,c as o,a as b,b as t,F as U,e as T,t as k,f as u,w as h,v as f,g as N,h as E,i as p,j,n as q,k as I,l as R,p as W,m as H,q as x,s as ct,u as nt,x as ht,y as pt,z as mt,A as gt,B as ft}from"./vendor.d17456b7.js";const yt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const m of c)if(m.type==="childList")for(const r of m.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&g(r)}).observe(document,{childList:!0,subtree:!0});function i(c){const m={};return c.integrity&&(m.integrity=c.integrity),c.referrerpolicy&&(m.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?m.credentials="include":c.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function g(c){if(c.ep)return;c.ep=!0;const m=i(c);fetch(c.href,m)}};yt();var S=(s,e)=>{for(const[i,g]of e)s[i]=g;return s};const vt=V({name:"app"}),$t={id:"app"};function _t(s,e,i,g,c,m){const r=_("router-view");return l(),o("div",$t,[b(r)])}var bt=S(vt,[["render",_t]]);const kt=V({data:()=>({widgets:null}),async created(){const s=await fetch("/api/page/index");if(s.status!==200){this.$router.push({name:"login"});return}const e=await s.json();this.widgets=e.widgets}}),wt={key:0,id:"app"},Ct={id:"top",ref:"top"},Vt={id:"main",ref:"main"},St={class:"table is-striped is-fullwidth"},Ut=t("thead",null,[t("tr",null,[t("th",null,"Widget"),t("th",null,"Hint")])],-1),It=["href"];function Pt(s,e,i,g,c,m){const r=_("navbar");return s.widgets?(l(),o("div",wt,[t("div",Ct,[b(r)],512),t("div",Vt,[t("table",St,[Ut,t("tbody",null,[(l(!0),o(U,null,T(s.widgets,(n,$)=>(l(),o("tr",{key:$},[t("td",null,[t("a",{href:n.url,target:"blank"},k(n.title),9,It)]),t("td",null,k(n.hint),1)]))),128))])])],512)])):u("",!0)}var Tt=S(kt,[["render",Pt]]);const At=V({data:()=>({user:"",pass:"",error:"",success:""}),async mounted(){const e=new URLSearchParams(window.location.search).get("t");if(e){this.success="",this.error="";const i=await fetch("/api/_handle-token",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:e})});i.status===200?(await i.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const s=await fetch("/api/auth",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,pass:this.pass})});s.status===200?this.$router.push({name:"index"}):s.status===401?this.error=(await s.json()).reason:this.error="Unknown error"}}}),Dt={class:"center-screen"},Mt=t("h1",{class:"title is-6"},"Hyottoko.club",-1),Et={key:0,class:"field has-background-success-light has-text-success-dark"},Lt={key:1,class:"field has-background-danger-light has-text-danger-dark"},jt={class:"field"},Rt={class:"control has-icons-left"},Ot=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-user"})],-1),Nt={class:"field"},Ft={class:"control has-icons-left"},Jt=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-lock"})],-1),Bt={class:"field"},zt={class:"field"},qt=p("Register an account"),Wt=p(" | "),Ht=p("Forgot password?");function Kt(s,e,i,g,c,m){const r=_("router-link");return l(),o("div",Dt,[Mt,t("form",null,[s.success?(l(),o("div",Et,k(s.success),1)):u("",!0),s.error?(l(),o("div",Lt,k(s.error),1)):u("",!0),t("div",jt,[t("div",Rt,[h(t("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":e[0]||(e[0]=n=>s.user=n),onKeyup:e[1]||(e[1]=n=>s.error="")},null,544),[[f,s.user]]),Ot])]),t("div",Nt,[t("div",Ft,[h(t("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":e[2]||(e[2]=n=>s.pass=n),onKeyup:[e[3]||(e[3]=n=>s.error=""),e[4]||(e[4]=N((...n)=>s.submit&&s.submit(...n),["enter"]))]},null,544),[[f,s.pass]]),Jt])]),t("div",Bt,[t("span",{class:"button is-small is-primary",onClick:e[5]||(e[5]=(...n)=>s.submit&&s.submit(...n))},"Login")]),t("div",zt,[b(r,{to:{name:"register"}},{default:E(()=>[qt]),_:1}),Wt,b(r,{to:{name:"forgot-password"}},{default:E(()=>[Ht]),_:1})])])])}var Gt=S(At,[["render",Kt]]);const Yt=1001,lt=4e3;class Xt{constructor(e,i){G(this,"handle",null);G(this,"reconnectTimeout",null);G(this,"sendBuffer",[]);this.addr=e,this.protocols=i,this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{}}send(e){this.handle?this.handle.send(e):this.sendBuffer.push(e)}connect(){let e=new WebSocket(this.addr,this.protocols);e.onopen=i=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=e;this.sendBuffer.length>0;)this.handle.send(this.sendBuffer.shift());this.onopen(i)},e.onmessage=i=>{this.onmessage(i)},e.onclose=i=>{this.handle=null,i.code===lt||i.code===Yt||(this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3)),this.onclose(i)}}disconnect(){this.handle&&this.handle.close(lt)}}const Qt=(...s)=>console.log("[WsClient.js]",...s);class Y extends Xt{constructor(e,i){super(e,i);this._on={},this.onopen=g=>{this._dispatch("socket","open",g)},this.onmessage=g=>{if(this._dispatch("socket","message",g),this._on.message){const c=this._parseMessageData(g.data);c.event&&this._dispatch("message",c.event,c.data)}},this.onclose=g=>{this._dispatch("socket","close",g)}}onSocket(e,i){this.addEventListener("socket",e,i)}onMessage(e,i){this.addEventListener("message",e,i)}addEventListener(e,i,g){const c=Array.isArray(i)?i:[i];this._on[e]=this._on[e]||{};for(const m of c)this._on[e][m]=this._on[e][m]||[],this._on[e][m].push(g)}_parseMessageData(e){try{const i=JSON.parse(e);if(i.event)return{event:i.event,data:i.data||null}}catch{}return{event:null,data:null}}_dispatch(e,i,...g){const m=(this._on[e]||{})[i]||[];if(m.length!==0){Qt(`ws dispatch ${e} ${i}`);for(const r of m)r(...g)}}}const tt=async(s,e,i)=>new Promise((g,c)=>{const m=new window.XMLHttpRequest;m.open(s,e,!0),m.withCredentials=!0;for(const r in i.headers||{})m.setRequestHeader(r,i.headers[r]);m.addEventListener("load",function(r){g({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),m.addEventListener("error",function(r){c(new Error("xhr error"))}),m.upload&&i.onUploadProgress&&m.upload.addEventListener("progress",function(r){i.onUploadProgress&&i.onUploadProgress(r)}),m.send(i.body)});var st={request:tt,get:(s,e)=>tt("get",s,e),post:(s,e)=>tt("post",s,e)};const Zt=V({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null,drawUrl:"",favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}}}),async created(){this.ws=new Y(this.$conf.wsBase+"/drawcast",this.$me.token),this.ws.onMessage("init",async s=>{this.settings=s.settings,this.defaultSettings=s.defaultSettings,this.unchangedJson=JSON.stringify(s.settings),this.drawUrl=s.drawUrl;const e=await st.get("/api/drawcast/all-images/",{});this.favoriteSelection.items=await e.json()}),this.ws.connect()},watch:{settings:{deep:!0,handler(s){this.changedJson=JSON.stringify(s)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},receiveUrl(){return`${location.protocol}//${location.host}/widget/drawcast_receive/${this.$me.widgetToken}/`},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage==0?0:1)},currentFavoriteSelectionItems(){const s=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(s,s+this.favoriteSelection.pagination.perPage)}},methods:{toggleFavorite(s){this.settings.favorites.includes(s)?this.settings.favorites=this.settings.favorites.filter(e=>e!==s):this.settings.favorites.push(s)},soundUploaded(s){this.settings.notificationSound={filename:s.originalname,file:s.filename,volume:100}},sendSave(){this.sendMsg({event:"save",settings:{canvasWidth:parseInt(this.settings.canvasWidth,10)||720,canvasHeight:parseInt(this.settings.canvasHeight,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,customDescription:this.settings.customDescription,palette:this.settings.palette,displayDuration:parseInt(this.settings.displayDuration,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,notificationSound:this.settings.notificationSound,favorites:this.settings.favorites}})},sendMsg(s){this.ws.send(JSON.stringify(s))}},unmounted(){this.ws&&this.ws.disconnect()}}),xt={id:"app"},ts={id:"top",ref:"top"},ss={id:"actionbar",class:"p-1"},es=["disabled"],ns=["href"],ls=["href"],os={id:"main",ref:"main"},is={key:0,class:"table is-striped",ref:"table"},as=t("tr",null,[t("td",{colspan:"3"},"General")],-1),ds=t("td",null,[t("code",null,"settings.canvasWidth")],-1),rs=t("td",null,[p(" Width of the drawing area."),t("br"),p(" Caution: changing this will clear the area for currenty connected users. ")],-1),us=t("td",null,[t("code",null,"settings.canvasHeight")],-1),cs=t("td",null,[p(" Height of the drawing area."),t("br"),p(" Caution: changing this will clear the area for currenty connected users. ")],-1),hs=t("td",null,[t("code",null,"settings.displayDuration")],-1),ps=t("td",null," The duration in Milliseconds that each drawing will be shown ",-1),ms=t("td",null,[t("code",null,"settings.displayLatestForever")],-1),gs=t("td",null,"If checked, the latest drawing will be shown indefinately.",-1),fs=t("td",null,[t("code",null,"settings.displayLatestAutomatically")],-1),ys=t("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),vs=t("td",null,[t("code",null,"settings.submitButtonText")],-1),$s=t("td",null,null,-1),_s=t("td",null,[t("code",null,"settings.submitConfirm")],-1),bs=t("td",null," Leave empty if no confirm is required by user before sending. ",-1),ks=t("td",null,[t("code",null,"settings.customDescription")],-1),ws=t("td",null,"Description text below the drawing panel.",-1),Cs=t("td",null,[t("code",null,"settings.palette")],-1),Vs=["onUpdate:modelValue"],Ss=t("br",null,null,-1),Us=t("br",null,null,-1),Is=t("td",null,[p(" Default colors appearing on the draw page."),t("br"),p(" Caution: Changing this will change selected color for currenty connected users. ")],-1),Ps=t("td",null,[t("code",null,"settings.notificationSound")],-1),Ts={key:0,class:"spacerow media-holder"},As=t("i",{class:"fa fa-remove"},null,-1),Ds=[As],Ms=t("td",null,[p(" Add a sound here that plays when new drawings arrive. "),t("br"),p(" Note: Not played in drawing window, only in widget. ")],-1),Es=t("code",null,"settings.favorites",-1),Ls={class:"preview"},js=["src"],Rs=t("div",null,"Currently selected favorites:",-1),Os={class:"favorites"},Ns=["src","onClick","onMouseover"],Fs=t("div",{class:"mt-2"},"Select favorites:",-1),Js={class:"favorites-select"},Bs=["src","onClick","onMouseover"],zs=["disabled"],qs=["disabled"],Ws=t("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function Hs(s,e,i,g,c,m){const r=_("navbar"),n=_("player"),$=_("volume-slider"),y=_("upload");return l(),o("div",xt,[t("div",ts,[b(r),t("div",ss,[t("button",{class:"button is-small is-primary mr-1",disabled:!s.changed,onClick:e[0]||(e[0]=(...v)=>s.sendSave&&s.sendSave(...v))}," Save ",8,es),t("a",{class:"button is-small mr-1",href:s.receiveUrl,target:"_blank"},"Open widget",8,ns),t("a",{class:"button is-small",href:s.drawUrl,target:"_blank"},"Open draw",8,ls)])],512),t("div",os,[s.settings?(l(),o("table",is,[t("tbody",null,[as,t("tr",null,[ds,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[1]||(e[1]=v=>s.settings.canvasWidth=v)},null,512),[[f,s.settings.canvasWidth]])]),rs]),t("tr",null,[us,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[2]||(e[2]=v=>s.settings.canvasHeight=v)},null,512),[[f,s.settings.canvasHeight]])]),cs]),t("tr",null,[hs,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[3]||(e[3]=v=>s.settings.displayDuration=v)},null,512),[[f,s.settings.displayDuration]])]),ps]),t("tr",null,[ms,t("td",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=v=>s.settings.displayLatestForever=v)},null,512),[[j,s.settings.displayLatestForever]])]),gs]),t("tr",null,[fs,t("td",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=v=>s.settings.displayLatestAutomatically=v)},null,512),[[j,s.settings.displayLatestAutomatically]])]),ys]),t("tr",null,[vs,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[6]||(e[6]=v=>s.settings.submitButtonText=v)},null,512),[[f,s.settings.submitButtonText]])]),$s]),t("tr",null,[_s,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[7]||(e[7]=v=>s.settings.submitConfirm=v)},null,512),[[f,s.settings.submitConfirm]])]),bs]),t("tr",null,[ks,t("td",null,[h(t("textarea",{class:"textarea","onUpdate:modelValue":e[8]||(e[8]=v=>s.settings.customDescription=v)},null,512),[[f,s.settings.customDescription]])]),ws]),t("tr",null,[Cs,t("td",null,[(l(!0),o(U,null,T(s.settings.palette,(v,P)=>(l(),o("label",{class:"square",key:P},[h(t("input",{type:"color","onUpdate:modelValue":a=>s.settings.palette[P]=a},null,8,Vs),[[f,s.settings.palette[P]]]),t("span",{class:"square-inner",style:q({backgroundColor:v})},null,4)]))),128)),Ss,Us,t("button",{class:"button is-small",onClick:e[9]||(e[9]=v=>s.settings.palette=s.defaultSettings.palette)}," Reset to default palette ")]),Is]),t("tr",null,[Ps,t("td",null,[s.settings.notificationSound?(l(),o("div",Ts,[b(n,{src:s.settings.notificationSound.file,name:s.settings.notificationSound.filename,volume:s.settings.notificationSound.volume,class:"button is-small"},null,8,["src","name","volume"]),b($,{modelValue:s.settings.notificationSound.volume,"onUpdate:modelValue":e[10]||(e[10]=v=>s.settings.notificationSound.volume=v)},null,8,["modelValue"]),t("button",{class:"button is-small",onClick:e[11]||(e[11]=v=>s.settings.notificationSound=null)},Ds)])):u("",!0),b(y,{onUploaded:s.soundUploaded,accept:"audio/*",label:"Upload Audio"},null,8,["onUploaded"])]),Ms]),t("tr",null,[t("td",null,[Es,t("div",Ls,[s.favoriteSelection.hovered?(l(),o("img",{key:0,src:s.favoriteSelection.hovered},null,8,js)):u("",!0)])]),t("td",null,[Rs,t("div",Os,[(l(!0),o(U,null,T(s.settings.favorites,(v,P)=>(l(),o("img",{src:v,key:P,width:"50",height:"50",onClick:a=>s.toggleFavorite(v),onMouseover:a=>s.favoriteSelection.hovered=v,onMouseleave:e[12]||(e[12]=a=>s.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,Ns))),128))]),Fs,t("div",Js,[(l(!0),o(U,null,T(s.currentFavoriteSelectionItems,(v,P)=>(l(),o("img",{src:v,key:P,width:"50",height:"50",onClick:a=>s.toggleFavorite(v),onMouseover:a=>s.favoriteSelection.hovered=v,onMouseleave:e[13]||(e[13]=a=>s.favoriteSelection.hovered=""),class:I(["thumbnail mr-1",{"is-favorited":s.settings.favorites.includes(v)}])},null,42,Bs))),128))]),t("span",{class:"button is-small",onClick:e[14]||(e[14]=v=>s.favoriteSelection.pagination.page=s.favoriteSelection.pagination.page-1),disabled:s.favoriteSelection.pagination.page>1?null:!0},"Prev",8,zs),t("span",{class:"button is-small",onClick:e[15]||(e[15]=v=>s.favoriteSelection.pagination.page=s.favoriteSelection.pagination.page+1),disabled:s.favoriteSelection.pagination.page<s.favoriteSelectionTotalPages?null:!0},"Next",8,qs)]),Ws])])],512)):u("",!0)],512)])}var Ks=S(Zt,[["render",Hs]]);const Gs=V({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(s){this.variables=this.variables.filter((e,i)=>i!==s)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await fetch("/save-variables",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({variables:this.variables})}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const s=await fetch("/api/page/variables");if(s.status!==200){this.$router.push({name:"login"});return}const e=await s.json();this.variables=e.variables,this.setUnchanged()}}),Ys={id:"app"},Xs={id:"top",ref:"top"},Qs={id:"actionbar",class:"p-1"},Zs=["disabled"],xs={id:"main"},te={class:"mb-4"},se=t("h1",{class:"title mb-2"},"Global Variables",-1),ee=t("div",{class:"help"},[p(" Variables can be used from commands with "),t("code",null,"$var(variable_name)"),p(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),ne={class:"table is-striped"},le=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Value"),t("th")])],-1),oe=["onUpdate:modelValue"],ie=["onUpdate:modelValue"],ae=t("i",{class:"fa fa-trash"},null,-1);function de(s,e,i,g,c,m){const r=_("navbar"),n=_("doubleclick-button");return l(),o("div",Ys,[t("div",Xs,[b(r),t("div",Qs,[t("button",{class:"button is-small",onClick:e[0]||(e[0]=(...$)=>s.onAdd&&s.onAdd(...$))},"Add"),t("button",{class:"button is-small is-primary",disabled:!s.changed,onClick:e[1]||(e[1]=(...$)=>s.sendSave&&s.sendSave(...$))}," Save ",8,Zs)])],512),t("div",xs,[t("div",te,[se,ee,t("table",ne,[le,t("tbody",null,[(l(!0),o(U,null,T(s.variables,($,y)=>(l(),o("tr",{key:y},[t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":v=>$.name=v},null,8,oe),[[f,$.name]])]),t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":v=>$.value=v},null,8,ie),[[f,$.value]])]),t("td",null,[b(n,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:v=>s.remove(y)},{default:E(()=>[ae]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var re=S(Gs,[["render",de]]);const ue=V({data:()=>({user:"",pass:"",email:"",error:"",success:!1}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const s=await fetch("/api/user/_resend_verification_mail",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.email})});if(s.status===200)this.success=!0;else try{this.error=(await s.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const s=await fetch("/api/user/_register",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,pass:this.pass,email:this.email})});if(s.status===200)this.success=!0;else try{this.error=(await s.json()).reason}catch{this.error="Unknown error"}}}}),ce={class:"center-screen"},he=t("h1",{class:"title is-6"},"Hyottoko.club",-1),pe={key:0,class:"field has-background-success-light has-text-success-dark"},me=p(" Account registered. Please check your mail. Click "),ge=p("here"),fe=p(" to login. "),ye={key:1},ve={key:0,class:"field has-background-danger-light has-text-danger-dark"},$e={key:0},_e=p(" A user with this email is already registered. "),be=t("br",null,null,-1),ke=p("Request a password reset."),we={key:1},Ce=p(" A user with this email is already registered. "),Ve=t("br",null,null,-1),Se={key:2},Ue={key:3},Ie={key:4},Pe={class:"field"},Te={class:"control has-icons-left"},Ae=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-user"})],-1),De={class:"field"},Me={class:"control has-icons-left"},Ee=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-envelope"})],-1),Le={class:"field"},je={class:"control has-icons-left"},Re=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-lock"})],-1),Oe={class:"field"},Ne=["disabled"];function Fe(s,e,i,g,c,m){const r=_("router-link");return l(),o("div",ce,[he,s.success?(l(),o("div",pe,[me,b(r,{to:{name:"login"}},{default:E(()=>[ge]),_:1}),fe])):(l(),o("div",ye,[s.error?(l(),o("div",ve,[s.error==="verified_mail_already_exists"?(l(),o("div",$e,[_e,be,b(r,{to:{name:"forgot-password"}},{default:E(()=>[ke]),_:1})])):s.error==="unverified_mail_already_exists"?(l(),o("div",we,[Ce,Ve,t("span",{class:"button is-small",onClick:e[0]||(e[0]=(...n)=>s.onRequestVerificationEmail&&s.onRequestVerificationEmail(...n))},"Resend verification email")])):s.error==="verified_name_already_exists"?(l(),o("div",Se," A user with this name is already registered. ")):s.error==="unverified_name_already_exists"?(l(),o("div",Ue," A user with this name is already registered. ")):(l(),o("span",Ie,k(s.error),1))])):u("",!0),t("div",Pe,[t("div",Te,[h(t("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":[e[1]||(e[1]=n=>s.user=n),e[2]||(e[2]=n=>s.error="")]},null,512),[[f,s.user]]),Ae])]),t("div",De,[t("div",Me,[h(t("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":[e[3]||(e[3]=n=>s.email=n),e[4]||(e[4]=n=>s.error="")]},null,512),[[f,s.email]]),Ee])]),t("div",Le,[t("div",je,[h(t("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":[e[5]||(e[5]=n=>s.pass=n),e[6]||(e[6]=n=>s.error="")],onKeyup:e[7]||(e[7]=N((...n)=>s.submit&&s.submit(...n),["enter"]))},null,544),[[f,s.pass]]),Re])]),t("div",Oe,[t("button",{class:"button is-small is-primary",disabled:s.canRegister?null:!0,onClick:e[8]||(e[8]=(...n)=>s.submit&&s.submit(...n))}," Register ",8,Ne)])]))])}var Je=S(ue,[["render",Fe]]);const Be=V({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[]},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const s=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],e=document.location,i=`${e.protocol}//${e.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${i}&scope=${s.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(s){this.twitch_channels=this.twitch_channels.filter((e,i)=>i!==s)},addchannel(){this.twitch_channels.push({channel_id:"",channel_name:"",access_token:""})},async loadid(s){this.twitch_channels[s].channel_id=await this.getUserIdByName(this.twitch_channels[s].channel_name)},async getUserIdByName(s){const e={name:s,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},i=await fetch("/twitch/user-id-by-name",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});try{return(await i.json()).id}catch{return""}},async sendSave(){await fetch("/api/save-settings",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const s=await fetch("/api/page/settings");if(s.status!==200){this.$router.push({name:"login"});return}const e=await s.json();this.user=e.user,this.twitch_channels=e.twitchChannels,this.setUnchanged()}}),ze={id:"app"},qe={id:"top",ref:"top"},We={id:"actionbar",class:"p-1"},He=["disabled"],Ke={id:"main"},Ge={class:"mb-4"},Ye=t("h1",{class:"title mb-2"},"User",-1),Xe={class:"table is-striped"},Qe=t("td",null,"Name:",-1),Ze=t("td",null,"Email:",-1),xe=t("td",null,"Password:",-1),tn={key:0,class:"mb-4"},sn=t("h1",{class:"title mb-2"},"Twitch-Bot",-1),en=t("p",null,[p(" Please refer to "),t("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),p(". ")],-1),nn={class:"table is-striped"},ln=t("td",null,"Bot name:",-1),on=t("td",null,"Bot oauth (pass):",-1),an=t("td",null,"Bot client_id:",-1),dn=t("td",null,"Bot client_secret:",-1),rn={class:"mb-4"},un=t("h1",{class:"title mb-2"},"Twitch Channels",-1),cn=p(" List of twitch channels where the bot will connect to. "),hn={key:0},pn={key:0,class:"table is-striped"},mn=t("thead",null,[t("tr",null,[t("td",null,"Channel name"),t("td",null,"Channel id*"),t("td",null,"Access Token*"),t("td")])],-1),gn=["onUpdate:modelValue"],fn=["onUpdate:modelValue"],yn=["onClick"],vn=["onUpdate:modelValue"],$n=["onClick"],_n=t("i",{class:"fa fa-remove"},null,-1),bn=[_n],kn={key:1,class:"content"},wn=t("p",null," Channel Id* and Access Token*: You may not need the client id or access token. No public feature currently uses them. ",-1),Cn={key:0},Vn={key:1,class:"list"},Sn=t("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Un={class:"list-item"},In=p(" Click "),Pn=["href"],Tn=p(" to authorize the bot with the channel "),An=t("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),Dn={key:2};function Mn(s,e,i,g,c,m){const r=_("navbar");return l(),o("div",ze,[t("div",qe,[b(r),t("div",We,[t("button",{class:"button is-small is-primary",disabled:!s.changed,onClick:e[0]||(e[0]=(...n)=>s.sendSave&&s.sendSave(...n))}," Save ",8,He)])],512),t("div",Ke,[t("div",Ge,[Ye,t("table",Xe,[t("tbody",null,[t("tr",null,[Qe,t("td",null,k(s.user.name),1)]),t("tr",null,[Ze,t("td",null,[h(t("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=n=>s.user.email=n)},null,512),[[f,s.user.email]])])]),t("tr",null,[xe,t("td",null,[h(t("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=n=>s.user.pass=n)},null,512),[[f,s.user.pass]])])])])])]),s.isAdmin?(l(),o("div",tn,[sn,en,t("table",nn,[t("tbody",null,[t("tr",null,[ln,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>s.user.tmi_identity_username=n)},null,512),[[f,s.user.tmi_identity_username]])])]),t("tr",null,[on,t("td",null,[h(t("input",{class:"input is-small",type:"password","onUpdate:modelValue":e[4]||(e[4]=n=>s.user.tmi_identity_password=n)},null,512),[[f,s.user.tmi_identity_password]])])]),t("tr",null,[an,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[5]||(e[5]=n=>s.user.tmi_identity_client_id=n)},null,512),[[f,s.user.tmi_identity_client_id]])])]),t("tr",null,[dn,t("td",null,[h(t("input",{class:"input is-small",type:"password","onUpdate:modelValue":e[6]||(e[6]=n=>s.user.tmi_identity_client_secret=n)},null,512),[[f,s.user.tmi_identity_client_secret]])])])])])])):u("",!0),t("div",rn,[un,t("p",null,[cn,s.twitch_channels.length===0?(l(),o("span",hn," Currently no channels are configured. ")):u("",!0)]),s.twitch_channels.length>0?(l(),o("table",pn,[mn,t("tbody",null,[(l(!0),o(U,null,T(s.twitch_channels,(n,$)=>(l(),o("tr",{key:n.channel_name},[t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":y=>n.channel_name=y},null,8,gn),[[f,n.channel_name]])]),t("td",null,[n.channel_id?h((l(),o("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":y=>n.channel_id=y},null,8,fn)),[[f,n.channel_id]]):u("",!0),n.channel_id?u("",!0):(l(),o("button",{key:1,class:"button is-small",onClick:y=>s.loadid($)}," Load id ",8,yn))]),t("td",null,[h(t("input",{class:"input is-small",type:"password","onUpdate:modelValue":y=>n.access_token=y},null,8,vn),[[f,n.access_token]])]),t("td",null,[t("button",{class:"button is-small",onClick:y=>s.rmchannel($)},bn,8,$n)])]))),128))])])):u("",!0),t("button",{class:"button is-small",onClick:e[7]||(e[7]=n=>s.addchannel())}," Add channel ")]),s.twitch_channels.length>0?(l(),o("div",kn,[wn,s.accessTokenLink?(l(),o("p",Cn,"To get an access token, do the following:")):u("",!0),s.accessTokenLink?(l(),o("ol",Vn,[Sn,t("li",Un,[In,t("a",{href:s.accessTokenLink,target:"_blank"},"here",8,Pn),Tn]),An])):s.isAdmin?(l(),o("p",Dn,' To configure an access token, please configure the "Bot client_id" above. ')):u("",!0)])):u("",!0)])])}var En=S(Be,[["render",Mn]]);const Ln=V({data:()=>({playerVisible:!1,playlist:[],settings:{volume:100,hideVideoImage:{file:"",filename:""},showProgressBar:!1,customCss:"",customCssPresets:[]},filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:""}),computed:{tags(){const s=[];return this.playlist.forEach(e=>{e.tags.forEach(i=>{const g=s.findIndex(c=>c.value===i);g===-1?s.push({value:i,count:1}):s[g].count++})}),s},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(s=>s.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},importPlaylistUrl(){return`${location.protocol}//${location.host}/sr/import`},exportPlaylistUrl(){return`${location.protocol}//${location.host}/sr/export`},widgetUrl(){return`${location.protocol}//${location.host}/widget/sr/${this.$me.widgetToken}/`}},methods:{sendSettings(){this.sendCtrl("settings",[this.settings])},onTagUpdated(s){this.updateTag(s[0],s[1])},onPlaylistCtrl(s){this.sendCtrl(s[0],s[1])},applyFilter(s){this.sendCtrl("filter",[{tag:s}])},async doImportPlaylist(){(await st.post(this.importPlaylistUrl,{headers:{Accept:"application/json","Content-Type":"application/json"},body:this.importPlaylist})).status===200?(this.tab="playlist",this.$toasted.success("Import successful")):this.$toasted.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(s,e){this.sendMsg({event:"ctrl",ctrl:s,args:e})},ended(){this.sendMsg({event:"ended"})},sendMsg(s){this.ws?this.ws.send(JSON.stringify(s)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(s){this.player.setVolume(s)},updateTag(s,e){s!==e&&this.sendCtrl("updatetag",[s,e])}},async mounted(){this.$nextTick(()=>{this.ws=new Y(this.$conf.wsBase+"/sr",this.$me.token),this.ws.onMessage("settings",s=>{this.settings=s.settings}),this.ws.onMessage(["pause"],s=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],s=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],s=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],s=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","clear","move","tags"],s=>{this.settings=s.settings;const e=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=s.filter,this.playlist=s.playlist;const i=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;e!==i&&this.play()}),this.ws.onMessage(["filter"],s=>{this.settings=s.settings;const e=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=s.filter,this.playlist=s.playlist,this.filteredPlaylist.find(i=>i.id===e)||this.play()}),this.ws.onMessage(["dislike","like","video","playIdx","resetStats","shuffle"],s=>{this.settings=s.settings,this.filter=s.filter,this.playlist=s.playlist}),this.ws.onMessage(["add","init"],s=>{this.settings=s.settings,this.filter=s.filter,this.playlist=s.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),D=s=>(W("data-v-255c1852"),s=s(),H(),s),jn={id:"app"},Rn={id:"top",ref:"top"},On={id:"actionbar",class:"p-1"},Nn=["disabled"],Fn=D(()=>t("i",{class:"fa fa-eraser mr-1"},null,-1)),Jn=D(()=>t("span",{class:"txt"}," Reset stats",-1)),Bn=[Fn,Jn],zn=["disabled"],qn=D(()=>t("i",{class:"fa fa-eject mr-1"},null,-1)),Wn=D(()=>t("span",{class:"txt"}," Clear",-1)),Hn=[qn,Wn],Kn=["disabled"],Gn=D(()=>t("i",{class:"fa fa-random mr-1"},null,-1)),Yn=D(()=>t("span",{class:"txt"}," Shuffle",-1)),Xn=[Gn,Yn],Qn=["disabled","title"],Zn=D(()=>t("i",{class:"fa fa-tv mr-1"},null,-1)),xn={class:"txt"},tl={class:"field has-addons mr-1"},sl={class:"control"},el=["disabled"],nl={class:"control"},ll=["disabled"],ol=D(()=>t("i",{class:"fa fa-search mr-1"},null,-1)),il=p(" from playlist "),al=[ol,il],dl={class:"field has-addons mr-1"},rl={class:"control"},ul=["disabled"],cl={class:"control"},hl=["disabled"],pl=D(()=>t("i",{class:"fa fa-plus mr-1"},null,-1)),ml=p(" from YouTube "),gl=[pl,ml],fl=["disabled","href"],yl={id:"main",ref:"main"},vl={style:{width:"640px","max-width":"100%"}},$l={class:"tabs"},_l=D(()=>t("a",null,"Playlist",-1)),bl=[_l],kl=D(()=>t("a",null,"Settings",-1)),wl=[kl],Cl=D(()=>t("a",null,"Help",-1)),Vl=[Cl],Sl=D(()=>t("a",null,"Tags",-1)),Ul=[Sl],Il=D(()=>t("a",null,"Import/Export",-1)),Pl=[Il],Tl={key:0},Al={class:"mb-1"},Dl=["href"],Ml=D(()=>t("i",{class:"fa fa-download mr-1"},null,-1)),El=p(" Export playlist"),Ll=[Ml,El],jl=D(()=>t("i",{class:"fa fa-upload mr-1"},null,-1)),Rl=p(" Import playlist "),Ol=[jl,Rl],Nl={key:1,id:"help"},Fl={key:2,id:"tags"},Jl={key:4,id:"playlist",class:"table-container"};function Bl(s,e,i,g,c,m){const r=_("navbar"),n=_("youtube"),$=_("help"),y=_("tags-editor"),v=_("song-request-settings"),P=_("playlist-editor");return l(),o("div",jn,[t("div",Rn,[b(r),t("div",On,[t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[0]||(e[0]=a=>s.sendCtrl("resetStats",[])),title:"Reset stats"},Bn,8,Nn),t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[1]||(e[1]=a=>s.sendCtrl("clear",[])),title:"Clear"},Hn,8,zn),t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[2]||(e[2]=a=>s.sendCtrl("shuffle",[])),title:"Shuffle"},Xn,8,Kn),t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[3]||(e[3]=(...a)=>s.togglePlayer&&s.togglePlayer(...a)),title:s.togglePlayerButtonText},[Zn,t("span",xn,k(s.togglePlayerButtonText),1)],8,Qn),t("div",tl,[t("div",sl,[h(t("input",{class:"input is-small",disabled:s.inited?null:!0,"onUpdate:modelValue":e[4]||(e[4]=a=>s.resrinput=a),onKeyup:e[5]||(e[5]=N((...a)=>s.resr&&s.resr(...a),["enter"]))},null,40,el),[[f,s.resrinput]])]),t("div",nl,[t("button",{class:"button is-small",disabled:s.inited?null:!0,onClick:e[6]||(e[6]=(...a)=>s.resr&&s.resr(...a))},al,8,ll)])]),t("div",dl,[t("div",rl,[h(t("input",{class:"input is-small",disabled:s.inited?null:!0,"onUpdate:modelValue":e[7]||(e[7]=a=>s.srinput=a),onKeyup:e[8]||(e[8]=N((...a)=>s.sr&&s.sr(...a),["enter"]))},null,40,ul),[[f,s.srinput]])]),t("div",cl,[t("button",{class:"button is-small",disabled:s.inited?null:!0,onClick:e[9]||(e[9]=(...a)=>s.sr&&s.sr(...a))},gl,8,hl)])]),t("a",{class:"button is-small mr-1",disabled:s.inited?null:!0,href:s.widgetUrl,target:"_blank"},"Open SR widget",8,fl)])],512),t("div",yl,[t("div",vl,[t("div",{id:"player",class:"video-16-9",style:q(s.playerstyle)},[b(n,{ref:"youtube",onEnded:s.ended,visible:s.playerVisible},null,8,["onEnded","visible"])],4)]),t("div",$l,[t("ul",null,[t("li",{class:I({"is-active":s.tab==="playlist"}),onClick:e[10]||(e[10]=a=>s.tab="playlist")},bl,2),t("li",{class:I({"is-active":s.tab==="settings"}),onClick:e[11]||(e[11]=a=>s.tab="settings")},wl,2),t("li",{class:I({"is-active":s.tab==="help"}),onClick:e[12]||(e[12]=a=>s.tab="help")},Vl,2),t("li",{class:I({"is-active":s.tab==="tags"}),onClick:e[13]||(e[13]=a=>s.tab="tags")},Ul,2),t("li",{class:I({"is-active":s.tab==="import"}),onClick:e[14]||(e[14]=a=>s.tab="import")},Pl,2)])]),s.inited&&s.tab==="import"?(l(),o("div",Tl,[t("div",Al,[t("a",{class:"button is-small mr-1",href:s.exportPlaylistUrl,target:"_blank"},Ll,8,Dl),t("button",{class:"button is-small",onClick:e[15]||(e[15]=(...a)=>s.doImportPlaylist&&s.doImportPlaylist(...a))},Ol)]),h(t("textarea",{class:"textarea mb-1","onUpdate:modelValue":e[16]||(e[16]=a=>s.importPlaylist=a)},null,512),[[f,s.importPlaylist]])])):u("",!0),s.inited&&s.tab==="help"?(l(),o("div",Nl,[b($)])):u("",!0),s.inited&&s.tab==="tags"?(l(),o("div",Fl,[b(y,{tags:s.tags,onUpdateTag:s.onTagUpdated},null,8,["tags","onUpdateTag"])])):u("",!0),s.inited&&s.tab==="settings"?(l(),R(v,{key:3,id:"settings",modelValue:s.settings,"onUpdate:modelValue":[e[17]||(e[17]=a=>s.settings=a),s.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])):u("",!0),s.inited&&s.tab==="playlist"?(l(),o("div",Jl,[b(P,{playlist:s.playlist,filter:s.filter,onStopPlayer:e[18]||(e[18]=a=>s.player.stop()),onFilterChange:s.applyFilter,onCtrl:s.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):u("",!0)],512)])}var zl=S(Ln,[["render",Bl],["__scopeId","data-v-255c1852"]]);const J=s=>({type:s,data:{command:"",minInterval:0,minLines:0}}),ot=()=>"",it=()=>({sound:{filename:"",file:"",volume:100},image:{filename:"",file:""},minDurationMs:"1s"}),ql=()=>({steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}),Wl=s=>{switch(s){case"text":return{triggers:[J("command")],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[ot()]}};case"media":return{triggers:[J("command")],action:"media",restrict_to:[],variables:[],variableChanges:[],data:it()};case"countdown":return{triggers:[J("command")],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:ql()};case"jisho_org_lookup":return{triggers:[J("command")],action:"jisho_org_lookup",restrict_to:[],variables:[],variableChanges:[],data:{}};case"madochan_createword":return{triggers:[J("command")],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}};case"chatters":return{triggers:[J("command")],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}};default:return null}};var K={newTrigger:J,newText:ot,newMedia:it,newCmd:Wl};const Hl=1,X=1e3*Hl,Q=60*X,Z=60*Q,et=24*Z,at=s=>{if(s==="")throw new Error("unable to parse duration");const e=`${s}`.trim();if(!e)throw new Error("unable to parse duration");if(e.match(/^\d+$/))return parseInt(e,10);const i=e.match(/^(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!i)throw new Error("unable to parse duration");const g=i[1]?parseInt(i[1],10):0,c=i[2]?parseInt(i[2],10):0,m=i[3]?parseInt(i[3],10):0,r=i[4]?parseInt(i[4],10):0,n=i[5]?parseInt(i[5],10):0;return r*X+m*Q+c*Z+g*et+n},Kl=s=>{try{return at(s)}catch{return 0}},Gl=s=>{let e=s;const i=Math.floor(e/et);e=e%et;const g=Math.floor(e/Z);e=e%Z;const c=Math.floor(e/Q);e=e%Q;const m=Math.floor(e/X);e=e%X;const r=e,n=["ms","s","m","h","d"],$=[r,m,c,g,i];let y=0;for(;y<$.length&&$[y]===0;)y++;let v=$.length-1;for(;v>=0&&$[v]===0;)v--;const P=[];for(let a=y;a<=v;a++)P.unshift(`${$[a]}${n[a]}`);return P.join(" ")};function Yl(s,e,i){if(i>=s.length)for(var g=i-s.length+1;g--;)s.push(void 0);return s.splice(i,0,s.splice(e,1)[0]),s}const Xl=(s,e)=>{const i=[{regex:/\$args\(\)/g,replacer:(m,r)=>e},{regex:/\$args\((\d+)\)/g,replacer:(m,r)=>e},{regex:/\$var\(([^)]+)\)/g,replacer:(m,r)=>e},{regex:/\$user\.name/g,replacer:()=>e},{regex:/\$([a-z][a-z0-9]*)(?!\()/g,replacer:(m,r)=>m},{regex:/\$customapi\(([^$\)]*)\)\[\'([A-Za-z0-9_ -]+)\'\]/g,replacer:(m,r,n)=>e},{regex:/\$customapi\(([^$\)]*)\)/g,replacer:(m,r)=>e},{regex:/\$urlencode\(([^$\)]*)\)/g,replacer:(m,r)=>e},{regex:/\$calc\((\d+)([*/+-])(\d+)\)/g,replacer:(m,r,n,$)=>e}];let g=s,c;do{c=g;for(let m of i)g=g.replace(m.regex,m.replacer)}while(c!==g);return g},Ql=(s,e=",",i=-1)=>{const g=s.split(e);return i===-1||g.length<=i?g:[...g.slice(0,i-1),g.slice(i-1).join(e)]},Zl=s=>{let e=s.length;for(;e>0;){let i=Math.floor(Math.random()*e);e--;let g=s[e];s[e]=s[i],s[i]=g}return s};var F={arrayMove:Yl,humanDuration:Gl,parseHumanDuration:Kl,mustParseHumanDuration:at,doDummyReplacements:Xl,split:Ql,shuffle:Zl};const xl=V({data:()=>({commands:[],settings:{volume:100},globalVariables:[],ws:null,editIdx:null,editCommand:null,inited:!1,tab:"commands"}),computed:{baseVolume(){return this.settings.volume},widgetUrl(){return`${location.protocol}//${location.host}/widget/media/${this.$me.widgetToken}/`}},methods:{permissionsStr(s){if(!s.restrict_to||s.restrict_to.length===0)return"Everyone";const e=[];return s.restrict_to.includes("broadcaster")&&e.push("Broadcaster"),s.restrict_to.includes("mod")&&e.push("Moderators"),s.restrict_to.includes("sub")&&e.push("Subscribers"),e.join(", ")},add(s){const e=K.newCmd(s);!e||(this.editIdx=this.commands.length,this.editCommand=e)},remove(s){this.commands=this.commands.filter((e,i)=>i!==s),this.sendSave()},edit(s){this.editIdx=s,this.editCommand=this.commands[s]},duplicate(s){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[s]))},editedCommand(s){this.commands[this.editIdx]=s,this.sendSave(),this.editIdx=null,this.editCommand=null},onVolumeChange(){this.sendSave()},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings})},sendMsg(s){this.ws.send(JSON.stringify(s))},dragEnd(s){this.commands=F.arrayMove(this.commands,s.oldIndex,s.newIndex),this.sendSave()}},async mounted(){this.ws=new Y(this.$conf.wsBase+"/general",this.$me.token),this.ws.onMessage("init",s=>{this.commands=s.commands,this.settings=s.settings,this.globalVariables=s.globalVariables,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),O=s=>(W("data-v-781bb45e"),s=s(),H(),s),to={id:"app"},so={id:"top",ref:"top"},eo={id:"actionbar",class:"p-1"},no=["disabled"],lo=["disabled"],oo=["disabled"],io=["disabled"],ao=["disabled"],ro=["disabled"],uo=["href"],co={id:"main",ref:"main"},ho={class:"tabs"},po=O(()=>t("a",null,"Commands",-1)),mo=[po],go=O(()=>t("a",null,"Settings",-1)),fo=[go],yo={key:1},vo={key:0,class:"table-container"},$o={class:"table is-striped",ref:"table"},_o=O(()=>t("thead",null,[t("tr",null,[t("th"),t("th"),t("th",null,"Trigger"),t("th",null,"Response"),t("th",null,"Type"),t("th",null,"Permissions"),t("th"),t("th")])],-1)),bo=O(()=>t("td",{class:"pt-4 handle"},[t("i",{class:"fa fa-arrows"})],-1)),ko={class:"pl-0 pr-0"},wo=["onClick"],Co=O(()=>t("i",{class:"fa fa-pencil"},null,-1)),Vo=[Co],So={class:"col-triggers"},Uo={key:0},Io={key:0},Po=O(()=>t("span",{class:"is-small"},"Timer: ",-1)),To={key:0},Ao={key:1},Do={key:2},Mo={key:3},Eo={key:0},Lo={key:0,class:"spacerow media-holder media-holder-inline"},jo={key:1,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},Ro={key:2,class:"ml-2"},Oo=p("for at least "),No={key:3,class:"ml-2"},Fo=p("for "),Jo={key:5},Bo={key:0},zo=O(()=>t("span",null,"\u2192",-1)),qo=p(" \u2715 "),Wo=O(()=>t("span",null,"\u2192",-1)),Ho={key:1},Ko={key:1},Go={key:2},Yo=p(" Media("),Xo={key:0},Qo={key:1},Zo={key:2},xo=p(") "),ti={key:3},si={class:"pl-0 pr-0"},ei=O(()=>t("i",{class:"fa fa-trash"},null,-1)),ni=["onClick"],li=O(()=>t("i",{class:"fa fa-clone"},null,-1)),oi=[li],ii={key:1},ai={key:2},di={key:0,class:"table is-striped",ref:"table"},ri=O(()=>t("td",null,[t("code",null,"settings.volume")],-1)),ui=O(()=>t("td",null,"Base volume for all media playing from commands",-1));function ci(s,e,i,g,c,m){const r=_("navbar"),n=_("command-edit"),$=_("duration"),y=_("responsive-image"),v=_("player"),P=_("doubleclick-button"),a=_("draggable"),C=_("volume-slider");return l(),o("div",to,[t("div",so,[b(r),t("div",eo,[t("button",{class:"button is-small mr-1",disabled:s.inited?null:!0,onClick:e[0]||(e[0]=d=>s.add("text")),title:"Send a message to chat"}," Add text ",8,no),t("button",{class:"button is-small mr-1",onClick:e[1]||(e[1]=d=>s.add("media")),disabled:s.inited?null:!0,title:"Display an image and/or play a sound"}," Add media ",8,lo),t("button",{class:"button is-small mr-1",onClick:e[2]||(e[2]=d=>s.add("countdown")),disabled:s.inited?null:!0,title:"Add a countdown or messages spaced by time intervals"}," Add countdown ",8,oo),t("button",{class:"button is-small mr-1",onClick:e[3]||(e[3]=d=>s.add("jisho_org_lookup")),disabled:s.inited?null:!0,title:"Lookup a word via jisho.org"}," Add jisho_org_lookup ",8,io),t("button",{class:"button is-small mr-1",onClick:e[4]||(e[4]=d=>s.add("madochan_createword")),disabled:s.inited?null:!0,title:"Create a word with madochan"}," Add madochan ",8,ao),t("button",{class:"button is-small mr-1",onClick:e[5]||(e[5]=d=>s.add("chatters")),disabled:s.inited?null:!0,title:"Displays users who chatted during the stream"}," Add chatters ",8,ro),t("a",{class:"button is-small",href:s.widgetUrl,target:"_blank"},"Open Media widget",8,uo)])],512),t("div",co,[s.editCommand?(l(),R(n,{key:0,globalVariables:s.globalVariables,modelValue:s.editCommand,mode:s.editIdx>=s.commands.length?"create":"edit",baseVolume:s.baseVolume,"onUpdate:modelValue":s.editedCommand,onCancel:e[6]||(e[6]=d=>s.editCommand=null)},null,8,["globalVariables","modelValue","mode","baseVolume","onUpdate:modelValue"])):u("",!0),t("div",ho,[t("ul",null,[t("li",{class:I({"is-active":s.tab==="commands"}),onClick:e[7]||(e[7]=d=>s.tab="commands")},mo,2),t("li",{class:I({"is-active":s.tab==="settings"}),onClick:e[8]||(e[8]=d=>s.tab="settings")},fo,2)])]),s.inited&&s.tab==="commands"?(l(),o("div",yo,[s.commands.length>0?(l(),o("div",vo,[t("table",$o,[_o,b(a,{modelValue:s.commands,onEnd:s.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:E(({element:d,index:z})=>[t("tr",null,[bo,t("td",ko,[t("button",{class:"button is-small",onClick:A=>s.edit(z)},Vo,8,wo)]),t("td",So,[(l(!0),o(U,null,T(d.triggers,(A,M)=>(l(),o("div",{key:M,class:"spacerow"},[t("div",null,[d.triggers[M].type==="command"?(l(),o("code",Uo,k(d.triggers[M].data.command),1)):u("",!0)]),d.triggers[M].type==="timer"?(l(),o("div",Io,[Po,t("code",null,[p(k(d.triggers[M].data.minLines)+" lines, ",1),b($,{value:d.triggers[M].data.minInterval},null,8,["value"])])])):u("",!0)]))),128))]),t("td",null,[d.action==="jisho_org_lookup"?(l(),o("div",To," Outputs the translation for the searched word. ")):u("",!0),d.action==="madochan_createword"?(l(),o("div",Ao," Creates a word for a definition. ")):u("",!0),d.action==="chatters"?(l(),o("div",Do," Outputs the people who chatted during the stream. ")):u("",!0),d.action==="text"?(l(),o("div",Mo,[(l(!0),o(U,null,T(d.data.text,(A,M)=>(l(),o(U,{key:M},[t("code",null,k(d.data.text[M]),1),M<d.data.text.length-1?(l(),o("span",Eo,"or")):u("",!0)],64))),128))])):u("",!0),d.action==="media"?(l(),o("div",{key:4,class:I(d.action)},[d.data.image.file||d.data.sound.file?(l(),o("div",Lo,[d.data.image.file?(l(),R(y,{key:0,src:d.data.image.file,title:d.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):u("",!0),d.data.image.file&&d.data.sound.file?(l(),o("i",jo)):u("",!0),b(v,{src:d.data.sound.file,name:d.data.sound.filename,volume:d.data.sound.volume,baseVolume:s.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),d.data.image.file&&d.data.sound.file?(l(),o("span",Ro,[Oo,b($,{value:d.data.minDurationMs},null,8,["value"])])):d.data.image.file?(l(),o("span",No,[Fo,b($,{value:d.data.minDurationMs},null,8,["value"])])):u("",!0)])):u("",!0)],2)):u("",!0),d.action==="countdown"?(l(),o("div",Jo,[(d.data.type||"auto")==="auto"?(l(),o("div",Bo,[t("code",null,k(d.data.intro),1),zo,t("code",null,k(d.data.steps),1),qo,b($,{value:d.data.interval},null,8,["value"]),Wo,t("code",null,k(d.data.outro),1)])):(l(),o("div",Ho,[(l(!0),o(U,null,T(d.data.actions,(A,M)=>(l(),o(U,{key:M},[A.type==="delay"?(l(),R($,{key:0,value:A.value},null,8,["value"])):u("",!0),A.type==="text"?(l(),o("code",Ko,k(A.value),1)):u("",!0),A.type==="media"?(l(),o("code",Go,[Yo,A.value.image.file?(l(),o("span",Xo,k(A.value.image.filename),1)):u("",!0),A.value.image.file&&A.value.sound.file?(l(),o("span",Qo,"+")):u("",!0),A.value.sound.file?(l(),o("span",Zo,k(A.value.sound.filename),1)):u("",!0),xo])):u("",!0),M<d.data.actions.length-1?(l(),o("span",ti,"\u2192")):u("",!0)],64))),128))]))])):u("",!0)]),t("td",null,k(d.action),1),t("td",null,k(s.permissionsStr(d)),1),t("td",si,[b(P,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:A=>s.remove(z)},{default:E(()=>[ei]),_:2},1032,["onDoubleclick"]),t("button",{class:"button is-small",onClick:A=>s.duplicate(z)},oi,8,ni)])])]),_:1},8,["modelValue","onEnd"])],512)])):(l(),o("div",ii,"No commands set up"))])):u("",!0),s.inited&&s.tab==="settings"?(l(),o("div",ai,[s.settings?(l(),o("table",di,[t("tbody",null,[t("tr",null,[ri,t("td",null,[b(C,{modelValue:s.settings.volume,"onUpdate:modelValue":[e[9]||(e[9]=d=>s.settings.volume=d),s.onVolumeChange]},null,8,["modelValue","onUpdate:modelValue"])]),ui])])],512)):u("",!0)])):u("",!0)],512)])}var hi=S(xl,[["render",ci],["__scopeId","data-v-781bb45e"]]);const pi=V({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:null,defaultSettings:null,ws:null}),watch:{settings:{deep:!0,handler(s){this.changedJson=JSON.stringify(s)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return`${location.protocol}//${location.host}/widget/speech-to-text/${this.$me.widgetToken}/`}},methods:{sendSave(){this.sendMsg({event:"save",settings:this.settings})},sendMsg(s){this.ws.send(JSON.stringify(s))}},async mounted(){this.ws=new Y(this.$conf.wsBase+"/speech-to-text",this.$me.token),this.ws.onMessage("init",s=>{this.settings=s.settings,this.defaultSettings=s.defaultSettings,this.unchangedJson=JSON.stringify(s.settings)}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),mi={id:"app"},gi={id:"top",ref:"top"},fi={id:"actionbar",class:"p-1"},yi=["disabled"],vi=["href"],$i={id:"main",ref:"main"},_i={key:0,class:"table is-striped",ref:"table"},bi=t("tr",null,[t("td",{colspan:"3"},"General")],-1),ki=t("td",null,[t("code",null,"settings.style.bgColor")],-1),wi=["disabled"],Ci=t("i",{class:"fa fa-remove"},null,-1),Vi=[Ci],Si=t("td",null,[t("code",null,"settings.style.vAlign")],-1),Ui={class:"select is-small"},Ii=t("option",{value:"top"},"top",-1),Pi=t("option",{value:"bottom"},"bottom",-1),Ti=[Ii,Pi],Ai=["disabled"],Di=t("i",{class:"fa fa-remove"},null,-1),Mi=[Di],Ei=t("tr",null,[t("td",{colspan:"3"},"Recognition")],-1),Li=t("td",null,[t("code",null,"settings.recognition.lang")],-1),ji=["disabled"],Ri=t("i",{class:"fa fa-remove"},null,-1),Oi=[Ri],Ni=t("td",null,[t("code",null,"settings.recognition.synthesize")],-1),Fi=["disabled"],Ji=t("i",{class:"fa fa-remove"},null,-1),Bi=[Ji],zi=t("td",null,[t("code",null,"settings.recognition.synthesizeLang")],-1),qi=["disabled"],Wi=t("i",{class:"fa fa-remove"},null,-1),Hi=[Wi],Ki=t("td",null,[t("code",null,"settings.recognition.display")],-1),Gi=["disabled"],Yi=t("i",{class:"fa fa-remove"},null,-1),Xi=[Yi],Qi=t("td",null,[t("code",null,"settings.styles.recognition.color")],-1),Zi=["disabled"],xi=t("i",{class:"fa fa-remove"},null,-1),ta=[xi],sa=t("td",null,[t("code",null,"settings.styles.recognition.strokeWidth")],-1),ea=["disabled"],na=t("i",{class:"fa fa-remove"},null,-1),la=[na],oa=t("td",null,[t("code",null,"settings.styles.recognition.strokeColor")],-1),ia=["disabled"],aa=t("i",{class:"fa fa-remove"},null,-1),da=[aa],ra=t("td",null,[t("code",null,"settings.styles.recognition.fontFamily")],-1),ua=["disabled"],ca=t("i",{class:"fa fa-remove"},null,-1),ha=[ca],pa=t("td",null,[t("code",null,"settings.styles.recognition.fontSize")],-1),ma=["disabled"],ga=t("i",{class:"fa fa-remove"},null,-1),fa=[ga],ya=t("td",null,[t("code",null,"settings.styles.recognition.fontWeight")],-1),va=["disabled"],$a=t("i",{class:"fa fa-remove"},null,-1),_a=[$a],ba=t("tr",null,[t("td",{colspan:"3"},"Translation")],-1),ka=t("td",null,[t("code",null,"settings.translation.enabled")],-1),wa=["disabled"],Ca=t("i",{class:"fa fa-remove"},null,-1),Va=[Ca],Sa=t("td",null,[t("code",null,"settings.translation.synthesize")],-1),Ua=["disabled"],Ia=t("i",{class:"fa fa-remove"},null,-1),Pa=[Ia],Ta=t("td",null,[t("code",null,"settings.translation.synthesizeLang")],-1),Aa=["disabled"],Da=t("i",{class:"fa fa-remove"},null,-1),Ma=[Da],Ea=t("td",null,[t("code",null,"settings.translation.langSrc")],-1),La=["disabled"],ja=t("i",{class:"fa fa-remove"},null,-1),Ra=[ja],Oa=t("td",null,[t("code",null,"settings.translation.langDst")],-1),Na=["disabled"],Fa=t("i",{class:"fa fa-remove"},null,-1),Ja=[Fa],Ba=t("td",null,[t("code",null,"settings.styles.translation.color")],-1),za=["disabled"],qa=t("i",{class:"fa fa-remove"},null,-1),Wa=[qa],Ha=t("td",null,[t("code",null,"settings.styles.translation.strokeWidth")],-1),Ka=["disabled"],Ga=t("i",{class:"fa fa-remove"},null,-1),Ya=[Ga],Xa=t("td",null,[t("code",null,"settings.styles.translation.strokeColor")],-1),Qa=["disabled"],Za=t("i",{class:"fa fa-remove"},null,-1),xa=[Za],td=t("td",null,[t("code",null,"settings.styles.translation.fontFamily")],-1),sd=["disabled"],ed=t("i",{class:"fa fa-remove"},null,-1),nd=[ed],ld=t("td",null,[t("code",null,"settings.styles.translation.fontSize")],-1),od=["disabled"],id=t("i",{class:"fa fa-remove"},null,-1),ad=[id],dd=t("td",null,[t("code",null,"settings.styles.translation.fontWeight")],-1),rd=["disabled"],ud=t("i",{class:"fa fa-remove"},null,-1),cd=[ud],hd=t("tr",null,[t("td",{colspan:"3"},"Debug")],-1),pd=t("td",null,[t("code",null,"settings.status.enabled")],-1),md=["disabled"],gd=t("i",{class:"fa fa-remove"},null,-1),fd=[gd];function yd(s,e,i,g,c,m){const r=_("navbar");return l(),o("div",mi,[t("div",gi,[b(r),t("div",fi,[t("button",{class:"button is-small is-primary mr-1",disabled:!s.changed,onClick:e[0]||(e[0]=(...n)=>s.sendSave&&s.sendSave(...n))}," Save ",8,yi),t("a",{class:"button is-small",href:s.widgetUrl,target:"_blank"},"Open widget",8,vi)])],512),t("div",$i,[s.settings?(l(),o("table",_i,[t("tbody",null,[bi,t("tr",null,[ki,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[1]||(e[1]=n=>s.settings.styles.bgColor=n)},null,512),[[f,s.settings.styles.bgColor]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.bgColor===s.defaultSettings.styles.bgColor,onClick:e[2]||(e[2]=n=>s.settings.styles.bgColor=s.defaultSettings.styles.bgColor)},Vi,8,wi)])]),t("tr",null,[Si,t("td",null,[t("div",Ui,[h(t("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.settings.styles.vAlign=n)},Ti,512),[[x,s.settings.styles.vAlign]])])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.vAlign===s.defaultSettings.styles.vAlign,onClick:e[4]||(e[4]=n=>s.settings.styles.vAlign=s.defaultSettings.styles.vAlign)},Mi,8,Ai)])]),Ei,t("tr",null,[Li,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[5]||(e[5]=n=>s.settings.recognition.lang=n)},null,512),[[f,s.settings.recognition.lang]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.lang===s.defaultSettings.recognition.lang,onClick:e[6]||(e[6]=n=>s.settings.recognition.lang=s.defaultSettings.recognition.lang)},Oi,8,ji)])]),t("tr",null,[Ni,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=n=>s.settings.recognition.synthesize=n)},null,512),[[j,s.settings.recognition.synthesize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.synthesize===s.defaultSettings.recognition.synthesize,onClick:e[8]||(e[8]=n=>s.settings.translation.enabled=s.defaultSettings.translation.enabled)},Bi,8,Fi)])]),t("tr",null,[zi,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[9]||(e[9]=n=>s.settings.recognition.synthesizeLang=n)},null,512),[[f,s.settings.recognition.synthesizeLang]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.synthesizeLang===s.defaultSettings.recognition.synthesizeLang,onClick:e[10]||(e[10]=n=>s.settings.recognition.synthesizeLang=s.defaultSettings.recognition.synthesizeLang)},Hi,8,qi)])]),t("tr",null,[Ki,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=n=>s.settings.recognition.display=n)},null,512),[[j,s.settings.recognition.display]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.recognition.display===s.defaultSettings.recognition.display,onClick:e[12]||(e[12]=n=>s.settings.recognition.display=s.defaultSettings.recognition.display)},Xi,8,Gi)])]),t("tr",null,[Qi,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[13]||(e[13]=n=>s.settings.styles.recognition.color=n)},null,512),[[f,s.settings.styles.recognition.color]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.color===s.defaultSettings.styles.recognition.color,onClick:e[14]||(e[14]=n=>s.settings.styles.recognition.color=s.defaultSettings.styles.recognition.color)},ta,8,Zi)])]),t("tr",null,[sa,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[15]||(e[15]=n=>s.settings.styles.recognition.strokeWidth=n)},null,512),[[f,s.settings.styles.recognition.strokeWidth]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.strokeWidth===s.defaultSettings.styles.recognition.strokeWidth,onClick:e[16]||(e[16]=n=>s.settings.styles.recognition.strokeWidth=s.defaultSettings.styles.recognition.strokeWidth)},la,8,ea)])]),t("tr",null,[oa,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[17]||(e[17]=n=>s.settings.styles.recognition.strokeColor=n)},null,512),[[f,s.settings.styles.recognition.strokeColor]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.strokeColor===s.defaultSettings.styles.recognition.strokeColor,onClick:e[18]||(e[18]=n=>s.settings.styles.recognition.strokeColor=s.defaultSettings.styles.recognition.strokeColor)},da,8,ia)])]),t("tr",null,[ra,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[19]||(e[19]=n=>s.settings.styles.recognition.fontFamily=n)},null,512),[[f,s.settings.styles.recognition.fontFamily]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.fontFamily===s.defaultSettings.styles.recognition.fontFamily,onClick:e[20]||(e[20]=n=>s.settings.styles.recognition.fontFamily=s.defaultSettings.styles.recognition.fontFamily)},ha,8,ua)])]),t("tr",null,[pa,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[21]||(e[21]=n=>s.settings.styles.recognition.fontSize=n)},null,512),[[f,s.settings.styles.recognition.fontSize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.fontSize===s.defaultSettings.styles.recognition.fontSize,onClick:e[22]||(e[22]=n=>s.settings.styles.recognition.fontSize=s.defaultSettings.styles.recognition.fontSize)},fa,8,ma)])]),t("tr",null,[ya,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[23]||(e[23]=n=>s.settings.styles.recognition.fontWeight=n)},null,512),[[f,s.settings.styles.recognition.fontWeight]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.recognition.fontWeight===s.defaultSettings.styles.recognition.fontWeight,onClick:e[24]||(e[24]=n=>s.settings.styles.weight=s.defaultSettings.styles.weight)},_a,8,va)])]),ba,t("tr",null,[ka,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[25]||(e[25]=n=>s.settings.translation.enabled=n)},null,512),[[j,s.settings.translation.enabled]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.enabled===s.defaultSettings.translation.enabled,onClick:e[26]||(e[26]=n=>s.settings.translation.enabled=s.defaultSettings.translation.enabled)},Va,8,wa)])]),t("tr",null,[Sa,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[27]||(e[27]=n=>s.settings.translation.synthesize=n)},null,512),[[j,s.settings.translation.synthesize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.synthesize===s.defaultSettings.translation.synthesize,onClick:e[28]||(e[28]=n=>s.settings.translation.synthesize=s.defaultSettings.translation.synthesize)},Pa,8,Ua)])]),t("tr",null,[Ta,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[29]||(e[29]=n=>s.settings.translation.synthesizeLang=n)},null,512),[[f,s.settings.translation.synthesizeLang]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.synthesizeLang===s.defaultSettings.translation.synthesizeLang,onClick:e[30]||(e[30]=n=>s.settings.translation.synthesizeLang=s.defaultSettings.translation.synthesizeLang)},Ma,8,Aa)])]),t("tr",null,[Ea,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[31]||(e[31]=n=>s.settings.translation.langSrc=n)},null,512),[[f,s.settings.translation.langSrc]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.langSrc===s.defaultSettings.translation.langSrc,onClick:e[32]||(e[32]=n=>s.settings.translation.langSrc=s.defaultSettings.translation.langSrc)},Ra,8,La)])]),t("tr",null,[Oa,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[33]||(e[33]=n=>s.settings.translation.langDst=n)},null,512),[[f,s.settings.translation.langDst]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.translation.langDst===s.defaultSettings.translation.langDst,onClick:e[34]||(e[34]=n=>s.settings.translation.langDst=s.defaultSettings.translation.langDst)},Ja,8,Na)])]),t("tr",null,[Ba,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[35]||(e[35]=n=>s.settings.styles.translation.color=n)},null,512),[[f,s.settings.styles.translation.color]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.color===s.defaultSettings.styles.translation.color,onClick:e[36]||(e[36]=n=>s.settings.styles.translation.color=s.defaultSettings.styles.translation.color)},Wa,8,za)])]),t("tr",null,[Ha,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[37]||(e[37]=n=>s.settings.styles.translation.strokeWidth=n)},null,512),[[f,s.settings.styles.translation.strokeWidth]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.strokeWidth===s.defaultSettings.styles.translation.strokeWidth,onClick:e[38]||(e[38]=n=>s.settings.styles.translation.strokeWidth=s.defaultSettings.styles.translation.strokeWidth)},Ya,8,Ka)])]),t("tr",null,[Xa,t("td",null,[h(t("input",{class:"input is-small",type:"color","onUpdate:modelValue":e[39]||(e[39]=n=>s.settings.styles.translation.strokeColor=n)},null,512),[[f,s.settings.styles.translation.strokeColor]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.strokeColor===s.defaultSettings.styles.translation.strokeColor,onClick:e[40]||(e[40]=n=>s.settings.styles.translation.strokeColor=s.defaultSettings.styles.translation.strokeColor)},xa,8,Qa)])]),t("tr",null,[td,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[41]||(e[41]=n=>s.settings.styles.translation.fontFamily=n)},null,512),[[f,s.settings.styles.translation.fontFamily]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.fontFamily===s.defaultSettings.styles.translation.fontFamily,onClick:e[42]||(e[42]=n=>s.settings.styles.translation.fontFamily=s.defaultSettings.styles.translation.fontFamily)},nd,8,sd)])]),t("tr",null,[ld,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[43]||(e[43]=n=>s.settings.styles.translation.fontSize=n)},null,512),[[f,s.settings.styles.translation.fontSize]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.fontSize===s.defaultSettings.styles.translation.fontSize,onClick:e[44]||(e[44]=n=>s.settings.styles.translation.fontSize=s.defaultSettings.styles.translation.fontSize)},ad,8,od)])]),t("tr",null,[dd,t("td",null,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":e[45]||(e[45]=n=>s.settings.styles.translation.fontWeight=n)},null,512),[[f,s.settings.styles.translation.fontWeight]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.styles.translation.fontWeight===s.defaultSettings.styles.translation.fontWeight,onClick:e[46]||(e[46]=n=>s.settings.styles.weight=s.defaultSettings.styles.weight)},cd,8,rd)])]),hd,t("tr",null,[pd,t("td",null,[h(t("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":e[47]||(e[47]=n=>s.settings.status.enabled=n)},null,512),[[j,s.settings.status.enabled]])]),t("td",null,[t("button",{class:"button is-small",disabled:s.settings.status.enabled===s.defaultSettings.status.enabled,onClick:e[48]||(e[48]=n=>s.settings.status.enabled=s.defaultSettings.status.enabled)},fd,8,md)])])])],512)):u("",!0)],512)])}var vd=S(pi,[["render",yd]]);const $d=V({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const e=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const i=await fetch("/api/user/_reset_password",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({pass:this.pass,token:e})});if(i.status===200)this.success=!0;else try{this.error=(await i.json()).reason}catch{this.error="Unknown error"}}}}),_d={class:"center-screen"},bd=t("h1",{class:"title is-6"},"Hyottoko.club",-1),kd={key:0,class:"field has-background-success-light has-text-success-dark"},wd=p(" Password successfully set. Click "),Cd=p("here"),Vd=p(" to login. "),Sd={key:1},Ud={key:0,class:"field has-background-danger-light has-text-danger-dark"},Id={class:"field"},Pd={class:"control has-icons-left"},Td=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-lock"})],-1),Ad={class:"field"},Dd=["disabled"];function Md(s,e,i,g,c,m){const r=_("router-link");return l(),o("div",_d,[bd,s.success?(l(),o("div",kd,[wd,b(r,{to:{name:"login"}},{default:E(()=>[Cd]),_:1}),Vd])):(l(),o("div",Sd,[s.error?(l(),o("div",Ud,k(s.error),1)):u("",!0),t("div",Id,[t("div",Pd,[h(t("input",{class:"input is-small",type:"password",placeholder:"New Password","onUpdate:modelValue":e[0]||(e[0]=n=>s.pass=n),onKeyup:[e[1]||(e[1]=n=>s.error=""),e[2]||(e[2]=N((...n)=>s.submit&&s.submit(...n),["enter"]))]},null,544),[[f,s.pass]]),Td])]),t("div",Ad,[t("button",{class:"button is-small is-primary",disabled:s.canSubmit?null:!0,onClick:e[3]||(e[3]=(...n)=>s.submit&&s.submit(...n))}," Save Password ",8,Dd)])]))])}var Ed=S($d,[["render",Md]]);const Ld=V({data:()=>({email:"",error:"",success:!1}),methods:{async submit(){this.success=!1,this.error="";const s=await fetch("/api/user/_request_password_reset",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.email})});if(s.status===200)this.success=!0;else try{this.error=(await s.json()).reason}catch{this.error="Unknown error"}}}}),jd={class:"center-screen"},Rd=t("h1",{class:"title is-6"},"Hyottoko.club",-1),Od={key:0,class:"field has-background-success-light has-text-success-dark"},Nd=p(" Password-reset mail sent. Click "),Fd=p("here"),Jd=p(" to login. "),Bd={key:1},zd={key:0,class:"field has-background-danger-light has-text-danger-dark"},qd={class:"field"},Wd={class:"control has-icons-left"},Hd=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-envelope"})],-1),Kd={class:"field"};function Gd(s,e,i,g,c,m){const r=_("router-link");return l(),o("div",jd,[Rd,s.success?(l(),o("div",Od,[Nd,b(r,{to:{name:"login"}},{default:E(()=>[Fd]),_:1}),Jd])):(l(),o("form",Bd,[s.error?(l(),o("div",zd,k(s.error),1)):u("",!0),t("div",qd,[t("div",Wd,[h(t("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":e[0]||(e[0]=n=>s.email=n),onKeyup:e[1]||(e[1]=n=>s.error="")},null,544),[[f,s.email]]),Hd])]),t("div",Kd,[t("span",{class:"button is-small is-primary",onClick:e[2]||(e[2]=(...n)=>s.submit&&s.submit(...n))},"Request Password Reset")])]))])}var Yd=S(Ld,[["render",Gd]]);const Xd=V({name:"upload",props:{accept:String,label:String},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?`Uploading (${this.uploadPercent}%)`:this.label||"Upload File"},progressStyle(){if(!this.uploading)return{};const s=this.uploadPercent,e="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${e} 0%, ${e} ${s}%, transparent ${s}%)`}}},methods:{async upload(s){const e=s.target.files[0];if(!e)return;this.uploading=!0;const i=new FormData;i.append("file",e,e.name);const g=await st.post("/api/upload",{body:i,onUploadProgress:m=>{this.progress=m.loaded/m.total}});this.uploading=!1;const c=await g.json();this.$emit("uploaded",c)}}}),Qd=s=>(W("data-v-f8e36c38"),s=s(),H(),s),Zd={class:"upload"},xd=["disabled","accept"],tr={class:"button is-small"},sr=Qd(()=>t("i",{class:"fa fa-upload mr-1"},null,-1));function er(s,e,i,g,c,m){return l(),o("label",Zd,[t("input",{type:"file",disabled:s.uploading,style:{display:"none"},onChange:e[0]||(e[0]=(...r)=>s.upload&&s.upload(...r)),accept:s.accept},null,40,xd),t("span",tr,[sr,p(" "+k(s.buttonText),1)]),t("span",{class:"progress",style:q(s.progressStyle)},null,4)])}var nr=S(Xd,[["render",er],["__scopeId","data-v-f8e36c38"]]);const lr=V({props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(s){try{const e=F.doDummyReplacements(s,"0");F.mustParseHumanDuration(e),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",s)}},modelValue:{handler(s){this.v=`${s}`}}}});function or(s,e,i,g,c,m){return h((l(),o("input",{class:I(["input is-small spaceinput",s.classes]),"onUpdate:modelValue":e[0]||(e[0]=r=>s.v=r)},null,2)),[[f,s.v]])}var ir=S(lr,[["render",or]]);const ar=V({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const s=parseInt(`${this.baseVolume}`,10)/100,e=parseInt(`${this.volume}`,10)/100;this.audio.volume=s*e,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio("/uploads/"+this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function dr(s,e,i,g,c,m){return s.src?(l(),o("span",{key:0,class:"player",onClick:e[0]||(e[0]=(...r)=>s.toggle&&s.toggle(...r))},[p(k(s.name)+" ",1),t("i",{class:I(["fa ml-1",s.cls])},null,2)])):u("",!0)}var rr=S(ar,[["render",dr]]);const ur=V({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),cr={class:"columns"},hr={class:"column is-four-fifth"},pr={class:"control has-icons-left has-icons-right range slider"},mr=["min","max"],gr={class:"icon is-small is-left"},fr={class:"icon is-small is-right"},yr={class:"column is-one-fifth"};function vr(s,e,i,g,c,m){return l(),o("div",cr,[t("div",hr,[t("div",pr,[h(t("input",{type:"range",class:"input is-small",min:s.min,max:s.max,"onUpdate:modelValue":[e[0]||(e[0]=r=>s.curVal=r),e[1]||(e[1]=(...r)=>s.valChange&&s.valChange(...r))]},null,8,mr),[[f,s.curVal]]),t("span",gr,[t("i",{class:I(["fa",s.iconLeft])},null,2)]),t("span",fr,[t("i",{class:I(["fa",s.iconRight])},null,2)])])]),t("div",yr,[h(t("input",{type:"number",class:"input is-small","onUpdate:modelValue":[e[2]||(e[2]=r=>s.curVal=r),e[3]||(e[3]=(...r)=>s.valChange&&s.valChange(...r))]},null,512),[[f,s.curVal]])])])}var $r=S(ur,[["render",vr],["__scopeId","data-v-0799d56c"]]);const _r=V({name:"volume-slider",props:{modelValue:{required:!0}},data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",this.volume)}},created(){this.volume=parseInt(this.modelValue,10)}});function br(s,e,i,g,c,m){const r=_("slider");return l(),R(r,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:s.volume,"onUpdate:modelValue":[e[0]||(e[0]=n=>s.volume=n),s.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var kr=S(_r,[["render",br]]);const wr=V({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(/uploads/${encodeURIComponent(this.src)})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),Cr=["title"];function Vr(s,e,i,g,c,m){return l(),o("div",{class:"responsive-image",style:q(s.style),title:s.title},null,12,Cr)}var Sr=S(wr,[["render",Vr]]),Ur="/assets/hyottoko.30d2bcb9.png";const Ir=V({name:"navbar",computed:{user(){var s,e;return((e=(s=this.$me)==null?void 0:s.user)==null?void 0:e.name)||""}},data:()=>({linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"settings"},text:"Settings"}],burgerActive:!1}),methods:{toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){if((await(await fetch("/api/logout",{method:"POST"})).json()).success)this.$router.push({name:"login"});else throw new Error("[2021-09-25 18:36]")}}}),Pr={class:"navbar",role:"navigation","aria-label":"main navigation"},Tr={class:"navbar-brand"},Ar=t("img",{src:Ur,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),Dr={class:"greeting"},Mr=t("span",{"aria-hidden":"true"},null,-1),Er=t("span",{"aria-hidden":"true"},null,-1),Lr=t("span",{"aria-hidden":"true"},null,-1),jr=[Mr,Er,Lr],Rr={class:"navbar-start"},Or={class:"navbar-end"};function Nr(s,e,i,g,c,m){const r=_("router-link");return l(),o("nav",Pr,[t("div",Tr,[b(r,{class:"navbar-item",to:{name:"index"}},{default:E(()=>[Ar,t("span",Dr,"Welcome back, "+k(s.user),1)]),_:1}),t("a",{role:"button",class:I(["navbar-burger",{"is-active":s.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:e[0]||(e[0]=(...n)=>s.toggleBurgerMenu&&s.toggleBurgerMenu(...n))},jr,2)]),t("div",{id:"navbarBasicExample",class:I(["navbar-menu",{"is-active":s.burgerActive}])},[t("div",Rr,[(l(!0),o(U,null,T(s.linksStart,(n,$)=>(l(),R(r,{class:"navbar-item",key:$,to:n.to},{default:E(()=>[p(k(n.text),1)]),_:2},1032,["to"]))),128))]),t("div",Or,[t("a",{class:"navbar-item",onClick:e[1]||(e[1]=(...n)=>s.onLogoutClick&&s.onLogoutClick(...n))},"Logout")])],2)])}var Fr=S(Ir,[["render",Nr]]);const Jr=V({props:{value:{required:!0}},computed:{tag(){try{return F.mustParseHumanDuration(this.value),"span"}catch{return"code"}},humanReadable(){try{return F.humanDuration(F.mustParseHumanDuration(this.value))}catch{return this.value}}}}),Br={key:0},zr={key:1};function qr(s,e,i,g,c,m){return s.tag==="span"?(l(),o("span",Br,k(s.humanReadable),1)):(l(),o("code",zr,k(s.humanReadable),1))}var Wr=S(Jr,[["render",qr]]);const Hr=V({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(s){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time-=10,this.time<=0&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),Kr={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function Gr(s,e,i,g,c,m){return l(),o("button",{class:"doubleclick-button",onClick:e[0]||(e[0]=(...r)=>s.onClick&&s.onClick(...r))},[ct(s.$slots,"default",{},void 0,!0),s.timer?(l(),o("span",Kr,[p(k(s.message)+" ",1),t("span",{class:"doubleclick-button-timout-indicator",style:q(s.indicatorStyle)},null,4)])):u("",!0)])}var Yr=S(Hr,[["render",Gr],["__scopeId","data-v-72e9e0bd"]]);const B=(...s)=>console.log("[youtube.js]",...s);let dt=!1;function Xr(){return dt?(B("ytapi ALREADY ready"),Promise.resolve()):new Promise(s=>{const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api",document.head.append(e),window.onYouTubeIframeAPIReady=()=>{dt=!0,B("ytapi ready"),s()}})}function Qr(s){return new Promise(e=>{B("create player on "+s);const i=new YT.Player(s,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{B("player ready"),e(i)}}})})}async function Zr(s){return await Xr(),await Qr(s)}const xr=V({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const s=this.getDuration(),e=this.getCurrentTime();return s?e/s:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let s=20;this.tryPlayInterval=setInterval(()=>{if(B("playing",this.playing(),"triesRemaining",s),--s,this.playing()||s<0){B("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(s){this.yt?(this.yt.cueVideoById(s),this.tryPlay()):this.toplay=s},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(s){this.yt?this.yt.setVolume(s):this.tovolume=s},setLoop(s){this.loop=s},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await Zr(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(B("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",s=>{s.data===YT.PlayerState.CUED?this.tryPlay():s.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),tu=["id"];function su(s,e,i,g,c,m){return l(),o("div",{id:s.id},null,8,tu)}var eu=S(xr,[["render",su]]);const nu=V({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},baseVolume:{default:100}},emits:["update:modelValue","cancel"],data:()=>({item:null,newtrigger:"command",variableChangeFocusIdx:-1}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(s){this.item=JSON.parse(JSON.stringify(s))}}},methods:{addtxt(){this.item.data.text.push(K.newText())},addtrigger(){this.item.triggers.push(K.newTrigger(this.newtrigger))},onAddVariableChange(){this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(s){this.item.variableChanges=this.item.variableChanges.filter((e,i)=>i!==s)},onAddVariable(){this.item.variables.push({name:"",value:""})},rmVariable(s){this.item.variables=this.item.variables.filter((e,i)=>i!==s)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndUploaded(s){this.item.data.sound.filename=s.originalname,this.item.data.sound.file=s.filename},mediaImgUploaded(s){this.item.data.image.filename=s.originalname,this.item.data.image.file=s.filename},rmtxt(s){this.item.data.text=this.item.data.text.filter((e,i)=>i!==s)},rmtrigger(s){this.item.triggers=this.item.triggers.filter((e,i)=>i!==s)},autocompletableVariables(s){const e=this.item.variables.slice().map(i=>({var:i,type:"local"}));return this.globalVariables.forEach(i=>{e.find(g=>g.var.name===i.name)||e.push({var:i,type:"global"})}),e.filter(i=>i.var.name.startsWith(s)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{valid(){for(const s of this.item.triggers)if(s.type==="command"){if(!s.data.command)return!1}else if(s.type==="timer"){try{F.mustParseHumanDuration(s.data.minInterval)}catch{return!1}const e=parseInt(s.data.minLines,10);if(isNaN(e))return!1}if(this.item.action==="text"){for(const s of this.item.data.text)if(s==="")return!1}return!0},title(){const s={create:"Create new ",edit:"Edit "},e={jisho_org_lookup:"jisho.org lookup",madochan_createword:"madochan",chatters:"chatters command",media:"media command",countdown:"countdown",text:"command"};return`${s[this.mode]}${e[this.item.action]}`}}}),w=s=>(W("data-v-1bf0a91c"),s=s(),H(),s),lu={key:0,class:"modal is-active"},ou={class:"modal-card"},iu={class:"modal-card-head"},au={class:"modal-card-title"},du={class:"modal-card-body"},ru={class:"table is-striped"},uu=w(()=>t("td",null,"Triggers:",-1)),cu={key:0,class:"field has-addons"},hu={class:"control has-icons-left"},pu=["onUpdate:modelValue"],mu=w(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-comments-o"})],-1)),gu={class:"control"},fu=["disabled","onClick"],yu=w(()=>t("i",{class:"fa fa-remove"},null,-1)),vu=[yu],$u={key:1,class:"timer-trigger"},_u={class:"control"},bu=["disabled","onClick"],ku=w(()=>t("i",{class:"fa fa-remove"},null,-1)),wu=[ku],Cu={class:"columns"},Vu=w(()=>t("div",{class:"column is-one-third"},[t("label",null,"Min. Lines")],-1)),Su={class:"column is-two-third"},Uu={class:"control has-icons-left"},Iu=["onUpdate:modelValue"],Pu=w(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-comments-o"})],-1)),Tu={class:"columns"},Au=w(()=>t("div",{class:"column is-one-third"},[t("label",null,"Min. Interval")],-1)),Du={class:"column is-two-third"},Mu={class:"control has-icons-left has-icons-right"},Eu=w(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1)),Lu=w(()=>t("p",{class:"help"}," Command will be triggered when at least min. lines chat messages arrived AND time interval have passed. ",-1)),ju={class:"field has-addons mr-1"},Ru={class:"control has-icons-left"},Ou={key:0,class:"select is-small"},Nu=w(()=>t("option",{value:"command"},"Command",-1)),Fu=w(()=>t("option",{value:"timer"},"Timer",-1)),Ju=[Nu,Fu],Bu=w(()=>t("i",{class:"fa fa-plus mr-1"},null,-1)),zu=p(" Add "),qu=[Bu,zu],Wu={key:0},Hu=w(()=>t("td",null,"Response:",-1)),Ku=w(()=>t("td",null,"Outputs the translation for the searched word.",-1)),Gu=[Hu,Ku],Yu={key:1},Xu=w(()=>t("td",null,"Response:",-1)),Qu=w(()=>t("td",null,"Creates a word for a definition.",-1)),Zu=[Xu,Qu],xu={key:2},tc=w(()=>t("td",null,"Model:",-1)),sc={class:"control"},ec=w(()=>t("div",{class:"help"},[p(" For possible values refer to "),t("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),nc={key:3},lc=w(()=>t("td",null,"Weirdness:",-1)),oc={class:"control"},ic=w(()=>t("div",{class:"help"},[p(" For possible values refer to "),t("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),ac={key:4},dc=w(()=>t("td",null,"Response:",-1)),rc=w(()=>t("td",null,"Outputs the people who chatted during the stream.",-1)),uc=[dc,rc],cc={key:5},hc=w(()=>t("td",null,"Response:",-1)),pc=["onUpdate:modelValue"],mc=["disabled","onClick"],gc=w(()=>t("i",{class:"fa fa-remove"},null,-1)),fc=[gc],yc={class:"field"},vc=w(()=>t("i",{class:"fa fa-plus mr-1"},null,-1)),$c=p(" Add response "),_c=[vc,$c],bc=w(()=>t("div",null,[t("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),kc={key:6},wc=w(()=>t("td",null,"Image:",-1)),Cc=w(()=>t("i",{class:"fa fa-remove mr-1"},null,-1)),Vc=p(" Remove "),Sc=[Cc,Vc],Uc={key:2},Ic={key:7},Pc=w(()=>t("td",null,"Sound:",-1)),Tc=w(()=>t("i",{class:"fa fa-remove mr-1"},null,-1)),Ac=p(" Remove "),Dc=[Tc,Ac],Mc={key:3},Ec={key:8},Lc=w(()=>t("td",null,"Duration:",-1)),jc={class:"control has-icons-left"},Rc=w(()=>t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1)),Oc={key:9},Nc=w(()=>t("td",null,"Settings",-1)),Fc=w(()=>t("td",null,"Variables:",-1)),Jc={key:0},Bc=w(()=>t("thead",null,[t("tr",null,[t("td",null,"Name"),t("td",null,"Value")])],-1)),zc=["onUpdate:modelValue"],qc=["onUpdate:modelValue"],Wc=["onClick"],Hc=w(()=>t("i",{class:"fa fa-remove"},null,-1)),Kc=[Hc],Gc=w(()=>t("div",{class:"help"},[p(" Variables can be used from the command with "),t("code",null,"$var(variable_name)"),p(". If the referenced variable is not defined here, "),t("a",{href:"/variables/",target:"_blank"},"global variables"),p(" are used. ")],-1)),Yc=w(()=>t("td",null,"Variable changes:",-1)),Xc={key:0},Qc=w(()=>t("thead",null,[t("tr",null,[t("td",null,"Name"),t("td",null,"Change"),t("td",null,"Value"),t("td")])],-1)),Zc={class:"dropdown is-active is-up"},xc={class:"dropdown-trigger"},th=["onUpdate:modelValue","onFocus"],sh={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},eh={class:"dropdown-content"},nh=["onClick"],lh=p(") "),oh={class:"select is-small"},ih=["onUpdate:modelValue"],ah=w(()=>t("option",{value:"set"},"set",-1)),dh=w(()=>t("option",{value:"increase_by"},"increase by",-1)),rh=w(()=>t("option",{value:"decrease_by"},"decrease by",-1)),uh=[ah,dh,rh],ch=["onUpdate:modelValue"],hh=["onClick"],ph=w(()=>t("i",{class:"fa fa-remove"},null,-1)),mh=[ph],gh=w(()=>t("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),fh=w(()=>t("td",null,"Permissions:",-1)),yh=p(" Broadcaster "),vh=p(" Moderators "),$h=p(" Subscribers "),_h={class:"modal-card-foot"},bh=["disabled"];function kh(s,e,i,g,c,m){const r=_("duration-input"),n=_("responsive-image"),$=_("upload"),y=_("player"),v=_("volume-slider"),P=_("countdown-edit");return s.item?(l(),o("div",lu,[t("div",{class:"modal-background",onClick:e[0]||(e[0]=(...a)=>s.onOverlayClick&&s.onOverlayClick(...a))}),t("div",ou,[t("header",iu,[t("p",au,k(s.title),1),t("button",{class:"delete","aria-label":"close",onClick:e[1]||(e[1]=(...a)=>s.onCloseClick&&s.onCloseClick(...a))})]),t("section",du,[t("table",ru,[t("tbody",null,[t("tr",null,[uu,t("td",null,[(l(!0),o(U,null,T(s.item.triggers,(a,C)=>(l(),o("div",{key:C,class:"spacerow"},[s.item.triggers[C].type==="command"?(l(),o("div",cu,[t("div",hu,[h(t("input",{class:I(["input is-small",{"has-background-danger-light":!s.item.triggers[C].data.command,"has-text-danger-dark":!s.item.triggers[C].data.command}]),type:"text","onUpdate:modelValue":d=>s.item.triggers[C].data.command=d},null,10,pu),[[f,s.item.triggers[C].data.command]]),mu]),t("div",gu,[t("button",{class:"button is-small",disabled:s.item.triggers.length<=1,onClick:d=>s.rmtrigger(C)},vu,8,fu)])])):u("",!0),s.item.triggers[C].type==="timer"?(l(),o("div",$u,[t("div",_u,[t("button",{class:"button is-small",disabled:s.item.triggers.length<=1,onClick:d=>s.rmtrigger(C)},wu,8,bu)]),t("div",Cu,[Vu,t("div",Su,[t("div",Uu,[h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":d=>s.item.triggers[C].data.minLines=d},null,8,Iu),[[f,s.item.triggers[C].data.minLines]]),Pu])])]),t("div",Tu,[Au,t("div",Du,[t("div",Mu,[b(r,{modelValue:s.item.triggers[C].data.minInterval,"onUpdate:modelValue":d=>s.item.triggers[C].data.minInterval=d},null,8,["modelValue","onUpdate:modelValue"]),Eu])])]),Lu])):u("",!0)]))),128)),t("div",ju,[t("div",Ru,[s.item.action!=="jisho_org_lookup"?(l(),o("div",Ou,[h(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.newtrigger=a)},Ju,512),[[x,s.newtrigger]])])):u("",!0)]),t("button",{class:"button is-small",onClick:e[3]||(e[3]=a=>s.addtrigger())},qu)])])]),s.item.action==="jisho_org_lookup"?(l(),o("tr",Wu,Gu)):u("",!0),s.item.action==="madochan_createword"?(l(),o("tr",Yu,Zu)):u("",!0),s.item.action==="madochan_createword"?(l(),o("tr",xu,[tc,t("td",null,[t("div",sc,[h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[4]||(e[4]=a=>s.item.data.model=a)},null,512),[[f,s.item.data.model]])]),ec])])):u("",!0),s.item.action==="madochan_createword"?(l(),o("tr",nc,[lc,t("td",null,[t("div",oc,[h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[5]||(e[5]=a=>s.item.data.weirdness=a)},null,512),[[f,s.item.data.weirdness]])]),ic])])):u("",!0),s.item.action==="chatters"?(l(),o("tr",ac,uc)):u("",!0),s.item.action==="text"?(l(),o("tr",cc,[hc,t("td",null,[(l(!0),o(U,null,T(s.item.data.text,(a,C)=>(l(),o("div",{key:C,class:"field textarea-holder"},[h(t("textarea",{class:I(["textarea",{"has-background-danger-light":!s.item.data.text[C],"has-text-danger-dark":!s.item.data.text[C]}]),type:"text","onUpdate:modelValue":d=>s.item.data.text[C]=d},null,10,pc),[[f,s.item.data.text[C]]]),t("button",{class:"button is-small",disabled:s.item.data.text.length<=1,onClick:d=>s.rmtxt(C)},fc,8,mc)]))),128)),t("div",yc,[t("button",{class:"button is-small",onClick:e[6]||(e[6]=(...a)=>s.addtxt&&s.addtxt(...a))},_c)]),bc])])):u("",!0),s.item.action==="media"?(l(),o("tr",kc,[wc,t("td",null,[s.item.data.image.file?(l(),R(n,{key:0,src:s.item.data.image.file,title:s.item.data.image.filename,width:"100%",height:"90",style:{display:"block"}},null,8,["src","title"])):u("",!0),s.item.data.image.file?(l(),o("button",{key:1,class:"button is-small",onClick:e[7]||(e[7]=a=>s.item.data.image.file=null)},Sc)):u("",!0),s.item.data.image.file?(l(),o("br",Uc)):u("",!0),b($,{onUploaded:s.mediaImgUploaded,accept:"image/*",label:"Upload Image",class:I({"mt-1":s.item.data.image.file})},null,8,["onUploaded","class"])])])):u("",!0),s.item.action==="media"?(l(),o("tr",Ic,[Pc,t("td",null,[s.item.data.sound.file?(l(),R(y,{key:0,src:s.item.data.sound.file,name:s.item.data.sound.filename,volume:s.item.data.sound.volume,baseVolume:s.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):u("",!0),s.item.data.sound.file?(l(),R(v,{key:1,modelValue:s.item.data.sound.volume,"onUpdate:modelValue":e[8]||(e[8]=a=>s.item.data.sound.volume=a)},null,8,["modelValue"])):u("",!0),s.item.data.sound.file?(l(),o("button",{key:2,class:"button is-small",onClick:e[9]||(e[9]=a=>s.item.data.sound.file=null)},Dc)):u("",!0),s.item.data.sound.file?(l(),o("br",Mc)):u("",!0),b($,{onUploaded:s.mediaSndUploaded,accept:"audio/*",label:"Upload Sound",class:I({"mt-1":s.item.data.sound.file})},null,8,["onUploaded","class"])])])):u("",!0),s.item.action==="media"?(l(),o("tr",Ec,[Lc,t("td",null,[t("div",jc,[b(r,{modelValue:s.item.data.minDurationMs,"onUpdate:modelValue":e[10]||(e[10]=a=>s.item.data.minDurationMs=a)},null,8,["modelValue"]),Rc])])])):u("",!0),s.item.action==="countdown"?(l(),o("tr",Oc,[Nc,t("td",null,[b(P,{modelValue:s.item.data,"onUpdate:modelValue":e[11]||(e[11]=a=>s.item.data=a),baseVolume:s.baseVolume},null,8,["modelValue","baseVolume"])])])):u("",!0),t("tr",null,[Fc,t("td",null,[s.item.variables.length>0?(l(),o("table",Jc,[Bc,t("tbody",null,[(l(!0),o(U,null,T(s.item.variables,(a,C)=>(l(),o("tr",{key:C},[t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>a.name=d},null,8,zc),[[f,a.name]])]),t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>a.value=d},null,8,qc),[[f,a.value]])]),t("td",null,[t("button",{class:"button is-small",onClick:d=>s.rmVariable(C)},Kc,8,Wc)])]))),128))])])):u("",!0),t("span",{class:"button is-small",onClick:e[12]||(e[12]=(...a)=>s.onAddVariable&&s.onAddVariable(...a))},"Add Variable"),Gc])]),t("tr",null,[Yc,t("td",null,[s.item.variableChanges.length>0?(l(),o("table",Xc,[Qc,t("tbody",null,[(l(!0),o(U,null,T(s.item.variableChanges,(a,C)=>(l(),o("tr",{key:C},[t("td",null,[t("div",Zc,[t("div",xc,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>a.name=d,onFocus:d=>s.variableChangeFocusIdx=C,onBlur:e[13]||(e[13]=(...d)=>s.onVarChangeInputBlur&&s.onVarChangeInputBlur(...d))},null,40,th),[[f,a.name]])]),s.variableChangeFocusIdx===C?(l(),o("div",sh,[t("div",eh,[(l(!0),o(U,null,T(s.autocompletableVariables(a.name),(d,z)=>(l(),o("a",{class:"dropdown-item",key:z,onClick:A=>a.name=d.var.name},[p(k(d.var.name)+" ("+k(d.type)+", ",1),t("code",null,k(d.var.value),1),lh],8,nh))),128))])])):u("",!0)])]),t("td",null,[t("div",oh,[h(t("select",{"onUpdate:modelValue":d=>a.change=d},uh,8,ih),[[x,a.change]])])]),t("td",null,[h(t("input",{type:"text",class:"input is-small","onUpdate:modelValue":d=>a.value=d},null,8,ch),[[f,a.value]])]),t("td",null,[t("button",{class:"button is-small",onClick:d=>s.rmVariableChange(C)},mh,8,hh)])]))),128))])])):u("",!0),t("span",{class:"button is-small",onClick:e[14]||(e[14]=(...a)=>s.onAddVariableChange&&s.onAddVariableChange(...a))},"Add Variable Change"),gh])]),t("tr",null,[fh,t("td",null,[t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[15]||(e[15]=a=>s.item.restrict_to=a),value:"broadcaster"},null,512),[[j,s.item.restrict_to]]),yh]),t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=a=>s.item.restrict_to=a),value:"mod"},null,512),[[j,s.item.restrict_to]]),vh]),t("label",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":e[17]||(e[17]=a=>s.item.restrict_to=a),value:"sub"},null,512),[[j,s.item.restrict_to]]),$h])])])])])]),t("footer",_h,[t("button",{class:"button is-small is-primary",disabled:!s.valid,onClick:e[18]||(e[18]=(...a)=>s.onSaveClick&&s.onSaveClick(...a))}," Save changes ",8,bh),t("button",{class:"button is-small",onClick:e[19]||(e[19]=(...a)=>s.onCancelClick&&s.onCancelClick(...a))},"Cancel")])])])):u("",!0)}var wh=S(nu,[["render",kh],["__scopeId","data-v-1bf0a91c"]]);const Ch=V({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(s){this.countdown.actions=F.arrayMove(this.countdown.actions,s.oldIndex,s.newIndex)},onAddDelay(){this.countdown.actions.push({type:"delay",value:"1s"})},onAddText(){this.countdown.actions.push({type:"text",value:K.newText()})},onAddMedia(){this.countdown.actions.push({type:"media",value:K.newMedia()})},rmaction(s){this.countdown.actions=this.countdown.actions.filter((e,i)=>i!==s)},mediaSndUploaded(s,e){this.countdown.actions[s].value.sound.filename=e.originalname,this.countdown.actions[s].value.sound.file=e.filename},mediaImgUploaded(s,e){this.countdown.actions[s].value.image.filename=e.originalname,this.countdown.actions[s].value.image.file=e.filename}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),Vh={class:"control"},Sh={class:"radio"},Uh=p(" Manual "),Ih={class:"radio"},Ph=p(" Auto "),Th={key:0},Ah={class:"spacerow"},Dh=t("label",{class:"spacelabel"},"Steps ",-1),Mh={class:"spacerow"},Eh=t("label",{class:"spacelabel"},"Interval ",-1),Lh={class:"spacerow"},jh=t("label",{class:"spacelabel"},"Intro ",-1),Rh={class:"spacerow"},Oh=t("label",{class:"spacelabel"},"Outro ",-1),Nh={key:1},Fh={class:"field has-addons mr-1"},Jh=t("span",{class:"handle p-2"},[t("i",{class:"fa fa-arrows"})],-1),Bh={key:0,class:"control has-icons-left"},zh=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1),qh={key:1,class:"control has-icons-left"},Wh=["onUpdate:modelValue"],Hh=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-comments-o"})],-1),Kh={key:2,class:"control has-icons-left"},Gh=t("td",null,"Image:",-1),Yh=["onClick"],Xh=t("i",{class:"fa fa-remove mr-1"},null,-1),Qh=p(" Remove "),Zh=[Xh,Qh],xh={key:2},tp=t("td",null,"Sound:",-1),sp=["onClick"],ep=t("i",{class:"fa fa-remove mr-1"},null,-1),np=p(" Remove "),lp=[ep,np],op={key:3},ip=t("td",null,"Duration:",-1),ap={class:"control has-icons-left"},dp=t("span",{class:"icon is-small is-left"},[t("i",{class:"fa fa-hourglass"})],-1),rp={class:"control"},up=["onClick"],cp=t("i",{class:"fa fa-remove"},null,-1),hp=[cp],pp=t("i",{class:"fa fa-hourglass mr-1"},null,-1),mp=p(" Add Delay "),gp=[pp,mp],fp=t("i",{class:"fa fa-comments-o mr-1"},null,-1),yp=p(" Add Chat "),vp=[fp,yp],$p=t("i",{class:"fa fa-picture-o mr-1"},null,-1),_p=p(" Add Media "),bp=[$p,_p];function kp(s,e,i,g,c,m){const r=_("duration-input"),n=_("responsive-image"),$=_("upload"),y=_("player"),v=_("volume-slider"),P=_("draggable");return l(),o("div",null,[t("div",Vh,[t("label",Sh,[h(t("input",{type:"radio",value:"manual","onUpdate:modelValue":e[0]||(e[0]=a=>s.countdown.type=a)},null,512),[[nt,s.countdown.type]]),Uh]),t("label",Ih,[h(t("input",{type:"radio",value:"auto","onUpdate:modelValue":e[1]||(e[1]=a=>s.countdown.type=a)},null,512),[[nt,s.countdown.type]]),Ph])]),s.countdown.type==="auto"?(l(),o("div",Th,[t("div",Ah,[Dh,h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[2]||(e[2]=a=>s.countdown.steps=a)},null,512),[[f,s.countdown.steps]])]),t("div",Mh,[Eh,b(r,{modelValue:s.countdown.interval,"onUpdate:modelValue":e[3]||(e[3]=a=>s.countdown.interval=a)},null,8,["modelValue"])]),t("div",Lh,[jh,h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[4]||(e[4]=a=>s.countdown.intro=a)},null,512),[[f,s.countdown.intro]])]),t("div",Rh,[Oh,h(t("input",{class:"input is-small spaceinput","onUpdate:modelValue":e[5]||(e[5]=a=>s.countdown.outro=a)},null,512),[[f,s.countdown.outro]])])])):(l(),o("div",Nh,[b(P,{modelValue:s.countdown.actions,onEnd:s.dragEnd,handle:".handle","item-key":"id"},{item:E(({element:a,index:C})=>[t("div",Fh,[Jh,a.type==="delay"?(l(),o("div",Bh,[b(r,{modelValue:a.value,"onUpdate:modelValue":d=>a.value=d},null,8,["modelValue","onUpdate:modelValue"]),zh])):a.type==="text"?(l(),o("div",qh,[h(t("input",{class:"input is-small",type:"text","onUpdate:modelValue":d=>a.value=d},null,8,Wh),[[f,a.value]]),Hh])):a.type==="media"?(l(),o("div",Kh,[t("table",null,[t("tr",null,[Gh,t("td",null,[a.value.image.file?(l(),R(n,{key:0,src:a.value.image.file,title:a.value.image.filename,width:"100%",height:"90",style:{display:"block"}},null,8,["src","title"])):u("",!0),a.value.image.file?(l(),o("button",{key:1,class:"button is-small",onClick:d=>a.value.image.file=null},Zh,8,Yh)):u("",!0),a.value.image.file?(l(),o("br",xh)):u("",!0),b($,{onUploaded:d=>s.mediaImgUploaded(C,d),accept:"image/*",label:"Upload Image",class:I({"mt-1":a.value.image.file})},null,8,["onUploaded","class"])])]),t("tr",null,[tp,t("td",null,[a.value.sound.file?(l(),R(y,{key:0,src:a.value.sound.file,name:a.value.sound.filename,volume:a.value.sound.volume,baseVolume:s.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):u("",!0),a.value.sound.file?(l(),R(v,{key:1,modelValue:a.value.sound.volume,"onUpdate:modelValue":d=>a.value.sound.volume=d},null,8,["modelValue","onUpdate:modelValue"])):u("",!0),a.value.sound.file?(l(),o("button",{key:2,class:"button is-small",onClick:d=>a.value.sound.file=null},lp,8,sp)):u("",!0),a.value.sound.file?(l(),o("br",op)):u("",!0),b($,{onUploaded:d=>s.mediaSndUploaded(C,d),accept:"audio/*",label:"Upload Sound",class:I({"mt-1":a.value.sound.file})},null,8,["onUploaded","class"])])]),t("tr",null,[ip,t("td",null,[t("div",ap,[b(r,{modelValue:a.value.minDurationMs,"onUpdate:modelValue":d=>a.value.minDurationMs=d},null,8,["modelValue","onUpdate:modelValue"]),dp])])])])])):u("",!0),t("div",rp,[t("button",{class:"button is-small",onClick:d=>s.rmaction(C)},hp,8,up)])])]),_:1},8,["modelValue","onEnd"]),t("button",{class:"button is-small",onClick:e[6]||(e[6]=(...a)=>s.onAddDelay&&s.onAddDelay(...a))},gp),t("button",{class:"button is-small",onClick:e[7]||(e[7]=(...a)=>s.onAddText&&s.onAddText(...a))},vp),t("button",{class:"button is-small",onClick:e[8]||(e[8]=(...a)=>s.onAddMedia&&s.onAddMedia(...a))},bp)]))])}var wp=S(Ch,[["render",kp]]);const Cp=V({setup(){}}),Vp={class:"table is-striped"},Sp=t("thead",null,[t("tr",null,[t("th",null,"Chat command"),t("th",null,"Viewer"),t("th",null,"Mod"),t("th",null,"Explanation")])],-1),Up=t("tbody",null,[t("tr",null,[t("td",null,[t("code",null,"!sr <SEARCH>")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[p(" Search for "),t("code",null,"<SEARCH>"),p(" at youtube (by id or by title) and queue the first result in the playlist (after the first found batch of unplayed songs)."),t("br"),p(" This only executes if "),t("code",null,"<SEARCH>"),p(" does not match one of the commands below. ")])]),t("tr",null,[t("td",null,[t("code",null,"!sr undo")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Remove the song that was last added by oneself.")]),t("tr",null,[t("td",null,[t("code",null,"!sr current")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Show what song is currently playing")]),t("tr",null,[t("td",null,[t("code",null,"!sr good")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Vote the current song up")]),t("tr",null,[t("td",null,[t("code",null,"!sr bad")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Vote the current song down")]),t("tr",null,[t("td",null,[t("code",null,"!sr stats")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Show stats about the playlist")]),t("tr",null,[t("td",null,[t("code",null,"!sr stat")]),t("td",{class:"has-text-success"},"\u2714"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Alias for stats")]),t("tr",null,[t("td",null,[t("code",null,"!sr rm")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Remove the current song from the playlist")]),t("tr",null,[t("td",null,[t("code",null,"!sr next")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Skip to the next song")]),t("tr",null,[t("td",null,[t("code",null,"!sr prev")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Skip to the previous song")]),t("tr",null,[t("td",null,[t("code",null,"!sr skip")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Alias for next")]),t("tr",null,[t("td",null,[t("code",null,"!sr jumptonew")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Jump to the next unplayed song")]),t("tr",null,[t("td",null,[t("code",null,"!sr shuffle")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[p(" Shuffle the playlist (current song unaffected). "),t("br"),p(" Non-played and played songs will be shuffled separately and non-played songs will be put after currently playing song. ")])]),t("tr",null,[t("td",null,[t("code",null,"!sr resetStats")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Reset all statistics of all songs")]),t("tr",null,[t("td",null,[t("code",null,"!sr clear")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Clear the playlist")]),t("tr",null,[t("td",null,[t("code",null,"!sr pause")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Pause currently playing song")]),t("tr",null,[t("td",null,[t("code",null,"!sr unpause")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Unpause currently paused song")]),t("tr",null,[t("td",null,[t("code",null,"!sr loop")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Loop the current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr noloop")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Stop looping the current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr unloop")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Alias for noloop")]),t("tr",null,[t("td",null,[t("code",null,"!sr hidevideo")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Hide video for current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr showvideo")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,"Show video for current song")]),t("tr",null,[t("td",null,[t("code",null,"!sr tag <TAG>")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[p("Add tag "),t("code",null,"<TAG>"),p(" to the current song")])]),t("tr",null,[t("td",null,[t("code",null,"!sr rmtag <TAG>")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[p("Remove tag "),t("code",null,"<TAG>"),p(" from the current song")])]),t("tr",null,[t("td",null,[t("code",null,"!sr filter [<TAG>]")]),t("td",{class:"has-text-danger"},"\u2716"),t("td",{class:"has-text-success"},"\u2714"),t("td",null,[p(" Play only songs with the given tag "),t("code",null,"<TAG>"),p(". If no tag is given, play all songs. ")])])],-1),Ip=[Sp,Up];function Pp(s,e,i,g,c,m){return l(),o("table",Vp,Ip)}var Tp=S(Cp,[["render",Pp]]);const Ap=V({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1}),methods:{toggleVisibility(s,e){s.hidevideo?this.sendCtrl("videoVisibility",[!0,e]):this.sendCtrl("videoVisibility",[!1,e])},dragEnd(s){this.sendCtrl("move",[s.oldIndex,s.newIndex])},applyFilter(s){this.$emit("filterChange",s)},sendCtrl(s,e){this.$emit("ctrl",[s,e])},isFilteredOut(s){return this.filter.tag!==""&&!s.tags.includes(this.filter.tag)},startAddTag(s){this.tagInputIdx=s,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(s=>(s.filteredOut=this.isFilteredOut(s),s))},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(s=>s.tags.includes(this.filter.tag))}},watch:{playlist:function(s,e){s.find(i=>!this.isFilteredOut(i))||this.$emit("stopPlayer")},filter:function(s,e){this.playlist.find(i=>!this.isFilteredOut(i))||this.$emit("stopPlayer")}}}),Dp={class:"filters"},Mp={class:"currentfilter"},Ep=t("div",{class:"mr-1 pt-1"},"Filter:",-1),Lp=t("i",{class:"fa fa-remove ml-1"},null,-1),jp={key:1,class:"field has-addons mr-1"},Rp={class:"control"},Op={class:"control"},Np={class:"pt-1"},Fp=p(" Hide filtered out"),Jp={key:0,class:"table is-striped"},Bp=t("thead",null,[t("tr",null,[t("th"),t("th"),t("th"),t("th",null,"Title"),t("th",null,"User"),t("th",null,"Plays"),t("th"),t("th"),t("th"),t("th")])],-1),zp=t("td",{class:"pt-4 handle"},[t("i",{class:"fa fa-arrows"})],-1),qp=["disabled","onClick"],Wp=t("i",{class:"fa fa-play"},null,-1),Hp=[Wp],Kp=["href"],Gp=t("i",{class:"fa fa-external-link"},null,-1),Yp=["onClick"],Xp=t("i",{class:"fa fa-remove ml-1"},null,-1),Qp=["onClick"],Zp=t("i",{class:"fa fa-plus"},null,-1),xp=[Zp],tm={key:0,class:"field has-addons"},sm={class:"control"},em=["onKeyup"],nm={class:"control"},lm=["disabled","onClick"],om=["onClick","title"],im=["onClick"],am=t("i",{class:"fa fa-thumbs-up mr-1"},null,-1),dm=["onClick"],rm=t("i",{class:"fa fa-thumbs-down mr-1"},null,-1),um=["onClick"],cm=t("i",{class:"fa fa-trash"},null,-1),hm=[cm],pm={key:1};function mm(s,e,i,g,c,m){const r=_("draggable");return l(),o("div",null,[t("div",Dp,[t("div",Mp,[Ep,s.filter.tag?(l(),o("span",{key:0,class:"tag mr-1",onClick:e[0]||(e[0]=n=>s.applyFilter(""))},[p(k(s.filter.tag)+" ",1),Lp])):(l(),o("div",jp,[t("div",Rp,[h(t("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":e[1]||(e[1]=n=>s.filterTagInput=n),onKeyup:e[2]||(e[2]=N(n=>s.applyFilter(s.filterTagInput),["enter"]))},null,544),[[f,s.filterTagInput]])]),t("div",Op,[t("span",{class:"button is-small",onClick:e[3]||(e[3]=n=>s.applyFilter(s.filterTagInput))},"Apply filter")])])),t("label",Np,[h(t("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=n=>s.hideFilteredOut=n)},null,512),[[j,s.hideFilteredOut]]),Fp])])]),s.playlist.length>0?(l(),o("table",Jp,[Bp,b(r,{modelValue:s.enhancedPlaylist,onEnd:s.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:E(({element:n,index:$})=>[h(t("tr",null,[zp,t("td",null,k($+1),1),t("td",null,[$!==s.firstIndex?(l(),o("button",{key:0,class:"button is-small",disabled:n.filteredOut?!0:null,onClick:y=>s.sendCtrl("playIdx",[$]),title:"Play"},Hp,8,qp)):u("",!0)]),t("td",null,[t("a",{href:"https://www.youtube.com/watch?v="+n.yt,target:"_blank"},[p(k(n.title||n.yt)+" ",1),Gp],8,Kp),t("div",null,[(l(!0),o(U,null,T(n.tags,(y,v)=>(l(),o("span",{key:v,class:"tag",onClick:P=>s.sendCtrl("rmtag",[y,$])},[p(k(y)+" ",1),Xp],8,Yp))),128)),t("span",{class:"button is-small",onClick:y=>s.startAddTag($)},xp,8,Qp)]),s.tagInputIdx===$?(l(),o("div",tm,[t("div",sm,[h(t("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":e[5]||(e[5]=y=>s.tagInput=y),onKeyup:N(y=>{s.sendCtrl("addtag",[s.tagInput,$]),s.tagInput=""},["enter"])},null,40,em),[[f,s.tagInput]])]),t("div",nm,[t("span",{class:"button is-small",disabled:s.tagInput?null:!0,onClick:y=>{s.sendCtrl("addtag",[s.tagInput,$]),s.tagInput=""}},"Add tag",8,lm)])])):u("",!0)]),t("td",null,k(n.user),1),t("td",null,k(n.plays)+"x",1),t("td",null,[t("button",{class:"button is-small",onClick:y=>s.toggleVisibility(n,$),title:n.hidevideo?"Video hidden":"Video visible"},[t("i",{class:I(["fa mr-1",{"fa-eye":!n.hidevideo,"fa-eye-slash":n.hidevideo}])},null,2)],8,om)]),t("td",null,[t("button",{class:"button is-small",onClick:y=>s.sendCtrl("goodIdx",[$])},[am,p(" "+k(n.goods),1)],8,im)]),t("td",null,[t("button",{class:"button is-small",onClick:y=>s.sendCtrl("badIdx",[$])},[rm,p(" "+k(n.bads),1)],8,dm)]),t("td",null,[t("button",{class:"button is-small",onClick:y=>s.sendCtrl("rmIdx",[$]),title:"Remove"},hm,8,um)])],512),[[ht,!s.hideFilteredOut||!n.filteredOut]])]),_:1},8,["modelValue","onEnd"])])):(l(),o("div",pm,"Playlist is empty"))])}var gm=S(Ap,[["render",mm]]);const fm=V({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(s){const e=this.settings.customCssPresets.find(i=>i.name===s);e?this.settings.customCss=e.css:console.warn(`preset not found: ${s}`),this.sendSettings()},removePreset(s){this.settings.customCssPresets=this.settings.customCssPresets.filter(e=>e.name!==s),this.sendSettings()},savePreset(){const s=this.settings.customCssPresets.findIndex(e=>e.name===this.cssPresetName);s>=0?this.settings.customCssPresets[s].css=this.settings.customCss:this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss}),this.sendSettings()},hideVideoImageRemoved(){this.settings.hideVideoImage={filename:"",file:""},this.sendSettings()},hideVideoImageUploaded(s){this.settings.hideVideoImage={filename:s.originalname,file:s.filename},this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:{volume:100,hideVideoImage:{file:"",filename:""},showProgressBar:!1,customCssPresets:[],customCss:""},css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { animation: init 10s linear forwards, back 10s 0s linear infinite; }
.title { margin: 1em 0; white-space: nowrap; }
.not-playing .title { text-overflow: ellipsis; overflow: hidden; }
.meta, .vote { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Show only titles and marquee the current song (better version):",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.vote, .meta { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`}]}})}),L=s=>(W("data-v-d79e7668"),s=s(),H(),s),ym={key:0,class:"table is-striped",ref:"table"},vm=L(()=>t("td",null,[t("code",null,"settings.volume")],-1)),$m=L(()=>t("td",null,"Base volume for all songs played",-1)),_m=L(()=>t("td",null,[t("code",null,"settings.hideVideoImage")],-1)),bm={key:0,class:"mb-1"},km=L(()=>t("br",null,null,-1)),wm=L(()=>t("i",{class:"fa fa-remove mr-1"},null,-1)),Cm=p(" Remove Image "),Vm=[wm,Cm],Sm=L(()=>t("td",null,"Image to display when a video is hidden.",-1)),Um=L(()=>t("td",null,[t("code",null,"settings.showProgressBar")],-1)),Im=L(()=>t("td",null,"Show a progress bar in the bottom part of the video in the widget.",-1)),Pm=L(()=>t("code",null,"settings.customCss",-1)),Tm={class:"field has-addons mr-1"},Am={class:"control is-expanded"},Dm={class:"control"},Mm=["onClick"],Em=["onClick"],Lm=L(()=>t("i",{class:"fa fa-remove"},null,-1)),jm=[Lm],Rm=L(()=>t("p",null,"Classes that can be used for styling:",-1)),Om={class:"table"},Nm=L(()=>t("thead",null,[t("tr",null,[t("th",null,"Class"),t("th",null,"Description")])],-1)),Fm=L(()=>t("p",null,[t("b",null,"Examples:")],-1));function Jm(s,e,i,g,c,m){const r=_("volume-slider"),n=_("responsive-image"),$=_("upload");return l(),o("div",null,[s.settings?(l(),o("table",ym,[t("tbody",null,[t("tr",null,[vm,t("td",null,[b(r,{modelValue:s.settings.volume,"onUpdate:modelValue":[e[0]||(e[0]=y=>s.settings.volume=y),s.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),$m]),t("tr",null,[_m,t("td",null,[s.settings.hideVideoImage.file?(l(),o("div",bm,[b(n,{src:s.settings.hideVideoImage.file,title:s.settings.hideVideoImage.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"]),km,t("button",{class:"button is-small",onClick:e[1]||(e[1]=(...y)=>s.hideVideoImageRemoved&&s.hideVideoImageRemoved(...y))},Vm)])):u("",!0),b($,{onUploaded:s.hideVideoImageUploaded,accept:"image/*",label:"Upload Image"},null,8,["onUploaded"])]),Sm]),t("tr",null,[Um,t("td",null,[h(t("input",{type:"checkbox","onUpdate:modelValue":[e[2]||(e[2]=y=>s.settings.showProgressBar=y),e[3]||(e[3]=(...y)=>s.sendSettings&&s.sendSettings(...y))]},null,512),[[j,s.settings.showProgressBar]])]),Im]),t("tr",null,[t("td",null,[Pm,t("div",Tm,[t("div",Am,[h(t("input",{class:"input is-small","onUpdate:modelValue":e[4]||(e[4]=y=>s.cssPresetName=y),onFocus:e[5]||(e[5]=y=>s.cssPresetDropdownActive=!0),onBlur:e[6]||(e[6]=y=>s.cssPresetDropdownActive=!1)},null,544),[[f,s.cssPresetName]])]),t("div",Dm,[t("span",{class:"button is-small",onClick:e[7]||(e[7]=(...y)=>s.savePreset&&s.savePreset(...y))},"Save preset")])]),(l(!0),o(U,null,T(s.settings.customCssPresets,(y,v)=>(l(),o("div",{class:"mb-1",key:v},[t("span",{class:"button is-small",onClick:P=>s.loadPreset(y.name)},k(y.name),9,Mm),t("span",{class:"button is-small ml-1",onClick:P=>s.removePreset(y.name)},jm,8,Em)]))),128))]),t("td",null,[h(t("textarea",{class:"textarea","onUpdate:modelValue":[e[8]||(e[8]=y=>s.settings.customCss=y),e[9]||(e[9]=(...y)=>s.sendSettings&&s.sendSettings(...y))]},null,512),[[f,s.settings.customCss]])]),t("td",null,[Rm,t("table",Om,[Nm,t("tbody",null,[(l(!0),o(U,null,T(s.css.classExamples,(y,v)=>(l(),o("tr",{key:v},[t("td",null,[t("code",null,k(y.class),1)]),t("td",null,k(y.desc),1)]))),128))])]),Fm,(l(!0),o(U,null,T(s.css.codeExamples,(y,v)=>(l(),o("p",{key:v},[p(k(y.desc)+" ",1),t("pre",null,[t("code",null,k(y.code),1)])]))),128))])])])],512)):u("",!0)])}var Bm=S(fm,[["render",Jm],["__scopeId","data-v-d79e7668"]]);const zm=V({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(s,e){this.editTag=s.value,this.tagEditIdx=e},updateTag(s,e){this.$emit("updateTag",[s,e])}}}),qm={class:"table is-striped"},Wm=t("tr",null,[t("th",null,"Tag"),t("th"),t("th")],-1),Hm=["onKeyup"],Km=["value","onFocus"],Gm=["disabled","onClick"];function Ym(s,e,i,g,c,m){return l(),o("table",qm,[Wm,(l(!0),o(U,null,T(s.tags,(r,n)=>(l(),o("tr",{key:n},[t("td",null,[s.tagEditIdx===n?h((l(),o("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":e[0]||(e[0]=$=>s.editTag=$),onKeyup:N($=>s.updateTag(r.value,s.editTag),["enter"])},null,40,Hm)),[[f,s.editTag]]):(l(),o("input",{key:1,type:"text",class:"input is-small",value:r.value,onFocus:$=>s.onInputFocus(r,n)},null,40,Km))]),t("td",null,[s.tagEditIdx===n?(l(),o("span",{key:0,class:"button is-small",disabled:r.value===s.editTag?!0:null,onClick:$=>s.updateTag(r.value,s.editTag)},"Save",8,Gm)):u("",!0)]),t("td",null,k(r.count)+"x",1)]))),128))])}var Xm=S(zm,[["render",Ym]]);const Qm=async()=>{const s=pt({history:mt(),routes:[{name:"index",path:"/",component:Tt,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:Gt,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:Je,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:Ed,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:Yd,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:hi,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:re,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:zl,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:vd,meta:{title:"Speech to text",protected:!0}},{name:"drawcast",path:"/drawcast/",component:Ks,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:En,meta:{title:"Settings",protected:!0}}]}),e=async m=>{const r=await fetch(m);return r.status===200?await r.json():null},i=await e("/api/conf"),g=await e("/api/user/me");s.beforeEach((m,r,n)=>{if(m.meta.protected&&!g){n({name:"login"});return}if(!m.meta.protected&&g){n({name:"index"});return}r.name&&document.documentElement.classList.remove(`view-${String(r.name)}`),document.documentElement.classList.add(`view-${String(m.name)}`),document.title=`${m.meta.title}`,n()});const c=gt(bt);c.config.globalProperties.$conf=i,c.config.globalProperties.$me=g,c.use(s),c.component("doubleclick-button",Yr),c.component("draggable",ft),c.component("duration-input",ir),c.component("duration",Wr),c.component("navbar",Fr),c.component("player",rr),c.component("responsive-image",Sr),c.component("slider",$r),c.component("upload",nr),c.component("volume-slider",kr),c.component("youtube",eu),c.component("command-edit",wh),c.component("countdown-edit",wp),c.component("playlist-editor",gm),c.component("tags-editor",Xm),c.component("song-request-settings",Bm),c.component("help",Tp),c.mount("#app")};Qm();
