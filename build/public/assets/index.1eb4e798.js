import{d as D,r as $,o as i,c as o,a as C,b as e,F as P,e as T,t as w,f as h,m as vt,w as u,v as _,g as G,h as q,i as p,j as z,n as Y,k as F,u as zt,l as E,p as Q,q as Z,s as _t,x as Rt,y as yt,z as tt,A as qt,B as Nt,C as Bt,D as Jt,E as Wt}from"./vendor.7107ada0.js";const Ht=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const m of y.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&l(m)}).observe(document,{childList:!0,subtree:!0});function a(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerpolicy&&(y.referrerPolicy=f.referrerpolicy),f.crossorigin==="use-credentials"?y.credentials="include":f.crossorigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function l(f){if(f.ep)return;f.ep=!0;const y=a(f);fetch(f.href,y)}};Ht();var A=(t,s)=>{const a=t.__vccOpts||t;for(const[l,f]of s)a[l]=f;return a};const Kt=D({name:"app"}),Gt={id:"app"};function Yt(t,s,a,l,f,y){const m=$("router-view");return i(),o("div",Gt,[C(m)])}var Xt=A(Kt,[["render",Yt]]);const lt=async(t,s,a)=>new Promise((l,f)=>{const y=new window.XMLHttpRequest;y.open(t,s,!0),y.withCredentials=!0;const m=a.headers||{};for(const n in m)y.setRequestHeader(n,m[n]);y.addEventListener("load",function(n){l({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),y.addEventListener("error",function(n){f(new Error("xhr error"))}),y.upload&&a.onUploadProgress&&y.upload.addEventListener("progress",function(n){a.onUploadProgress&&a.onUploadProgress(n)}),y.send(a.body)}),j=async(t,s={})=>lt("get",t,s),Qt=async(t,s={})=>lt("post",t,s),bt=async(t,s)=>lt("post",t,{headers:{Accept:"application/json","Content-Type":"application/json"},body:s}),H=async(t,s)=>bt(t,JSON.stringify(s));var O={resendVerificationMail:async t=>H("/api/user/_resend_verification_mail",t),requestPasswordReset:async t=>H("/api/user/_request_password_reset",t),register:async t=>H("/api/user/_register",t),resetPassword:async t=>H("/api/user/_reset_password",t),handleToken:async t=>H("/api/_handle-token",t),saveVariables:async t=>H("/api/save-variables",t),twitchUserIdByName:async t=>H("/api/twitch/user-id-by-name",t),saveUserSettings:async t=>H("/api/save-settings",t),getPageVariablesData:async()=>j("/api/page/variables"),getPageIndexData:async()=>j("/api/page/index"),getPageSettingsData:async()=>j("/api/page/settings"),getMe:async()=>j("/api/user/me"),logout:async()=>Qt("/api/logout"),login:async t=>H("/api/auth",t),getConf:async()=>j("/api/conf"),upload:async(t,s)=>{const a=new FormData;return a.append("file",t,t.name),lt("post","/api/upload",{body:a,onUploadProgress:s})},importPlaylist:async t=>bt("/api/sr/import",t),getDrawcastAllImages:async()=>j("/api/drawcast/all-images/")};const Zt=D({data:()=>({widgets:null}),async created(){const t=await O.getPageIndexData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.widgets=s.widgets}}),jt={key:0,id:"app"},xt={id:"top",ref:"top"},te={id:"main",ref:"main"},ee={class:"table is-striped is-fullwidth"},se=e("thead",null,[e("tr",null,[e("th",null,"Widget"),e("th",null,"Hint")])],-1),ne=["href"];function ie(t,s,a,l,f,y){const m=$("navbar");return t.widgets?(i(),o("div",jt,[e("div",xt,[C(m)],512),e("div",te,[e("table",ee,[se,e("tbody",null,[(i(!0),o(P,null,T(t.widgets,(n,r)=>(i(),o("tr",{key:r},[e("td",null,[e("a",{href:n.url,target:"blank"},w(n.title),9,ne)]),e("td",null,w(n.hint),1)]))),128))])])],512)])):h("",!0)}var oe=A(Zt,[["render",ie]]);let rt=null;const ht=vt();async function $t(){const t=await O.getMe();rt=t.status===200?await t.json():null,rt&&ht.emit("login")}async function ae(){return(await(await O.logout()).json()).success?(rt=null,ht.emit("logout"),{error:!1}):{error:"[2021-09-25 18:36]"}}async function le(t,s){const a=await O.login({user:t,pass:s});return a.status===200?(await $t(),{error:!1}):a.status===401?{error:(await a.json()).reason}:{error:"Unknown error"}}var W={getMe:()=>rt,eventBus:ht,logout:ae,login:le,init:$t};const re=D({data:()=>({user:"",pass:"",error:"",success:""}),async mounted(){const s=new URLSearchParams(window.location.search).get("t");if(s){this.success="",this.error="";const a=await O.handleToken({token:s});a.status===200?(await a.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const t=await W.login(this.user,this.pass);t.error?this.error=t.error:this.$router.push({name:"index"})}}}),de={class:"center-screen"},ue=e("h1",{class:"title is-6"},"Hyottoko.club",-1),me={key:0,class:"field has-background-success-light has-text-success-dark"},ce={key:1,class:"field has-background-danger-light has-text-danger-dark"},he={class:"field"},pe={class:"control has-icons-left"},ge=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),fe={class:"field"},ve={class:"control has-icons-left"},_e=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),ye={class:"field"},be={class:"field"},$e=p("Register an account"),we=p(" | "),ke=p("Forgot password?");function Ce(t,s,a,l,f,y){const m=$("router-link");return i(),o("div",de,[ue,e("form",null,[t.success?(i(),o("div",me,w(t.success),1)):h("",!0),t.error?(i(),o("div",ce,w(t.error),1)):h("",!0),e("div",he,[e("div",pe,[u(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":s[0]||(s[0]=n=>t.user=n),onKeyup:s[1]||(s[1]=n=>t.error="")},null,544),[[_,t.user]]),ge])]),e("div",fe,[e("div",ve,[u(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":s[2]||(s[2]=n=>t.pass=n),onKeyup:[s[3]||(s[3]=n=>t.error=""),s[4]||(s[4]=G((...n)=>t.submit&&t.submit(...n),["enter"]))]},null,544),[[_,t.pass]]),_e])]),e("div",ye,[e("span",{class:"button is-small is-primary",onClick:s[5]||(s[5]=(...n)=>t.submit&&t.submit(...n))},"Login")]),e("div",be,[C(m,{to:{name:"register"}},{default:q(()=>[$e]),_:1}),we,C(m,{to:{name:"forgot-password"}},{default:q(()=>[ke]),_:1})])])])}var Ve=A(re,[["render",Ce]]);const Se=1,et=1e3*Se,st=60*et,nt=60*st,dt=24*nt;let it=[];const Ie=t=>{switch(t){case"error":it=["error"];break;case"info":it=["error","info"];break;case"log":it=["error","info","log"];break;case"debug":it=["error","info","log","debug"];break}};Ie("info");const wt=(t,...s)=>{const a=t,l=f=>(...y)=>{it.includes(f)&&console[f](Ue("hh:mm:ss",new Date),`[${a}]`,...s,...y)};return{log:l("log"),info:l("info"),debug:l("debug"),error:l("error")}},Ue=(t,s)=>t.replace(/(hh|mm|ss)/g,(a,l)=>{switch(l){case"hh":return ut(s.getHours(),"00");case"mm":return ut(s.getMinutes(),"00");case"ss":return ut(s.getSeconds(),"00");default:return a}}),ut=(t,s)=>{const a=`${t}`;return a.length>=s.length?a:s.substr(0,s.length-a.length)+a},kt=t=>{if(t==="")throw new Error("unable to parse duration");const s=`${t}`.trim();if(!s)throw new Error("unable to parse duration");if(s.match(/^\d+$/))return parseInt(s,10);const a=s.match(/^((?:\d*)\.(?:\d*))(d|h|m|s)$/);if(a){const d=parseFloat(a[1]);if(isNaN(d))throw new Error("unable to parse duration");const k=a[2];let b=0;return k==="d"?b=d*dt:k==="h"?b=d*nt:k==="m"?b=d*st:k==="s"&&(b=d*et),Math.round(b)}const l=s.match(/^(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!l)throw new Error("unable to parse duration");const f=l[1]?parseInt(l[1],10):0,y=l[2]?parseInt(l[2],10):0,m=l[3]?parseInt(l[3],10):0,n=l[4]?parseInt(l[4],10):0,r=l[5]?parseInt(l[5],10):0;return n*et+m*st+y*nt+f*dt+r},De=t=>{try{return kt(t)}catch{return 0}},Ae=t=>{let s=t;const a=Math.floor(s/dt);s=s%dt;const l=Math.floor(s/nt);s=s%nt;const f=Math.floor(s/st);s=s%st;const y=Math.floor(s/et);s=s%et;const m=s,n=["ms","s","m","h","d"],r=[m,y,f,l,a];let d=0;for(;d<r.length&&r[d]===0;)d++;let k=r.length-1;for(;k>=0&&r[k]===0;)k--;const b=[];for(let c=d;c<=k;c++)b.unshift(`${r[c]}${n[c]}`);return b.join(" ")};function Pe(t,s,a){if(a>=t.length){let l=a-t.length+1;for(;l--;)t.push(void 0)}return t.splice(a,0,t.splice(s,1)[0]),t}const Te=(t,s)=>{const a=[/\$args(?:\((\d*)(:?)(\d*)\))?/g,/\$rand\(\s*(\d+)?\s*,\s*?(\d+)?\s*\)/g,/\$var\(([^)]+)\)/g,/\$user\.name/g,/\$customapi\(([^$)]*)\)\['([A-Za-z0-9_ -]+)'\]/g,/\$customapi\(([^$)]*)\)/g,/\$urlencode\(([^$)]*)\)/g,/\$calc\((\d+)([*/+-])(\d+)\)/g];let l=t,f;do{f=l;for(const y of a)l=l.replace(y,s)}while(f!==l);return l},Fe=(t,s=",",a=-1)=>{const l=t.split(s);return a===-1||l.length<=a?l:[...l.slice(0,a-1),l.slice(a-1).join(s)]},Ee=t=>{let s=t.length;for(;s>0;){const a=Math.floor(Math.random()*s);s--;const l=t[s];t[s]=t[a],t[a]=l}return t};function ot(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath}}function mt(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath,volume:100}}var K={arrayMove:Pe,humanDuration:Ae,parseHumanDuration:De,mustParseHumanDuration:kt,doDummyReplacements:Te,split:Fe,shuffle:Ee,pad:ut,mediaFileFromUploadedFile:ot,soundMediaFileFromUploadedFile:mt};const Ct=()=>({submitButtonText:"Submit",submitConfirm:"",recentImagesTitle:"",canvasWidth:720,canvasHeight:405,customDescription:"",customProfileImage:null,palette:["#000000","#808080","#ff0000","#ff8000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff8080","#80ff80","#ffffff","#c0c0c0","#800000","#804000","#808000","#008000","#008080","#000080","#800080","#8080ff","#ffff80"],displayDuration:5e3,displayLatestForever:!1,displayLatestAutomatically:!1,notificationSound:null,favoriteLists:[{list:[],title:""}]});let Vt=null;const Me=async()=>{const t=await O.getConf();Vt=t.status===200?await t.json():null};var St={init:Me,getConf:()=>Vt};const Le=1001,It=4e3,Ut=wt("WsWrapper.ts");class Oe{constructor(s,a){this.handle=null,this.reconnectTimeout=null,this.sendBuffer=[],this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{},this.addr=s,this.protocols=a}send(s){this.handle?this.handle.send(s):this.sendBuffer.push(s)}connect(){const s=new WebSocket(this.addr,this.protocols);s.onopen=a=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=s;this.sendBuffer.length>0;){const l=this.sendBuffer.shift();l&&this.handle.send(l)}this.onopen(a)},s.onmessage=a=>{this.onmessage(a)},s.onclose=a=>{this.handle=null,a.code===It?Ut.info("custom disconnect, will not reconnect"):a.code===Le?Ut.info("going away, will not reconnect"):this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3),this.onclose(a)}}disconnect(){this.handle&&this.handle.close(It)}}const Dt=wt("WsClient.ts");class ze extends Oe{constructor(s,a){super(s,a);this._on={},this.onopen=l=>{this._dispatch("socket","open",l)},this.onmessage=l=>{if(this._dispatch("socket","message",l),this._on.message){const f=this._parseMessageData(l.data);f.event&&this._dispatch("message",`${f.event}`,f.data)}},this.onclose=l=>{this._dispatch("socket","close",l)}}onSocket(s,a){this.addEventListener("socket",s,a)}onMessage(s,a){this.addEventListener("message",s,a)}addEventListener(s,a,l){const f=Array.isArray(a)?a:[a];this._on[s]=this._on[s]||{};for(const y of f)this._on[s][y]=this._on[s][y]||[],this._on[s][y].push(l)}_parseMessageData(s){try{const a=JSON.parse(s);if(a.event)return{event:a.event,data:a.data||null}}catch(a){Dt.info(a)}return{event:null,data:null}}_dispatch(s,a,...l){const y=(this._on[s]||{})[a]||[];if(y.length!==0){Dt.log(`ws dispatch ${s} ${a}`);for(const m of y)m(...l)}}}const Re=t=>{const s=W.getMe();return`${location.protocol}//${location.host}/widget/${t}/${s.widgetToken}/`},qe=t=>{const s=St.getConf(),a=W.getMe();return new ze(`${s.wsBase}/${t}`,a?a.token:"")};var N={widgetUrl:Re,wsClient:qe};const Ne=D({data:()=>({unchangedJson:"{}",changedJson:"{}",inited:!1,settings:Ct(),defaultSettings:Ct(),ws:null,drawUrl:"",favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}}}),async created(){this.ws=N.wsClient("drawcast"),this.ws.onMessage("init",async t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.drawUrl=t.drawUrl;const s=await O.getDrawcastAllImages();this.favoriteSelection.items=await s.json(),this.inited=!0}),this.ws.connect()},watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},receiveUrl(){return N.widgetUrl("drawcast_receive")},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage==0?0:1)},currentFavoriteSelectionItems(){const t=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(t,t+this.favoriteSelection.pagination.perPage)}},methods:{addFavoriteList(){if(!this.settings){console.warn("addFavoriteList: this.settings not initialized");return}this.settings.favoriteLists.push({list:[],title:""})},removeFavoriteList(t){if(!this.settings){console.warn("removeFavoriteList: this.settings not initialized");return}const s=[];for(let a in this.settings.favoriteLists)parseInt(a,10)!==parseInt(`${t}`,10)&&s.push(this.settings.favoriteLists[a]);this.settings.favoriteLists=s},toggleFavorite(t,s){if(!this.settings){console.warn("toggleFavorite: this.settings not initialized");return}this.settings.favoriteLists[t].list.includes(s)?this.settings.favoriteLists[t].list=this.settings.favoriteLists[t].list.filter(a=>a!==s):this.settings.favoriteLists[t].list.push(s)},customProfileImageRemoved(){if(!this.settings){console.warn("customProfileImageRemoved: this.settings not initialized");return}this.settings.customProfileImage=null},customProfileImageUploaded(t){if(!this.settings){console.warn("customProfileImageUploaded: this.settings not initialized");return}this.settings.customProfileImage=ot(t)},soundUploaded(t){if(!this.settings){console.warn("soundUploaded: this.settings not initialized");return}this.settings.notificationSound=mt(t)},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:{canvasWidth:parseInt(`${this.settings.canvasWidth}`,10)||720,canvasHeight:parseInt(`${this.settings.canvasHeight}`,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,recentImagesTitle:this.settings.recentImagesTitle,customDescription:this.settings.customDescription,customProfileImage:this.settings.customProfileImage,palette:this.settings.palette,displayDuration:parseInt(`${this.settings.displayDuration}`,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,notificationSound:this.settings.notificationSound,favoriteLists:this.settings.favoriteLists}})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},unmounted(){this.ws&&this.ws.disconnect()}}),Be={id:"app"},Je={id:"top",ref:"top"},We={id:"actionbar",class:"p-1"},He=["disabled"],Ke=["href"],Ge=["href"],Ye={id:"main",ref:"main"},Xe={key:0,class:"table is-striped",ref:"table"},Qe=e("tr",null,[e("td",{colspan:"3"},"General")],-1),Ze=e("td",null,[e("code",null,"settings.canvasWidth")],-1),je=e("td",null,[p(" Width of the drawing area."),e("br"),p(" Caution: changing this will clear the area for currenty connected users. ")],-1),xe=e("td",null,[e("code",null,"settings.canvasHeight")],-1),ts=e("td",null,[p(" Height of the drawing area."),e("br"),p(" Caution: changing this will clear the area for currenty connected users. ")],-1),es=e("td",null,[e("code",null,"settings.displayDuration")],-1),ss=e("td",null," The duration in Milliseconds that each drawing will be shown ",-1),ns=e("td",null,[e("code",null,"settings.displayLatestForever")],-1),is=e("td",null,"If checked, the latest drawing will be shown indefinately.",-1),os=e("td",null,[e("code",null,"settings.displayLatestAutomatically")],-1),as=e("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),ls=e("td",null,[e("code",null,"settings.submitButtonText")],-1),rs=e("td",null,null,-1),ds=e("td",null,[e("code",null,"settings.submitConfirm")],-1),us=e("td",null," Leave empty if no confirm is required by user before sending. ",-1),ms=e("td",null,[e("code",null,"settings.recentImagesTitle")],-1),cs=e("td",null,"Title for the recently submitted images gallery.",-1),hs=e("td",null,[e("code",null,"settings.customDescription")],-1),ps=e("td",null,"Description text below the drawing panel.",-1),gs=e("td",null,[e("code",null,"settings.customProfileImage")],-1),fs={key:0,class:"spacerow media-holder"},vs=e("br",null,null,-1),_s=e("i",{class:"fa fa-remove mr-1"},null,-1),ys=p(" Remove Image "),bs=[_s,ys],$s=e("td",null,[p(" Profile image that will be displayed next to the "),e("code",null,"settings.customDescription"),p(". ")],-1),ws=e("td",null,[e("code",null,"settings.palette")],-1),ks=["onUpdate:modelValue"],Cs=e("br",null,null,-1),Vs=e("br",null,null,-1),Ss=e("td",null,[p(" Default colors appearing on the draw page."),e("br"),p(" Caution: Changing this will change selected color for currenty connected users. ")],-1),Is=e("td",null,[e("code",null,"settings.notificationSound")],-1),Us={key:0,class:"spacerow media-holder"},Ds=e("i",{class:"fa fa-remove"},null,-1),As=[Ds],Ps=e("td",null,[p(" Add a sound here that plays when new drawings arrive. "),e("br"),p(" Note: Not played in drawing window, only in widget. ")],-1),Ts=e("div",null,[e("code",null,"settings.favoriteLists")],-1),Fs={class:"preview"},Es=["src"],Ms={key:0},Ls=["onClick"],Os=e("div",null,"Title:",-1),zs=["onUpdate:modelValue"],Rs=e("div",null,"Currently selected favorites:",-1),qs={class:"favorites"},Ns=["src","onClick","onMouseover"],Bs=e("div",{class:"mt-2"},"Select favorites:",-1),Js={class:"favorites-select"},Ws=["src","onClick","onMouseover"],Hs=["disabled"],Ks=["disabled"],Gs=e("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function Ys(t,s,a,l,f,y){const m=$("navbar"),n=$("responsive-image"),r=$("upload"),d=$("player"),k=$("volume-slider");return i(),o("div",Be,[e("div",Je,[C(m),e("div",We,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...b)=>t.sendSave&&t.sendSave(...b))}," Save ",8,He),e("a",{class:"button is-small mr-1",href:t.receiveUrl,target:"_blank"},"Open widget",8,Ke),e("a",{class:"button is-small",href:t.drawUrl,target:"_blank"},"Open draw",8,Ge)])],512),e("div",Ye,[t.inited?(i(),o("table",Xe,[e("tbody",null,[Qe,e("tr",null,[Ze,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[1]||(s[1]=b=>t.settings.canvasWidth=b)},null,512),[[_,t.settings.canvasWidth]])]),je]),e("tr",null,[xe,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=b=>t.settings.canvasHeight=b)},null,512),[[_,t.settings.canvasHeight]])]),ts]),e("tr",null,[es,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=b=>t.settings.displayDuration=b)},null,512),[[_,t.settings.displayDuration]])]),ss]),e("tr",null,[ns,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=b=>t.settings.displayLatestForever=b)},null,512),[[z,t.settings.displayLatestForever]])]),is]),e("tr",null,[os,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=b=>t.settings.displayLatestAutomatically=b)},null,512),[[z,t.settings.displayLatestAutomatically]])]),as]),e("tr",null,[ls,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=b=>t.settings.submitButtonText=b)},null,512),[[_,t.settings.submitButtonText]])]),rs]),e("tr",null,[ds,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[7]||(s[7]=b=>t.settings.submitConfirm=b)},null,512),[[_,t.settings.submitConfirm]])]),us]),e("tr",null,[ms,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[8]||(s[8]=b=>t.settings.recentImagesTitle=b)},null,512),[[_,t.settings.recentImagesTitle]])]),cs]),e("tr",null,[hs,e("td",null,[u(e("textarea",{class:"textarea","onUpdate:modelValue":s[9]||(s[9]=b=>t.settings.customDescription=b)},null,512),[[_,t.settings.customDescription]])]),ps]),e("tr",null,[gs,e("td",null,[t.settings.customProfileImage?(i(),o("div",fs,[C(n,{src:t.settings.customProfileImage.urlpath,title:t.settings.customProfileImage.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"]),vs,e("button",{class:"button is-small",onClick:s[10]||(s[10]=(...b)=>t.customProfileImageRemoved&&t.customProfileImageRemoved(...b))},bs)])):h("",!0),C(r,{onUploaded:t.customProfileImageUploaded,accept:"image/*",label:"Upload Image"},null,8,["onUploaded"])]),$s]),e("tr",null,[ws,e("td",null,[(i(!0),o(P,null,T(t.settings.palette,(b,c)=>(i(),o("label",{class:"square",key:c},[u(e("input",{type:"color","onUpdate:modelValue":v=>t.settings.palette[c]=v},null,8,ks),[[_,t.settings.palette[c]]]),e("span",{class:"square-inner",style:Y({backgroundColor:b})},null,4)]))),128)),Cs,Vs,e("button",{class:"button is-small",onClick:s[11]||(s[11]=b=>t.settings.palette=t.defaultSettings.palette)}," Reset to default palette ")]),Ss]),e("tr",null,[Is,e("td",null,[t.settings.notificationSound?(i(),o("div",Us,[C(d,{src:t.settings.notificationSound.urlpath,name:t.settings.notificationSound.filename,volume:t.settings.notificationSound.volume,class:"button is-small"},null,8,["src","name","volume"]),C(k,{modelValue:t.settings.notificationSound.volume,"onUpdate:modelValue":s[12]||(s[12]=b=>t.settings.notificationSound.volume=b)},null,8,["modelValue"]),e("button",{class:"button is-small",onClick:s[13]||(s[13]=b=>t.settings.notificationSound=null)},As)])):h("",!0),C(r,{onUploaded:t.soundUploaded,accept:"audio/*",label:"Upload Audio"},null,8,["onUploaded"])]),Ps]),e("tr",null,[e("td",null,[Ts,e("div",null,[e("span",{class:"button is-small",onClick:s[14]||(s[14]=(...b)=>t.addFavoriteList&&t.addFavoriteList(...b))},"Add a list")]),e("div",Fs,[t.favoriteSelection.hovered?(i(),o("img",{key:0,src:t.favoriteSelection.hovered},null,8,Es)):h("",!0)])]),e("td",null,[(i(!0),o(P,null,T(t.settings.favoriteLists,(b,c)=>(i(),o("div",{key:c},[t.settings.favoriteLists.length>1?(i(),o("div",Ms,[e("span",{class:"button is-small",onClick:v=>t.removeFavoriteList(c)},"Remove this list",8,Ls)])):h("",!0),Os,u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":v=>b.title=v},null,8,zs),[[_,b.title]]),Rs,e("div",qs,[(i(!0),o(P,null,T(b.list,(v,g)=>(i(),o("img",{src:v,key:g,width:"50",height:"50",onClick:V=>t.toggleFavorite(c,v),onMouseover:V=>t.favoriteSelection.hovered=v,onMouseleave:s[15]||(s[15]=V=>t.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,Ns))),128))]),Bs,e("div",Js,[(i(!0),o(P,null,T(t.currentFavoriteSelectionItems,(v,g)=>(i(),o("img",{src:v,key:g,width:"50",height:"50",onClick:V=>t.toggleFavorite(c,v),onMouseover:V=>t.favoriteSelection.hovered=v,onMouseleave:s[16]||(s[16]=V=>t.favoriteSelection.hovered=""),class:F(["thumbnail mr-1",{"is-favorited":b.list.includes(v)}])},null,42,Ws))),128))]),e("span",{class:"button is-small",onClick:s[17]||(s[17]=v=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page-1),disabled:t.favoriteSelection.pagination.page>1?null:!0},"Prev",8,Hs),e("span",{class:"button is-small",onClick:s[18]||(s[18]=v=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page+1),disabled:t.favoriteSelection.pagination.page<t.favoriteSelectionTotalPages?null:!0},"Next",8,Ks)]))),128))]),Gs])])],512)):h("",!0)],512)])}var Xs=A(Ne,[["render",Ys]]);const Qs=D({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(t){this.variables=this.variables.filter((s,a)=>a!==t)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await O.saveVariables({variables:this.variables}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await O.getPageVariablesData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.variables=s.variables,this.setUnchanged()}}),Zs={id:"app"},js={id:"top",ref:"top"},xs={id:"actionbar",class:"p-1"},tn=["disabled"],en={id:"main"},sn={class:"mb-4"},nn=e("h1",{class:"title mb-2"},"Global Variables",-1),on=e("div",{class:"help"},[p(" Variables can be used from commands with "),e("code",null,"$var(variable_name)"),p(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),an={class:"table is-striped"},ln=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Value"),e("th")])],-1),rn=["onUpdate:modelValue"],dn=["onUpdate:modelValue"],un=e("i",{class:"fa fa-trash"},null,-1);function mn(t,s,a,l,f,y){const m=$("navbar"),n=$("doubleclick-button");return i(),o("div",Zs,[e("div",js,[C(m),e("div",xs,[e("button",{class:"button is-small",onClick:s[0]||(s[0]=(...r)=>t.onAdd&&t.onAdd(...r))},"Add"),e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[1]||(s[1]=(...r)=>t.sendSave&&t.sendSave(...r))}," Save ",8,tn)])],512),e("div",en,[e("div",sn,[nn,on,e("table",an,[ln,e("tbody",null,[(i(!0),o(P,null,T(t.variables,(r,d)=>(i(),o("tr",{key:d},[e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":k=>r.name=k},null,8,rn),[[_,r.name]])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":k=>r.value=k},null,8,dn),[[_,r.value]])]),e("td",null,[C(n,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:k=>t.remove(d)},{default:q(()=>[un]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var cn=A(Qs,[["render",mn]]);const hn=D({data:()=>({user:"",pass:"",email:"",error:"",success:!1}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const t=await O.resendVerificationMail({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const t=await O.register({user:this.user,pass:this.pass,email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),pn={class:"center-screen"},gn=e("h1",{class:"title is-6"},"Hyottoko.club",-1),fn={key:0,class:"field has-background-success-light has-text-success-dark"},vn=p(" Account registered. Please check your mail. Click "),_n=p("here"),yn=p(" to login. "),bn={key:1},$n={key:0,class:"field has-background-danger-light has-text-danger-dark"},wn={key:0},kn=p(" A user with this email is already registered. "),Cn=e("br",null,null,-1),Vn=p("Request a password reset."),Sn={key:1},In=p(" A user with this email is already registered. "),Un=e("br",null,null,-1),Dn={key:2},An={key:3},Pn={key:4},Tn={class:"field"},Fn={class:"control has-icons-left"},En=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),Mn={class:"field"},Ln={class:"control has-icons-left"},On=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),zn={class:"field"},Rn={class:"control has-icons-left"},qn=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Nn={class:"field"},Bn=["disabled"];function Jn(t,s,a,l,f,y){const m=$("router-link");return i(),o("div",pn,[gn,t.success?(i(),o("div",fn,[vn,C(m,{to:{name:"login"}},{default:q(()=>[_n]),_:1}),yn])):(i(),o("div",bn,[t.error?(i(),o("div",$n,[t.error==="verified_mail_already_exists"?(i(),o("div",wn,[kn,Cn,C(m,{to:{name:"forgot-password"}},{default:q(()=>[Vn]),_:1})])):t.error==="unverified_mail_already_exists"?(i(),o("div",Sn,[In,Un,e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...n)=>t.onRequestVerificationEmail&&t.onRequestVerificationEmail(...n))},"Resend verification email")])):t.error==="verified_name_already_exists"?(i(),o("div",Dn," A user with this name is already registered. ")):t.error==="unverified_name_already_exists"?(i(),o("div",An," A user with this name is already registered. ")):(i(),o("span",Pn,w(t.error),1))])):h("",!0),e("div",Tn,[e("div",Fn,[u(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":[s[1]||(s[1]=n=>t.user=n),s[2]||(s[2]=n=>t.error="")]},null,512),[[_,t.user]]),En])]),e("div",Mn,[e("div",Ln,[u(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":[s[3]||(s[3]=n=>t.email=n),s[4]||(s[4]=n=>t.error="")]},null,512),[[_,t.email]]),On])]),e("div",zn,[e("div",Rn,[u(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":[s[5]||(s[5]=n=>t.pass=n),s[6]||(s[6]=n=>t.error="")],onKeyup:s[7]||(s[7]=G((...n)=>t.submit&&t.submit(...n),["enter"]))},null,544),[[_,t.pass]]),qn])]),e("div",Nn,[e("button",{class:"button is-small is-primary",disabled:t.canRegister?null:!0,onClick:s[8]||(s[8]=(...n)=>t.submit&&t.submit(...n))}," Register ",8,Bn)])]))])}var Wn=A(hn,[["render",Jn]]);const Hn=D({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[],tmi_identity_client_id:"",tmi_identity_client_secret:""},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const t=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],s=document.location,a=`${s.protocol}//${s.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${a}&scope=${t.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(t){this.twitch_channels=this.twitch_channels.filter((s,a)=>a!==t)},addchannel(){this.twitch_channels.push({user_id:this.user.id,bot_status_messages:1,channel_id:"",channel_name:"",access_token:""})},async loadid(t){this.twitch_channels[t].channel_id=await this.getTwitchUserIdByName(this.twitch_channels[t].channel_name)},async getTwitchUserIdByName(t){const s={name:t,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},a=await O.twitchUserIdByName(s);try{return`${(await a.json()).id}`}catch{return""}},async sendSave(){await O.saveUserSettings({user:this.user,twitch_channels:this.twitch_channels}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await O.getPageSettingsData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.user=s.user,this.twitch_channels=s.twitchChannels,this.setUnchanged()}}),Kn={id:"app"},Gn={id:"top",ref:"top"},Yn={id:"actionbar",class:"p-1"},Xn=["disabled"],Qn={id:"main"},Zn={class:"mb-4"},jn=e("h1",{class:"title mb-2"},"User",-1),xn={class:"table is-striped"},ti=e("td",null,"Name:",-1),ei=e("td",null,"Email:",-1),si=e("td",null,"Password:",-1),ni={key:0,class:"mb-4"},ii=e("h1",{class:"title mb-2"},"Twitch-Bot",-1),oi=e("p",null,[p(" Please refer to "),e("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),p(". ")],-1),ai={class:"table is-striped"},li=e("td",null,"Bot name:",-1),ri=e("td",null,"Bot oauth (pass):",-1),di=e("td",null,"Bot client_id:",-1),ui=e("td",null,"Bot client_secret:",-1),mi={class:"mb-4"},ci=e("h1",{class:"title mb-2"},"Twitch Channels",-1),hi=p(" List of twitch channels where the bot will connect to. "),pi={key:0},gi={key:0,class:"table is-striped"},fi=e("thead",null,[e("tr",null,[e("td",null,"Channel name"),e("td",null,"Chat status updates"),e("td",null,"Channel id*"),e("td",null,"Access Token*"),e("td")])],-1),vi=["onUpdate:modelValue"],_i=["onUpdate:modelValue"],yi=["onClick"],bi=["onUpdate:modelValue"],$i=["onClick"],wi=e("i",{class:"fa fa-remove"},null,-1),ki=[wi],Ci={key:1,class:"content"},Vi=e("p",null," Channel Id* and Access Token*: You may not need the client id or access token. They are required for channel point reward redemption triggers only. ",-1),Si={key:0},Ii={key:1,class:"list"},Ui=e("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Di={class:"list-item"},Ai=p(" Click "),Pi=["href"],Ti=p(" to authorize the bot with the channel "),Fi=e("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),Ei={key:2};function Mi(t,s,a,l,f,y){const m=$("navbar"),n=$("checkbox");return i(),o("div",Kn,[e("div",Gn,[C(m),e("div",Yn,[e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[0]||(s[0]=(...r)=>t.sendSave&&t.sendSave(...r))}," Save ",8,Xn)])],512),e("div",Qn,[e("div",Zn,[jn,e("table",xn,[e("tbody",null,[e("tr",null,[ti,e("td",null,w(t.user.name),1)]),e("tr",null,[ei,e("td",null,[u(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=r=>t.user.email=r)},null,512),[[_,t.user.email]])])]),e("tr",null,[si,e("td",null,[u(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=r=>t.user.pass=r)},null,512),[[_,t.user.pass]])])])])])]),t.isAdmin?(i(),o("div",ni,[ii,oi,e("table",ai,[e("tbody",null,[e("tr",null,[li,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=r=>t.user.tmi_identity_username=r)},null,512),[[_,t.user.tmi_identity_username]])])]),e("tr",null,[ri,e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[4]||(s[4]=r=>t.user.tmi_identity_password=r)},null,512),[[_,t.user.tmi_identity_password]])])]),e("tr",null,[di,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=r=>t.user.tmi_identity_client_id=r)},null,512),[[_,t.user.tmi_identity_client_id]])])]),e("tr",null,[ui,e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[6]||(s[6]=r=>t.user.tmi_identity_client_secret=r)},null,512),[[_,t.user.tmi_identity_client_secret]])])])])])])):h("",!0),e("div",mi,[ci,e("p",null,[hi,t.twitch_channels.length===0?(i(),o("span",pi," Currently no channels are configured. ")):h("",!0)]),t.twitch_channels.length>0?(i(),o("table",gi,[fi,e("tbody",null,[(i(!0),o(P,null,T(t.twitch_channels,(r,d)=>(i(),o("tr",{key:d},[e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":k=>r.channel_name=k},null,8,vi),[[_,r.channel_name]])]),e("td",null,[C(n,{class:"is-small",onValue:1,offValue:0,modelValue:r.bot_status_messages,"onUpdate:modelValue":k=>r.bot_status_messages=k},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[r.channel_id?u((i(),o("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":k=>r.channel_id=k},null,8,_i)),[[_,r.channel_id]]):h("",!0),r.channel_id?h("",!0):(i(),o("button",{key:1,class:"button is-small",onClick:k=>t.loadid(d)}," Load id ",8,yi))]),e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":k=>r.access_token=k},null,8,bi),[[_,r.access_token]])]),e("td",null,[e("button",{class:"button is-small",onClick:k=>t.rmchannel(d)},ki,8,$i)])]))),128))])])):h("",!0),e("button",{class:"button is-small",onClick:s[7]||(s[7]=r=>t.addchannel())}," Add channel ")]),t.twitch_channels.length>0?(i(),o("div",Ci,[Vi,t.accessTokenLink?(i(),o("p",Si,"To get an access token, do the following:")):h("",!0),t.accessTokenLink?(i(),o("ol",Ii,[Ui,e("li",Di,[Ai,e("a",{href:t.accessTokenLink,target:"_blank"},"here",8,Pi),Ti]),Fi])):t.isAdmin?(i(),o("p",Ei,' To configure an access token, please configure the "Bot client_id" above. ')):h("",!0)])):h("",!0)])])}var Li=A(Hn,[["render",Mi]]);const Oi=(t=null)=>({name:(t==null?void 0:t.name)||"",css:(t==null?void 0:t.css)||"",showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}),zi=(t=null)=>{var s,a,l,f;return{volume:typeof(t==null?void 0:t.volume)=="undefined"?100:t.volume,hideVideoImage:{file:((s=t==null?void 0:t.hideVideoImage)==null?void 0:s.file)||"",filename:((a=t==null?void 0:t.hideVideoImage)==null?void 0:a.filename)||"",urlpath:((l=t==null?void 0:t.hideVideoImage)==null?void 0:l.urlpath)?t.hideVideoImage.urlpath:((f=t==null?void 0:t.hideVideoImage)==null?void 0:f.file)?`/uploads/${encodeURIComponent(t.hideVideoImage.file)}`:""},customCss:(t==null?void 0:t.customCss)||"",customCssPresets:typeof(t==null?void 0:t.customCssPresets)=="undefined"?[]:t.customCssPresets.map(Oi),showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,initAutoplay:typeof(t==null?void 0:t.initAutoplay)=="undefined"?!0:t.initAutoplay,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}};const Ri=D({data:()=>({playerVisible:!1,playlist:[],commands:[],globalVariables:[],settings:zi(),filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:"",toast:zt(),controlDefinitions:[{title:"Reset stats",ctrl:"resetStats",icon:"fa-eraser"},{title:"Clear playlist",ctrl:"clear",icon:"fa-eject"},{title:"Shuffle",ctrl:"shuffle",icon:"fa-random"},{title:"Play",ctrl:"unpause",icon:"fa-play"},{title:"Pause",ctrl:"pause",icon:"fa-pause"},{title:"Prev",ctrl:"prev",icon:"fa-step-backward"},{title:"Next",ctrl:"skip",icon:"fa-step-forward"}],tabDefinitions:[{tab:"playlist",title:"Playlist"},{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"},{tab:"tags",title:"Tags"},{tab:"import",title:"Import/Export"}],possibleActions:["sr_current","sr_undo","sr_good","sr_bad","sr_stats","sr_prev","sr_next","sr_jumptonew","sr_clear","sr_rm","sr_shuffle","sr_reset_stats","sr_loop","sr_noloop","sr_pause","sr_unpause","sr_hidevideo","sr_showvideo","sr_request","sr_re_request","sr_addtag","sr_rmtag","sr_volume","sr_filter","sr_preset","sr_queue"]}),computed:{tags(){const t=[];return this.playlist.forEach(s=>{s.tags.forEach(a=>{const l=t.findIndex(f=>f.value===a);l===-1?t.push({value:a,count:1}):t[l].count++})}),t},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(t=>t.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},exportPlaylistUrl(){return`${location.protocol}//${location.host}/api/sr/export`},widgetUrl(){return N.widgetUrl("sr")}},methods:{sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings})},onTagUpdated(t){this.updateTag(t[0],t[1])},onPlaylistCtrl(t){this.sendCtrl(t[0],t[1])},applyFilter(t){this.sendCtrl("filter",[{tag:t}])},async doImportPlaylist(){(await O.importPlaylist(this.importPlaylist)).status===200?(this.tab="playlist",this.toast.success("Import successful")):this.toast.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(t,s){this.sendMsg({event:"ctrl",ctrl:t,args:s})},ended(){this.sendMsg({event:"ended"})},sendMsg(t){this.ws?this.ws.send(JSON.stringify(t)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(t){this.player.setVolume(t)},updateTag(t,s){t!==s&&this.sendCtrl("updatetag",[t,s])}},async mounted(){this.$nextTick(()=>{this.ws=N.wsClient("sr"),this.ws.onMessage("save",t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables}),this.ws.onMessage(["pause"],t=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],t=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],t=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],t=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","clear","move","tags"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist;const a=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;s!==a&&this.play()}),this.ws.onMessage(["filter"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist,this.filteredPlaylist.find(a=>a.id===s)||this.play()}),this.ws.onMessage(["dislike","like","video","playIdx","resetStats","shuffle"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.filter=t.filter,this.playlist=t.playlist}),this.ws.onMessage(["add","init"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.filter=t.filter,this.playlist=t.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),at=t=>(Q("data-v-1639230a"),t=t(),Z(),t),qi={id:"app"},Ni={id:"top",ref:"top"},Bi={id:"actionbar",class:"p-1"},Ji=["disabled","onClick","title"],Wi=["disabled","title"],Hi=at(()=>e("i",{class:"fa fa-tv mr-1"},null,-1)),Ki={class:"txt"},Gi={class:"field has-addons mr-1"},Yi={class:"control"},Xi=["disabled"],Qi={class:"control"},Zi=["disabled"],ji=at(()=>e("i",{class:"fa fa-search mr-1"},null,-1)),xi=p(" from playlist "),to=[ji,xi],eo={class:"field has-addons mr-1"},so={class:"control"},no=["disabled"],io={class:"control"},oo=["disabled"],ao=at(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),lo=p(" from YouTube "),ro=[ao,lo],uo=["disabled","href"],mo={id:"main",ref:"main"},co={style:{width:"640px","max-width":"100%"}},ho={class:"tabs"},po=["onClick"],go={key:0},fo={class:"mb-1"},vo=["href"],_o=at(()=>e("i",{class:"fa fa-download mr-1"},null,-1)),yo=p(" Export playlist"),bo=[_o,yo],$o=at(()=>e("i",{class:"fa fa-upload mr-1"},null,-1)),wo=p(" Import playlist "),ko=[$o,wo],Co={key:1,id:"tags"},Vo={key:3,id:"playlist",class:"table-container"};function So(t,s,a,l,f,y){const m=$("navbar"),n=$("youtube"),r=$("tags-editor"),d=$("song-request-settings"),k=$("playlist-editor"),b=$("commands-editor");return i(),o("div",qi,[e("div",Ni,[C(m),e("div",Bi,[(i(!0),o(P,null,T(t.controlDefinitions,(c,v)=>(i(),o("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:g=>t.sendCtrl(c.ctrl,[]),title:c.title,key:v},[e("i",{class:F(["fa",c.icon])},null,2)],8,Ji))),128)),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[0]||(s[0]=(...c)=>t.togglePlayer&&t.togglePlayer(...c)),title:t.togglePlayerButtonText},[Hi,e("span",Ki,w(t.togglePlayerButtonText),1)],8,Wi),e("div",Gi,[e("div",Yi,[u(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[1]||(s[1]=c=>t.resrinput=c),onKeyup:s[2]||(s[2]=G((...c)=>t.resr&&t.resr(...c),["enter"]))},null,40,Xi),[[_,t.resrinput]])]),e("div",Qi,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[3]||(s[3]=(...c)=>t.resr&&t.resr(...c))},to,8,Zi)])]),e("div",eo,[e("div",so,[u(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[4]||(s[4]=c=>t.srinput=c),onKeyup:s[5]||(s[5]=G((...c)=>t.sr&&t.sr(...c),["enter"]))},null,40,no),[[_,t.srinput]])]),e("div",io,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[6]||(s[6]=(...c)=>t.sr&&t.sr(...c))},ro,8,oo)])]),e("a",{class:"button is-small mr-1",disabled:t.inited?null:!0,href:t.widgetUrl,target:"_blank"},"Open SR widget",8,uo)])],512),e("div",mo,[e("div",co,[e("div",{id:"player",class:"video-16-9",style:Y(t.playerstyle)},[C(n,{ref:"youtube",onEnded:t.ended,visible:t.playerVisible},null,8,["onEnded","visible"])],4)]),e("div",ho,[e("ul",null,[(i(!0),o(P,null,T(t.tabDefinitions,(c,v)=>(i(),o("li",{key:v,class:F({"is-active":t.tab===c.tab}),onClick:g=>t.tab=c.tab},[e("a",null,w(c.title),1)],10,po))),128))])]),t.inited&&t.tab==="import"?(i(),o("div",go,[e("div",fo,[e("a",{class:"button is-small mr-1",href:t.exportPlaylistUrl,target:"_blank"},bo,8,vo),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...c)=>t.doImportPlaylist&&t.doImportPlaylist(...c))},ko)]),u(e("textarea",{class:"textarea mb-1","onUpdate:modelValue":s[8]||(s[8]=c=>t.importPlaylist=c)},null,512),[[_,t.importPlaylist]])])):h("",!0),t.inited&&t.tab==="tags"?(i(),o("div",Co,[C(r,{tags:t.tags,onUpdateTag:t.onTagUpdated},null,8,["tags","onUpdateTag"])])):h("",!0),t.inited&&t.tab==="settings"?(i(),E(d,{key:2,id:"settings",modelValue:t.settings,"onUpdate:modelValue":[s[9]||(s[9]=c=>t.settings=c),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),t.inited&&t.tab==="playlist"?(i(),o("div",Vo,[C(k,{playlist:t.playlist,filter:t.filter,onStopPlayer:s[10]||(s[10]=c=>t.player.stop()),onFilterChange:t.applyFilter,onCtrl:t.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):h("",!0),t.inited&&t.tab==="commands"?(i(),E(b,{key:4,modelValue:t.commands,"onUpdate:modelValue":[s[11]||(s[11]=c=>t.commands=c),t.sendSave],globalVariables:t.globalVariables,possibleActions:t.possibleActions,baseVolume:100},null,8,["modelValue","onUpdate:modelValue","globalVariables","possibleActions"])):h("",!0)],512)])}var Io=A(Ri,[["render",So],["__scopeId","data-v-1639230a"]]);const Uo=()=>({volume:100}),Do=()=>({showImages:!0}),Ao=D({data:()=>({commands:[],settings:Uo(),adminSettings:Do(),globalVariables:[],ws:null,possibleActions:["text","media","media_volume","countdown","dict_lookup","madochan_createword","chatters","set_channel_title","set_channel_game_id"],tabDefinitions:[{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"}],inited:!1,tab:"commands"}),computed:{baseVolume(){return this.settings.volume},widgetUrl(){return N.widgetUrl("media")}},methods:{updateShowImages(t){this.adminSettings.showImages=t,this.sendSave()},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings,adminSettings:this.adminSettings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=N.wsClient("general"),this.ws.onMessage("init",t=>{this.commands=t.commands,this.settings=t.settings,this.adminSettings=t.adminSettings,this.globalVariables=t.globalVariables,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Po={id:"app"},To={id:"top",ref:"top"},Fo={id:"main",ref:"main"},Eo={class:"tabs"},Mo=["onClick"],Lo=["href"],Oo={key:1},zo={key:0,class:"table is-striped",ref:"table"},Ro=e("td",null,[e("code",null,"settings.volume")],-1),qo=e("td",null,"Base volume for all media playing from commands",-1);function No(t,s,a,l,f,y){const m=$("navbar"),n=$("commands-editor"),r=$("volume-slider");return i(),o("div",Po,[e("div",To,[C(m)],512),e("div",Fo,[e("div",Eo,[e("ul",null,[(i(!0),o(P,null,T(t.tabDefinitions,(d,k)=>(i(),o("li",{key:k,class:F({"is-active":t.tab===d.tab}),onClick:b=>t.tab=d.tab},[e("a",null,w(d.title),1)],10,Mo))),128)),e("li",null,[e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open Media widget",8,Lo)])])]),t.inited&&t.tab==="commands"?(i(),E(n,{key:0,modelValue:t.commands,"onUpdate:modelValue":[s[0]||(s[0]=d=>t.commands=d),t.sendSave],globalVariables:t.globalVariables,possibleActions:t.possibleActions,baseVolume:t.baseVolume,showToggleImages:!0,showFilterActions:!0,showImages:t.adminSettings.showImages,onShowImagesChange:t.updateShowImages},null,8,["modelValue","onUpdate:modelValue","globalVariables","possibleActions","baseVolume","showImages","onShowImagesChange"])):h("",!0),t.inited&&t.tab==="settings"?(i(),o("div",Oo,[t.settings?(i(),o("table",zo,[e("tbody",null,[e("tr",null,[Ro,e("td",null,[C(r,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[1]||(s[1]=d=>t.settings.volume=d),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])]),qo])])],512)):h("",!0)])):h("",!0)],512)])}var Bo=A(Ao,[["render",No]]);const At=()=>({status:{enabled:!1},styles:{bgColor:"#ff00ff",vAlign:"bottom",recognition:{fontFamily:"sans-serif",fontSize:"30",fontWeight:"400",strokeWidth:"8",strokeColor:"#292929",color:"#ffff00"},translation:{fontFamily:"sans-serif",fontSize:"30",fontWeight:"400",strokeWidth:"8",strokeColor:"#292929",color:"#cbcbcb"}},recognition:{display:!0,lang:"ja",synthesize:!1,synthesizeLang:""},translation:{enabled:!0,langSrc:"ja",langDst:"en",synthesize:!1,synthesizeLang:""}}),Jo=D({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:At(),defaultSettings:At(),ws:null,inited:!1}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return N.widgetUrl("speech-to-text")}},methods:{sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=N.wsClient("speech-to-text"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Wo={id:"app"},Ho={id:"top",ref:"top"},Ko={id:"actionbar",class:"p-1"},Go=["disabled"],Yo=["href"],Xo={id:"main",ref:"main"},Qo={key:0,class:"table is-striped",ref:"table"},Zo=e("tr",null,[e("td",{colspan:"3"},"General")],-1),jo=e("td",null,[e("code",null,"settings.style.bgColor")],-1),xo=["disabled"],ta=e("i",{class:"fa fa-remove"},null,-1),ea=[ta],sa=e("td",null,[e("code",null,"settings.style.vAlign")],-1),na={class:"select is-small"},ia=e("option",{value:"top"},"top",-1),oa=e("option",{value:"bottom"},"bottom",-1),aa=[ia,oa],la=["disabled"],ra=e("i",{class:"fa fa-remove"},null,-1),da=[ra],ua=e("tr",null,[e("td",{colspan:"3"},"Recognition")],-1),ma=e("td",null,[e("code",null,"settings.recognition.lang")],-1),ca=["disabled"],ha=e("i",{class:"fa fa-remove"},null,-1),pa=[ha],ga=e("td",null,[e("code",null,"settings.recognition.synthesize")],-1),fa=["disabled"],va=e("i",{class:"fa fa-remove"},null,-1),_a=[va],ya=e("td",null,[e("code",null,"settings.recognition.synthesizeLang")],-1),ba=["disabled"],$a=e("i",{class:"fa fa-remove"},null,-1),wa=[$a],ka=e("td",null,[e("code",null,"settings.recognition.display")],-1),Ca=["disabled"],Va=e("i",{class:"fa fa-remove"},null,-1),Sa=[Va],Ia=e("td",null,[e("code",null,"settings.styles.recognition.color")],-1),Ua=["disabled"],Da=e("i",{class:"fa fa-remove"},null,-1),Aa=[Da],Pa=e("td",null,[e("code",null,"settings.styles.recognition.strokeWidth")],-1),Ta=["disabled"],Fa=e("i",{class:"fa fa-remove"},null,-1),Ea=[Fa],Ma=e("td",null,[e("code",null,"settings.styles.recognition.strokeColor")],-1),La=["disabled"],Oa=e("i",{class:"fa fa-remove"},null,-1),za=[Oa],Ra=e("td",null,[e("code",null,"settings.styles.recognition.fontFamily")],-1),qa=["disabled"],Na=e("i",{class:"fa fa-remove"},null,-1),Ba=[Na],Ja=e("td",null,[e("code",null,"settings.styles.recognition.fontSize")],-1),Wa=["disabled"],Ha=e("i",{class:"fa fa-remove"},null,-1),Ka=[Ha],Ga=e("td",null,[e("code",null,"settings.styles.recognition.fontWeight")],-1),Ya=["disabled"],Xa=e("i",{class:"fa fa-remove"},null,-1),Qa=[Xa],Za=e("tr",null,[e("td",{colspan:"3"},"Translation")],-1),ja=e("td",null,[e("code",null,"settings.translation.enabled")],-1),xa=["disabled"],tl=e("i",{class:"fa fa-remove"},null,-1),el=[tl],sl=e("td",null,[e("code",null,"settings.translation.synthesize")],-1),nl=["disabled"],il=e("i",{class:"fa fa-remove"},null,-1),ol=[il],al=e("td",null,[e("code",null,"settings.translation.synthesizeLang")],-1),ll=["disabled"],rl=e("i",{class:"fa fa-remove"},null,-1),dl=[rl],ul=e("td",null,[e("code",null,"settings.translation.langSrc")],-1),ml=["disabled"],cl=e("i",{class:"fa fa-remove"},null,-1),hl=[cl],pl=e("td",null,[e("code",null,"settings.translation.langDst")],-1),gl=["disabled"],fl=e("i",{class:"fa fa-remove"},null,-1),vl=[fl],_l=e("td",null,[e("code",null,"settings.styles.translation.color")],-1),yl=["disabled"],bl=e("i",{class:"fa fa-remove"},null,-1),$l=[bl],wl=e("td",null,[e("code",null,"settings.styles.translation.strokeWidth")],-1),kl=["disabled"],Cl=e("i",{class:"fa fa-remove"},null,-1),Vl=[Cl],Sl=e("td",null,[e("code",null,"settings.styles.translation.strokeColor")],-1),Il=["disabled"],Ul=e("i",{class:"fa fa-remove"},null,-1),Dl=[Ul],Al=e("td",null,[e("code",null,"settings.styles.translation.fontFamily")],-1),Pl=["disabled"],Tl=e("i",{class:"fa fa-remove"},null,-1),Fl=[Tl],El=e("td",null,[e("code",null,"settings.styles.translation.fontSize")],-1),Ml=["disabled"],Ll=e("i",{class:"fa fa-remove"},null,-1),Ol=[Ll],zl=e("td",null,[e("code",null,"settings.styles.translation.fontWeight")],-1),Rl=["disabled"],ql=e("i",{class:"fa fa-remove"},null,-1),Nl=[ql],Bl=e("tr",null,[e("td",{colspan:"3"},"Debug")],-1),Jl=e("td",null,[e("code",null,"settings.status.enabled")],-1),Wl=["disabled"],Hl=e("i",{class:"fa fa-remove"},null,-1),Kl=[Hl];function Gl(t,s,a,l,f,y){const m=$("navbar");return i(),o("div",Wo,[e("div",Ho,[C(m),e("div",Ko,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...n)=>t.sendSave&&t.sendSave(...n))}," Save ",8,Go),e("a",{class:"button is-small",href:t.widgetUrl,target:"_blank"},"Open widget",8,Yo)])],512),e("div",Xo,[t.inited?(i(),o("table",Qo,[e("tbody",null,[Zo,e("tr",null,[jo,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=n=>t.settings.styles.bgColor=n)},null,512),[[_,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=n=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},ea,8,xo)])]),e("tr",null,[sa,e("td",null,[e("div",na,[u(e("select",{"onUpdate:modelValue":s[3]||(s[3]=n=>t.settings.styles.vAlign=n)},aa,512),[[_t,t.settings.styles.vAlign]])])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.vAlign===t.defaultSettings.styles.vAlign,onClick:s[4]||(s[4]=n=>t.settings.styles.vAlign=t.defaultSettings.styles.vAlign)},da,8,la)])]),ua,e("tr",null,[ma,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=n=>t.settings.recognition.lang=n)},null,512),[[_,t.settings.recognition.lang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.lang===t.defaultSettings.recognition.lang,onClick:s[6]||(s[6]=n=>t.settings.recognition.lang=t.defaultSettings.recognition.lang)},pa,8,ca)])]),e("tr",null,[ga,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=n=>t.settings.recognition.synthesize=n)},null,512),[[z,t.settings.recognition.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesize===t.defaultSettings.recognition.synthesize,onClick:s[8]||(s[8]=n=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},_a,8,fa)])]),e("tr",null,[ya,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=n=>t.settings.recognition.synthesizeLang=n)},null,512),[[_,t.settings.recognition.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesizeLang===t.defaultSettings.recognition.synthesizeLang,onClick:s[10]||(s[10]=n=>t.settings.recognition.synthesizeLang=t.defaultSettings.recognition.synthesizeLang)},wa,8,ba)])]),e("tr",null,[ka,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=n=>t.settings.recognition.display=n)},null,512),[[z,t.settings.recognition.display]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.display===t.defaultSettings.recognition.display,onClick:s[12]||(s[12]=n=>t.settings.recognition.display=t.defaultSettings.recognition.display)},Sa,8,Ca)])]),e("tr",null,[Ia,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[13]||(s[13]=n=>t.settings.styles.recognition.color=n)},null,512),[[_,t.settings.styles.recognition.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.color===t.defaultSettings.styles.recognition.color,onClick:s[14]||(s[14]=n=>t.settings.styles.recognition.color=t.defaultSettings.styles.recognition.color)},Aa,8,Ua)])]),e("tr",null,[Pa,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[15]||(s[15]=n=>t.settings.styles.recognition.strokeWidth=n)},null,512),[[_,t.settings.styles.recognition.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeWidth===t.defaultSettings.styles.recognition.strokeWidth,onClick:s[16]||(s[16]=n=>t.settings.styles.recognition.strokeWidth=t.defaultSettings.styles.recognition.strokeWidth)},Ea,8,Ta)])]),e("tr",null,[Ma,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[17]||(s[17]=n=>t.settings.styles.recognition.strokeColor=n)},null,512),[[_,t.settings.styles.recognition.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeColor===t.defaultSettings.styles.recognition.strokeColor,onClick:s[18]||(s[18]=n=>t.settings.styles.recognition.strokeColor=t.defaultSettings.styles.recognition.strokeColor)},za,8,La)])]),e("tr",null,[Ra,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[19]||(s[19]=n=>t.settings.styles.recognition.fontFamily=n)},null,512),[[_,t.settings.styles.recognition.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontFamily===t.defaultSettings.styles.recognition.fontFamily,onClick:s[20]||(s[20]=n=>t.settings.styles.recognition.fontFamily=t.defaultSettings.styles.recognition.fontFamily)},Ba,8,qa)])]),e("tr",null,[Ja,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[21]||(s[21]=n=>t.settings.styles.recognition.fontSize=n)},null,512),[[_,t.settings.styles.recognition.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontSize===t.defaultSettings.styles.recognition.fontSize,onClick:s[22]||(s[22]=n=>t.settings.styles.recognition.fontSize=t.defaultSettings.styles.recognition.fontSize)},Ka,8,Wa)])]),e("tr",null,[Ga,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[23]||(s[23]=n=>t.settings.styles.recognition.fontWeight=n)},null,512),[[_,t.settings.styles.recognition.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontWeight===t.defaultSettings.styles.recognition.fontWeight,onClick:s[24]||(s[24]=n=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Qa,8,Ya)])]),Za,e("tr",null,[ja,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=n=>t.settings.translation.enabled=n)},null,512),[[z,t.settings.translation.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.enabled===t.defaultSettings.translation.enabled,onClick:s[26]||(s[26]=n=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},el,8,xa)])]),e("tr",null,[sl,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=n=>t.settings.translation.synthesize=n)},null,512),[[z,t.settings.translation.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesize===t.defaultSettings.translation.synthesize,onClick:s[28]||(s[28]=n=>t.settings.translation.synthesize=t.defaultSettings.translation.synthesize)},ol,8,nl)])]),e("tr",null,[al,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[29]||(s[29]=n=>t.settings.translation.synthesizeLang=n)},null,512),[[_,t.settings.translation.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesizeLang===t.defaultSettings.translation.synthesizeLang,onClick:s[30]||(s[30]=n=>t.settings.translation.synthesizeLang=t.defaultSettings.translation.synthesizeLang)},dl,8,ll)])]),e("tr",null,[ul,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[31]||(s[31]=n=>t.settings.translation.langSrc=n)},null,512),[[_,t.settings.translation.langSrc]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langSrc===t.defaultSettings.translation.langSrc,onClick:s[32]||(s[32]=n=>t.settings.translation.langSrc=t.defaultSettings.translation.langSrc)},hl,8,ml)])]),e("tr",null,[pl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[33]||(s[33]=n=>t.settings.translation.langDst=n)},null,512),[[_,t.settings.translation.langDst]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langDst===t.defaultSettings.translation.langDst,onClick:s[34]||(s[34]=n=>t.settings.translation.langDst=t.defaultSettings.translation.langDst)},vl,8,gl)])]),e("tr",null,[_l,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[35]||(s[35]=n=>t.settings.styles.translation.color=n)},null,512),[[_,t.settings.styles.translation.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.color===t.defaultSettings.styles.translation.color,onClick:s[36]||(s[36]=n=>t.settings.styles.translation.color=t.defaultSettings.styles.translation.color)},$l,8,yl)])]),e("tr",null,[wl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[37]||(s[37]=n=>t.settings.styles.translation.strokeWidth=n)},null,512),[[_,t.settings.styles.translation.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeWidth===t.defaultSettings.styles.translation.strokeWidth,onClick:s[38]||(s[38]=n=>t.settings.styles.translation.strokeWidth=t.defaultSettings.styles.translation.strokeWidth)},Vl,8,kl)])]),e("tr",null,[Sl,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[39]||(s[39]=n=>t.settings.styles.translation.strokeColor=n)},null,512),[[_,t.settings.styles.translation.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeColor===t.defaultSettings.styles.translation.strokeColor,onClick:s[40]||(s[40]=n=>t.settings.styles.translation.strokeColor=t.defaultSettings.styles.translation.strokeColor)},Dl,8,Il)])]),e("tr",null,[Al,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[41]||(s[41]=n=>t.settings.styles.translation.fontFamily=n)},null,512),[[_,t.settings.styles.translation.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontFamily===t.defaultSettings.styles.translation.fontFamily,onClick:s[42]||(s[42]=n=>t.settings.styles.translation.fontFamily=t.defaultSettings.styles.translation.fontFamily)},Fl,8,Pl)])]),e("tr",null,[El,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[43]||(s[43]=n=>t.settings.styles.translation.fontSize=n)},null,512),[[_,t.settings.styles.translation.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontSize===t.defaultSettings.styles.translation.fontSize,onClick:s[44]||(s[44]=n=>t.settings.styles.translation.fontSize=t.defaultSettings.styles.translation.fontSize)},Ol,8,Ml)])]),e("tr",null,[zl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[45]||(s[45]=n=>t.settings.styles.translation.fontWeight=n)},null,512),[[_,t.settings.styles.translation.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontWeight===t.defaultSettings.styles.translation.fontWeight,onClick:s[46]||(s[46]=n=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Nl,8,Rl)])]),Bl,e("tr",null,[Jl,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[47]||(s[47]=n=>t.settings.status.enabled=n)},null,512),[[z,t.settings.status.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.status.enabled===t.defaultSettings.status.enabled,onClick:s[48]||(s[48]=n=>t.settings.status.enabled=t.defaultSettings.status.enabled)},Kl,8,Wl)])])])],512)):h("",!0)],512)])}var Yl=A(Jo,[["render",Gl]]);const Pt=()=>({styles:{bgColor:"#80ff00"},avatarDefinitions:[]});const Xl=D({data:()=>({editIdx:-1,editEntity:null,unchangedJson:"{}",changedJson:"{}",settings:Pt(),defaultSettings:Pt(),ws:null,inited:!1,tabDefinitions:[{tab:"avatars",title:"Avatars"},{tab:"settings",title:"Settings"}],tab:"avatars"}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},controlWidgetUrl(){return N.widgetUrl("avatar")},displayWidgetUrl(){return N.widgetUrl("avatar_receive")}},methods:{edit(t){if(!this.settings){console.warn("edit: this.settings not initialized");return}this.editIdx=t,this.editEntity=this.settings.avatarDefinitions[t]},remove(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.avatarDefinitions=this.settings.avatarDefinitions.filter((s,a)=>a!==t),this.sendSave()},duplicate(t){if(!this.settings){console.warn("duplicate: this.settings not initialized");return}this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=JSON.parse(JSON.stringify(this.settings.avatarDefinitions[t]))},updatedAvatar(t){if(!this.settings){console.warn("updateAvatar: this.settings not initialized");return}this.settings.avatarDefinitions[this.editIdx]=t,this.sendSave()},addAvatar(){if(!this.settings){console.warn("addAvatar: this.settings not initialized");return}const t={name:"Unnamed Avatar",width:64,height:64,stateDefinitions:[{value:"default",deletable:!1},{value:"speaking",deletable:!1}],slotDefinitions:[]};this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=t},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},dragEnd(t){if(!this.settings){console.warn("dragEnd: this.settings not initialized");return}this.settings.avatarDefinitions=K.arrayMove(this.settings.avatarDefinitions,t.oldIndex,t.newIndex),this.sendSave()}},async mounted(){this.ws=N.wsClient("avatar"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Ql={id:"app"},Zl={id:"top",ref:"top"},jl={id:"actionbar",class:"p-1"},xl=["href"],tr=["href"],er={key:0,id:"main",ref:"main"},sr={class:"tabs"},nr=["onClick"],ir={key:0,class:"table is-striped"},or=e("tr",null,[e("td",{colspan:"3"},"General")],-1),ar=e("td",null,[e("code",null,"settings.style.bgColor")],-1),lr=["disabled"],rr=e("i",{class:"fa fa-remove"},null,-1),dr=[rr],ur={key:1},mr={class:"table is-striped"},cr=e("thead",null,[e("tr",null,[e("th"),e("th"),e("th",null,"Preview"),e("th",null,"Name"),e("th")])],-1),hr=e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1),pr={class:"pl-0 pr-0"},gr=["onClick"],fr=e("i",{class:"fa fa-pencil"},null,-1),vr=[fr],_r={class:"pl-0 pr-0"},yr=e("i",{class:"fa fa-trash"},null,-1),br=["onClick"],$r=e("i",{class:"fa fa-clone"},null,-1),wr=[$r];function kr(t,s,a,l,f,y){const m=$("navbar"),n=$("avatar-preview"),r=$("doubleclick-button"),d=$("draggable"),k=$("avatar-editor");return i(),o("div",Ql,[e("div",Zl,[C(m),e("div",jl,[e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open control widget",8,xl),e("a",{class:"button is-small mr-1",href:t.displayWidgetUrl,target:"_blank"},"Open display widget",8,tr)])],512),t.inited?(i(),o("div",er,[e("div",sr,[e("ul",null,[(i(!0),o(P,null,T(t.tabDefinitions,(b,c)=>(i(),o("li",{key:c,class:F({"is-active":t.tab===b.tab}),onClick:v=>t.tab=b.tab},[e("a",null,w(b.title),1)],10,nr))),128))])]),t.tab==="settings"?(i(),o("table",ir,[e("tbody",null,[or,e("tr",null,[ar,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":[s[0]||(s[0]=b=>t.settings.styles.bgColor=b),s[1]||(s[1]=(...b)=>t.sendSave&&t.sendSave(...b))]},null,512),[[_,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=b=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},dr,8,lr)])])])])):h("",!0),t.tab==="avatars"?(i(),o("div",ur,[e("table",mr,[cr,C(d,{modelValue:t.settings.avatarDefinitions,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:q(({element:b,index:c})=>[e("tr",null,[hr,e("td",pr,[e("button",{class:"button is-small",onClick:v=>t.edit(c)},vr,8,gr)]),e("td",null,[C(n,{avatar:b},null,8,["avatar"])]),e("td",null,w(b.name),1),e("td",_r,[C(r,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:v=>t.remove(c)},{default:q(()=>[yr]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:v=>t.duplicate(c)},wr,8,br)])])]),_:1},8,["modelValue","onEnd"])]),t.editEntity?(i(),E(k,{key:0,modelValue:t.editEntity,"onUpdate:modelValue":t.updatedAvatar,onCancel:s[3]||(s[3]=b=>t.editEntity=null)},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),e("span",{class:"button is-small",onClick:s[4]||(s[4]=(...b)=>t.addAvatar&&t.addAvatar(...b))},"Add avatar")])):h("",!0)],512)):h("",!0)])}var Cr=A(Xl,[["render",kr]]);const Vr=D({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const s=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const a=await O.resetPassword({pass:this.pass,token:s});if(a.status===200)this.success=!0;else try{this.error=(await a.json()).reason}catch{this.error="Unknown error"}}}}),Sr={class:"center-screen"},Ir=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Ur={key:0,class:"field has-background-success-light has-text-success-dark"},Dr=p(" Password successfully set. Click "),Ar=p("here"),Pr=p(" to login. "),Tr={key:1},Fr={key:0,class:"field has-background-danger-light has-text-danger-dark"},Er={class:"field"},Mr={class:"control has-icons-left"},Lr=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Or={class:"field"},zr=["disabled"];function Rr(t,s,a,l,f,y){const m=$("router-link");return i(),o("div",Sr,[Ir,t.success?(i(),o("div",Ur,[Dr,C(m,{to:{name:"login"}},{default:q(()=>[Ar]),_:1}),Pr])):(i(),o("div",Tr,[t.error?(i(),o("div",Fr,w(t.error),1)):h("",!0),e("div",Er,[e("div",Mr,[u(e("input",{class:"input is-small",type:"password",placeholder:"New Password","onUpdate:modelValue":s[0]||(s[0]=n=>t.pass=n),onKeyup:[s[1]||(s[1]=n=>t.error=""),s[2]||(s[2]=G((...n)=>t.submit&&t.submit(...n),["enter"]))]},null,544),[[_,t.pass]]),Lr])]),e("div",Or,[e("button",{class:"button is-small is-primary",disabled:t.canSubmit?null:!0,onClick:s[3]||(s[3]=(...n)=>t.submit&&t.submit(...n))}," Save Password ",8,zr)])]))])}var qr=A(Vr,[["render",Rr]]);const Nr=D({data:()=>({email:"",error:"",success:!1}),methods:{async submit(){this.success=!1,this.error="";const t=await O.requestPasswordReset({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),Br={class:"center-screen"},Jr=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Wr={key:0,class:"field has-background-success-light has-text-success-dark"},Hr=p(" Password-reset mail sent. Click "),Kr=p("here"),Gr=p(" to login. "),Yr={key:1},Xr={key:0,class:"field has-background-danger-light has-text-danger-dark"},Qr={class:"field"},Zr={class:"control has-icons-left"},jr=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),xr={class:"field"};function td(t,s,a,l,f,y){const m=$("router-link");return i(),o("div",Br,[Jr,t.success?(i(),o("div",Wr,[Hr,C(m,{to:{name:"login"}},{default:q(()=>[Kr]),_:1}),Gr])):(i(),o("form",Yr,[t.error?(i(),o("div",Xr,w(t.error),1)):h("",!0),e("div",Qr,[e("div",Zr,[u(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":s[0]||(s[0]=n=>t.email=n),onKeyup:s[1]||(s[1]=n=>t.error="")},null,544),[[_,t.email]]),jr])]),e("div",xr,[e("span",{class:"button is-small is-primary",onClick:s[2]||(s[2]=(...n)=>t.submit&&t.submit(...n))},"Request Password Reset")])]))])}var ed=A(Nr,[["render",td]]);const sd=D({name:"upload",props:{accept:String,label:{type:String,default:"Upload File"}},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?` Uploading (${this.uploadPercent}%)`:this.label?` ${this.label}`:""},progressStyle(){if(!this.uploading)return{};const t=this.uploadPercent,s="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${s} 0%, ${s} ${t}%, transparent ${t}%)`}}},methods:{async upload(t){const s=t.target.files[0];if(!s)return;this.uploading=!0;const a=await O.upload(s,f=>{this.progress=f.loaded/f.total});this.uploading=!1;const l=await a.json();this.$emit("uploaded",l)}}}),nd={class:"upload"},id=["disabled","accept"],od={class:"button is-small"};function ad(t,s,a,l,f,y){return i(),o("label",nd,[e("input",{type:"file",disabled:t.uploading,style:{display:"none"},onChange:s[0]||(s[0]=(...m)=>t.upload&&t.upload(...m)),accept:t.accept},null,40,id),e("span",od,[e("i",{class:F(["fa fa-upload",{"mr-1":t.buttonText}])},null,2),p(w(t.buttonText),1)]),e("span",{class:"progress",style:Y(t.progressStyle)},null,4)])}var ld=A(sd,[["render",ad],["__scopeId","data-v-aec4eb9c"]]);const rd=D({props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(t){try{const s=K.doDummyReplacements(t,"0");K.mustParseHumanDuration(s),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",t)}},modelValue:{handler(t){this.v=`${t}`}}}});function dd(t,s,a,l,f,y){return u((i(),o("input",{class:F(["input is-small spaceinput",t.classes]),"onUpdate:modelValue":s[0]||(s[0]=m=>t.v=m)},null,2)),[[_,t.v]])}var ud=A(rd,[["render",dd]]);const md=D({props:{modelValue:{type:Object,required:!0},onValue:{type:Object,default:!0},offValue:{type:Object,default:!1}},emits:["update:modelValue"],data(){return{value:!1}},created(){this.value=this.modelValue===this.onValue},methods:{emitUpdate(){this.$emit("update:modelValue",this.value?this.onValue:this.offValue)}}});function cd(t,s,a,l,f,y){return u((i(),o("input",{type:"checkbox","onUpdate:modelValue":[s[0]||(s[0]=m=>t.value=m),s[1]||(s[1]=(...m)=>t.emitUpdate&&t.emitUpdate(...m))]},null,512)),[[z,t.value]])}var hd=A(md,[["render",cd]]);const pd=D({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const t=parseInt(`${this.baseVolume}`,10)/100,s=parseInt(`${this.volume}`,10)/100;this.audio.volume=t*s,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio(this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function gd(t,s,a,l,f,y){return t.src?(i(),o("span",{key:0,class:"player",onClick:s[0]||(s[0]=(...m)=>t.toggle&&t.toggle(...m))},[p(w(t.name)+" ",1),e("i",{class:F(["fa ml-1",t.cls])},null,2)])):h("",!0)}var fd=A(pd,[["render",gd]]);const vd=D({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),_d={class:"columns"},yd={class:"column is-four-fifth"},bd={class:"control has-icons-left has-icons-right range slider"},$d=["min","max"],wd={class:"icon is-small is-left"},kd={class:"icon is-small is-right"},Cd={class:"column is-one-fifth"};function Vd(t,s,a,l,f,y){return i(),o("div",_d,[e("div",yd,[e("div",bd,[u(e("input",{type:"range",class:"input is-small",min:t.min,max:t.max,"onUpdate:modelValue":[s[0]||(s[0]=m=>t.curVal=m),s[1]||(s[1]=(...m)=>t.valChange&&t.valChange(...m))]},null,8,$d),[[_,t.curVal]]),e("span",wd,[e("i",{class:F(["fa",t.iconLeft])},null,2)]),e("span",kd,[e("i",{class:F(["fa",t.iconRight])},null,2)])])]),e("div",Cd,[u(e("input",{type:"number",class:"input is-small","onUpdate:modelValue":[s[2]||(s[2]=m=>t.curVal=m),s[3]||(s[3]=(...m)=>t.valChange&&t.valChange(...m))]},null,512),[[_,t.curVal]])])])}var Sd=A(vd,[["render",Vd],["__scopeId","data-v-0799d56c"]]);const Id=D({name:"volume-slider",props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.volume}`,10))}},created(){this.volume=parseInt(`${this.modelValue}`,10)}});function Ud(t,s,a,l,f,y){const m=$("slider");return i(),E(m,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:t.volume,"onUpdate:modelValue":[s[0]||(s[0]=n=>t.volume=n),t.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var Dd=A(Id,[["render",Ud]]);const Ad=D({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(${this.src})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),Pd=["title"];function Td(t,s,a,l,f,y){return i(),o("div",{class:"responsive-image",style:Y(t.style),title:t.title},null,12,Pd)}var Fd=A(Ad,[["render",Td]]);const ct=vt();let x,pt={problems:[]};function Ed(){x=N.wsClient("core"),x.onMessage(["status"],t=>{JSON.stringify(pt)!==JSON.stringify(t)&&(pt=t,ct.emit("status",pt))}),x.connect()}function Md(){x&&(x.disconnect(),x=null)}var Tt={init:Ed,stop:Md,eventBus:ct},Ld="/assets/hyottoko.30d2bcb9.png";const Od=D({name:"navbar",computed:{user(){var t,s;return((s=(t=this.$me)==null?void 0:t.user)==null?void 0:s.name)||""}},created(){this.$me=W.getMe(),ct.on("status",this.statusChanged)},beforeUnmount(){ct.off("status",this.statusChanged)},data:()=>({$me:null,linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"avatar"},text:"Avatar"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"settings"},text:"Settings"}],problems:[],burgerActive:!1}),methods:{statusChanged(t){this.problems=t.problems},toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){const t=await W.logout();if(t.error)throw new Error(t.error);this.$router.push({name:"login"})}}}),zd={class:"navbar",role:"navigation","aria-label":"main navigation"},Rd={class:"navbar-brand"},qd=e("img",{src:Ld,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),Nd={class:"greeting"},Bd=e("span",{"aria-hidden":"true"},null,-1),Jd=e("span",{"aria-hidden":"true"},null,-1),Wd=e("span",{"aria-hidden":"true"},null,-1),Hd=[Bd,Jd,Wd],Kd={class:"navbar-start"},Gd={class:"navbar-end"},Yd=["title"],Xd=e("i",{class:"fa fa-warning mr-1"},null,-1);function Qd(t,s,a,l,f,y){const m=$("router-link");return i(),o("nav",zd,[e("div",Rd,[C(m,{class:"navbar-item",to:{name:"index"}},{default:q(()=>[qd,e("span",Nd,"Welcome back, "+w(t.user),1)]),_:1}),e("a",{role:"button",class:F(["navbar-burger",{"is-active":t.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:s[0]||(s[0]=(...n)=>t.toggleBurgerMenu&&t.toggleBurgerMenu(...n))},Hd,2)]),e("div",{id:"navbarBasicExample",class:F(["navbar-menu",{"is-active":t.burgerActive}])},[e("div",Kd,[(i(!0),o(P,null,T(t.linksStart,(n,r)=>(i(),E(m,{class:"navbar-item",key:r,to:n.to},{default:q(()=>[p(w(n.text),1)]),_:2},1032,["to"]))),128))]),e("div",Gd,[t.problems.length?(i(),o("a",{key:0,class:"navbar-item has-text-danger",title:t.problems.join(" ---- ")},[Xd,p(" "+w(t.problems.length)+" Problem"+w(t.problems.length>1?"s":""),1)],8,Yd)):h("",!0),e("a",{class:"navbar-item",onClick:s[1]||(s[1]=(...n)=>t.onLogoutClick&&t.onLogoutClick(...n))},"Logout")])],2)])}var Zd=A(Od,[["render",Qd]]);const jd=D({props:{value:{required:!0}},computed:{tag(){try{return K.mustParseHumanDuration(`${this.value}`),"span"}catch{return"code"}},humanReadable(){try{return K.humanDuration(K.mustParseHumanDuration(`${this.value}`))}catch{return this.value}}}}),xd={key:0},tu={key:1};function eu(t,s,a,l,f,y){return t.tag==="span"?(i(),o("span",xd,w(t.humanReadable),1)):(i(),o("code",tu,w(t.humanReadable),1))}var su=A(jd,[["render",eu]]);const nu=D({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null||this.time===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time&&(this.time-=10),(!this.time||this.time<=0)&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),iu={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function ou(t,s,a,l,f,y){return i(),o("button",{class:"doubleclick-button",onClick:s[0]||(s[0]=(...m)=>t.onClick&&t.onClick(...m))},[Rt(t.$slots,"default",{},void 0,!0),t.timer?(i(),o("span",iu,[p(w(t.message)+" ",1),e("span",{class:"doubleclick-button-timout-indicator",style:Y(t.indicatorStyle)},null,4)])):h("",!0)])}var au=A(nu,[["render",ou],["__scopeId","data-v-621de3e2"]]);const lu=D({props:{label:{type:String,required:!0},actions:{type:Array,required:!0}},emits:["click"],data(){return{active:!1}},methods:{onActionClick(t){this.closeDropdown(),this.$emit("click",t)},openDropdown(){this.active=!0},closeDropdown(){this.active=!1},hideDropdown(t){!this.$refs.dropdown||this.$refs.dropdown.contains(t.target)||this.closeDropdown()}},mounted(){window.addEventListener("click",this.hideDropdown)},unmounted(){window.removeEventListener("click",this.hideDropdown)}}),ru={class:"dropdown-trigger"},du=e("span",{class:"icon is-small"},[e("i",{class:"fa fa-angle-down","aria-hidden":"true"})],-1),uu={class:"dropdown-menu",id:"dropdown-menu",role:"menu"},mu={class:"dropdown-content"},cu=["onClick","title"];function hu(t,s,a,l,f,y){return i(),o("div",{class:F(["dropdown mr-1",{"is-active":t.active}]),ref:"dropdown"},[e("div",ru,[e("button",{class:"button is-small mr-1","aria-haspopup":"true","aria-controls":"dropdown-menu",onClick:s[0]||(s[0]=(...m)=>t.openDropdown&&t.openDropdown(...m))},[e("span",null,w(t.label),1),du])]),e("div",uu,[e("div",mu,[(i(!0),o(P,null,T(t.actions,(m,n)=>(i(),o("a",{href:"#",class:"dropdown-item",key:n,onClick:r=>t.onActionClick(m),title:m.title},w(m.label),9,cu))),128))])])],2)}var pu=A(lu,[["render",hu]]);const X=(...t)=>console.log("[youtube.js]",...t);let Ft=!1;function gu(){return Ft?(X("ytapi ALREADY ready"),Promise.resolve()):new Promise(t=>{const s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",document.head.append(s),window.onYouTubeIframeAPIReady=()=>{Ft=!0,X("ytapi ready"),t()}})}function fu(t){return new Promise(s=>{X("create player on "+t);const a=new YT.Player(t,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{X("player ready"),s(a)}}})})}async function vu(t){return await gu(),await fu(t)}const _u=D({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const t=this.getDuration(),s=this.getCurrentTime();return t?s/t:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let t=20;this.tryPlayInterval=setInterval(()=>{if(X("playing",this.playing(),"triesRemaining",t),--t,this.playing()||t<0){X("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(t){this.yt?(this.yt.cueVideoById(t),this.tryPlay()):this.toplay=t},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(t){this.yt?this.yt.setVolume(t):this.tovolume=t},setLoop(t){this.loop=t},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await vu(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(X("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",t=>{t.data===YT.PlayerState.CUED?this.tryPlay():t.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),yu=["id"];function bu(t,s,a,l,f,y){return i(),o("div",{id:t.id},null,8,yu)}var $u=A(_u,[["render",bu]]);const M=["mod","broadcaster"],gt=()=>"",Et=()=>({sound:{filename:"",file:"",urlpath:"",volume:100},image:{filename:"",file:"",urlpath:""},minDurationMs:"1s"}),wu=()=>({steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}),Mt=t=>({type:t,data:{command:"",commandExact:!1,minInterval:0,minLines:0}}),U=(t="",s=!1)=>{const a=Mt("command");return a.data.command=t,a.data.commandExact=s,a},ft={dict_lookup:"Outputs the translation for the searched word.",madochan_createword:"Creates a word for a definition.",chatters:"Outputs the people who chatted during the stream.",media:"Display an image and/or play a sound",media_volume:`Sets the media volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
  <br />
  If no argument is given, just outputs the current volume`,countdown:"Add a countdown or messages spaced by time intervals",text:"Send a message to chat",set_channel_title:"Change the stream title",set_channel_game_id:"Change the stream category",sr_current:"Show what song is currently playing",sr_undo:"Remove the song that was last added by oneself.",sr_good:"Vote the current song up",sr_bad:"Vote the current song down",sr_stats:"Show stats about the playlist",sr_prev:"Skip to the previous song",sr_next:"Skip to the next song",sr_jumptonew:"Jump to the next unplayed song",sr_clear:"Clear the playlist",sr_rm:"Remove the current song from the playlist",sr_shuffle:`Shuffle the playlist (current song unaffected).
    <br />
    Non-played and played songs will be shuffled separately and non-played
    songs will be put after currently playing song.`,sr_reset_stats:"Reset all statistics of all songs",sr_loop:"Loop the current song",sr_noloop:"Stop looping the current song",sr_pause:"Pause currently playing song",sr_unpause:"Unpause currently paused song",sr_hidevideo:"Hide video for current song",sr_showvideo:"Show video for current song",sr_request:`
  Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
  at youtube (by id or by title)
  and queue the first result in the playlist (after the first found
  batch of unplayed songs).`,sr_re_request:`
  Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
  in the current playlist and queue the first result in the playlist
  (after the first found batch of unplayed songs).`,sr_addtag:"Add tag <code>&lt;TAG&gt;</code> (argument to this command) to the current song",sr_rmtag:"Remove tag <code>&lt;TAG&gt;</code> (argument to this command) from the current song",sr_volume:`Sets the song request volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
  <br />
  If no argument is given, just outputs the current volume`,sr_filter:`Play only songs with the given tag <code>&lt;TAG&gt;</code> (argument to this command). If no tag
  is given, play all songs.`,sr_preset:`Switches to the preset <code>&lt;PRESET&gt;</code> (argument to this command) if it exists.
  If no arguments are given, outputs all available presets.`,sr_queue:"Shows the next 3 songs that will play."},Lt={dict_lookup:"dictionary lookup",madochan_createword:"madochan",chatters:"chatters command",media:"media command",media_volume:"media volume command",countdown:"countdown",text:"command",set_channel_title:"change stream title command",set_channel_game_id:"change stream category command",sr_current:"sr_current",sr_undo:"sr_undo",sr_good:"sr_good",sr_bad:"sr_bad",sr_stats:"sr_stats",sr_prev:"sr_prev",sr_next:"sr_next",sr_jumptonew:"sr_jumptonew",sr_clear:"sr_clear",sr_rm:"sr_rm",sr_shuffle:"sr_shuffle",sr_reset_stats:"sr_reset_stats",sr_loop:"sr_loop",sr_noloop:"sr_noloop",sr_pause:"sr_pause",sr_unpause:"sr_unpause",sr_hidevideo:"sr_hidevideo",sr_showvideo:"sr_showvideo",sr_request:"sr_request",sr_re_request:"sr_re_request",sr_addtag:"sr_addtag",sr_rmtag:"sr_rmtag",sr_volume:"sr_volume",sr_filter:"sr_filter",sr_preset:"sr_preset",sr_queue:"sr_queue"},ku=t=>{switch(t){case"text":return{triggers:[U()],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[gt()]}};case"media":return{triggers:[U()],action:"media",restrict_to:[],variables:[],variableChanges:[],data:Et()};case"media_volume":return{triggers:[U()],action:"media_volume",restrict_to:M,variables:[],variableChanges:[],data:{}};case"countdown":return{triggers:[U()],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:wu()};case"dict_lookup":return{triggers:[U()],action:"dict_lookup",restrict_to:[],variables:[],variableChanges:[],data:{lang:"ja",phrase:""}};case"madochan_createword":return{triggers:[U()],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}};case"chatters":return{triggers:[U()],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}};case"set_channel_title":return{triggers:[U()],action:"set_channel_title",restrict_to:M,variables:[],variableChanges:[],data:{title:""}};case"set_channel_game_id":return{triggers:[U()],action:"set_channel_game_id",restrict_to:M,variables:[],variableChanges:[],data:{game_id:""}};case"sr_current":return{action:"sr_current",triggers:[U("!sr current",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_undo":return{action:"sr_undo",triggers:[U("!sr undo",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_good":return{action:"sr_good",triggers:[U("!sr good",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_bad":return{action:"sr_bad",triggers:[U("!sr bad",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_stats":return{action:"sr_stats",triggers:[U("!sr stats",!0),U("!sr stat",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_prev":return{action:"sr_prev",triggers:[U("!sr prev",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_next":return{action:"sr_next",triggers:[U("!sr next",!0),U("!sr skip",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_jumptonew":return{action:"sr_jumptonew",triggers:[U("!sr jumptonew",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_clear":return{action:"sr_clear",triggers:[U("!sr clear",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_rm":return{action:"sr_rm",triggers:[U("!sr rm",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_shuffle":return{action:"sr_shuffle",triggers:[U("!sr shuffle",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_reset_stats":return{action:"sr_reset_stats",triggers:[U("!sr resetStats",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_loop":return{action:"sr_loop",triggers:[U("!sr loop",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_noloop":return{action:"sr_noloop",triggers:[U("!sr noloop",!0),U("!sr unloop",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_pause":return{action:"sr_pause",triggers:[U("!sr pause",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_unpause":return{action:"sr_unpause",triggers:[U("!sr nopause",!0),U("!sr unpause",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_hidevideo":return{action:"sr_hidevideo",triggers:[U("!sr hidevideo",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_showvideo":return{action:"sr_showvideo",triggers:[U("!sr showvideo",!0)],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_request":return{action:"sr_request",triggers:[U("!sr")],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_re_request":return{action:"sr_re_request",triggers:[U("!resr")],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_addtag":return{action:"sr_addtag",triggers:[U("!sr tag"),U("!sr addtag")],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_rmtag":return{action:"sr_rmtag",triggers:[U("!sr rmtag")],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_volume":return{action:"sr_volume",triggers:[U("!sr volume")],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_filter":return{action:"sr_filter",triggers:[U("!sr filter")],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_preset":return{action:"sr_preset",triggers:[U("!sr preset")],restrict_to:M,variables:[],variableChanges:[],data:{}};case"sr_queue":return{action:"sr_queue",triggers:[U("!sr queue")],restrict_to:[],variables:[],variableChanges:[],data:{}};default:return null}};const Cu=D({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},baseVolume:{default:100}},emits:["update:modelValue","cancel"],data:()=>({item:null,variableChangeFocusIdx:-1,dictLangs:[{value:"ja",flag:"\u{1F1EF}\u{1F1F5}",title:"Japanese"},{value:"ru",flag:"\u{1F1F7}\u{1F1FA}",title:"Russian"},{value:"de",flag:"\u{1F1E9}\u{1F1EA}",title:"German"},{value:"es",flag:"\u{1F1EA}\u{1F1F8}",title:"Spanish"},{value:"fr",flag:"\u{1F1EB}\u{1F1F7}",title:"French"},{value:"it",flag:"\u{1F1EE}\u{1F1F9}",title:"Italian"},{value:"pt",flag:"\u{1F1F5}\u{1F1F9}/\u{1F1E7}\u{1F1F7}",title:"Portuguese"}]}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(t){this.item=JSON.parse(JSON.stringify(t))}}},methods:{addtxt(){if(!this.item){console.warn("addtxt: this.item not initialized");return}this.item.data.text.push(gt())},addtrigger(t){if(!this.item){console.warn("addtrigger: this.item not initialized");return}this.item.triggers.push(Mt(t.type))},onAddVariableChange(){if(!this.item){console.warn("onAddVariableChange: this.item not initialized");return}this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(t){if(!this.item){console.warn("rmVariableChange: this.item not initialized");return}this.item.variableChanges=this.item.variableChanges.filter((s,a)=>a!==t)},onAddVariable(){if(!this.item){console.warn("onAddVariable: this.item not initialized");return}this.item.variables.push({name:"",value:""})},rmVariable(t){if(!this.item){console.warn("rmVariable: this.item not initialized");return}this.item.variables=this.item.variables.filter((s,a)=>a!==t)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndUploaded(t){if(!this.item){console.warn("mediaSndUploaded: this.item not initialized");return}this.item.data.sound=mt(t)},mediaImgUploaded(t){if(!this.item){console.warn("mediaImgUploaded: this.item not initialized");return}this.item.data.image=ot(t)},rmtxt(t){if(!this.item){console.warn("rmtxt: this.item not initialized");return}this.item.data.text=this.item.data.text.filter((s,a)=>a!==t)},rmtrigger(t){if(!this.item){console.warn("rmtrigger: this.item not initialized");return}this.item.triggers=this.item.triggers.filter((s,a)=>a!==t)},autocompletableVariables(t){if(!this.item){console.warn("autocompletableVariables: this.item not initialized");return}const s=this.item.variables.slice().map(a=>({var:a,type:"local"}));return this.globalVariables.forEach(a=>{s.find(l=>l.var.name===a.name)||s.push({var:a,type:"global"})}),s.filter(a=>a.var.name.startsWith(t)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{requiresAccessToken(){return this.item?this.item.action==="set_channel_title"||this.item.action==="set_channel_game_id":!1},possibleTriggerActions(){return[{type:"command",label:"Add Command",title:"Command"},{type:"reward_redemption",label:"Add Reward Redemption",title:"Reward Redemption"},{type:"timer",label:"Add Timer",title:"Timer"}]},valid(){if(!this.item)return!1;for(const t of this.item.triggers)if(t.type==="command"){if(!t.data.command)return!1}else if(t.type==="timer"){try{K.mustParseHumanDuration(t.data.minInterval)}catch{return!1}const s=parseInt(`${t.data.minLines}`,10);if(isNaN(s))return!1}if(this.item.action==="text"){for(const t of this.item.data.text)if(t==="")return!1}return!0},actionDescriptions(){return ft},title(){return this.item?`${{create:"Create new ",edit:"Edit "}[this.mode]}${Lt[this.item.action]}`:""}}}),S=t=>(Q("data-v-1dd94f5c"),t=t(),Z(),t),Vu={key:0,class:"modal is-active"},Su={class:"modal-card"},Iu={class:"modal-card-head"},Uu={class:"modal-card-title"},Du={class:"modal-card-body"},Au={class:"table is-striped"},Pu=S(()=>e("td",null,"Triggers:",-1)),Tu={key:0},Fu=S(()=>e("td",null,"Description:",-1)),Eu=["innerHTML"],Mu={key:1},Lu=S(()=>e("td",null,"Attention:",-1)),Ou=S(()=>e("td",null,[e("div",{class:"help"},[p(" This requires "),e("code",null,"Access Token"),p(" to be set in the user settings. ")])],-1)),zu=[Lu,Ou],Ru={key:2},qu=S(()=>e("td",null,"Stream title:",-1)),Nu={key:3},Bu=S(()=>e("td",null,"Stream category:",-1)),Ju={key:4},Wu=S(()=>e("td",null,"Language:",-1)),Hu=["onClick","title"],Ku=S(()=>e("code",null,"$args(0)",-1)),Gu=[Ku],Yu={key:5},Xu=S(()=>e("td",null,"Phrase:",-1)),Qu=S(()=>e("code",null,"$args(1:)",-1)),Zu=[Qu],ju={key:6},xu=S(()=>e("td",null,"Response:",-1)),tm=S(()=>e("td",null,[e("div",{class:"help"},[p(" Outputs the translation for the input phrase. The translation is always from/to english. "),e("br"),p(" To let the user decide on the language use "),e("code",null,"$args(0)"),p(" as language, and "),e("code",null,"$args(1:)"),p(" as phrase. "),e("br"),p(" If phrase is left empty, all arguments to the command will be used as the phrase. ")])],-1)),em=[xu,tm],sm={key:7},nm=S(()=>e("td",null,"Response:",-1)),im=S(()=>e("td",null,"Creates a word for a definition.",-1)),om=[nm,im],am={key:8},lm=S(()=>e("td",null,"Model:",-1)),rm={class:"control"},dm=S(()=>e("div",{class:"help"},[p(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),um={key:9},mm=S(()=>e("td",null,"Weirdness:",-1)),cm={class:"control"},hm=S(()=>e("div",{class:"help"},[p(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),pm={key:10},gm=S(()=>e("td",null,"Response:",-1)),fm=S(()=>e("td",null,"Outputs the people who chatted during the stream.",-1)),vm=[gm,fm],_m={key:11},ym=S(()=>e("td",null,"Response:",-1)),bm=["onUpdate:modelValue"],$m=["disabled","onClick"],wm=S(()=>e("i",{class:"fa fa-remove"},null,-1)),km=[wm],Cm={class:"field"},Vm=S(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),Sm=p(" Add response "),Im=[Vm,Sm],Um=S(()=>e("div",null,[e("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),Dm={key:12},Am=S(()=>e("td",null,"Image:",-1)),Pm=S(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Tm=p(" Remove "),Fm=[Pm,Tm],Em={key:2},Mm={key:13},Lm=S(()=>e("td",null,"Sound:",-1)),Om=S(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),zm=p(" Remove "),Rm=[Om,zm],qm={key:3},Nm={key:14},Bm=S(()=>e("td",null,"Duration:",-1)),Jm={class:"control has-icons-left"},Wm=S(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),Hm={key:15},Km=S(()=>e("td",null,"Settings",-1)),Gm=S(()=>e("td",null,"Variables:",-1)),Ym={key:0},Xm=S(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Value")])],-1)),Qm=["onUpdate:modelValue"],Zm=["onUpdate:modelValue"],jm=["onClick"],xm=S(()=>e("i",{class:"fa fa-remove"},null,-1)),tc=[xm],ec=S(()=>e("div",{class:"help"},[p(" Variables can be used from the command with "),e("code",null,"$var(variable_name)"),p(". If the referenced variable is not defined here, "),e("a",{href:"/variables/",target:"_blank"},"global variables"),p(" are used. ")],-1)),sc=S(()=>e("td",null,"Variable changes:",-1)),nc={key:0},ic=S(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Change"),e("td",null,"Value"),e("td")])],-1)),oc={class:"dropdown is-active is-up"},ac={class:"dropdown-trigger"},lc=["onUpdate:modelValue","onFocus"],rc={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},dc={class:"dropdown-content"},uc=["onClick"],mc=p(") "),cc={class:"select is-small"},hc=["onUpdate:modelValue"],pc=S(()=>e("option",{value:"set"},"set",-1)),gc=S(()=>e("option",{value:"increase_by"},"increase by",-1)),fc=S(()=>e("option",{value:"decrease_by"},"decrease by",-1)),vc=[pc,gc,fc],_c=["onUpdate:modelValue"],yc=["onClick"],bc=S(()=>e("i",{class:"fa fa-remove"},null,-1)),$c=[bc],wc=S(()=>e("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),kc=S(()=>e("td",null,"Permissions:",-1)),Cc=p(" Broadcaster "),Vc=p(" Moderators "),Sc=p(" Subscribers "),Ic={class:"modal-card-foot"},Uc=["disabled"];function Dc(t,s,a,l,f,y){const m=$("trigger-editor"),n=$("dropdown-button"),r=$("responsive-image"),d=$("upload"),k=$("player"),b=$("volume-slider"),c=$("duration-input"),v=$("countdown-editor");return t.item?(i(),o("div",Vu,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...g)=>t.onOverlayClick&&t.onOverlayClick(...g))}),e("div",Su,[e("header",Iu,[e("p",Uu,w(t.title),1),e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...g)=>t.onCloseClick&&t.onCloseClick(...g))})]),e("section",Du,[e("table",Au,[e("tbody",null,[e("tr",null,[Pu,e("td",null,[(i(!0),o(P,null,T(t.item.triggers,(g,V)=>(i(),E(m,{key:V,class:"spacerow",modelValue:g,removable:t.item.triggers.length>1,"onUpdate:modelValue":I=>t.item.triggers[V]=I,onRemove:I=>t.rmtrigger(V)},null,8,["modelValue","removable","onUpdate:modelValue","onRemove"]))),128)),C(n,{actions:t.possibleTriggerActions,label:"Add trigger",onClick:t.addtrigger},null,8,["actions","onClick"])])]),t.actionDescriptions[t.item.action]?(i(),o("tr",Tu,[Fu,e("td",{innerHTML:t.actionDescriptions[t.item.action]},null,8,Eu)])):h("",!0),t.requiresAccessToken?(i(),o("tr",Mu,zu)):h("",!0),t.item.action==="set_channel_title"?(i(),o("tr",Ru,[qu,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[2]||(s[2]=g=>t.item.data.title=g)},null,512),[[_,t.item.data.title]]),e("span",{class:"button is-small mr-1",onClick:s[3]||(s[3]=g=>t.item.data.title="")},"All args")])])):h("",!0),t.item.action==="set_channel_game_id"?(i(),o("tr",Nu,[Bu,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[4]||(s[4]=g=>t.item.data.game_id=g)},null,512),[[_,t.item.data.game_id]]),e("span",{class:"button is-small mr-1",onClick:s[5]||(s[5]=g=>t.item.data.game_id="")},"All args")])])):h("",!0),t.item.action==="dict_lookup"?(i(),o("tr",Ju,[Wu,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[6]||(s[6]=g=>t.item.data.lang=g)},null,512),[[_,t.item.data.lang]]),(i(!0),o(P,null,T(t.dictLangs,(g,V)=>(i(),o("span",{key:V,class:"button is-small mr-1",onClick:I=>t.item.data.lang=g.value,title:g.title},w(g.flag),9,Hu))),128)),e("span",{class:"button is-small mr-1",onClick:s[7]||(s[7]=g=>t.item.data.lang="$args(0)")},Gu)])])):h("",!0),t.item.action==="dict_lookup"?(i(),o("tr",Yu,[Xu,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[8]||(s[8]=g=>t.item.data.phrase=g)},null,512),[[_,t.item.data.phrase]]),e("span",{class:"button is-small mr-1",onClick:s[9]||(s[9]=g=>t.item.data.phrase="")},"All args"),e("span",{class:"button is-small mr-1",onClick:s[10]||(s[10]=g=>t.item.data.phrase="$args(1:)")},Zu)])])):h("",!0),t.item.action==="dict_lookup"?(i(),o("tr",ju,em)):h("",!0),t.item.action==="madochan_createword"?(i(),o("tr",sm,om)):h("",!0),t.item.action==="madochan_createword"?(i(),o("tr",am,[lm,e("td",null,[e("div",rm,[u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[11]||(s[11]=g=>t.item.data.model=g)},null,512),[[_,t.item.data.model]])]),dm])])):h("",!0),t.item.action==="madochan_createword"?(i(),o("tr",um,[mm,e("td",null,[e("div",cm,[u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[12]||(s[12]=g=>t.item.data.weirdness=g)},null,512),[[_,t.item.data.weirdness]])]),hm])])):h("",!0),t.item.action==="chatters"?(i(),o("tr",pm,vm)):h("",!0),t.item.action==="text"?(i(),o("tr",_m,[ym,e("td",null,[(i(!0),o(P,null,T(t.item.data.text,(g,V)=>(i(),o("div",{key:V,class:"field textarea-holder"},[u(e("textarea",{class:F(["textarea",{"has-background-danger-light":!t.item.data.text[V],"has-text-danger-dark":!t.item.data.text[V]}]),type:"text","onUpdate:modelValue":I=>t.item.data.text[V]=I},null,10,bm),[[_,t.item.data.text[V]]]),e("button",{class:"button is-small",disabled:t.item.data.text.length<=1,onClick:I=>t.rmtxt(V)},km,8,$m)]))),128)),e("div",Cm,[e("button",{class:"button is-small",onClick:s[13]||(s[13]=(...g)=>t.addtxt&&t.addtxt(...g))},Im)]),Um])])):h("",!0),t.item.action==="media"?(i(),o("tr",Dm,[Am,e("td",null,[t.item.data.image.file?(i(),E(r,{key:0,src:t.item.data.image.urlpath,title:t.item.data.image.filename,width:"100%",height:"90px",style:{display:"block"}},null,8,["src","title"])):h("",!0),t.item.data.image.file?(i(),o("button",{key:1,class:"button is-small",onClick:s[14]||(s[14]=g=>t.item.data.image.file=null)},Fm)):h("",!0),t.item.data.image.file?(i(),o("br",Em)):h("",!0),C(d,{onUploaded:t.mediaImgUploaded,accept:"image/*",label:"Upload Image",class:F({"mt-1":t.item.data.image.file})},null,8,["onUploaded","class"])])])):h("",!0),t.item.action==="media"?(i(),o("tr",Mm,[Lm,e("td",null,[t.item.data.sound.file?(i(),E(k,{key:0,src:t.item.data.sound.urlpath,name:t.item.data.sound.filename,volume:t.item.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):h("",!0),t.item.data.sound.file?(i(),E(b,{key:1,modelValue:t.item.data.sound.volume,"onUpdate:modelValue":s[15]||(s[15]=g=>t.item.data.sound.volume=g)},null,8,["modelValue"])):h("",!0),t.item.data.sound.file?(i(),o("button",{key:2,class:"button is-small",onClick:s[16]||(s[16]=g=>t.item.data.sound.file=null)},Rm)):h("",!0),t.item.data.sound.file?(i(),o("br",qm)):h("",!0),C(d,{onUploaded:t.mediaSndUploaded,accept:"audio/*",label:"Upload Sound",class:F({"mt-1":t.item.data.sound.file})},null,8,["onUploaded","class"])])])):h("",!0),t.item.action==="media"?(i(),o("tr",Nm,[Bm,e("td",null,[e("div",Jm,[C(c,{modelValue:t.item.data.minDurationMs,"onUpdate:modelValue":s[17]||(s[17]=g=>t.item.data.minDurationMs=g)},null,8,["modelValue"]),Wm])])])):h("",!0),t.item.action==="countdown"?(i(),o("tr",Hm,[Km,e("td",null,[C(v,{modelValue:t.item.data,"onUpdate:modelValue":s[18]||(s[18]=g=>t.item.data=g),baseVolume:t.baseVolume},null,8,["modelValue","baseVolume"])])])):h("",!0),e("tr",null,[Gm,e("td",null,[t.item.variables.length>0?(i(),o("table",Ym,[Xm,e("tbody",null,[(i(!0),o(P,null,T(t.item.variables,(g,V)=>(i(),o("tr",{key:V},[e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":I=>g.name=I},null,8,Qm),[[_,g.name]])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":I=>g.value=I},null,8,Zm),[[_,g.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:I=>t.rmVariable(V)},tc,8,jm)])]))),128))])])):h("",!0),e("span",{class:"button is-small",onClick:s[19]||(s[19]=(...g)=>t.onAddVariable&&t.onAddVariable(...g))},"Add Variable"),ec])]),e("tr",null,[sc,e("td",null,[t.item.variableChanges.length>0?(i(),o("table",nc,[ic,e("tbody",null,[(i(!0),o(P,null,T(t.item.variableChanges,(g,V)=>(i(),o("tr",{key:V},[e("td",null,[e("div",oc,[e("div",ac,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":I=>g.name=I,onFocus:I=>t.variableChangeFocusIdx=V,onBlur:s[20]||(s[20]=(...I)=>t.onVarChangeInputBlur&&t.onVarChangeInputBlur(...I))},null,40,lc),[[_,g.name]])]),t.variableChangeFocusIdx===V?(i(),o("div",rc,[e("div",dc,[(i(!0),o(P,null,T(t.autocompletableVariables(g.name),(I,Ot)=>(i(),o("a",{class:"dropdown-item",key:Ot,onClick:U1=>g.name=I.var.name},[p(w(I.var.name)+" ("+w(I.type)+", ",1),e("code",null,w(I.var.value),1),mc],8,uc))),128))])])):h("",!0)])]),e("td",null,[e("div",cc,[u(e("select",{"onUpdate:modelValue":I=>g.change=I},vc,8,hc),[[_t,g.change]])])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":I=>g.value=I},null,8,_c),[[_,g.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:I=>t.rmVariableChange(V)},$c,8,yc)])]))),128))])])):h("",!0),e("span",{class:"button is-small",onClick:s[21]||(s[21]=(...g)=>t.onAddVariableChange&&t.onAddVariableChange(...g))},"Add Variable Change"),wc])]),e("tr",null,[kc,e("td",null,[e("label",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[22]||(s[22]=g=>t.item.restrict_to=g),value:"broadcaster"},null,512),[[z,t.item.restrict_to]]),Cc]),e("label",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[23]||(s[23]=g=>t.item.restrict_to=g),value:"mod"},null,512),[[z,t.item.restrict_to]]),Vc]),e("label",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[24]||(s[24]=g=>t.item.restrict_to=g),value:"sub"},null,512),[[z,t.item.restrict_to]]),Sc])])])])])]),e("footer",Ic,[e("button",{class:"button is-small is-primary",disabled:!t.valid,onClick:s[25]||(s[25]=(...g)=>t.onSaveClick&&t.onSaveClick(...g))}," Save changes ",8,Uc),e("button",{class:"button is-small",onClick:s[26]||(s[26]=(...g)=>t.onCancelClick&&t.onCancelClick(...g))},"Cancel")])])])):h("",!0)}var Ac=A(Cu,[["render",Dc],["__scopeId","data-v-1dd94f5c"]]);const Pc=D({props:{globalVariables:{type:Array,required:!0},possibleActions:{type:Array,required:!0},baseVolume:{type:Number,required:!0},modelValue:{type:Array,required:!0},showToggleImages:{type:Boolean,required:!1,default:!1},showFilterActions:{type:Boolean,required:!1,default:!1},showImages:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue","showImagesChange"],data(){return{commands:[],editIdx:null,editCommand:null,filter:{search:"",actions:[]},imagesVisible:!1}},computed:{possibleActionsMapped(){return this.possibleActions.map(t=>({type:t,title:this.actionDescription(t),label:`Add ${this.actionName(t)}`}))},possibleActionsWithCount(){return this.possibleActions.map(t=>({action:t,count:this.commandCount(t)})).filter(t=>t.count>0)},actionDescriptions(){return ft}},methods:{onImageVisibleChange(){this.$emit("showImagesChange",this.imagesVisible)},emitChange(){this.$emit("update:modelValue",this.commands)},commandCount(t){let s=0;for(const a of this.commands)a.action===t&&s++;return s},filteredOut(t){if(this.filter.actions.length>0&&!this.filter.actions.includes(t.action))return!0;if(!this.filter.search)return!1;const s=this.filter.search.toLowerCase();return!t.triggers.find(({type:a,data:l})=>a==="command"&&l.command.toLowerCase().indexOf(s)>=0)},permissionsStr(t){if(!t.restrict_to||t.restrict_to.length===0)return"Everyone";const s=[];return t.restrict_to.includes("broadcaster")&&s.push("Broadcaster"),t.restrict_to.includes("mod")&&s.push("Moderators"),t.restrict_to.includes("sub")&&s.push("Subscribers"),s.join(", ")},remove(t){this.commands=this.commands.filter((s,a)=>a!==t),this.emitChange()},add(t){const s=ku(t.type);!s||(this.editIdx=this.commands.length,this.editCommand=s)},edit(t){this.editIdx=t,this.editCommand=this.commands[t]},duplicate(t){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[t]))},editedCommand(t){this.editIdx!==null&&(this.commands[this.editIdx]=t,this.emitChange(),this.editIdx=null,this.editCommand=null)},dragEnd(t){this.commands=K.arrayMove(this.commands,t.oldIndex,t.newIndex),this.emitChange()},actionDescription(t){return ft[t]},actionName(t){return Lt[t]}},created(){this.commands=JSON.parse(JSON.stringify(this.modelValue)),this.imagesVisible=this.showImages}}),R=t=>(Q("data-v-3f10b47e"),t=t(),Z(),t),Tc={class:"actions"},Fc=R(()=>e("div",{class:"mr-1"},"Filter:",-1)),Ec={class:"field has-addons mr-1 mb-0"},Mc={class:"control"},Lc={key:0,class:"field"},Oc=["value"],zc={key:0,class:"table-container"},Rc={class:"table is-striped",ref:"table"},qc=R(()=>e("th",null,null,-1)),Nc=R(()=>e("th",null,null,-1)),Bc=R(()=>e("th",null,"Trigger",-1)),Jc=p(" Response "),Wc={key:0},Hc=p(" Show images "),Kc=R(()=>e("th",null,"Type",-1)),Gc=R(()=>e("th",null,"Permissions",-1)),Yc=R(()=>e("th",null,null,-1)),Xc=R(()=>e("th",null,null,-1)),Qc=R(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Zc={class:"pl-0 pr-0"},jc=["onClick"],xc=R(()=>e("i",{class:"fa fa-pencil"},null,-1)),th=[xc],eh={class:"col-triggers"},sh={key:0},nh={key:1},ih=R(()=>e("span",{class:"is-small",title:"Channel Point Reward"},[e("i",{class:"fa fa-bullseye"}),p(": ")],-1)),oh={key:2},ah=R(()=>e("span",{class:"is-small"},"Timer: ",-1)),lh={key:0},rh={key:0},dh={key:0,class:"spacerow media-holder media-holder-inline"},uh={key:1},mh={key:2,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},ch={key:3,class:"ml-2"},hh=p("for at least "),ph={key:4,class:"ml-2"},gh=p("for "),fh={key:2},vh={key:0},_h=R(()=>e("span",null,"\u2192",-1)),yh=p(" \u2715 "),bh=R(()=>e("span",null,"\u2192",-1)),$h={key:1},wh={key:1},kh={key:2},Ch=p(" Media("),Vh={key:0},Sh={key:1},Ih={key:2},Uh=p(") "),Dh={key:3},Ah=["innerHTML"],Ph={class:"pl-0 pr-0"},Th=R(()=>e("i",{class:"fa fa-trash"},null,-1)),Fh=["onClick"],Eh=R(()=>e("i",{class:"fa fa-clone"},null,-1)),Mh=[Eh],Lh={key:1};function Oh(t,s,a,l,f,y){const m=$("dropdown-button"),n=$("duration"),r=$("responsive-image"),d=$("player"),k=$("doubleclick-button"),b=$("draggable"),c=$("command-editor");return i(),o("div",null,[e("div",Tc,[C(m,{actions:t.possibleActionsMapped,label:"Add command",onClick:t.add},null,8,["actions","onClick"]),Fc,e("div",Ec,[e("div",Mc,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=v=>t.filter.search=v)},null,512),[[_,t.filter.search]])])]),t.showFilterActions?(i(),o("div",Lc,[(i(!0),o(P,null,T(t.possibleActionsWithCount,(v,g)=>(i(),o("label",{class:"mr-1",key:g},[u(e("input",{class:"mr-1",type:"checkbox",value:v.action,"onUpdate:modelValue":s[1]||(s[1]=V=>t.filter.actions=V)},null,8,Oc),[[z,t.filter.actions]]),p(w(v.action)+" ("+w(v.count)+")",1)]))),128))])):h("",!0)]),t.commands.length>0?(i(),o("div",zc,[e("table",Rc,[e("thead",null,[e("tr",null,[qc,Nc,Bc,e("th",null,[Jc,t.showToggleImages?(i(),o("label",Wc,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[2]||(s[2]=v=>t.imagesVisible=v),s[3]||(s[3]=(...v)=>t.onImageVisibleChange&&t.onImageVisibleChange(...v))]},null,512),[[z,t.imagesVisible]]),Hc])):h("",!0)]),Kc,Gc,Yc,Xc])]),C(b,{modelValue:t.commands,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:q(({element:v,index:g})=>[u(e("tr",null,[Qc,e("td",Zc,[e("button",{class:"button is-small",onClick:V=>t.edit(g)},th,8,jc)]),e("td",eh,[(i(!0),o(P,null,T(v.triggers,(V,I)=>(i(),o("div",{key:I,class:"spacerow"},[v.triggers[I].type==="command"?(i(),o("div",sh,[e("code",null,w(v.triggers[I].data.command),1)])):h("",!0),v.triggers[I].type==="reward_redemption"?(i(),o("div",nh,[ih,e("code",null,w(v.triggers[I].data.command),1)])):h("",!0),v.triggers[I].type==="timer"?(i(),o("div",oh,[ah,e("code",null,[p(w(v.triggers[I].data.minLines)+" lines, ",1),C(n,{value:v.triggers[I].data.minInterval},null,8,["value"])])])):h("",!0)]))),128))]),e("td",null,[v.action==="text"?(i(),o("div",lh,[(i(!0),o(P,null,T(v.data.text,(V,I)=>(i(),o(P,{key:I},[e("code",null,w(v.data.text[I]),1),I<v.data.text.length-1?(i(),o("span",rh,"or")):h("",!0)],64))),128))])):v.action==="media"?(i(),o("div",{key:1,class:F(v.action)},[v.data.image.file||v.data.sound.file?(i(),o("div",dh,[v.data.image.file&&t.imagesVisible?(i(),E(r,{key:0,src:v.data.image.urlpath,title:v.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):v.data.image.file?(i(),o("code",uh,w(v.data.image.filename),1)):h("",!0),v.data.image.file&&v.data.sound.file?(i(),o("i",mh)):h("",!0),C(d,{src:v.data.sound.urlpath,name:v.data.sound.filename,volume:v.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),v.data.image.file&&v.data.sound.file?(i(),o("span",ch,[hh,C(n,{value:v.data.minDurationMs},null,8,["value"])])):v.data.image.file?(i(),o("span",ph,[gh,C(n,{value:v.data.minDurationMs},null,8,["value"])])):h("",!0)])):h("",!0)],2)):v.action==="countdown"?(i(),o("div",fh,[(v.data.type||"auto")==="auto"?(i(),o("div",vh,[e("code",null,w(v.data.intro),1),_h,e("code",null,w(v.data.steps),1),yh,C(n,{value:v.data.interval},null,8,["value"]),bh,e("code",null,w(v.data.outro),1)])):(i(),o("div",$h,[(i(!0),o(P,null,T(v.data.actions,(V,I)=>(i(),o(P,{key:I},[V.type==="delay"?(i(),E(n,{key:0,value:V.value},null,8,["value"])):h("",!0),V.type==="text"?(i(),o("code",wh,w(V.value),1)):h("",!0),V.type==="media"?(i(),o("code",kh,[Ch,V.value.image.file?(i(),o("span",Vh,w(V.value.image.filename),1)):h("",!0),V.value.image.file&&V.value.sound.file?(i(),o("span",Sh,"+")):h("",!0),V.value.sound.file?(i(),o("span",Ih,w(V.value.sound.filename),1)):h("",!0),Uh])):h("",!0),I<v.data.actions.length-1?(i(),o("span",Dh,"\u2192")):h("",!0)],64))),128))]))])):t.actionDescriptions[v.action]?(i(),o("div",{key:3,innerHTML:t.actionDescriptions[v.action]},null,8,Ah)):h("",!0)]),e("td",null,w(v.action),1),e("td",null,w(t.permissionsStr(v)),1),e("td",Ph,[C(k,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:V=>t.remove(g)},{default:q(()=>[Th]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:V=>t.duplicate(g)},Mh,8,Fh)])],512),[[yt,!t.filteredOut(v)]])]),_:1},8,["modelValue","onEnd"])],512)])):(i(),o("div",Lh,"No commands set up")),t.editCommand?(i(),E(c,{key:2,globalVariables:t.globalVariables,modelValue:t.editCommand,mode:t.editIdx>=t.commands.length?"create":"edit",baseVolume:t.baseVolume,"onUpdate:modelValue":t.editedCommand,onCancel:s[4]||(s[4]=v=>t.editCommand=null)},null,8,["globalVariables","modelValue","mode","baseVolume","onUpdate:modelValue"])):h("",!0)])}var zh=A(Pc,[["render",Oh],["__scopeId","data-v-3f10b47e"]]);const Rh=D({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(t){this.countdown.actions=K.arrayMove(this.countdown.actions,t.oldIndex,t.newIndex)},onAddDelay(){this.countdown.actions.push({type:"delay",value:"1s"})},onAddText(){this.countdown.actions.push({type:"text",value:gt()})},onAddMedia(){this.countdown.actions.push({type:"media",value:Et()})},rmaction(t){this.countdown.actions=this.countdown.actions.filter((s,a)=>a!==t)},mediaSndUploaded(t,s){this.countdown.actions[t].value.sound=mt(s)},mediaImgUploaded(t,s){this.countdown.actions[t].value.image=ot(s)}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),qh={class:"control"},Nh={class:"radio"},Bh=p(" Manual "),Jh={class:"radio"},Wh=p(" Auto "),Hh={key:0},Kh={class:"spacerow"},Gh=e("label",{class:"spacelabel"},"Steps ",-1),Yh={class:"spacerow"},Xh=e("label",{class:"spacelabel"},"Interval ",-1),Qh={class:"spacerow"},Zh=e("label",{class:"spacelabel"},"Intro ",-1),jh={class:"spacerow"},xh=e("label",{class:"spacelabel"},"Outro ",-1),tp={key:1},ep={class:"field has-addons mr-1"},sp=e("span",{class:"handle p-2"},[e("i",{class:"fa fa-arrows"})],-1),np={key:0,class:"control has-icons-left"},ip=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),op={key:1,class:"control has-icons-left"},ap=["onUpdate:modelValue"],lp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),rp={key:2,class:"control has-icons-left"},dp=e("td",null,"Image:",-1),up=["onClick"],mp=e("i",{class:"fa fa-remove mr-1"},null,-1),cp=p(" Remove "),hp=[mp,cp],pp={key:2},gp=e("td",null,"Sound:",-1),fp=["onClick"],vp=e("i",{class:"fa fa-remove mr-1"},null,-1),_p=p(" Remove "),yp=[vp,_p],bp={key:3},$p=e("td",null,"Duration:",-1),wp={class:"control has-icons-left"},kp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),Cp={class:"control"},Vp=["onClick"],Sp=e("i",{class:"fa fa-remove"},null,-1),Ip=[Sp],Up=e("i",{class:"fa fa-hourglass mr-1"},null,-1),Dp=p(" Add Delay "),Ap=[Up,Dp],Pp=e("i",{class:"fa fa-comments-o mr-1"},null,-1),Tp=p(" Add Chat "),Fp=[Pp,Tp],Ep=e("i",{class:"fa fa-picture-o mr-1"},null,-1),Mp=p(" Add Media "),Lp=[Ep,Mp];function Op(t,s,a,l,f,y){const m=$("duration-input"),n=$("responsive-image"),r=$("upload"),d=$("player"),k=$("volume-slider"),b=$("draggable");return i(),o("div",null,[e("div",qh,[e("label",Nh,[u(e("input",{type:"radio",value:"manual","onUpdate:modelValue":s[0]||(s[0]=c=>t.countdown.type=c)},null,512),[[tt,t.countdown.type]]),Bh]),e("label",Jh,[u(e("input",{type:"radio",value:"auto","onUpdate:modelValue":s[1]||(s[1]=c=>t.countdown.type=c)},null,512),[[tt,t.countdown.type]]),Wh])]),t.countdown.type==="auto"?(i(),o("div",Hh,[e("div",Kh,[Gh,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[2]||(s[2]=c=>t.countdown.steps=c)},null,512),[[_,t.countdown.steps]])]),e("div",Yh,[Xh,C(m,{modelValue:t.countdown.interval,"onUpdate:modelValue":s[3]||(s[3]=c=>t.countdown.interval=c)},null,8,["modelValue"])]),e("div",Qh,[Zh,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[4]||(s[4]=c=>t.countdown.intro=c)},null,512),[[_,t.countdown.intro]])]),e("div",jh,[xh,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[5]||(s[5]=c=>t.countdown.outro=c)},null,512),[[_,t.countdown.outro]])])])):(i(),o("div",tp,[C(b,{modelValue:t.countdown.actions,onEnd:t.dragEnd,handle:".handle","item-key":"id"},{item:q(({element:c,index:v})=>[e("div",ep,[sp,c.type==="delay"?(i(),o("div",np,[C(m,{modelValue:c.value,"onUpdate:modelValue":g=>c.value=g},null,8,["modelValue","onUpdate:modelValue"]),ip])):c.type==="text"?(i(),o("div",op,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":g=>c.value=g},null,8,ap),[[_,c.value]]),lp])):c.type==="media"?(i(),o("div",rp,[e("table",null,[e("tr",null,[dp,e("td",null,[c.value.image.file?(i(),E(n,{key:0,src:c.value.image.urlpath,title:c.value.image.filename,width:"100%",height:"90px",style:{display:"block"}},null,8,["src","title"])):h("",!0),c.value.image.file?(i(),o("button",{key:1,class:"button is-small",onClick:g=>c.value.image.file=null},hp,8,up)):h("",!0),c.value.image.file?(i(),o("br",pp)):h("",!0),C(r,{onUploaded:g=>t.mediaImgUploaded(v,g),accept:"image/*",label:"Upload Image",class:F({"mt-1":c.value.image.file})},null,8,["onUploaded","class"])])]),e("tr",null,[gp,e("td",null,[c.value.sound.file?(i(),E(d,{key:0,src:c.value.sound.urlpath,name:c.value.sound.filename,volume:c.value.sound.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):h("",!0),c.value.sound.file?(i(),E(k,{key:1,modelValue:c.value.sound.volume,"onUpdate:modelValue":g=>c.value.sound.volume=g},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),c.value.sound.file?(i(),o("button",{key:2,class:"button is-small",onClick:g=>c.value.sound.file=null},yp,8,fp)):h("",!0),c.value.sound.file?(i(),o("br",bp)):h("",!0),C(r,{onUploaded:g=>t.mediaSndUploaded(v,g),accept:"audio/*",label:"Upload Sound",class:F({"mt-1":c.value.sound.file})},null,8,["onUploaded","class"])])]),e("tr",null,[$p,e("td",null,[e("div",wp,[C(m,{modelValue:c.value.minDurationMs,"onUpdate:modelValue":g=>c.value.minDurationMs=g},null,8,["modelValue","onUpdate:modelValue"]),kp])])])])])):h("",!0),e("div",Cp,[e("button",{class:"button is-small",onClick:g=>t.rmaction(v)},Ip,8,Vp)])])]),_:1},8,["modelValue","onEnd"]),e("button",{class:"button is-small",onClick:s[6]||(s[6]=(...c)=>t.onAddDelay&&t.onAddDelay(...c))},Ap),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...c)=>t.onAddText&&t.onAddText(...c))},Fp),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(...c)=>t.onAddMedia&&t.onAddMedia(...c))},Lp)]))])}var zp=A(Rh,[["render",Op]]);const Rp=D({props:{modelValue:{type:Object,required:!0},removable:{type:Boolean,required:!0}},emits:["update:modelValue","remove"],data(){return{value:{type:"",data:{command:"",commandExact:!1,minInterval:0,minLines:0}}}},created(){this.apply(this.modelValue)},methods:{emitRemove(){this.$emit("remove")},emitUpdate(){this.$emit("update:modelValue",this.value)},apply(t){this.value=JSON.parse(JSON.stringify(t))}},watch:{modelValue(t,s){this.apply(t)}}}),B=t=>(Q("data-v-d4f9a1f6"),t=t(),Z(),t),qp={class:"trigger-editor"},Np={key:0,class:"field has-addons"},Bp={class:"control has-icons-left mr-1"},Jp=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),Wp={class:"control mr-1",title:"Check if command should only be executed if it matches exactly (= no arguments come after it)."},Hp=B(()=>e("span",{class:"is-small is-left"},"exact",-1)),Kp={class:"control"},Gp=["disabled"],Yp=B(()=>e("i",{class:"fa fa-remove"},null,-1)),Xp=[Yp],Qp={key:1,class:"field has-addons"},Zp={class:"control has-icons-left"},jp=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-bullseye"})],-1)),xp={class:"control"},tg=["disabled"],eg=B(()=>e("i",{class:"fa fa-remove"},null,-1)),sg=[eg],ng={key:2,class:"timer-trigger"},ig={class:"control remove-control"},og=["disabled"],ag=B(()=>e("i",{class:"fa fa-remove"},null,-1)),lg=[ag],rg={class:"timer-trigger-inner"},dg=B(()=>e("label",{class:"mr-1"},"Messages \u2265",-1)),ug={class:"control has-icons-left mr-1"},mg=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),cg=B(()=>e("label",{class:"mr-1"},"Interval \u2265",-1)),hg={class:"control has-icons-left has-icons-right mr-1"},pg=B(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),gg=B(()=>e("p",{class:"help"},[p(" Command will be triggered when at least "),e("code",null,"Messages"),p(" chat messages arrived AND "),e("code",null,"Interval"),p(" have passed. ")],-1));function fg(t,s,a,l,f,y){const m=$("duration-input");return i(),o("div",qp,[t.value.type==="command"?(i(),o("div",Np,[e("div",Bp,[u(e("input",{class:F(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[0]||(s[0]=n=>t.value.data.command=n),s[1]||(s[1]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,2),[[_,t.value.data.command]]),Jp]),e("div",Wp,[e("label",null,[u(e("input",{type:"checkbox",class:"checkbox mr-1","onUpdate:modelValue":[s[2]||(s[2]=n=>t.value.data.commandExact=n),s[3]||(s[3]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,512),[[z,t.value.data.commandExact]]),Hp])]),e("div",Kp,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[4]||(s[4]=(...n)=>t.emitRemove&&t.emitRemove(...n))},Xp,8,Gp)])])):h("",!0),t.value.type==="reward_redemption"?(i(),o("div",Qp,[e("div",Zp,[u(e("input",{class:F(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[5]||(s[5]=n=>t.value.data.command=n),s[6]||(s[6]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,2),[[_,t.value.data.command]]),jp]),e("div",xp,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[7]||(s[7]=(...n)=>t.emitRemove&&t.emitRemove(...n))},sg,8,tg)])])):h("",!0),t.value.type==="timer"?(i(),o("div",ng,[e("div",ig,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[8]||(s[8]=(...n)=>t.emitRemove&&t.emitRemove(...n))},lg,8,og)]),e("div",rg,[dg,e("div",ug,[u(e("input",{class:"input is-small","onUpdate:modelValue":[s[9]||(s[9]=n=>t.value.data.minLines=n),s[10]||(s[10]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,512),[[_,t.value.data.minLines]]),mg]),cg,e("div",hg,[C(m,{modelValue:t.value.data.minInterval,"onUpdate:modelValue":s[11]||(s[11]=n=>{t.value.data.minInterval=n,t.emitUpdate()})},null,8,["modelValue"]),pg])]),gg])):h("",!0)])}var vg=A(Rp,[["render",fg],["__scopeId","data-v-d4f9a1f6"]]);const _g=D({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1}),methods:{toggleVisibility(t,s){t.hidevideo?this.sendCtrl("videoVisibility",[!0,s]):this.sendCtrl("videoVisibility",[!1,s])},dragEnd(t){this.sendCtrl("move",[t.oldIndex,t.newIndex])},applyFilter(t){this.$emit("filterChange",t)},sendCtrl(t,s){this.$emit("ctrl",[t,s])},isFilteredOut(t){return this.filter.tag!==""&&!t.tags.includes(this.filter.tag)},startAddTag(t){this.tagInputIdx=t,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(t=>(t.filteredOut=this.isFilteredOut(t),t))},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(t=>t.tags.includes(this.filter.tag))}},watch:{playlist:function(t,s){t.find(a=>!this.isFilteredOut(a))||this.$emit("stopPlayer")},filter:function(t,s){this.playlist.find(a=>!this.isFilteredOut(a))||this.$emit("stopPlayer")}}}),J=t=>(Q("data-v-c0843896"),t=t(),Z(),t),yg={class:"filters"},bg={class:"currentfilter"},$g=J(()=>e("div",{class:"mr-1"},"Filter:",-1)),wg=J(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),kg={key:1,class:"field has-addons mr-1 mb-0"},Cg={class:"control"},Vg={class:"control"},Sg={class:"pt-1"},Ig=p(" Hide filtered out"),Ug={key:0,class:"table is-striped"},Dg=J(()=>e("thead",null,[e("tr",null,[e("th"),e("th"),e("th"),e("th",null,"Title"),e("th",null,"User"),e("th",null,"Plays"),e("th"),e("th"),e("th"),e("th")])],-1)),Ag=J(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Pg=["disabled","onClick"],Tg=J(()=>e("i",{class:"fa fa-play"},null,-1)),Fg=[Tg],Eg=["href"],Mg=J(()=>e("i",{class:"fa fa-external-link"},null,-1)),Lg=["onClick"],Og=J(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),zg=["onClick"],Rg=J(()=>e("i",{class:"fa fa-plus"},null,-1)),qg=[Rg],Ng={key:0,class:"field has-addons"},Bg={class:"control"},Jg=["onKeyup"],Wg={class:"control"},Hg=["disabled","onClick"],Kg=["onClick","title"],Gg=["onClick"],Yg=J(()=>e("i",{class:"fa fa-thumbs-up mr-1"},null,-1)),Xg=["onClick"],Qg=J(()=>e("i",{class:"fa fa-thumbs-down mr-1"},null,-1)),Zg=["onClick"],jg=J(()=>e("i",{class:"fa fa-trash"},null,-1)),xg=[jg],tf={key:1};function ef(t,s,a,l,f,y){const m=$("draggable");return i(),o("div",null,[e("div",yg,[e("div",bg,[$g,t.filter.tag?(i(),o("span",{key:0,class:"tag mr-1",onClick:s[0]||(s[0]=n=>t.applyFilter(""))},[p(w(t.filter.tag)+" ",1),wg])):(i(),o("div",kg,[e("div",Cg,[u(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[1]||(s[1]=n=>t.filterTagInput=n),onKeyup:s[2]||(s[2]=G(n=>t.applyFilter(t.filterTagInput),["enter"]))},null,544),[[_,t.filterTagInput]])]),e("div",Vg,[e("span",{class:"button is-small",onClick:s[3]||(s[3]=n=>t.applyFilter(t.filterTagInput))},"Apply filter")])])),e("label",Sg,[u(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=n=>t.hideFilteredOut=n)},null,512),[[z,t.hideFilteredOut]]),Ig])])]),t.playlist.length>0?(i(),o("table",Ug,[Dg,C(m,{modelValue:t.enhancedPlaylist,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:q(({element:n,index:r})=>[u(e("tr",null,[Ag,e("td",null,w(r+1),1),e("td",null,[r!==t.firstIndex?(i(),o("button",{key:0,class:"button is-small",disabled:n.filteredOut?!0:null,onClick:d=>t.sendCtrl("playIdx",[r]),title:"Play"},Fg,8,Pg)):h("",!0)]),e("td",null,[e("a",{href:"https://www.youtube.com/watch?v="+n.yt,target:"_blank"},[p(w(n.title||n.yt)+" ",1),Mg],8,Eg),e("div",null,[(i(!0),o(P,null,T(n.tags,(d,k)=>(i(),o("span",{key:k,class:"tag",onClick:b=>t.sendCtrl("rmtag",[d,r])},[p(w(d)+" ",1),Og],8,Lg))),128)),e("span",{class:"button is-small",onClick:d=>t.startAddTag(r)},qg,8,zg)]),t.tagInputIdx===r?(i(),o("div",Ng,[e("div",Bg,[u(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[5]||(s[5]=d=>t.tagInput=d),onKeyup:G(d=>{t.sendCtrl("addtag",[t.tagInput,r]),t.tagInput=""},["enter"])},null,40,Jg),[[_,t.tagInput]])]),e("div",Wg,[e("span",{class:"button is-small",disabled:t.tagInput?null:!0,onClick:d=>{t.sendCtrl("addtag",[t.tagInput,r]),t.tagInput=""}},"Add tag",8,Hg)])])):h("",!0)]),e("td",null,w(n.user),1),e("td",null,w(n.plays)+"x",1),e("td",null,[e("button",{class:"button is-small",onClick:d=>t.toggleVisibility(n,r),title:n.hidevideo?"Video hidden":"Video visible"},[e("i",{class:F(["fa mr-1",{"fa-eye":!n.hidevideo,"fa-eye-slash":n.hidevideo}])},null,2)],8,Kg)]),e("td",null,[e("button",{class:"button is-small",onClick:d=>t.sendCtrl("goodIdx",[r])},[Yg,p(" "+w(n.goods),1)],8,Gg)]),e("td",null,[e("button",{class:"button is-small",onClick:d=>t.sendCtrl("badIdx",[r])},[Qg,p(" "+w(n.bads),1)],8,Xg)]),e("td",null,[e("button",{class:"button is-small",onClick:d=>t.sendCtrl("rmIdx",[r]),title:"Remove"},xg,8,Zg)])],512),[[yt,!t.hideFilteredOut||!n.filteredOut]])]),_:1},8,["modelValue","onEnd"])])):(i(),o("div",tf,"Playlist is empty"))])}var sf=A(_g,[["render",ef],["__scopeId","data-v-c0843896"]]);const nf=D({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(t){const s=this.settings.customCssPresets.find(a=>a.name===t);s?(this.settings.customCss=s.css,this.settings.showProgressBar=s.showProgressBar,this.settings.showThumbnails=s.showThumbnails,this.settings.maxItemsShown=s.maxItemsShown):console.warn(`preset not found: ${t}`),this.sendSettings()},removePreset(t){this.settings.customCssPresets=this.settings.customCssPresets.filter(s=>s.name!==t),this.sendSettings()},savePreset(){const t=this.settings.customCssPresets.findIndex(s=>s.name===this.cssPresetName);t>=0?(this.settings.customCssPresets[t].css=this.settings.customCss,this.settings.customCssPresets[t].showProgressBar=this.settings.showProgressBar,this.settings.customCssPresets[t].showThumbnails=this.settings.showThumbnails,this.settings.customCssPresets[t].maxItemsShown=this.settings.maxItemsShown):this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss,showProgressBar:this.settings.showProgressBar,showThumbnails:this.settings.showThumbnails,maxItemsShown:this.settings.maxItemsShown}),this.sendSettings()},hideVideoImageRemoved(){this.settings.hideVideoImage={filename:"",file:""},this.sendSettings()},hideVideoImageUploaded(t){this.settings.hideVideoImage=ot(t),this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:{volume:100,hideVideoImage:{file:"",filename:""},initAutoplay:!0,showThumbnails:!1,maxItemsShown:0,showProgressBar:!1,customCssPresets:[],customCss:""},css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.title { margin-bottom: 0; }
.meta-left, .meta-right, .thumbnail { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Replace icon for thumbs-up with an image",code:`.meta-right .vote-up { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }
.meta-right .vote-up .fa { display: none; }`},{desc:"Remove text before/after username",code:`.meta-user-text-before,
.meta-user-text-after {display: none}`},{desc:"Add a fontawesome icon before username (\\f075 is the icon unicode, refer to https://fontawesome.com/v4.7/icons/)",code:'.meta-user-name::before { content: "\\f075"; display: inline-block; font: normal normal normal 14px/1 FontAwesome; font-size: inherit; margin-right: .5em; }'},{desc:"Add an image icon before username",code:".meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }"},{desc:"Add an image icon before username for specific user only",code:`[data-user="nc_para_" i] .meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }`},{desc:"Change item display depending on username (this one changes background and makes thumbnails black boxes)",code:`[data-user="nc_para_" i] { background: #dd0066; }
[data-user="nc_para_" i] .thumbnail img { display: none; }
[data-user="nc_para_" i] .thumbnail { background: black; }`},{desc:"Show player left of the playlist (and limit its height to 320px)",code:`.wrapper { display: grid; grid-template-areas: "player playlist"; grid-template-columns: 50% auto; grid-template-rows: 320px; }
.player iframe { height: 320px; }`},{desc:"Show thumbnails only, and display meta info above them",code:`.item { display: block; position: relative; padding: 0; color: white; }
.title, .meta-left, .meta-right { position: absolute; padding: .2em; background: rgba(244,0,90,.9); }
.meta-left { top: 0; left: 0; font-size: 1em; }
.meta-right { top: 0; right: 0; font-size: 1em; }
.title { bottom: 0; left: 0; right: 0; margin-bottom: 0; }
.thumbnail { width: auto; }`},{desc:"Align thumbnails to the bottom",code:".thumbnail { align-self: end; }"},{desc:"Align thumbnails to the center",code:".thumbnail { align-self: center; }"},{desc:"Add a margin/padding to the thumbnails",code:".thumbnail { padding: 20px; }"},{desc:"Show number of plays not at player, but in icon form on the right near votes",code:`.meta-left .meta-user:after,
.meta-left .meta-plays { display: none; }
.meta-right .meta-plays { display: inline-block; }`},{desc:"Show the progress bar only, and no video (progress bar above list)",code:`
.player { height: 5px; padding-bottom: 0; }
.progress { height: 5px; }`},{desc:"Show the progress bar only, and no video (progress bar below list)",code:`
.wrapper { display: grid; grid-template-areas: "list" "player"; }
.player { height: 5px; padding-bottom: 0; grid-area: player }
.list { grid-area: list }
.progress { height: 5px; }`}]}})}),L=t=>(Q("data-v-69bd5f13"),t=t(),Z(),t),of={key:0,class:"table is-striped",ref:"table"},af=L(()=>e("tr",null,[e("td",{colspan:"3"},"General")],-1)),lf=L(()=>e("td",null,[e("code",null,"settings.volume")],-1)),rf=L(()=>e("td",null,"Base volume for all songs played.",-1)),df=L(()=>e("td",null,[e("code",null,"settings.initAutoplay")],-1)),uf=L(()=>e("td",null,"If checked, the widget will autoplay when first opened.",-1)),mf=L(()=>e("td",null,[e("code",null,"settings.hideVideoImage")],-1)),cf={key:0,class:"mb-1"},hf=L(()=>e("br",null,null,-1)),pf=L(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),gf=p(" Remove Image "),ff=[pf,gf],vf=L(()=>e("td",null,"Image to display when a video is hidden.",-1)),_f=L(()=>e("tr",null,[e("td",{colspan:"3"},"Visuals")],-1)),yf=L(()=>e("td",null,[e("code",null,"settings.showProgressBar")],-1)),bf=L(()=>e("td",null,"Render a progress bar in the bottom part of the video in the widget.",-1)),$f=L(()=>e("td",null,[e("code",null,"settings.showThumbnails")],-1)),wf={class:"mr-1"},kf=p("Off"),Cf={class:"mr-1"},Vf=p("Left"),Sf={class:"mr-1"},If=p("Right"),Uf=L(()=>e("td",null,"Render video thumbnails in the widget.",-1)),Df=L(()=>e("td",null,[e("code",null,"settings.maxItemsShown")],-1)),Af=L(()=>e("td",null,"Max. number of items displayed in the playlist. Set to -1 for no limit.",-1)),Pf=L(()=>e("code",null,"settings.customCss",-1)),Tf={class:"field has-addons mr-1"},Ff={class:"control is-expanded"},Ef={class:"control"},Mf=["onClick"],Lf=["onClick"],Of=L(()=>e("i",{class:"fa fa-remove"},null,-1)),zf=[Of],Rf=L(()=>e("p",null,"Classes that can be used for styling:",-1)),qf={class:"table"},Nf=L(()=>e("thead",null,[e("tr",null,[e("th",null,"Class"),e("th",null,"Description")])],-1)),Bf=L(()=>e("p",null,[e("b",null,"Examples:")],-1));function Jf(t,s,a,l,f,y){const m=$("volume-slider"),n=$("responsive-image"),r=$("upload");return i(),o("div",null,[t.settings?(i(),o("table",of,[e("tbody",null,[af,e("tr",null,[lf,e("td",null,[C(m,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[0]||(s[0]=d=>t.settings.volume=d),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),rf]),e("tr",null,[df,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[1]||(s[1]=d=>t.settings.initAutoplay=d),s[2]||(s[2]=(...d)=>t.sendSettings&&t.sendSettings(...d))]},null,512),[[z,t.settings.initAutoplay]])]),uf]),e("tr",null,[mf,e("td",null,[t.settings.hideVideoImage.file?(i(),o("div",cf,[C(n,{src:t.settings.hideVideoImage.urlpath,title:t.settings.hideVideoImage.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"]),hf,e("button",{class:"button is-small",onClick:s[3]||(s[3]=(...d)=>t.hideVideoImageRemoved&&t.hideVideoImageRemoved(...d))},ff)])):h("",!0),C(r,{onUploaded:t.hideVideoImageUploaded,accept:"image/*",label:"Upload Image"},null,8,["onUploaded"])]),vf]),_f,e("tr",null,[yf,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[4]||(s[4]=d=>t.settings.showProgressBar=d),s[5]||(s[5]=(...d)=>t.sendSettings&&t.sendSettings(...d))]},null,512),[[z,t.settings.showProgressBar]])]),bf]),e("tr",null,[$f,e("td",null,[e("label",wf,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[6]||(s[6]=d=>t.settings.showThumbnails=d),s[7]||(s[7]=(...d)=>t.sendSettings&&t.sendSettings(...d))],value:!1},null,512),[[tt,t.settings.showThumbnails]]),kf]),e("label",Cf,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[8]||(s[8]=d=>t.settings.showThumbnails=d),s[9]||(s[9]=(...d)=>t.sendSettings&&t.sendSettings(...d))],value:"left"},null,512),[[tt,t.settings.showThumbnails]]),Vf]),e("label",Sf,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[10]||(s[10]=d=>t.settings.showThumbnails=d),s[11]||(s[11]=(...d)=>t.sendSettings&&t.sendSettings(...d))],value:"right"},null,512),[[tt,t.settings.showThumbnails]]),If])]),Uf]),e("tr",null,[Df,e("td",null,[u(e("input",{type:"number",min:"-1","onUpdate:modelValue":[s[12]||(s[12]=d=>t.settings.maxItemsShown=d),s[13]||(s[13]=(...d)=>t.sendSettings&&t.sendSettings(...d))]},null,512),[[_,t.settings.maxItemsShown]])]),Af]),e("tr",null,[e("td",null,[Pf,e("div",Tf,[e("div",Ff,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[14]||(s[14]=d=>t.cssPresetName=d),onFocus:s[15]||(s[15]=d=>t.cssPresetDropdownActive=!0),onBlur:s[16]||(s[16]=d=>t.cssPresetDropdownActive=!1)},null,544),[[_,t.cssPresetName]])]),e("div",Ef,[e("span",{class:"button is-small",onClick:s[17]||(s[17]=(...d)=>t.savePreset&&t.savePreset(...d))},"Save preset")])]),(i(!0),o(P,null,T(t.settings.customCssPresets,(d,k)=>(i(),o("div",{class:"mb-1",key:k},[e("span",{class:"button is-small",onClick:b=>t.loadPreset(d.name)},w(d.name),9,Mf),e("span",{class:"button is-small ml-1",onClick:b=>t.removePreset(d.name)},zf,8,Lf)]))),128))]),e("td",null,[u(e("textarea",{class:"textarea","onUpdate:modelValue":[s[18]||(s[18]=d=>t.settings.customCss=d),s[19]||(s[19]=(...d)=>t.sendSettings&&t.sendSettings(...d))]},null,512),[[_,t.settings.customCss]])]),e("td",null,[Rf,e("table",qf,[Nf,e("tbody",null,[(i(!0),o(P,null,T(t.css.classExamples,(d,k)=>(i(),o("tr",{key:k},[e("td",null,[e("code",null,w(d.class),1)]),e("td",null,w(d.desc),1)]))),128))])]),Bf,(i(!0),o(P,null,T(t.css.codeExamples,(d,k)=>(i(),o("p",{key:k},[p(w(d.desc)+" ",1),e("pre",null,[e("code",null,w(d.code),1)])]))),128))])])])],512)):h("",!0)])}var Wf=A(nf,[["render",Jf],["__scopeId","data-v-69bd5f13"]]);const Hf=D({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(t,s){this.editTag=t.value,this.tagEditIdx=s},updateTag(t,s){this.$emit("updateTag",[t,s])}}}),Kf={class:"table is-striped"},Gf=e("tr",null,[e("th",null,"Tag"),e("th"),e("th")],-1),Yf=["onKeyup"],Xf=["value","onFocus"],Qf=["disabled","onClick"];function Zf(t,s,a,l,f,y){return i(),o("table",Kf,[Gf,(i(!0),o(P,null,T(t.tags,(m,n)=>(i(),o("tr",{key:n},[e("td",null,[t.tagEditIdx===n?u((i(),o("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=r=>t.editTag=r),onKeyup:G(r=>t.updateTag(m.value,t.editTag),["enter"])},null,40,Yf)),[[_,t.editTag]]):(i(),o("input",{key:1,type:"text",class:"input is-small",value:m.value,onFocus:r=>t.onInputFocus(m,n)},null,40,Xf))]),e("td",null,[t.tagEditIdx===n?(i(),o("span",{key:0,class:"button is-small",disabled:m.value===t.editTag?!0:null,onClick:r=>t.updateTag(m.value,t.editTag)},"Save",8,Qf)):h("",!0)]),e("td",null,w(m.count)+"x",1)]))),128))])}var jf=A(Hf,[["render",Zf]]);const xf=D({props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","cancel"],data:()=>({item:null,itemStr:"null",newState:"",newSlotDefinitionName:""}),mounted(){this.itemStr=JSON.stringify(this.modelValue),this.item=JSON.parse(this.itemStr),this.adjustAllImagesDivSize(),window.addEventListener("resize",this.adjustAllImagesDivSize)},unmounted(){window.removeEventListener("resize",this.adjustAllImagesDivSize)},watch:{modelValue:{handler(t){this.item=JSON.parse(this.itemStr)}},item:{handler(t){this.itemStr=JSON.stringify(t)},deep:!0},itemStr:{handler(t){const s=JSON.stringify(this.item);try{const a=JSON.parse(t);s!==a&&(this.item=a)}catch(a){console.warn(a)}}}},computed:{allImages(){var s;const t=[];return(s=this.item)==null||s.slotDefinitions.forEach(a=>{a.items.forEach(l=>{l.states.forEach(f=>{f.frames.forEach(y=>{y.url&&!t.includes(y.url)&&t.push(y.url)})})})}),t},isStateAddable(){return!(!this.item||this.newState===""||this.item.stateDefinitions.find(({value:t})=>t===this.newState))}},methods:{autoDetectDimensions(){if(this.allImages.length===0)return;const t=new Image;t.onload=()=>{!this.item||(this.item.width=t.width,this.item.height=t.height)},t.src=this.allImages[0]},adjustAllImagesDivSize(){this.$nextTick(()=>{if(!this.$refs.cardBody||!this.$refs.allImagesDiv)return;const t=this.$refs.cardBody.clientHeight;this.$refs.allImagesDiv.style.maxHeight=`${t}px`})},imageDragStart(t){t.dataTransfer.setData("avatar-image-url",t.target.getAttribute("data-src"))},emitUpdate(){if(!this.item){console.warn("emitUpdate: this.item not initialized");return}this.$emit("update:modelValue",{name:this.item.name,width:parseInt(`${this.item.width}`,10),height:parseInt(`${this.item.height}`,10),stateDefinitions:this.item.stateDefinitions,slotDefinitions:this.item.slotDefinitions})},onSaveClick(){this.emitUpdate()},onSaveAndCloseClick(){this.emitUpdate(),this.$emit("cancel")},onCancelClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},addStateDefinition(){if(!this.item){console.warn("addStateDefinition: this.item not initialized");return}const t={value:this.newState,deletable:!0};this.item.stateDefinitions.push(t);for(let s of this.item.slotDefinitions)for(let a of s.items)a.states.push({state:t.value,frames:[]})},removeStateDefinition(t){if(!this.item){console.warn("removeStateDefinition: this.item not initialized");return}const s=[];for(let l in this.item.stateDefinitions)parseInt(l,10)!==parseInt(`${t}`,10)&&s.push(this.item.stateDefinitions[l]);this.item.stateDefinitions=s;const a=s.map(l=>l.value);for(let l of this.item.slotDefinitions)for(let f of l.items)f.states=f.states.filter(y=>a.includes(y.state))},removeSlotDefinition(t){if(!this.item){console.warn("removeSlotDefinition: this.item not initialized");return}const s=[];for(let a in this.item.slotDefinitions)parseInt(a,10)!==parseInt(`${t}`,10)&&s.push(this.item.slotDefinitions[a]);this.item.slotDefinitions=s},updateSlotDefinition(t,s){if(!this.item){console.warn("updateSlotDefinition: this.item not initialized");return}this.item.slotDefinitions[parseInt(`${t}`,10)]=s},addSlotDefinition(){if(!this.item){console.warn("addSlotDefinition: this.item not initialized");return}const t={slot:"Unnamed slot",defaultItemIndex:-1,items:[]};this.item.slotDefinitions.push(t)},moveSlotUp(t){if(!this.item){console.warn("moveSlotUp: this.item not initialized");return}if(t<=0)return;const s=this.item.slotDefinitions[t-1];this.item.slotDefinitions[t-1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s},moveSlotDown(t){if(!this.item){console.warn("moveSlotDown: this.item not initialized");return}if(t>=this.item.slotDefinitions.length-1)return;const s=this.item.slotDefinitions[t+1];this.item.slotDefinitions[t+1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s}}}),tv={key:0,class:"avatar-editor modal is-active"},ev={class:"modal-card"},sv={class:"modal-card-head"},nv=e("p",{class:"modal-card-title"},"Edit Avatar",-1),iv={class:"modal-card-body",ref:"cardBody"},ov={class:"columns"},av={class:"column is-three-quarters"},lv={class:"table is-striped"},rv=e("td",null,"Name:",-1),dv=e("td",null,"Dimensions:",-1),uv=p("\u2716"),mv=p(" Pixels "),cv=e("td",null,"States:",-1),hv=["onClick"],pv=e("i",{class:"fa fa-trash"},null,-1),gv=[pv],fv=["disabled"],vv=e("td",null,"Slots",-1),_v={class:"column"},yv=e("div",null,"JSON:",-1),bv=e("div",null,"All images in use:",-1),$v={class:"avatar-all-images",ref:"allImagesDiv"},wv=["src","data-src"],kv={class:"modal-card-foot"};function Cv(t,s,a,l,f,y){const m=$("avatar-slot-definition-editor");return t.item?(i(),o("div",tv,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...n)=>t.onOverlayClick&&t.onOverlayClick(...n))}),e("div",ev,[e("header",sv,[nv,e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...n)=>t.onCloseClick&&t.onCloseClick(...n))})]),e("section",iv,[e("div",ov,[e("div",av,[e("table",lv,[e("tbody",null,[e("tr",null,[rv,e("td",null,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[2]||(s[2]=n=>t.item.name=n)},null,512),[[_,t.item.name]])])]),e("tr",null,[dv,e("td",null,[u(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[3]||(s[3]=n=>t.item.width=n)},null,512),[[_,t.item.width]]),uv,u(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[4]||(s[4]=n=>t.item.height=n)},null,512),[[_,t.item.height]]),mv,t.allImages.length?(i(),o("span",{key:0,class:"button is-small",onClick:s[5]||(s[5]=(...n)=>t.autoDetectDimensions&&t.autoDetectDimensions(...n))},"Auto-detect")):h("",!0)])]),e("tr",null,[cv,e("td",null,[(i(!0),o(P,null,T(t.item.stateDefinitions,(n,r)=>(i(),o("span",{class:"tag",key:r},[e("span",null,w(n.value),1),n.deletable?(i(),o("span",{key:0,class:"ml-1 is-clickable",onClick:d=>t.removeStateDefinition(r)},gv,8,hv)):h("",!0)]))),128)),u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=n=>t.newState=n),placeholder:"State"},null,512),[[_,t.newState]]),e("span",{class:"button is-small",onClick:s[7]||(s[7]=(...n)=>t.addStateDefinition&&t.addStateDefinition(...n)),disabled:t.isStateAddable?null:!0},"Add custom state",8,fv)])]),e("tr",null,[vv,e("td",null,[(i(!0),o(P,null,T(t.item.slotDefinitions,(n,r)=>(i(),E(m,{class:"card mb-2",key:r,modelValue:n,avatarDef:t.item,"onUpdate:modelValue":d=>t.updateSlotDefinition(r,d),onMoveUp:d=>t.moveSlotUp(r),onMoveDown:d=>t.moveSlotDown(r),onRemove:d=>t.removeSlotDefinition(r)},null,8,["modelValue","avatarDef","onUpdate:modelValue","onMoveUp","onMoveDown","onRemove"]))),128))])])])]),e("span",{class:"button is-small",onClick:s[8]||(s[8]=(...n)=>t.addSlotDefinition&&t.addSlotDefinition(...n))},"Add slot")]),e("div",_v,[yv,u(e("textarea",{class:"textarea mb-2","onUpdate:modelValue":s[9]||(s[9]=n=>t.itemStr=n)},null,512),[[_,t.itemStr]]),bv,e("div",$v,[(i(!0),o(P,null,T(t.allImages,(n,r)=>(i(),o("img",{key:r,src:n,draggable:"true",class:"mr-1 mb-1",onDragstart:s[10]||(s[10]=(...d)=>t.imageDragStart&&t.imageDragStart(...d)),"data-src":n},null,40,wv))),128))],512)])])],512),e("footer",kv,[e("button",{class:"button is-small is-primary",onClick:s[11]||(s[11]=(...n)=>t.onSaveClick&&t.onSaveClick(...n))}," Save "),e("button",{class:"button is-small is-primary",onClick:s[12]||(s[12]=(...n)=>t.onSaveAndCloseClick&&t.onSaveAndCloseClick(...n))}," Save and close "),e("button",{class:"button is-small",onClick:s[13]||(s[13]=(...n)=>t.onCancelClick&&t.onCancelClick(...n))},"Cancel")])])])):h("",!0)}var Vv=A(xf,[["render",Cv]]);const Sv=D({props:{modelValue:{type:Object,required:!0},avatarDef:{type:Object,required:!0}},emits:["update:modelValue","remove","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultItem(){return this.modelValue.defaultItemIndex>=0&&this.modelValue.items.length>this.modelValue.defaultItemIndex?this.modelValue.items[this.modelValue.defaultItemIndex]:null},defaultAnimation(){if(!this.defaultItem)return[];const t=this.defaultItem.states.find(({state:s})=>s==="default");return t?t.frames:[]}},methods:{emitChange(){this.$emit("update:modelValue",this.modelValue)},updateItem(t,s){this.modelValue.items[t]=s,this.emitChange()},removeItem(t,s){this.modelValue.items=this.modelValue.items.filter((a,l)=>l!==t),t<=this.modelValue.defaultItemIndex&&(this.modelValue.defaultItemIndex=this.modelValue.defaultItemIndex-1),this.modelValue.items.length>0&&this.modelValue.defaultItemIndex<0&&(this.modelValue.defaultItemIndex=0),this.emitChange()},makeItemDefault(t,s){this.modelValue.defaultItemIndex=t,this.emitChange()},addItem(){const t={title:`${this.modelValue.slot} item ${this.modelValue.items.length+1}`,states:this.avatarDef.stateDefinitions.map(s=>({state:s.value,frames:[]}))};this.modelValue.items.push(t),this.modelValue.defaultItemIndex===-1&&(this.modelValue.defaultItemIndex=0),this.emitChange()},moveItemUp(t){this.swapItems(t-1,t)},moveItemDown(t){this.swapItems(t+1,t)},swapItems(t,s){if(t<0||t>this.modelValue.items.length-1||s<0||s>this.modelValue.items.length-1)return;const a=this.modelValue.items[t];this.modelValue.items[t]=this.modelValue.items[s],this.modelValue.items[s]=a,this.modelValue.defaultItemIndex===t?this.modelValue.defaultItemIndex=s:this.modelValue.defaultItemIndex===s&&(this.modelValue.defaultItemIndex=t),this.modelValue.items=this.modelValue.items.slice()}}}),Iv={class:"avatar-slot-definition-editor"},Uv={class:"level avatar-slot-definition-editor-title p-1"},Dv={class:"level-left"},Av={class:"level-item"},Pv={class:"level-item"},Tv={class:"level-right"},Fv={class:"level-item"},Ev={class:"level-item"},Mv={class:"level-item"},Lv=e("i",{class:"fa fa-trash"},null,-1),Ov=[Lv],zv={class:"p-1"};function Rv(t,s,a,l,f,y){const m=$("avatar-animation"),n=$("avatar-slot-item-editor");return i(),o("div",Iv,[e("div",Uv,[e("div",Dv,[e("div",Av,[C(m,{frames:t.defaultAnimation,width:32,height:32},null,8,["frames"])]),e("div",Pv,[u(e("input",{class:F(["input is-small avatar-slot-definition-editor-title-input",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=r=>t.titleFocused=!0),onBlur:s[1]||(s[1]=r=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=r=>t.modelValue.slot=r)},null,34),[[_,t.modelValue.slot]])])]),e("div",Tv,[e("div",Fv,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[3]||(s[3]=r=>t.$emit("moveUp"))})]),e("div",Ev,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[4]||(s[4]=r=>t.$emit("moveDown"))})]),e("div",Mv,[e("span",{class:"button is-small",onClick:s[5]||(s[5]=r=>t.$emit("remove"))},Ov)])])]),e("div",zv,[(i(!0),o(P,null,T(t.modelValue.items,(r,d)=>(i(),E(n,{class:F(["card mb-1",{"is-default":d===this.modelValue.defaultItemIndex}]),key:d,modelValue:r,isDefault:d===this.modelValue.defaultItemIndex,onMoveUp:k=>t.moveItemUp(d),onMoveDown:k=>t.moveItemDown(d),"onUpdate:modelValue":k=>t.updateItem(d,k),onRemove:k=>t.removeItem(d,k),onMakeDefault:k=>t.makeItemDefault(d,k)},null,8,["class","modelValue","isDefault","onMoveUp","onMoveDown","onUpdate:modelValue","onRemove","onMakeDefault"]))),128))]),e("span",{class:"button is-small",onClick:s[6]||(s[6]=(...r)=>t.addItem&&t.addItem(...r))},"Add item")])}var qv=A(Sv,[["render",Rv]]);const Nv=D({props:{modelValue:{type:Object,required:!0},isDefault:{type:Boolean,required:!0}},emits:["update:modelValue","makeDefault","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultState(){return this.modelValue.states.find(({state:t})=>t==="default")}},methods:{updateAnimation(t,s){},makeDefault(){this.$emit("makeDefault",this.modelValue)}}}),Bv={class:"avatar-slot-item-editor p-1"},Jv={class:"level"},Wv={class:"level-left"},Hv={class:"level-item"},Kv={class:"level-item"},Gv={key:0,class:"has-text-success mr-1"},Yv=e("i",{class:"fa fa-check"},null,-1),Xv=p(" Default"),Qv=[Yv,Xv],Zv={class:"level-right"},jv={class:"level-item"},xv={class:"level-item"},t1={class:"level-item"},e1=e("i",{class:"fa fa-trash"},null,-1),s1=[e1];function n1(t,s,a,l,f,y){const m=$("avatar-slot-item-state-editor");return i(),o("div",Bv,[e("div",Jv,[e("div",Wv,[e("div",Hv,[u(e("input",{type:"text",class:F(["input is-small avatar-slot-item-editor-title",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=n=>t.titleFocused=!0),onBlur:s[1]||(s[1]=n=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=n=>t.modelValue.title=n)},null,34),[[_,t.modelValue.title]])]),e("div",Kv,[t.isDefault?(i(),o("span",Gv,Qv)):(i(),o("span",{key:1,class:"button is-small",onClick:s[3]||(s[3]=(...n)=>t.makeDefault&&t.makeDefault(...n))},"Make default"))])]),e("div",Zv,[e("div",jv,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[4]||(s[4]=n=>t.$emit("moveUp"))})]),e("div",xv,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[5]||(s[5]=n=>t.$emit("moveDown"))})]),e("div",t1,[e("span",{class:"button is-small",onClick:s[6]||(s[6]=n=>t.$emit("remove"))},s1)])])]),(i(!0),o(P,null,T(t.modelValue.states,(n,r)=>(i(),E(m,{class:"mr-1",modelValue:n,defaultState:t.defaultState,"onUpdate:modelValue":d=>t.updateAnimation(r,d),key:r},null,8,["modelValue","defaultState","onUpdate:modelValue"]))),128))])}var i1=A(Nv,[["render",n1]]);const o1=D({props:{avatar:{type:Object,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},computed:{animations(){return this.avatar.slotDefinitions.map(t=>{const s=t.items[t.defaultItemIndex];return s?s.states.find(({state:a})=>a==="default"):{title:"",states:[]}})}}});function a1(t,s,a,l,f,y){const m=$("avatar-animation");return i(),o("div",{class:"avatar-preview",style:Y({width:`${t.width}px`,height:`${t.height}px`})},[(i(!0),o(P,null,T(t.animations,(n,r)=>(i(),E(m,{frames:n.frames,key:r,width:t.width,height:t.height},null,8,["frames","width","height"]))),128))],4)}var l1=A(o1,[["render",a1]]);const r1=D({props:{modelValue:{type:Object,required:!0},defaultState:{type:Object,required:!0}},data(){return{editing:!1}},methods:{onDragOver(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDragEnter(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDrop(t){if(t.dataTransfer.getData("avatar-image-url")){t.preventDefault();const s={url:t.dataTransfer.getData("avatar-image-url"),duration:100};this.modelValue.frames.push(s)}},onOverlayClick(){this.editing=!1},imageUploaded(t,s){this.modelValue.frames[t].url=s.urlpath},removeFrame(t){this.modelValue.frames=this.modelValue.frames.filter((s,a)=>a!==t)},addFrame(){const t={url:"",duration:100};this.modelValue.frames.push(t)}}}),d1={class:"avatar-slot-item-state-editor-title"},u1={class:"avatar-animation-frame"},m1={class:"avatar-animation-frame-remove"},c1=["onClick"],h1=e("i",{class:"fa fa-trash"},null,-1),p1=[h1],g1=["src"],f1=["onUpdate:modelValue"],v1={class:"avatar-animation-card mr-1"},_1={class:"avatar-animation-frame"},y1=e("i",{class:"fa fa-plus"},null,-1),b1=[y1];function $1(t,s,a,l,f,y){const m=$("avatar-animation"),n=$("upload");return i(),o("div",{class:"avatar-slot-item-state-editor card",onDragover:s[1]||(s[1]=(...r)=>t.onDragOver&&t.onDragOver(...r)),onDragenter:s[2]||(s[2]=(...r)=>t.onDragEnter&&t.onDragEnter(...r)),onDrop:s[3]||(s[3]=(...r)=>t.onDrop&&t.onDrop(...r))},[e("div",d1,w(t.modelValue.state),1),t.modelValue.frames.length?(i(),E(m,{key:0,frames:t.modelValue.frames},null,8,["frames"])):(i(),E(m,{key:1,frames:t.defaultState.frames,class:"avatar-fallback-animation"},null,8,["frames"])),e("div",null,[(i(!0),o(P,null,T(t.modelValue.frames,(r,d)=>(i(),o("div",{class:"avatar-animation-card mr-1",key:d},[e("span",u1,[e("div",m1,[e("span",{class:"button is-small",onClick:k=>t.removeFrame(d)},p1,8,c1)]),r.url?(i(),o("img",{key:0,src:r.url,width:"64",height:"64"},null,8,g1)):(i(),E(n,{key:1,onUploaded:k=>t.imageUploaded(d,k),accept:"image/*",label:"",class:"avatar-animation-frame-upload"},null,8,["onUploaded"])),u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":k=>r.duration=k},null,8,f1),[[_,r.duration]])])]))),128)),e("div",v1,[e("span",_1,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...r)=>t.addFrame&&t.addFrame(...r))},b1)])])])],32)}var w1=A(r1,[["render",$1]]);const k1=D({props:{frames:{type:Array,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},data(){return{timeout:null,idx:-1}},computed:{src(){return this.idx>=0&&this.idx<this.frames.length?this.frames[this.idx].url:""}},methods:{nextFrame(){if(this.frames.length===0){this.idx=-1;return}this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.idx++,this.idx>=this.frames.length&&(this.idx=0),this.timeout=setTimeout(()=>{this.nextFrame()},this.frames[this.idx].duration)}},created(){this.nextFrame(),this.$watch("frames",()=>{this.idx=-1,this.nextFrame()},{deep:!0})},unmounted(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}),C1=["src","width","height"];function V1(t,s,a,l,f,y){return i(),o("span",{class:"avatar-animation",style:Y({width:`${t.width}px`,height:`${t.width}px`})},[t.src?(i(),o("img",{key:0,src:t.src,width:t.width,height:t.height},null,8,C1)):(i(),o("span",{key:1,style:Y({width:`${t.width}px`,height:`${t.width}px`,display:"inline-block"})},null,4))],4)}var S1=A(k1,[["render",V1]]);const I1=async()=>{const t=qt({history:Nt(),routes:[{name:"index",path:"/",component:oe,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:Ve,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:Wn,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:qr,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:ed,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:Bo,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:cn,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:Io,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:Yl,meta:{title:"Speech to text",protected:!0}},{name:"avatar",path:"/avatar/",component:Cr,meta:{title:"Avatar",protected:!0}},{name:"drawcast",path:"/drawcast/",component:Xs,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:Li,meta:{title:"Settings",protected:!0}}]});W.eventBus.on("login",()=>{Tt.init()}),W.eventBus.on("logout",()=>{Tt.stop()}),await St.init(),await W.init(),t.beforeEach((a,l,f)=>{if(a.meta.protected&&!W.getMe()){f({name:"login"});return}if(!a.meta.protected&&W.getMe()){f({name:"index"});return}l.name&&document.documentElement.classList.remove(`view-${String(l.name)}`),document.documentElement.classList.add(`view-${String(a.name)}`),document.title=`${a.meta.title}`,f()});const s=Bt(Xt);s.use(t),s.use(Jt,{}),s.component("doubleclick-button",au),s.component("dropdown-button",pu),s.component("checkbox",hd),s.component("draggable",Wt),s.component("duration-input",ud),s.component("duration",su),s.component("navbar",Zd),s.component("player",fd),s.component("responsive-image",Fd),s.component("slider",Sd),s.component("upload",ld),s.component("volume-slider",Dd),s.component("youtube",$u),s.component("commands-editor",zh),s.component("command-editor",Ac),s.component("countdown-editor",zp),s.component("trigger-editor",vg),s.component("playlist-editor",sf),s.component("tags-editor",jf),s.component("song-request-settings",Wf),s.component("avatar-editor",Vv),s.component("avatar-slot-definition-editor",qv),s.component("avatar-slot-item-editor",i1),s.component("avatar-preview",l1),s.component("avatar-slot-item-state-editor",w1),s.component("avatar-animation",S1),s.mount("#app")};I1();
