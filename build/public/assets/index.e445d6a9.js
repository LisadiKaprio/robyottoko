import{d as I,r as w,o as l,c as L,u as Xt,a,b as e,e as k,F as D,f as P,t as C,g as p,m as Zt,w as u,v as f,h as X,i as O,j as h,k as F,n as Z,l as E,p as G,q as Q,s as jt,x as pe,y as gt,z as x,A as ge,B as fe,C as ve,D as ye,E as $e}from"./vendor.6f9cbfd8.js";const _e=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))d(g);new MutationObserver(g=>{for(const y of g)if(y.type==="childList")for(const m of y.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&d(m)}).observe(document,{childList:!0,subtree:!0});function n(g){const y={};return g.integrity&&(y.integrity=g.integrity),g.referrerpolicy&&(y.referrerPolicy=g.referrerpolicy),g.crossorigin==="use-credentials"?y.credentials="include":g.crossorigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function d(g){if(g.ep)return;g.ep=!0;const y=n(g);fetch(g.href,y)}};_e();var A=(t,s)=>{const n=t.__vccOpts||t;for(const[d,g]of s)n[d]=g;return n};const be=I({name:"app"});function we(t,s,n,d,g,y){const m=w("router-view");return l(),L(m)}var ke=A(be,[["render",we]]);const ft=async(t,s,n)=>new Promise((d,g)=>{const y=new window.XMLHttpRequest;y.open(t,s,!0),y.withCredentials=!0;const m=n.headers||{};for(const i in m)y.setRequestHeader(i,m[i]);y.addEventListener("load",function(i){d({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),y.addEventListener("error",function(i){g(new Error("xhr error"))}),y.upload&&n.onUploadProgress&&y.upload.addEventListener("progress",function(i){n.onUploadProgress&&n.onUploadProgress(i)}),y.send(n.body)}),j=async(t,s={})=>ft("get",t,s),Ce=async(t,s={})=>ft("post",t,s),xt=async(t,s)=>ft("post",t,{headers:{Accept:"application/json","Content-Type":"application/json"},body:s}),H=async(t,s)=>xt(t,JSON.stringify(s));var q={resendVerificationMail:async t=>H("/api/user/_resend_verification_mail",t),requestPasswordReset:async t=>H("/api/user/_request_password_reset",t),register:async t=>H("/api/user/_register",t),resetPassword:async t=>H("/api/user/_reset_password",t),handleToken:async t=>H("/api/_handle-token",t),saveVariables:async t=>H("/api/save-variables",t),twitchUserIdByName:async t=>H("/api/twitch/user-id-by-name",t),saveUserSettings:async t=>H("/api/save-settings",t),getPageVariablesData:async()=>j("/api/page/variables"),getPageIndexData:async()=>j("/api/page/index"),getPageSettingsData:async()=>j("/api/page/settings"),getDataGlobal:async()=>j("/api/data/global"),getMe:async()=>j("/api/user/me"),logout:async()=>Ce("/api/logout"),login:async t=>H("/api/auth",t),getConf:async()=>j("/api/conf"),upload:async(t,s)=>{const n=new FormData;return n.append("file",t,t.name),ft("post","/api/upload",{body:n,onUploadProgress:s})},importPlaylist:async t=>xt("/api/sr/import",t),getDrawcastAllImages:async()=>j("/api/drawcast/all-images/"),createWidgetUrl:async t=>H("/api/widget/create_url",t)};const Ve=I({data:()=>({widgets:null,toast:Xt()}),async created(){const t=await q.getPageIndexData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.widgets=s.widgets},methods:{async newUrl(t){const s=await q.createWidgetUrl({type:t.type,pub:t.pub});if(s.status===200)try{const n=await s.json();n.url&&(this.widgets=this.widgets.map(d=>(d.type===t.type&&(d.url=n.url),d))),this.toast.success("New URL created")}catch{this.toast.error("New URL couldn't be created")}else this.toast.error("New URL couldn't be created")}}}),Se={key:0,class:"view"},Ue={id:"top",ref:"top"},De={id:"main",ref:"main"},Ie={class:"table is-striped is-fullwidth"},Ae=e("thead",null,[e("tr",null,[e("th",null,"Widget"),e("th",null,"Hint"),e("th")])],-1),Te=["href"],Pe=["onClick"];function Ne(t,s,n,d,g,y){const m=w("navbar");return t.widgets?(l(),a("div",Se,[e("div",Ue,[k(m)],512),e("div",De,[e("table",Ie,[Ae,e("tbody",null,[(l(!0),a(D,null,P(t.widgets,(i,r)=>(l(),a("tr",{key:r},[e("td",null,[e("a",{href:i.url,target:"blank"},C(i.title),9,Te)]),e("td",null,C(i.hint),1),e("td",null,[e("span",{class:"button is-small ml-1",onClick:o=>t.newUrl(i)},"Generate new url",8,Pe)])]))),128))])])],512)])):p("",!0)}var Me=A(Ve,[["render",Ne]]);let ht=null;const at=Zt(),te=()=>localStorage.getItem("darkmode")==="1",Ee=t=>{localStorage.setItem("darkmode",t?"1":"0"),at.emit("darkmode",t)};async function ee(){at.emit("darkmode",te());const t=await q.getMe();ht=t.status===200?await t.json():null,ht&&at.emit("login")}async function Re(){return(await(await q.logout()).json()).success?(ht=null,at.emit("logout"),{error:!1}):{error:"[2021-09-25 18:36]"}}async function Fe(t,s){const n=await q.login({user:t,pass:s});return n.status===200?(await ee(),{error:!1}):n.status===401?{error:(await n.json()).reason}:{error:"Unknown error"}}var B={getMe:()=>ht,isDarkmode:te,setDarkmode:Ee,eventBus:at,logout:Re,login:Fe,init:ee};const se={data:{registeredUserCount:0}},Le=async()=>{try{const s=await(await q.getDataGlobal()).json();se.data.registeredUserCount=s.registeredUserCount}catch(t){console.error(t)}};var vt={getData:()=>se.data,init:Le};const qe=I({data:()=>({user:"",pass:"",error:"",success:"",data:vt.getData()}),async mounted(){const s=new URLSearchParams(window.location.search).get("t");if(s){this.success="",this.error="";const n=await q.handleToken({token:s});n.status===200?(await n.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const t=await B.login(this.user,this.pass);t.error?this.error=t.error:this.$router.push({name:"index"})}}}),Oe={class:"view center-screen mt-2"},ze=e("h1",{class:"title is-4"},"Hyottoko.club",-1),Je={key:0,class:"field has-background-success-light has-text-success-dark"},We={key:1,class:"field has-background-danger-light has-text-danger-dark"},Be={class:"field"},He={class:"control has-icons-left"},Ge=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-user"})],-1),Qe={class:"field"},Ke={class:"control has-icons-left"},Ye=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-lock"})],-1),Xe={class:"field"},Ze={class:"field"},je=h("Register an account"),xe=h(" | "),ts=h("Forgot password?"),es={class:"field has-text-grey-light"};function ss(t,s,n,d,g,y){const m=w("router-link");return l(),a("div",Oe,[ze,e("form",null,[t.success?(l(),a("div",Je,C(t.success),1)):p("",!0),t.error?(l(),a("div",We,C(t.error),1)):p("",!0),e("div",Be,[e("div",He,[u(e("input",{class:"input",type:"text",placeholder:"User","onUpdate:modelValue":s[0]||(s[0]=i=>t.user=i),onKeyup:s[1]||(s[1]=i=>t.error="")},null,544),[[f,t.user]]),Ge])]),e("div",Qe,[e("div",Ke,[u(e("input",{class:"input",type:"password",placeholder:"Password","onUpdate:modelValue":s[2]||(s[2]=i=>t.pass=i),onKeyup:[s[3]||(s[3]=i=>t.error=""),s[4]||(s[4]=X((...i)=>t.submit&&t.submit(...i),["enter"]))]},null,544),[[f,t.pass]]),Ye])]),e("div",Xe,[e("span",{class:"button is-primary is-fullwidth",onClick:s[5]||(s[5]=(...i)=>t.submit&&t.submit(...i))},"Login")]),e("div",Ze,[k(m,{to:{name:"register"}},{default:O(()=>[je]),_:1}),xe,k(m,{to:{name:"forgot-password"}},{default:O(()=>[ts]),_:1})]),e("div",es," There are currently "+C(t.data.registeredUserCount)+" streamers registered \u2728. ",1)])])}var ns=A(qe,[["render",ss]]);const is=1,ot=1e3*is,rt=60*ot,dt=60*rt,ct=24*dt;let lt=[];const ls=t=>{switch(t){case"error":lt=["error"];break;case"info":lt=["error","info"];break;case"log":lt=["error","info","log"];break;case"debug":lt=["error","info","log","debug"];break}};ls("info");const ne=(t,...s)=>{const n=t,d=g=>(...y)=>{lt.includes(g)&&console[g](os("hh:mm:ss",new Date),`[${n}]`,...s,...y)};return{log:d("log"),info:d("info"),debug:d("debug"),error:d("error")}},as=t=>[...t].length,os=(t,s)=>t.replace(/(hh|mm|ss)/g,(n,d)=>{switch(d){case"hh":return mt(s.getHours(),"00");case"mm":return mt(s.getMinutes(),"00");case"ss":return mt(s.getSeconds(),"00");default:return n}}),mt=(t,s)=>{const n=`${t}`;return n.length>=s.length?n:s.substr(0,s.length-n.length)+n};function N(t){let s="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let d=0;d<t;d++)s+=n.charAt(Math.floor(Math.random()*n.length));return s}const bt=(t,s=!1)=>{if(t==="")throw new Error("unable to parse duration");const n=`${t}`.trim();if(!n)throw new Error("unable to parse duration");const d=_=>{if(_<0&&!s)throw new Error("negative value not allowed");return _};if(n.match(/^-?\d+$/))return d(parseInt(n,10));const g=n.match(/^(-?(?:\d*)\.(?:\d*))(d|h|m|s)$/);if(g){const _=parseFloat(g[1]);if(isNaN(_))throw new Error("unable to parse duration");const $=g[2];let v=0;return $==="d"?v=_*ct:$==="h"?v=_*dt:$==="m"?v=_*rt:$==="s"&&(v=_*ot),d(Math.round(v))}const y=n.match(/^(-?)(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!y)throw new Error("unable to parse duration");const m=y[1]?-1:1,i=y[2]?parseInt(y[2],10):0,r=y[3]?parseInt(y[3],10):0,o=y[4]?parseInt(y[4],10):0,c=y[5]?parseInt(y[5],10):0,b=y[6]?parseInt(y[6],10):0;return d(m*(c*ot+o*rt+r*dt+i*ct+b))},rs=(t,s=!1)=>{try{return bt(t,s)}catch{return 0}},ds=(t,s=["ms","s","m","h","d"])=>{let n=t;const d=Math.floor(n/ct);n=n%ct;const g=Math.floor(n/dt);n=n%dt;const y=Math.floor(n/rt);n=n%rt;const m=Math.floor(n/ot);n=n%ot;const r=[n,m,y,g,d];let o=0;for(;o<r.length&&r[o]===0;)o++;let c=r.length-1;for(;c>=0&&r[c]===0;)c--;const b=[];for(let _=o;_<=c;_++)b.unshift(`${r[_]}${s[_]}`);return b.join(" ")};function us(t,s,n){if(n>=t.length){let d=n-t.length+1;for(;d--;)t.push(void 0)}return t.splice(n,0,t.splice(s,1)[0]),t}const yt=(t,s,n)=>{if(s===n||s<0||s>t.length-1||n<0||n>t.length-1)return!1;const d=t[s];return t[s]=t[n],t[n]=d,!0},ms=(t,s)=>{const n=[/\$args(?:\((\d*)(:?)(\d*)\))?/g,/\$rand\(\s*(\d+)?\s*,\s*?(\d+)?\s*\)/g,/\$var\(([^)]+)\)/g,/\$bot\.(version|date|website|github|features)/g,/\$user(?:\(([^)]+)\)|())\.(name|profile_image_url|recent_clip_url|last_stream_category)/g,/\$customapi\(([^$)]*)\)\['([A-Za-z0-9_ -]+)'\]/g,/\$customapi\(([^$)]*)\)/g,/\$urlencode\(([^$)]*)\)/g,/\$calc\((\d+)([*/+-])(\d+)\)/g];let d=t,g;do{g=d;for(const y of n)d=d.replace(y,s)}while(g!==d);return d},hs=(t,s=",",n=-1)=>{const d=t.split(s);return n===-1||d.length<=n?d:[...d.slice(0,n-1),d.slice(n-1).join(s)]},cs=t=>{let s=t.length;for(;s>0;){const n=Math.floor(Math.random()*s);s--;const d=t[s];t[s]=t[n],t[n]=d}return t};function ie(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath}}function le(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath,volume:100}}const ps=(t,s="pt")=>{const n=`${t}`;return n.match(/^\d+$/)?`${n}${s}`:n};var Y={unicodeLength:as,arrayMove:us,arraySwap:yt,humanDuration:ds,parseHumanDuration:rs,mustParseHumanDuration:bt,doDummyReplacements:ms,split:hs,shuffle:cs,pad:mt,mediaFileFromUploadedFile:ie,soundMediaFileFromUploadedFile:le,toNumberUnitString:ps};const gs=t=>t?{file:t.file,filename:t.filename,urlpath:!t.urlpath&&t.file?`/uploads/${encodeURIComponent(t.file)}`:t.urlpath}:null,fs=t=>t?{file:t.file,filename:t.filename,urlpath:!t.urlpath&&t.file?`/uploads/${encodeURIComponent(t.file)}`:t.urlpath,volume:t.volume}:null,Jt=(t=null)=>({submitButtonText:!t||typeof t.submitButtonText=="undefined"?"Submit":t.submitButtonText,submitConfirm:!t||typeof t.submitConfirm=="undefined"?"":t.submitConfirm,recentImagesTitle:!t||typeof t.recentImagesTitle=="undefined"?"":t.recentImagesTitle,canvasWidth:!t||typeof t.canvasWidth=="undefined"?720:t.canvasWidth,canvasHeight:!t||typeof t.canvasHeight=="undefined"?405:t.canvasHeight,customDescription:!t||typeof t.customDescription=="undefined"?"":t.customDescription,customProfileImage:!t||typeof t.customProfileImage=="undefined"?null:gs(t.customProfileImage),palette:!t||typeof t.palette=="undefined"?["#000000","#808080","#ff0000","#ff8000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff8080","#80ff80","#ffffff","#c0c0c0","#800000","#804000","#808000","#008000","#008080","#000080","#800080","#8080ff","#ffff80"]:t.palette,displayDuration:!t||typeof t.displayDuration=="undefined"?5e3:t.displayDuration,displayLatestForever:!t||typeof t.displayLatestForever=="undefined"?!1:t.displayLatestForever,displayLatestAutomatically:!t||typeof t.displayLatestAutomatically=="undefined"?!1:t.displayLatestAutomatically,autofillLatest:!t||typeof t.autofillLatest=="undefined"?!1:t.autofillLatest,notificationSound:!t||typeof t.notificationSound=="undefined"?null:fs(t.notificationSound),requireManualApproval:!t||typeof t.requireManualApproval=="undefined"?!1:t.requireManualApproval,favoriteLists:!t||typeof t.favoriteLists=="undefined"?[{list:t&&t.favorites?t.favorites:[],title:t&&t.favoriteImagesTitle?t.favoriteImagesTitle:""}]:t.favoriteLists});let ae=null;const vs=async()=>{const t=await q.getConf();ae=t.status===200?await t.json():null};var oe={init:vs,getConf:()=>ae};const ys=1001,Wt=4e3,Bt=ne("WsWrapper.ts");class $s{constructor(s,n){this.handle=null,this.reconnectTimeout=null,this.sendBuffer=[],this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{},this.addr=s,this.protocols=n}send(s){this.handle?this.handle.send(s):this.sendBuffer.push(s)}connect(){const s=new WebSocket(this.addr,this.protocols);s.onopen=n=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=s;this.sendBuffer.length>0;){const d=this.sendBuffer.shift();d&&this.handle.send(d)}this.onopen(n)},s.onmessage=n=>{this.onmessage(n)},s.onclose=n=>{this.handle=null,n.code===Wt?Bt.info("custom disconnect, will not reconnect"):n.code===ys?Bt.info("going away, will not reconnect"):this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3),this.onclose(n)}}disconnect(){this.handle&&this.handle.close(Wt)}}const Ht=ne("WsClient.ts");class _s extends $s{constructor(s,n){super(s,n);this._on={},this.onopen=d=>{this._dispatch("socket","open",d)},this.onmessage=d=>{if(this._dispatch("socket","message",d),this._on.message){const g=this._parseMessageData(d.data);g.event&&this._dispatch("message",`${g.event}`,g.data,g)}},this.onclose=d=>{this._dispatch("socket","close",d)}}onSocket(s,n){this.addEventListener("socket",s,n)}onMessage(s,n){this.addEventListener("message",s,n)}addEventListener(s,n,d){const g=Array.isArray(n)?n:[n];this._on[s]=this._on[s]||{};for(const y of g)this._on[s][y]=this._on[s][y]||[],this._on[s][y].push(d)}_parseMessageData(s){try{const n=JSON.parse(s);if(n.event)return n.data=n.data||null,n}catch(n){Ht.info(n)}return{event:null,data:null}}_dispatch(s,n,...d){const y=(this._on[s]||{})[n]||[];if(y.length!==0){Ht.log(`ws dispatch ${s} ${n}`);for(const m of y)m(...d)}}}const bs=t=>{const s=oe.getConf(),n=B.getMe();return new _s(`${s.wsBase}/${t}`,n?n.token:"")};var et={wsClient:bs};const ws=I({data:()=>({unchangedJson:"{}",changedJson:"{}",inited:!1,settings:Jt(),defaultSettings:Jt(),ws:null,drawUrl:"",notificationSoundAudio:null,manualApproval:{hovered:"",items:[]},favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}},controlWidgetUrl:"",receiveWidgetUrl:""}),async created(){this.ws=et.wsClient("drawcast"),this.ws.onMessage("init",async t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.drawUrl=t.drawUrl,this.controlWidgetUrl=t.controlWidgetUrl,this.receiveWidgetUrl=t.receiveWidgetUrl;const n=await(await q.getDrawcastAllImages()).json();this.favoriteSelection.items=n.map(d=>d.path),this.settings.notificationSound&&(this.notificationSoundAudio=new Audio(this.settings.notificationSound.urlpath),this.notificationSoundAudio.volume=this.settings.notificationSound.volume/100),this.manualApproval.items=n.filter(d=>!d.approved).map(d=>d.path),this.inited=!0}),this.ws.onMessage("approved_image_received",t=>{this.favoriteSelection.items=this.favoriteSelection.items.filter(s=>s!==t.img),this.manualApproval.items=this.manualApproval.items.filter(s=>s!==t.img),this.favoriteSelection.items.unshift(t.img),this.favoriteSelection.items=this.favoriteSelection.items.slice()}),this.ws.onMessage("denied_image_received",t=>{this.favoriteSelection.items=this.favoriteSelection.items.filter(s=>s!==t.img),this.manualApproval.items=this.manualApproval.items.filter(s=>s!==t.img)}),this.ws.onMessage("image_received",t=>{this.favoriteSelection.items=this.favoriteSelection.items.filter(s=>s!==t.img),this.manualApproval.items=this.manualApproval.items.filter(s=>s!==t.img),this.favoriteSelection.items.unshift(t.img),this.favoriteSelection.items=this.favoriteSelection.items.slice(),this.manualApproval.items.push(t.img),this.manualApproval.items=this.manualApproval.items.slice(),t.mayNotify&&this.notificationSoundAudio&&this.notificationSoundAudio.play()}),this.ws.connect()},watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage===0?0:1)},currentFavoriteSelectionItems(){const t=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(t,t+this.favoriteSelection.pagination.perPage)}},methods:{approveImage(t){this.sendMsg({event:"approve_image",path:t})},denyImage(t){this.sendMsg({event:"deny_image",path:t})},addFavoriteList(){if(!this.settings){console.warn("addFavoriteList: this.settings not initialized");return}this.settings.favoriteLists.push({list:[],title:""})},moveFavoriteListUp(t){this.swapItems(t-1,t)},moveFavoriteListDown(t){this.swapItems(t+1,t)},swapItems(t,s){yt(this.settings.favoriteLists,t,s)},removeFavoriteList(t){if(!this.settings){console.warn("removeFavoriteList: this.settings not initialized");return}const s=[];for(let n in this.settings.favoriteLists)parseInt(n,10)!==parseInt(`${t}`,10)&&s.push(this.settings.favoriteLists[n]);this.settings.favoriteLists=s},toggleFavorite(t,s){if(!this.settings){console.warn("toggleFavorite: this.settings not initialized");return}this.settings.favoriteLists[t].list.includes(s)?this.settings.favoriteLists[t].list=this.settings.favoriteLists[t].list.filter(n=>n!==s):this.settings.favoriteLists[t].list.push(s)},customProfileImageChanged(t){if(!this.settings){console.warn("customProfileImageChanged: this.settings not initialized");return}this.settings.customProfileImage=t.file?t:null},notificationSoundChanged(t){if(!this.settings){console.warn("notificationSoundChanged: this.settings not initialized");return}this.settings.notificationSound=t.file?t:null},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:{canvasWidth:parseInt(`${this.settings.canvasWidth}`,10)||720,canvasHeight:parseInt(`${this.settings.canvasHeight}`,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,recentImagesTitle:this.settings.recentImagesTitle,customDescription:this.settings.customDescription,customProfileImage:this.settings.customProfileImage,palette:this.settings.palette,displayDuration:parseInt(`${this.settings.displayDuration}`,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,autofillLatest:this.settings.autofillLatest,requireManualApproval:this.settings.requireManualApproval,notificationSound:this.settings.notificationSound,favoriteLists:this.settings.favoriteLists}})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},unmounted(){this.ws&&this.ws.disconnect()}}),ks={class:"view"},Cs={id:"top",ref:"top"},Vs={id:"actionbar",class:"p-1"},Ss=["disabled"],Us=["href"],Ds=["href"],Is={id:"main",ref:"main"},As={key:0,class:"table is-striped",ref:"table"},Ts=e("tr",null,[e("td",{colspan:"3"},"General")],-1),Ps=e("td",null,[e("code",null,"settings.canvasWidth")],-1),Ns=e("td",null,[h(" Width of the drawing area."),e("br"),h(" Caution: changing this will clear the area for currenty connected users. ")],-1),Ms=e("td",null,[e("code",null,"settings.canvasHeight")],-1),Es=e("td",null,[h(" Height of the drawing area."),e("br"),h(" Caution: changing this will clear the area for currenty connected users. ")],-1),Rs=e("td",null,[e("code",null,"settings.displayDuration")],-1),Fs=e("td",null," The duration in Milliseconds that each drawing will be shown ",-1),Ls=e("td",null,[e("code",null,"settings.requireManualApproval")],-1),qs=e("td",null," If checked, new drawings need to be approved before being displayed for anyone. ",-1),Os=h(" Pending approval "),zs=e("br",null,null,-1),Js=["href"],Ws={key:0},Bs={class:"card-body"},Hs=["src"],Gs={class:"card-footer"},Qs=["onClick"],Ks=["onClick"],Ys={key:1},Xs=e("td",null,null,-1),Zs=e("td",null,[e("code",null,"settings.displayLatestForever")],-1),js=e("td",null,"If checked, the latest drawing will be shown indefinately.",-1),xs=e("td",null,[e("code",null,"settings.displayLatestAutomatically")],-1),tn=e("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),en=e("td",null,[e("code",null,"settings.autofillLatest")],-1),sn=e("td",null," Fill the latest submitted drawing into the draw panel when opening the draw page. ",-1),nn=e("td",null,[e("code",null,"settings.submitButtonText")],-1),ln=e("td",null,null,-1),an=e("td",null,[e("code",null,"settings.submitConfirm")],-1),on=e("td",null," Leave empty if no confirm is required by user before sending. ",-1),rn=e("td",null,[e("code",null,"settings.recentImagesTitle")],-1),dn=e("td",null,"Title for the recently submitted images gallery.",-1),un=e("td",null,[e("code",null,"settings.customDescription")],-1),mn=e("td",null,"Description text below the drawing panel.",-1),hn=e("td",null,[e("code",null,"settings.customProfileImage")],-1),cn=e("td",null,[h(" Profile image that will be displayed next to the "),e("code",null,"settings.customDescription"),h(". ")],-1),pn=e("td",null,[e("code",null,"settings.palette")],-1),gn=["onUpdate:modelValue"],fn=e("br",null,null,-1),vn=e("br",null,null,-1),yn=e("td",null,[h(" Default colors appearing on the draw page."),e("br"),h(" Caution: Changing this will change selected color for currenty connected users. ")],-1),$n=e("td",null,[e("code",null,"settings.notificationSound")],-1),_n=e("td",null,[h(" Add a sound here that plays when new drawings arrive. "),e("br"),h(" This is played in this window, if approval is necessary, otherwise it will play in the display widget. It won't play in the draw widget. ")],-1),bn=e("div",null,[e("code",null,"settings.favoriteLists")],-1),wn={class:"preview"},kn=["src"],Cn={key:0},Vn=["onClick"],Sn=e("i",{class:"fa fa-chevron-up"},null,-1),Un=[Sn],Dn=["onClick"],In=e("i",{class:"fa fa-chevron-down"},null,-1),An=[In],Tn=["onClick"],Pn=e("i",{class:"fa fa-trash"},null,-1),Nn=[Pn],Mn=e("td",null,"Title:",-1),En=["onUpdate:modelValue"],Rn=e("td",null,"Currently selected favorites:",-1),Fn={class:"favorites"},Ln=["src","onClick","onMouseover"],qn=e("td",null,"Select favorites:",-1),On={class:"favorites-select"},zn=["src","onClick","onMouseover"],Jn=["disabled"],Wn=["disabled"],Bn=e("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function Hn(t,s,n,d,g,y){const m=w("navbar"),i=w("image-upload"),r=w("sound-upload");return l(),a("div",ks,[e("div",Cs,[k(m),e("div",Vs,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...o)=>t.sendSave&&t.sendSave(...o))}," Save ",8,Ss),e("a",{class:"button is-small mr-1",href:t.receiveWidgetUrl,target:"_blank"},"Open widget",8,Us),e("a",{class:"button is-small",href:t.drawUrl,target:"_blank"},"Open draw",8,Ds)])],512),e("div",Is,[t.inited?(l(),a("table",As,[e("tbody",null,[Ts,e("tr",null,[Ps,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>t.settings.canvasWidth=o)},null,512),[[f,t.settings.canvasWidth]])]),Ns]),e("tr",null,[Ms,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>t.settings.canvasHeight=o)},null,512),[[f,t.settings.canvasHeight]])]),Es]),e("tr",null,[Rs,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.settings.displayDuration=o)},null,512),[[f,t.settings.displayDuration]])]),Fs]),e("tr",null,[Ls,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>t.settings.requireManualApproval=o)},null,512),[[F,t.settings.requireManualApproval]])]),qs]),e("tr",null,[e("td",null,[Os,zs,e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open in separate tab",8,Js)]),e("td",null,[t.manualApproval.items.length?(l(),a("div",Ws,[(l(!0),a(D,null,P(t.manualApproval.items,(o,c)=>(l(),a("div",{class:"image-to-approve card mr-1",key:c},[e("div",Bs,[e("img",{src:o,width:"250",class:"thumbnail mr-1"},null,8,Hs)]),e("div",Gs,[e("span",{class:"card-footer-item button is-small is-success is-light",onClick:b=>t.approveImage(o)}," Approve! ",8,Qs),e("span",{class:"card-footer-item button is-small is-danger is-light",onClick:b=>t.denyImage(o)}," Deny! ",8,Ks)])]))),128))])):(l(),a("div",Ys," Currently there are no drawings awaiting approval. "))]),Xs]),e("tr",null,[Zs,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=o=>t.settings.displayLatestForever=o)},null,512),[[F,t.settings.displayLatestForever]])]),js]),e("tr",null,[xs,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=o=>t.settings.displayLatestAutomatically=o)},null,512),[[F,t.settings.displayLatestAutomatically]])]),tn]),e("tr",null,[en,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=o=>t.settings.autofillLatest=o)},null,512),[[F,t.settings.autofillLatest]])]),sn]),e("tr",null,[nn,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[8]||(s[8]=o=>t.settings.submitButtonText=o)},null,512),[[f,t.settings.submitButtonText]])]),ln]),e("tr",null,[an,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=o=>t.settings.submitConfirm=o)},null,512),[[f,t.settings.submitConfirm]])]),on]),e("tr",null,[rn,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[10]||(s[10]=o=>t.settings.recentImagesTitle=o)},null,512),[[f,t.settings.recentImagesTitle]])]),dn]),e("tr",null,[un,e("td",null,[u(e("textarea",{class:"textarea","onUpdate:modelValue":s[11]||(s[11]=o=>t.settings.customDescription=o)},null,512),[[f,t.settings.customDescription]])]),mn]),e("tr",null,[hn,e("td",null,[k(i,{modelValue:t.settings.customProfileImage,"onUpdate:modelValue":[s[12]||(s[12]=o=>t.settings.customProfileImage=o),t.customProfileImageChanged],width:"100px",height:"50px",class:"spacerow media-holder"},null,8,["modelValue","onUpdate:modelValue"])]),cn]),e("tr",null,[pn,e("td",null,[(l(!0),a(D,null,P(t.settings.palette,(o,c)=>(l(),a("label",{class:"square",key:c},[u(e("input",{type:"color","onUpdate:modelValue":b=>t.settings.palette[c]=b},null,8,gn),[[f,t.settings.palette[c]]]),e("span",{class:"square-inner",style:Z({backgroundColor:o})},null,4)]))),128)),fn,vn,e("button",{class:"button is-small",onClick:s[13]||(s[13]=o=>t.settings.palette=t.defaultSettings.palette)}," Reset to default palette ")]),yn]),e("tr",null,[$n,e("td",null,[k(r,{modelValue:t.settings.notificationSound,"onUpdate:modelValue":[s[14]||(s[14]=o=>t.settings.notificationSound=o),t.notificationSoundChanged],class:"spacerow media-holder"},null,8,["modelValue","onUpdate:modelValue"])]),_n]),e("tr",null,[e("td",null,[bn,e("div",null,[e("span",{class:"button is-small",onClick:s[15]||(s[15]=(...o)=>t.addFavoriteList&&t.addFavoriteList(...o))},"Add a list")]),e("div",wn,[t.favoriteSelection.hovered?(l(),a("img",{key:0,src:t.favoriteSelection.hovered},null,8,kn)):p("",!0)])]),e("td",null,[(l(!0),a(D,null,P(t.settings.favoriteLists,(o,c)=>(l(),a("div",{class:"card p-2 mb-2",key:c},[t.settings.favoriteLists.length>1?(l(),a("div",Cn,[e("span",{class:E(["button is-small ml-1",{"is-disabled":c>0}]),onClick:b=>t.moveFavoriteListUp(c)},Un,10,Vn),e("span",{class:E(["button is-small ml-1",{"is-disabled":c<t.settings.favoriteLists.length-1}]),onClick:b=>t.moveFavoriteListDown(c)},An,10,Dn),e("span",{class:"button is-small ml-1",onClick:b=>t.removeFavoriteList(c)},Nn,8,Tn)])):p("",!0),e("table",null,[e("tr",null,[Mn,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":b=>o.title=b},null,8,En),[[f,o.title]])])]),e("tr",null,[Rn,e("td",null,[e("div",Fn,[(l(!0),a(D,null,P(o.list,(b,_)=>(l(),a("img",{src:b,key:_,width:"50",height:"50",onClick:$=>t.toggleFavorite(c,b),onMouseover:$=>t.favoriteSelection.hovered=b,onMouseleave:s[16]||(s[16]=$=>t.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,Ln))),128))])])]),e("tr",null,[qn,e("td",null,[e("div",On,[(l(!0),a(D,null,P(t.currentFavoriteSelectionItems,(b,_)=>(l(),a("img",{src:b,key:_,width:"50",height:"50",onClick:$=>t.toggleFavorite(c,b),onMouseover:$=>t.favoriteSelection.hovered=b,onMouseleave:s[17]||(s[17]=$=>t.favoriteSelection.hovered=""),class:E(["thumbnail mr-1",{"is-favorited":o.list.includes(b)}])},null,42,zn))),128))]),e("span",{class:"button is-small mr-1",onClick:s[18]||(s[18]=b=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page-1),disabled:t.favoriteSelection.pagination.page>1?null:!0},"Prev",8,Jn),e("span",{class:"button is-small",onClick:s[19]||(s[19]=b=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page+1),disabled:t.favoriteSelection.pagination.page<t.favoriteSelectionTotalPages?null:!0},"Next",8,Wn)])])])]))),128))]),Bn])])],512)):p("",!0)],512)])}var Gn=A(ws,[["render",Hn]]);const Qn=I({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(t){this.variables=this.variables.filter((s,n)=>n!==t)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await q.saveVariables({variables:this.variables}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await q.getPageVariablesData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.variables=s.variables,this.setUnchanged()}}),Kn={class:"view"},Yn={id:"top",ref:"top"},Xn={id:"actionbar",class:"p-1"},Zn=["disabled"],jn={id:"main"},xn={class:"mb-4"},ti=e("h1",{class:"title mb-2"},"Global Variables",-1),ei=e("div",{class:"help"},[h(" Variables can be used from commands with "),e("code",null,"$var(variable_name)"),h(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),si={class:"table is-striped"},ni=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Value"),e("th")])],-1),ii=["onUpdate:modelValue"],li=["onUpdate:modelValue"],ai=e("i",{class:"fa fa-trash"},null,-1);function oi(t,s,n,d,g,y){const m=w("navbar"),i=w("doubleclick-button");return l(),a("div",Kn,[e("div",Yn,[k(m),e("div",Xn,[e("button",{class:"button is-small",onClick:s[0]||(s[0]=(...r)=>t.onAdd&&t.onAdd(...r))},"Add"),e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[1]||(s[1]=(...r)=>t.sendSave&&t.sendSave(...r))}," Save ",8,Zn)])],512),e("div",jn,[e("div",xn,[ti,ei,e("table",si,[ni,e("tbody",null,[(l(!0),a(D,null,P(t.variables,(r,o)=>(l(),a("tr",{key:o},[e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":c=>r.name=c},null,8,ii),[[f,r.name]])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":c=>r.value=c},null,8,li),[[f,r.value]])]),e("td",null,[k(i,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:c=>t.remove(o)},{default:O(()=>[ai]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var ri=A(Qn,[["render",oi]]);const di=I({data:()=>({user:"",pass:"",email:"",error:"",success:!1,data:vt.getData()}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const t=await q.resendVerificationMail({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const t=await q.register({user:this.user,pass:this.pass,email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),ui={class:"view center-screen mt-2"},mi=e("h1",{class:"title is-4"},"Hyottoko.club",-1),hi={key:0,class:"field has-background-success-light has-text-success-dark"},ci=h(" Account registered. Please check your mail. Click "),pi=h("here"),gi=h(" to login. "),fi={key:1},vi={key:0,class:"field has-background-danger-light has-text-danger-dark"},yi={key:0},$i=h(" A user with this email is already registered. "),_i=e("br",null,null,-1),bi=h("Request a password reset."),wi={key:1},ki=h(" A user with this email is already registered. "),Ci=e("br",null,null,-1),Vi={key:2},Si={key:3},Ui={key:4},Di={class:"field"},Ii={class:"control has-icons-left"},Ai=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-user"})],-1),Ti={class:"field"},Pi={class:"control has-icons-left"},Ni=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-envelope"})],-1),Mi={class:"field"},Ei={class:"control has-icons-left"},Ri=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-lock"})],-1),Fi={class:"field"},Li=["disabled"],qi={class:"field"},Oi=h(" Already have an account? "),zi=h("Login!"),Ji={class:"field has-text-grey-light"};function Wi(t,s,n,d,g,y){const m=w("router-link");return l(),a("div",ui,[mi,t.success?(l(),a("div",hi,[ci,k(m,{to:{name:"login"}},{default:O(()=>[pi]),_:1}),gi])):(l(),a("div",fi,[t.error?(l(),a("div",vi,[t.error==="verified_mail_already_exists"?(l(),a("div",yi,[$i,_i,k(m,{to:{name:"forgot-password"}},{default:O(()=>[bi]),_:1})])):t.error==="unverified_mail_already_exists"?(l(),a("div",wi,[ki,Ci,e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...i)=>t.onRequestVerificationEmail&&t.onRequestVerificationEmail(...i))},"Resend verification email")])):t.error==="verified_name_already_exists"?(l(),a("div",Vi," A user with this name is already registered. ")):t.error==="unverified_name_already_exists"?(l(),a("div",Si," A user with this name is already registered. ")):(l(),a("span",Ui,C(t.error),1))])):p("",!0),e("div",Di,[e("div",Ii,[u(e("input",{class:"input",type:"text",placeholder:"User","onUpdate:modelValue":[s[1]||(s[1]=i=>t.user=i),s[2]||(s[2]=i=>t.error="")]},null,512),[[f,t.user]]),Ai])]),e("div",Ti,[e("div",Pi,[u(e("input",{class:"input",type:"email",placeholder:"Email","onUpdate:modelValue":[s[3]||(s[3]=i=>t.email=i),s[4]||(s[4]=i=>t.error="")]},null,512),[[f,t.email]]),Ni])]),e("div",Mi,[e("div",Ei,[u(e("input",{class:"input",type:"password",placeholder:"Password","onUpdate:modelValue":[s[5]||(s[5]=i=>t.pass=i),s[6]||(s[6]=i=>t.error="")],onKeyup:s[7]||(s[7]=X((...i)=>t.submit&&t.submit(...i),["enter"]))},null,544),[[f,t.pass]]),Ri])]),e("div",Fi,[e("button",{class:"button is-primary is-fullwidth",disabled:t.canRegister?null:!0,onClick:s[8]||(s[8]=(...i)=>t.submit&&t.submit(...i))}," Register ",8,Li)]),e("div",qi,[Oi,k(m,{to:{name:"login"}},{default:O(()=>[zi]),_:1})]),e("div",Ji," There are currently "+C(t.data.registeredUserCount)+" streamers registered \u2728. ",1)]))])}var Bi=A(di,[["render",Wi]]);const Hi=I({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[],tmi_identity_client_id:"",tmi_identity_client_secret:""},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const t=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],s=document.location,n=`${s.protocol}//${s.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${n}&scope=${t.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(t){this.twitch_channels=this.twitch_channels.filter((s,n)=>n!==t)},addchannel(){this.twitch_channels.push({user_id:this.user.id,bot_status_messages:1,channel_id:"",channel_name:"",access_token:""})},async loadid(t){this.twitch_channels[t].channel_id=await this.getTwitchUserIdByName(this.twitch_channels[t].channel_name)},async getTwitchUserIdByName(t){const s={name:t,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},n=await q.twitchUserIdByName(s);try{return`${(await n.json()).id}`}catch{return""}},async sendSave(){await q.saveUserSettings({user:this.user,twitch_channels:this.twitch_channels}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await q.getPageSettingsData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.user=s.user,this.twitch_channels=s.twitchChannels,this.setUnchanged()}}),Gi={class:"view"},Qi={id:"top",ref:"top"},Ki={id:"actionbar",class:"p-1"},Yi=["disabled"],Xi={id:"main"},Zi={class:"mb-4"},ji=e("h1",{class:"title mb-2"},"User",-1),xi={class:"table is-striped"},tl=e("td",null,"Name:",-1),el=e("td",null,"Email:",-1),sl=e("td",null,"Password:",-1),nl={key:0,class:"mb-4"},il=e("h1",{class:"title mb-2"},"Twitch-Bot",-1),ll=e("p",null,[h(" Please refer to "),e("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),h(". ")],-1),al={class:"table is-striped"},ol=e("td",null,"Bot name:",-1),rl=e("td",null,"Bot oauth (pass):",-1),dl=e("td",null,"Bot client_id:",-1),ul=e("td",null,"Bot client_secret:",-1),ml={class:"mb-4"},hl=e("h1",{class:"title mb-2"},"Twitch Channels",-1),cl=h(" List of twitch channels where the bot will connect to. "),pl={key:0},gl={key:0,class:"table is-striped"},fl=e("thead",null,[e("tr",null,[e("td",null,"Channel name"),e("td",null,"Chat status updates"),e("td",null,"Channel id*"),e("td",null,"Access Token*"),e("td")])],-1),vl=["onUpdate:modelValue"],yl=["onUpdate:modelValue"],$l=["onClick"],_l=["onUpdate:modelValue"],bl=["onClick"],wl=e("i",{class:"fa fa-remove"},null,-1),kl=[wl],Cl={key:1,class:"content"},Vl=e("p",null," Channel Id* and Access Token*: You may not need the client id or access token. They are required for channel point reward redemption triggers only. ",-1),Sl={key:0},Ul={key:1,class:"list"},Dl=e("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Il={class:"list-item"},Al=h(" Click "),Tl=["href"],Pl=h(" to authorize the bot with the channel "),Nl=e("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),Ml={key:2};function El(t,s,n,d,g,y){const m=w("navbar"),i=w("checkbox");return l(),a("div",Gi,[e("div",Qi,[k(m),e("div",Ki,[e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[0]||(s[0]=(...r)=>t.sendSave&&t.sendSave(...r))}," Save ",8,Yi)])],512),e("div",Xi,[e("div",Zi,[ji,e("table",xi,[e("tbody",null,[e("tr",null,[tl,e("td",null,C(t.user.name),1)]),e("tr",null,[el,e("td",null,[u(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=r=>t.user.email=r)},null,512),[[f,t.user.email]])])]),e("tr",null,[sl,e("td",null,[u(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=r=>t.user.pass=r)},null,512),[[f,t.user.pass]])])])])])]),t.isAdmin?(l(),a("div",nl,[il,ll,e("table",al,[e("tbody",null,[e("tr",null,[ol,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=r=>t.user.tmi_identity_username=r)},null,512),[[f,t.user.tmi_identity_username]])])]),e("tr",null,[rl,e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[4]||(s[4]=r=>t.user.tmi_identity_password=r)},null,512),[[f,t.user.tmi_identity_password]])])]),e("tr",null,[dl,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=r=>t.user.tmi_identity_client_id=r)},null,512),[[f,t.user.tmi_identity_client_id]])])]),e("tr",null,[ul,e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[6]||(s[6]=r=>t.user.tmi_identity_client_secret=r)},null,512),[[f,t.user.tmi_identity_client_secret]])])])])])])):p("",!0),e("div",ml,[hl,e("p",null,[cl,t.twitch_channels.length===0?(l(),a("span",pl," Currently no channels are configured. ")):p("",!0)]),t.twitch_channels.length>0?(l(),a("table",gl,[fl,e("tbody",null,[(l(!0),a(D,null,P(t.twitch_channels,(r,o)=>(l(),a("tr",{key:o},[e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":c=>r.channel_name=c},null,8,vl),[[f,r.channel_name]])]),e("td",null,[k(i,{class:"is-small",onValue:1,offValue:0,modelValue:r.bot_status_messages,"onUpdate:modelValue":c=>r.bot_status_messages=c},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[r.channel_id?u((l(),a("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":c=>r.channel_id=c},null,8,yl)),[[f,r.channel_id]]):p("",!0),r.channel_id?p("",!0):(l(),a("button",{key:1,class:"button is-small",onClick:c=>t.loadid(o)}," Load id ",8,$l))]),e("td",null,[u(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":c=>r.access_token=c},null,8,_l),[[f,r.access_token]])]),e("td",null,[e("button",{class:"button is-small",onClick:c=>t.rmchannel(o)},kl,8,bl)])]))),128))])])):p("",!0),e("button",{class:"button is-small",onClick:s[7]||(s[7]=r=>t.addchannel())}," Add channel ")]),t.twitch_channels.length>0?(l(),a("div",Cl,[Vl,t.accessTokenLink?(l(),a("p",Sl,"To get an access token, do the following:")):p("",!0),t.accessTokenLink?(l(),a("ol",Ul,[Dl,e("li",Il,[Al,e("a",{href:t.accessTokenLink,target:"_blank"},"here",8,Tl),Pl]),Nl])):t.isAdmin?(l(),a("p",Ml,' To configure an access token, please configure the "Bot client_id" above. ')):p("",!0)])):p("",!0)])])}var Rl=A(Hi,[["render",El]]);const R=["mod","broadcaster"],re=[{value:"broadcaster",label:"Broadcaster"},{value:"mod",label:"Moderators"},{value:"sub",label:"Subscribers"}],Fl=t=>{if(t.length===0)return"Everyone";const s=[];return re.forEach(n=>{t.includes(n.value)&&s.push(n.label)}),s.join(", ")},wt=()=>"",de=()=>({excludeFromGlobalWidget:!1,sound:{filename:"",file:"",urlpath:"",volume:100},image:{filename:"",file:"",urlpath:""},image_url:"",twitch_clip:{url:"",volume:100},minDurationMs:"1s"}),Ll=()=>({type:"delay",value:"1s"}),ql=()=>({type:"text",value:wt()}),Ol=()=>({type:"media",value:de()}),ue=t=>({type:t,data:{command:"",commandExact:!1,minInterval:0,minLines:0,since:"stream"}}),T=(t="",s=!1)=>{const n=ue("command");return n.data.command=t,n.data.commandExact=s,n},zl=t=>{if(t.type==="command")return!!t.data.command;if(t.type==="timer"){try{bt(t.data.minInterval)}catch{return!1}const s=parseInt(`${t.data.minLines}`,10);return!isNaN(s)}return!0},st={add_stream_tags:{Name:()=>"add_stream_tags command",Description:()=>"Add streamtag",NewCommand:()=>({id:N(10),triggers:[T()],action:"add_stream_tags",restrict_to:R,variables:[],variableChanges:[],data:{tag:""}}),RequiresAccessToken:()=>!0},chatters:{Name:()=>"chatters command",Description:()=>"Outputs the people who chatted during the stream.",NewCommand:()=>({id:N(10),triggers:[T()],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},countdown:{Name:()=>"countdown",Description:()=>"Add a countdown or messages spaced by time intervals.",NewCommand:()=>({id:N(10),triggers:[T()],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:{steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}}),RequiresAccessToken:()=>!1},dict_lookup:{Name:()=>"dictionary lookup",Description:()=>"Outputs the translation for the searched word.",NewCommand:()=>({id:N(10),triggers:[T()],action:"dict_lookup",restrict_to:[],variables:[],variableChanges:[],data:{lang:"ja",phrase:""}}),RequiresAccessToken:()=>!1},madochan_createword:{Name:()=>"madochan",Description:()=>"Creates a word for a definition.",NewCommand:()=>({id:N(10),triggers:[T()],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}}),RequiresAccessToken:()=>!1},media:{Name:()=>"media command",Description:()=>"Display an image and/or play a sound.",NewCommand:()=>({id:N(10),triggers:[T()],action:"media",restrict_to:[],variables:[],variableChanges:[],data:de()}),RequiresAccessToken:()=>!1},media_volume:{Name:()=>"media volume command",Description:()=>`Sets the media volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
    <br />
    If no argument is given, just outputs the current volume`,NewCommand:()=>({id:N(10),triggers:[T()],action:"media_volume",restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},text:{Name:()=>"command",Description:()=>"Send a message to chat",NewCommand:()=>({id:N(10),triggers:[T()],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[wt()]}}),RequiresAccessToken:()=>!1},remove_stream_tags:{Name:()=>"remove_stream_tags command",Description:()=>"Remove streamtag",NewCommand:()=>({id:N(10),triggers:[T()],action:"remove_stream_tags",restrict_to:R,variables:[],variableChanges:[],data:{tag:""}}),RequiresAccessToken:()=>!0},set_channel_game_id:{Name:()=>"change stream category command",Description:()=>"Change the stream category",NewCommand:()=>({id:N(10),triggers:[T()],action:"set_channel_game_id",restrict_to:R,variables:[],variableChanges:[],data:{game_id:""}}),RequiresAccessToken:()=>!0},set_channel_title:{Name:()=>"change stream title command",Description:()=>"Change the stream title",NewCommand:()=>({id:N(10),triggers:[T()],action:"set_channel_title",restrict_to:R,variables:[],variableChanges:[],data:{title:""}}),RequiresAccessToken:()=>!0},sr_current:{Name:()=>"sr_current",Description:()=>"Show what song is currently playing",NewCommand:()=>({id:N(10),action:"sr_current",triggers:[T("!sr current",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_undo:{Name:()=>"sr_undo",Description:()=>"Remove the song that was last added by oneself.",NewCommand:()=>({id:N(10),action:"sr_undo",triggers:[T("!sr undo",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_good:{Name:()=>"sr_good",Description:()=>"Vote the current song up",NewCommand:()=>({id:N(10),action:"sr_good",triggers:[T("!sr good",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_bad:{Name:()=>"sr_bad",Description:()=>"Vote the current song down",NewCommand:()=>({id:N(10),action:"sr_bad",triggers:[T("!sr bad",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_stats:{Name:()=>"sr_stats",Description:()=>"Show stats about the playlist",NewCommand:()=>({id:N(10),action:"sr_stats",triggers:[T("!sr stats",!0),T("!sr stat",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_prev:{Name:()=>"sr_prev",Description:()=>"Skip to the previous song",NewCommand:()=>({id:N(10),action:"sr_prev",triggers:[T("!sr prev",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_next:{Name:()=>"sr_next",Description:()=>"Skip to the next song",NewCommand:()=>({id:N(10),action:"sr_next",triggers:[T("!sr next",!0),T("!sr skip",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_jumptonew:{Name:()=>"sr_jumptonew",Description:()=>"Jump to the next unplayed song",NewCommand:()=>({id:N(10),action:"sr_jumptonew",triggers:[T("!sr jumptonew",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_clear:{Name:()=>"sr_clear",Description:()=>"Clear the playlist",NewCommand:()=>({id:N(10),action:"sr_clear",triggers:[T("!sr clear",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_rm:{Name:()=>"sr_rm",Description:()=>"Remove the current song from the playlist",NewCommand:()=>({id:N(10),action:"sr_rm",triggers:[T("!sr rm",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_shuffle:{Name:()=>"sr_shuffle",Description:()=>`Shuffle the playlist (current song unaffected).
    <br />
    Non-played and played songs will be shuffled separately and non-played
    songs will be put after currently playing song.`,NewCommand:()=>({id:N(10),action:"sr_shuffle",triggers:[T("!sr shuffle",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_reset_stats:{Name:()=>"sr_reset_stats",Description:()=>"Reset all statistics of all songs",NewCommand:()=>({id:N(10),action:"sr_reset_stats",triggers:[T("!sr resetStats",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_loop:{Name:()=>"sr_loop",Description:()=>"Loop the current song",NewCommand:()=>({id:N(10),action:"sr_loop",triggers:[T("!sr loop",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_noloop:{Name:()=>"sr_noloop",Description:()=>"Stop looping the current song",NewCommand:()=>({id:N(10),action:"sr_noloop",triggers:[T("!sr noloop",!0),T("!sr unloop",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_pause:{Name:()=>"sr_pause",Description:()=>"Pause currently playing song",NewCommand:()=>({id:N(10),action:"sr_pause",triggers:[T("!sr pause",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_unpause:{Name:()=>"sr_unpause",Description:()=>"Unpause currently paused song",NewCommand:()=>({id:N(10),action:"sr_unpause",triggers:[T("!sr nopause",!0),T("!sr unpause",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_hidevideo:{Name:()=>"sr_hidevideo",Description:()=>"Hide video for current song",NewCommand:()=>({id:N(10),action:"sr_hidevideo",triggers:[T("!sr hidevideo",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_showvideo:{Name:()=>"sr_showvideo",Description:()=>"Show video for current song",NewCommand:()=>({id:N(10),action:"sr_showvideo",triggers:[T("!sr showvideo",!0)],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_request:{Name:()=>"sr_request",Description:()=>`
    Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
    at youtube (by id or by title)
    and queue the first result in the playlist (after the first found
    batch of unplayed songs).`,NewCommand:()=>({id:N(10),action:"sr_request",triggers:[T("!sr")],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_re_request:{Name:()=>"sr_re_request",Description:()=>`
    Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
    in the current playlist and queue the first result in the playlist
    (after the first found batch of unplayed songs).`,NewCommand:()=>({id:N(10),action:"sr_re_request",triggers:[T("!resr")],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_addtag:{Name:()=>"sr_addtag",Description:()=>"Add tag <code>&lt;TAG&gt;</code> (argument to this command) to the current song",NewCommand:()=>({id:N(10),action:"sr_addtag",triggers:[T("!sr tag"),T("!sr addtag")],restrict_to:R,variables:[],variableChanges:[],data:{tag:""}}),RequiresAccessToken:()=>!1},sr_rmtag:{Name:()=>"sr_rmtag",Description:()=>"Remove tag <code>&lt;TAG&gt;</code> (argument to this command) from the current song",NewCommand:()=>({id:N(10),action:"sr_rmtag",triggers:[T("!sr rmtag")],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_volume:{Name:()=>"sr_volume",Description:()=>`Sets the song request volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
    <br />
    If no argument is given, just outputs the current volume`,NewCommand:()=>({id:N(10),action:"sr_volume",triggers:[T("!sr volume")],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_filter:{Name:()=>"sr_filter",Description:()=>`Play only songs with the given tag <code>&lt;TAG&gt;</code> (argument to this command). If no tag
  is given, play all songs.`,NewCommand:()=>({id:N(10),action:"sr_filter",triggers:[T("!sr filter")],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_preset:{Name:()=>"sr_preset",Description:()=>`Switches to the preset <code>&lt;PRESET&gt;</code> (argument to this command) if it exists.
  If no arguments are given, outputs all available presets.`,NewCommand:()=>({id:N(10),action:"sr_preset",triggers:[T("!sr preset")],restrict_to:R,variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1},sr_queue:{Name:()=>"sr_queue",Description:()=>"Shows the next 3 songs that will play.",NewCommand:()=>({id:N(10),action:"sr_queue",triggers:[T("!sr queue")],restrict_to:[],variables:[],variableChanges:[],data:{}}),RequiresAccessToken:()=>!1}},Jl=(t=null)=>({name:(t==null?void 0:t.name)||"",css:(t==null?void 0:t.css)||"",showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}),me=(t=null)=>{var s,n,d,g;return{volume:typeof(t==null?void 0:t.volume)=="undefined"?100:t.volume,initAutoplay:typeof(t==null?void 0:t.initAutoplay)=="undefined"?!0:t.initAutoplay,hideVideoImage:{file:((s=t==null?void 0:t.hideVideoImage)==null?void 0:s.file)||"",filename:((n=t==null?void 0:t.hideVideoImage)==null?void 0:n.filename)||"",urlpath:(d=t==null?void 0:t.hideVideoImage)!=null&&d.urlpath?t.hideVideoImage.urlpath:(g=t==null?void 0:t.hideVideoImage)!=null&&g.file?`/uploads/${encodeURIComponent(t.hideVideoImage.file)}`:""},maxSongLength:{viewer:typeof(t==null?void 0:t.maxSongLength)=="undefined"?0:t==null?void 0:t.maxSongLength.viewer,mod:typeof(t==null?void 0:t.maxSongLength)=="undefined"?0:t==null?void 0:t.maxSongLength.mod,sub:typeof(t==null?void 0:t.maxSongLength)=="undefined"?0:t==null?void 0:t.maxSongLength.sub},maxSongsQueued:{viewer:typeof(t==null?void 0:t.maxSongsQueued)=="undefined"?0:parseInt(t==null?void 0:t.maxSongsQueued.viewer,10),mod:typeof(t==null?void 0:t.maxSongsQueued)=="undefined"?0:parseInt(t==null?void 0:t.maxSongsQueued.mod,10),sub:typeof(t==null?void 0:t.maxSongsQueued)=="undefined"?0:parseInt(t==null?void 0:t.maxSongsQueued.sub,10)},customCss:(t==null?void 0:t.customCss)||"",customCssPresets:typeof(t==null?void 0:t.customCssPresets)=="undefined"?[]:t.customCssPresets.map(Jl),showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}};const Wl=I({data:()=>({playerVisible:!1,playlist:[],commands:[],globalVariables:[],channelPointsCustomRewards:{},settings:me(),filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:"",widgetUrl:"",toast:Xt(),controlDefinitions:[{title:"Reset stats",ctrl:"resetStats",icon:"fa-eraser"},{title:"Clear playlist",ctrl:"clear",icon:"fa-eject"},{title:"Shuffle",ctrl:"shuffle",icon:"fa-random"},{title:"Play",ctrl:"unpause",icon:"fa-play"},{title:"Pause",ctrl:"pause",icon:"fa-pause"},{title:"Prev",ctrl:"prev",icon:"fa-step-backward"},{title:"Next",ctrl:"skip",icon:"fa-step-forward"}],tabDefinitions:[{tab:"playlist",title:"Playlist"},{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"},{tab:"tags",title:"Tags"},{tab:"import",title:"Import/Export"}],possibleActions:["sr_current","sr_undo","sr_good","sr_bad","sr_stats","sr_prev","sr_next","sr_jumptonew","sr_clear","sr_rm","sr_shuffle","sr_reset_stats","sr_loop","sr_noloop","sr_pause","sr_unpause","sr_hidevideo","sr_showvideo","sr_request","sr_re_request","sr_addtag","sr_rmtag","sr_volume","sr_filter","sr_preset","sr_queue"]}),computed:{tags(){const t=[];return this.playlist.forEach(s=>{s.tags.forEach(n=>{const d=t.findIndex(g=>g.value===n);d===-1?t.push({value:n,count:1}):t[d].count++})}),t},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(t=>t.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},exportPlaylistUrl(){return`${location.protocol}//${location.host}/api/sr/export`}},methods:{sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings})},onTagUpdated(t){this.updateTag(t[0],t[1])},onPlaylistCtrl(t){this.sendCtrl(t[0],t[1])},applyFilter(t){this.sendCtrl("filter",[{tag:t}])},async doImportPlaylist(){(await q.importPlaylist(this.importPlaylist)).status===200?(this.tab="playlist",this.toast.success("Import successful")):this.toast.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(t,s){this.sendMsg({event:"ctrl",ctrl:t,args:s})},ended(){this.sendMsg({event:"ended"})},sendMsg(t){this.ws?this.ws.send(JSON.stringify(t)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(t){this.player.setVolume(t)},updateTag(t,s){t!==s&&this.sendCtrl("updatetag",[t,s])}},async mounted(){this.$nextTick(()=>{this.ws=et.wsClient("sr"),this.ws.onMessage("save",t=>{this.settings=t.settings,this.widgetUrl=t.widgetUrl,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards}),this.ws.onMessage(["pause"],t=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],t=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],t=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],t=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","move","tags"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist;const n=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;s!==n&&this.play()}),this.ws.onMessage(["filter"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist,this.filteredPlaylist.find(n=>n.id===s)||this.play()}),this.ws.onMessage(["dislike","like","video","playIdx","resetStats","shuffle"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards,this.filter=t.filter,this.playlist=t.playlist}),this.ws.onMessage(["add","init"],t=>{this.settings=t.settings,this.widgetUrl=t.widgetUrl,this.commands=t.commands,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards,this.filter=t.filter,this.playlist=t.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),it=t=>(G("data-v-14ddc780"),t=t(),Q(),t),Bl={class:"view"},Hl={id:"top",ref:"top"},Gl={id:"actionbar",class:"p-1"},Ql=["disabled","onClick","title"],Kl=["disabled"],Yl=it(()=>e("span",{class:"txt"},"Set all to played",-1)),Xl=[Yl],Zl=["disabled","title"],jl=it(()=>e("i",{class:"fa fa-tv mr-1"},null,-1)),xl={class:"txt"},ta={class:"field has-addons mr-1"},ea={class:"control"},sa=["disabled"],na={class:"control"},ia=["disabled"],la=it(()=>e("i",{class:"fa fa-search mr-1"},null,-1)),aa=h(" from playlist "),oa=[la,aa],ra={class:"field has-addons mr-1"},da={class:"control"},ua=["disabled"],ma={class:"control"},ha=["disabled"],ca=it(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),pa=h(" from YouTube "),ga=[ca,pa],fa=["disabled","href"],va={id:"main",ref:"main"},ya={style:{width:"640px","max-width":"100%"}},$a={class:"tabs"},_a=["onClick"],ba={key:0},wa={class:"mb-1"},ka=["href"],Ca=it(()=>e("i",{class:"fa fa-download mr-1"},null,-1)),Va=h(" Export playlist"),Sa=[Ca,Va],Ua=it(()=>e("i",{class:"fa fa-upload mr-1"},null,-1)),Da=h(" Import playlist "),Ia=[Ua,Da],Aa={key:1,id:"tags"},Ta={key:3,id:"playlist",class:"table-container"};function Pa(t,s,n,d,g,y){const m=w("navbar"),i=w("youtube"),r=w("tags-editor"),o=w("song-request-settings"),c=w("playlist-editor"),b=w("commands-editor");return l(),a("div",Bl,[e("div",Hl,[k(m),e("div",Gl,[(l(!0),a(D,null,P(t.controlDefinitions,(_,$)=>(l(),a("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:v=>t.sendCtrl(_.ctrl,[]),title:_.title,key:$},[e("i",{class:E(["fa",_.icon])},null,2)],8,Ql))),128)),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[0]||(s[0]=_=>t.sendCtrl("setAllToPlayed",[])),title:"Sets all songs to at least 1x played"},Xl,8,Kl),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[1]||(s[1]=(..._)=>t.togglePlayer&&t.togglePlayer(..._)),title:t.togglePlayerButtonText},[jl,e("span",xl,C(t.togglePlayerButtonText),1)],8,Zl),e("div",ta,[e("div",ea,[u(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[2]||(s[2]=_=>t.resrinput=_),onKeyup:s[3]||(s[3]=X((..._)=>t.resr&&t.resr(..._),["enter"]))},null,40,sa),[[f,t.resrinput]])]),e("div",na,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[4]||(s[4]=(..._)=>t.resr&&t.resr(..._))},oa,8,ia)])]),e("div",ra,[e("div",da,[u(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[5]||(s[5]=_=>t.srinput=_),onKeyup:s[6]||(s[6]=X((..._)=>t.sr&&t.sr(..._),["enter"]))},null,40,ua),[[f,t.srinput]])]),e("div",ma,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[7]||(s[7]=(..._)=>t.sr&&t.sr(..._))},ga,8,ha)])]),e("a",{class:"button is-small mr-1",disabled:t.inited?null:!0,href:t.widgetUrl,target:"_blank"},"Open SR widget",8,fa)])],512),e("div",va,[e("div",ya,[e("div",{id:"player",class:"video-16-9",style:Z(t.playerstyle)},[k(i,{ref:"youtube",onEnded:t.ended,visible:t.playerVisible},null,8,["onEnded","visible"])],4)]),e("div",$a,[e("ul",null,[(l(!0),a(D,null,P(t.tabDefinitions,(_,$)=>(l(),a("li",{key:$,class:E({"is-active":t.tab===_.tab}),onClick:v=>t.tab=_.tab},[e("a",null,C(_.title),1)],10,_a))),128))])]),t.inited&&t.tab==="import"?(l(),a("div",ba,[e("div",wa,[e("a",{class:"button is-small mr-1",href:t.exportPlaylistUrl,target:"_blank"},Sa,8,ka),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(..._)=>t.doImportPlaylist&&t.doImportPlaylist(..._))},Ia)]),u(e("textarea",{class:"textarea mb-1","onUpdate:modelValue":s[9]||(s[9]=_=>t.importPlaylist=_)},null,512),[[f,t.importPlaylist]])])):p("",!0),t.inited&&t.tab==="tags"?(l(),a("div",Aa,[k(r,{tags:t.tags,onUpdateTag:t.onTagUpdated},null,8,["tags","onUpdateTag"])])):p("",!0),t.inited&&t.tab==="settings"?(l(),L(o,{key:2,id:"settings",modelValue:t.settings,"onUpdate:modelValue":[s[10]||(s[10]=_=>t.settings=_),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])):p("",!0),t.inited&&t.tab==="playlist"?(l(),a("div",Ta,[k(c,{playlist:t.playlist,filter:t.filter,onStopPlayer:s[11]||(s[11]=_=>t.player.stop()),onFilterChange:t.applyFilter,onCtrl:t.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):p("",!0),t.inited&&t.tab==="commands"?(l(),L(b,{key:4,modelValue:t.commands,"onUpdate:modelValue":[s[12]||(s[12]=_=>t.commands=_),t.sendSave],globalVariables:t.globalVariables,channelPointsCustomRewards:t.channelPointsCustomRewards,possibleActions:t.possibleActions,baseVolume:100},null,8,["modelValue","onUpdate:modelValue","globalVariables","channelPointsCustomRewards","possibleActions"])):p("",!0)],512)])}var Na=A(Wl,[["render",Pa],["__scopeId","data-v-14ddc780"]]);const Ma=()=>({volume:100}),Ea=()=>({showImages:!0,autocommands:[]}),Ra=I({data:()=>({commands:[],settings:Ma(),adminSettings:Ea(),globalVariables:[],channelPointsCustomRewards:{},ws:null,possibleActions:["text","media","media_volume","countdown","dict_lookup","madochan_createword","chatters","set_channel_title","set_channel_game_id","add_stream_tags","remove_stream_tags"],tabDefinitions:[{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"}],inited:!1,tab:"commands",widgetUrl:""}),computed:{baseVolume(){return this.settings.volume}},methods:{updateShowImages(t){this.adminSettings.showImages=t,this.sendSave()},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings,adminSettings:this.adminSettings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=et.wsClient("general"),this.ws.onMessage("init",t=>{this.commands=t.commands,this.settings=t.settings,this.widgetUrl=t.mediaWidgetUrl,this.adminSettings=t.adminSettings,this.globalVariables=t.globalVariables,this.channelPointsCustomRewards=t.channelPointsCustomRewards,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Fa={class:"view"},La={id:"top",ref:"top"},qa={id:"main",ref:"main"},Oa={class:"tabs"},za=["onClick"],Ja=["href"],Wa={key:1},Ba={key:0,class:"table is-striped",ref:"table"},Ha=e("td",null,[e("code",null,"settings.volume")],-1),Ga=e("td",null,"Base volume for all media playing from commands",-1);function Qa(t,s,n,d,g,y){const m=w("navbar"),i=w("commands-editor"),r=w("volume-slider");return l(),a("div",Fa,[e("div",La,[k(m)],512),e("div",qa,[e("div",Oa,[e("ul",null,[(l(!0),a(D,null,P(t.tabDefinitions,(o,c)=>(l(),a("li",{key:c,class:E({"is-active":t.tab===o.tab}),onClick:b=>t.tab=o.tab},[e("a",null,C(o.title),1)],10,za))),128)),e("li",null,[e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open Media widget",8,Ja)])])]),t.inited&&t.tab==="commands"?(l(),L(i,{key:0,modelValue:t.commands,"onUpdate:modelValue":[s[0]||(s[0]=o=>t.commands=o),t.sendSave],globalVariables:t.globalVariables,channelPointsCustomRewards:t.channelPointsCustomRewards,possibleActions:t.possibleActions,baseVolume:t.baseVolume,showToggleImages:!0,showFilterActions:!0,widgetUrl:t.widgetUrl,showImages:t.adminSettings.showImages,onShowImagesChange:t.updateShowImages},null,8,["modelValue","onUpdate:modelValue","globalVariables","channelPointsCustomRewards","possibleActions","baseVolume","widgetUrl","showImages","onShowImagesChange"])):p("",!0),t.inited&&t.tab==="settings"?(l(),a("div",Wa,[t.settings?(l(),a("table",Ba,[e("tbody",null,[e("tr",null,[Ha,e("td",null,[k(r,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[1]||(s[1]=o=>t.settings.volume=o),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])]),Ga])])],512)):p("",!0)])):p("",!0)],512)])}var Ka=A(Ra,[["render",Qa]]);const Gt=(t=null)=>{var s,n,d,g,y,m,i,r,o,c,b,_,$,v,U,V,ut,$t,kt,Ct,Vt,St,Ut,Dt,It,At,Tt,Pt,Nt,Mt,Et,Rt,Ft,Lt,qt,Ot,zt;return{status:{enabled:typeof((s=t==null?void 0:t.status)==null?void 0:s.enabled)!="undefined"?t.status.enabled:!1},styles:{bgColor:typeof((n=t==null?void 0:t.styles)==null?void 0:n.bgColor)!="undefined"?t.styles.bgColor:"#ff00ff",bgColorEnabled:typeof((d=t==null?void 0:t.styles)==null?void 0:d.bgColorEnabled)!="undefined"?t.styles.bgColorEnabled:!0,vAlign:typeof((g=t==null?void 0:t.styles)==null?void 0:g.vAlign)!="undefined"?t.styles.vAlign:"bottom",recognition:{fontFamily:typeof((m=(y=t==null?void 0:t.styles)==null?void 0:y.recognition)==null?void 0:m.fontFamily)!="undefined"?t.styles.recognition.fontFamily:"sans-serif",fontSize:typeof((r=(i=t==null?void 0:t.styles)==null?void 0:i.recognition)==null?void 0:r.fontSize)!="undefined"?t.styles.recognition.fontSize:"30pt",fontWeight:typeof((c=(o=t==null?void 0:t.styles)==null?void 0:o.recognition)==null?void 0:c.fontWeight)!="undefined"?t.styles.recognition.fontWeight:"400",strokeWidth:typeof((_=(b=t==null?void 0:t.styles)==null?void 0:b.recognition)==null?void 0:_.strokeWidth)!="undefined"?t.styles.recognition.strokeWidth:"8pt",strokeColor:typeof((v=($=t==null?void 0:t.styles)==null?void 0:$.recognition)==null?void 0:v.strokeColor)!="undefined"?t.styles.recognition.strokeColor:"#292929",color:typeof((V=(U=t==null?void 0:t.styles)==null?void 0:U.recognition)==null?void 0:V.color)!="undefined"?t.styles.recognition.color:"#ffff00"},translation:{fontFamily:typeof(($t=(ut=t==null?void 0:t.styles)==null?void 0:ut.translation)==null?void 0:$t.fontFamily)!="undefined"?t.styles.translation.fontFamily:"sans-serif",fontSize:typeof((Ct=(kt=t==null?void 0:t.styles)==null?void 0:kt.translation)==null?void 0:Ct.fontSize)!="undefined"?t.styles.translation.fontSize:"30pt",fontWeight:typeof((St=(Vt=t==null?void 0:t.styles)==null?void 0:Vt.translation)==null?void 0:St.fontWeight)!="undefined"?t.styles.translation.fontWeight:"400",strokeWidth:typeof((Dt=(Ut=t==null?void 0:t.styles)==null?void 0:Ut.translation)==null?void 0:Dt.strokeWidth)!="undefined"?t.styles.translation.strokeWidth:"8pt",strokeColor:typeof((At=(It=t==null?void 0:t.styles)==null?void 0:It.translation)==null?void 0:At.strokeColor)!="undefined"?t.styles.translation.strokeColor:"#292929",color:typeof((Pt=(Tt=t==null?void 0:t.styles)==null?void 0:Tt.translation)==null?void 0:Pt.color)!="undefined"?t.styles.translation.color:"#cbcbcb"}},recognition:{display:typeof((Nt=t==null?void 0:t.recognition)==null?void 0:Nt.display)!="undefined"?t.recognition.display:!0,lang:typeof((Mt=t==null?void 0:t.recognition)==null?void 0:Mt.lang)!="undefined"?t.recognition.lang:"ja",synthesize:typeof((Et=t==null?void 0:t.recognition)==null?void 0:Et.synthesize)!="undefined"?t.recognition.synthesize:!1,synthesizeLang:typeof((Rt=t==null?void 0:t.recognition)==null?void 0:Rt.synthesizeLang)!="undefined"?t.recognition.synthesizeLang:""},translation:{enabled:typeof((Ft=t==null?void 0:t.translation)==null?void 0:Ft.enabled)!="undefined"?t.translation.enabled:!0,langSrc:typeof((Lt=t==null?void 0:t.translation)==null?void 0:Lt.langSrc)!="undefined"?t.translation.langSrc:"ja",langDst:typeof((qt=t==null?void 0:t.translation)==null?void 0:qt.langDst)!="undefined"?t.translation.langDst:"en",synthesize:typeof((Ot=t==null?void 0:t.translation)==null?void 0:Ot.synthesize)!="undefined"?t.translation.synthesize:!1,synthesizeLang:typeof((zt=t==null?void 0:t.translation)==null?void 0:zt.synthesizeLang)!="undefined"?t.translation.synthesizeLang:""}}},Ya=I({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:Gt(),defaultSettings:Gt(),ws:null,inited:!1,controlWidgetUrl:"",displayWidgetUrl:""}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=et.wsClient("speech-to-text"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.controlWidgetUrl=t.controlWidgetUrl,this.displayWidgetUrl=t.displayWidgetUrl,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Xa={class:"view"},Za={id:"top",ref:"top"},ja={id:"actionbar",class:"p-1"},xa=["disabled"],to=["href"],eo=["href"],so={id:"main",ref:"main"},no={key:0,class:"table is-striped",ref:"table"},io=e("tr",null,[e("td",{colspan:"3"},"General")],-1),lo=e("td",null,[e("code",null,"settings.style.bgColor")],-1),ao=["disabled"],oo=e("i",{class:"fa fa-remove"},null,-1),ro=[oo],uo=e("td",null,[e("code",null,"settings.style.bgColorEnabled")],-1),mo=e("td",null,[e("code",null,"settings.style.vAlign")],-1),ho={class:"select is-small"},co=e("option",{value:"top"},"top",-1),po=e("option",{value:"bottom"},"bottom",-1),go=[co,po],fo=["disabled"],vo=e("i",{class:"fa fa-remove"},null,-1),yo=[vo],$o=e("tr",null,[e("td",{colspan:"3"},"Recognition")],-1),_o=e("td",null,[e("code",null,"settings.recognition.lang")],-1),bo=["disabled"],wo=e("i",{class:"fa fa-remove"},null,-1),ko=[wo],Co=e("td",null,[e("code",null,"settings.recognition.synthesize")],-1),Vo=["disabled"],So=e("i",{class:"fa fa-remove"},null,-1),Uo=[So],Do=e("td",null,[e("code",null,"settings.recognition.synthesizeLang")],-1),Io=["disabled"],Ao=e("i",{class:"fa fa-remove"},null,-1),To=[Ao],Po=e("td",null,[e("code",null,"settings.recognition.display")],-1),No=["disabled"],Mo=e("i",{class:"fa fa-remove"},null,-1),Eo=[Mo],Ro=e("td",null,[e("code",null,"settings.styles.recognition.color")],-1),Fo=["disabled"],Lo=e("i",{class:"fa fa-remove"},null,-1),qo=[Lo],Oo=e("td",null,[e("code",null,"settings.styles.recognition.strokeWidth")],-1),zo=["disabled"],Jo=e("i",{class:"fa fa-remove"},null,-1),Wo=[Jo],Bo=e("td",null,[e("code",null,"settings.styles.recognition.strokeColor")],-1),Ho=["disabled"],Go=e("i",{class:"fa fa-remove"},null,-1),Qo=[Go],Ko=e("td",null,[e("code",null,"settings.styles.recognition.fontFamily")],-1),Yo=["disabled"],Xo=e("i",{class:"fa fa-remove"},null,-1),Zo=[Xo],jo=e("td",null,[e("code",null,"settings.styles.recognition.fontSize")],-1),xo=["disabled"],tr=e("i",{class:"fa fa-remove"},null,-1),er=[tr],sr=e("td",null,[e("code",null,"settings.styles.recognition.fontWeight")],-1),nr=["disabled"],ir=e("i",{class:"fa fa-remove"},null,-1),lr=[ir],ar=e("tr",null,[e("td",{colspan:"3"},"Translation")],-1),or=e("td",null,[e("code",null,"settings.translation.enabled")],-1),rr=["disabled"],dr=e("i",{class:"fa fa-remove"},null,-1),ur=[dr],mr=e("td",null,[e("code",null,"settings.translation.synthesize")],-1),hr=["disabled"],cr=e("i",{class:"fa fa-remove"},null,-1),pr=[cr],gr=e("td",null,[e("code",null,"settings.translation.synthesizeLang")],-1),fr=["disabled"],vr=e("i",{class:"fa fa-remove"},null,-1),yr=[vr],$r=e("td",null,[e("code",null,"settings.translation.langSrc")],-1),_r=["disabled"],br=e("i",{class:"fa fa-remove"},null,-1),wr=[br],kr=e("td",null,[e("code",null,"settings.translation.langDst")],-1),Cr=["disabled"],Vr=e("i",{class:"fa fa-remove"},null,-1),Sr=[Vr],Ur=e("td",null,[e("code",null,"settings.styles.translation.color")],-1),Dr=["disabled"],Ir=e("i",{class:"fa fa-remove"},null,-1),Ar=[Ir],Tr=e("td",null,[e("code",null,"settings.styles.translation.strokeWidth")],-1),Pr=["disabled"],Nr=e("i",{class:"fa fa-remove"},null,-1),Mr=[Nr],Er=e("td",null,[e("code",null,"settings.styles.translation.strokeColor")],-1),Rr=["disabled"],Fr=e("i",{class:"fa fa-remove"},null,-1),Lr=[Fr],qr=e("td",null,[e("code",null,"settings.styles.translation.fontFamily")],-1),Or=["disabled"],zr=e("i",{class:"fa fa-remove"},null,-1),Jr=[zr],Wr=e("td",null,[e("code",null,"settings.styles.translation.fontSize")],-1),Br=["disabled"],Hr=e("i",{class:"fa fa-remove"},null,-1),Gr=[Hr],Qr=e("td",null,[e("code",null,"settings.styles.translation.fontWeight")],-1),Kr=["disabled"],Yr=e("i",{class:"fa fa-remove"},null,-1),Xr=[Yr],Zr=e("tr",null,[e("td",{colspan:"3"},"Debug")],-1),jr=e("td",null,[e("code",null,"settings.status.enabled")],-1),xr=["disabled"],td=e("i",{class:"fa fa-remove"},null,-1),ed=[td];function sd(t,s,n,d,g,y){const m=w("navbar");return l(),a("div",Xa,[e("div",Za,[k(m),e("div",ja,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...i)=>t.sendSave&&t.sendSave(...i))}," Save ",8,xa),e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open control widget",8,to),e("a",{class:"button is-small mr-1",href:t.displayWidgetUrl,target:"_blank"},"Open display widget",8,eo)])],512),e("div",so,[t.inited?(l(),a("table",no,[e("tbody",null,[io,e("tr",null,[lo,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=i=>t.settings.styles.bgColor=i)},null,512),[[f,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=i=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},ro,8,ao)])]),e("tr",null,[uo,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=i=>t.settings.styles.bgColorEnabled=i)},null,512),[[F,t.settings.styles.bgColorEnabled]])])]),e("tr",null,[mo,e("td",null,[e("div",ho,[u(e("select",{"onUpdate:modelValue":s[4]||(s[4]=i=>t.settings.styles.vAlign=i)},go,512),[[jt,t.settings.styles.vAlign]])])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.vAlign===t.defaultSettings.styles.vAlign,onClick:s[5]||(s[5]=i=>t.settings.styles.vAlign=t.defaultSettings.styles.vAlign)},yo,8,fo)])]),$o,e("tr",null,[_o,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=i=>t.settings.recognition.lang=i)},null,512),[[f,t.settings.recognition.lang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.lang===t.defaultSettings.recognition.lang,onClick:s[7]||(s[7]=i=>t.settings.recognition.lang=t.defaultSettings.recognition.lang)},ko,8,bo)])]),e("tr",null,[Co,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=i=>t.settings.recognition.synthesize=i)},null,512),[[F,t.settings.recognition.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesize===t.defaultSettings.recognition.synthesize,onClick:s[9]||(s[9]=i=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},Uo,8,Vo)])]),e("tr",null,[Do,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[10]||(s[10]=i=>t.settings.recognition.synthesizeLang=i)},null,512),[[f,t.settings.recognition.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesizeLang===t.defaultSettings.recognition.synthesizeLang,onClick:s[11]||(s[11]=i=>t.settings.recognition.synthesizeLang=t.defaultSettings.recognition.synthesizeLang)},To,8,Io)])]),e("tr",null,[Po,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=i=>t.settings.recognition.display=i)},null,512),[[F,t.settings.recognition.display]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.display===t.defaultSettings.recognition.display,onClick:s[13]||(s[13]=i=>t.settings.recognition.display=t.defaultSettings.recognition.display)},Eo,8,No)])]),e("tr",null,[Ro,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[14]||(s[14]=i=>t.settings.styles.recognition.color=i)},null,512),[[f,t.settings.styles.recognition.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.color===t.defaultSettings.styles.recognition.color,onClick:s[15]||(s[15]=i=>t.settings.styles.recognition.color=t.defaultSettings.styles.recognition.color)},qo,8,Fo)])]),e("tr",null,[Oo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[16]||(s[16]=i=>t.settings.styles.recognition.strokeWidth=i)},null,512),[[f,t.settings.styles.recognition.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeWidth===t.defaultSettings.styles.recognition.strokeWidth,onClick:s[17]||(s[17]=i=>t.settings.styles.recognition.strokeWidth=t.defaultSettings.styles.recognition.strokeWidth)},Wo,8,zo)])]),e("tr",null,[Bo,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[18]||(s[18]=i=>t.settings.styles.recognition.strokeColor=i)},null,512),[[f,t.settings.styles.recognition.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeColor===t.defaultSettings.styles.recognition.strokeColor,onClick:s[19]||(s[19]=i=>t.settings.styles.recognition.strokeColor=t.defaultSettings.styles.recognition.strokeColor)},Qo,8,Ho)])]),e("tr",null,[Ko,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[20]||(s[20]=i=>t.settings.styles.recognition.fontFamily=i)},null,512),[[f,t.settings.styles.recognition.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontFamily===t.defaultSettings.styles.recognition.fontFamily,onClick:s[21]||(s[21]=i=>t.settings.styles.recognition.fontFamily=t.defaultSettings.styles.recognition.fontFamily)},Zo,8,Yo)])]),e("tr",null,[jo,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[22]||(s[22]=i=>t.settings.styles.recognition.fontSize=i)},null,512),[[f,t.settings.styles.recognition.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontSize===t.defaultSettings.styles.recognition.fontSize,onClick:s[23]||(s[23]=i=>t.settings.styles.recognition.fontSize=t.defaultSettings.styles.recognition.fontSize)},er,8,xo)])]),e("tr",null,[sr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[24]||(s[24]=i=>t.settings.styles.recognition.fontWeight=i)},null,512),[[f,t.settings.styles.recognition.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontWeight===t.defaultSettings.styles.recognition.fontWeight,onClick:s[25]||(s[25]=i=>t.settings.styles.weight=t.defaultSettings.styles.weight)},lr,8,nr)])]),ar,e("tr",null,[or,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[26]||(s[26]=i=>t.settings.translation.enabled=i)},null,512),[[F,t.settings.translation.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.enabled===t.defaultSettings.translation.enabled,onClick:s[27]||(s[27]=i=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},ur,8,rr)])]),e("tr",null,[mr,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[28]||(s[28]=i=>t.settings.translation.synthesize=i)},null,512),[[F,t.settings.translation.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesize===t.defaultSettings.translation.synthesize,onClick:s[29]||(s[29]=i=>t.settings.translation.synthesize=t.defaultSettings.translation.synthesize)},pr,8,hr)])]),e("tr",null,[gr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[30]||(s[30]=i=>t.settings.translation.synthesizeLang=i)},null,512),[[f,t.settings.translation.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesizeLang===t.defaultSettings.translation.synthesizeLang,onClick:s[31]||(s[31]=i=>t.settings.translation.synthesizeLang=t.defaultSettings.translation.synthesizeLang)},yr,8,fr)])]),e("tr",null,[$r,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[32]||(s[32]=i=>t.settings.translation.langSrc=i)},null,512),[[f,t.settings.translation.langSrc]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langSrc===t.defaultSettings.translation.langSrc,onClick:s[33]||(s[33]=i=>t.settings.translation.langSrc=t.defaultSettings.translation.langSrc)},wr,8,_r)])]),e("tr",null,[kr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[34]||(s[34]=i=>t.settings.translation.langDst=i)},null,512),[[f,t.settings.translation.langDst]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langDst===t.defaultSettings.translation.langDst,onClick:s[35]||(s[35]=i=>t.settings.translation.langDst=t.defaultSettings.translation.langDst)},Sr,8,Cr)])]),e("tr",null,[Ur,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[36]||(s[36]=i=>t.settings.styles.translation.color=i)},null,512),[[f,t.settings.styles.translation.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.color===t.defaultSettings.styles.translation.color,onClick:s[37]||(s[37]=i=>t.settings.styles.translation.color=t.defaultSettings.styles.translation.color)},Ar,8,Dr)])]),e("tr",null,[Tr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[38]||(s[38]=i=>t.settings.styles.translation.strokeWidth=i)},null,512),[[f,t.settings.styles.translation.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeWidth===t.defaultSettings.styles.translation.strokeWidth,onClick:s[39]||(s[39]=i=>t.settings.styles.translation.strokeWidth=t.defaultSettings.styles.translation.strokeWidth)},Mr,8,Pr)])]),e("tr",null,[Er,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[40]||(s[40]=i=>t.settings.styles.translation.strokeColor=i)},null,512),[[f,t.settings.styles.translation.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeColor===t.defaultSettings.styles.translation.strokeColor,onClick:s[41]||(s[41]=i=>t.settings.styles.translation.strokeColor=t.defaultSettings.styles.translation.strokeColor)},Lr,8,Rr)])]),e("tr",null,[qr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[42]||(s[42]=i=>t.settings.styles.translation.fontFamily=i)},null,512),[[f,t.settings.styles.translation.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontFamily===t.defaultSettings.styles.translation.fontFamily,onClick:s[43]||(s[43]=i=>t.settings.styles.translation.fontFamily=t.defaultSettings.styles.translation.fontFamily)},Jr,8,Or)])]),e("tr",null,[Wr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[44]||(s[44]=i=>t.settings.styles.translation.fontSize=i)},null,512),[[f,t.settings.styles.translation.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontSize===t.defaultSettings.styles.translation.fontSize,onClick:s[45]||(s[45]=i=>t.settings.styles.translation.fontSize=t.defaultSettings.styles.translation.fontSize)},Gr,8,Br)])]),e("tr",null,[Qr,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[46]||(s[46]=i=>t.settings.styles.translation.fontWeight=i)},null,512),[[f,t.settings.styles.translation.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontWeight===t.defaultSettings.styles.translation.fontWeight,onClick:s[47]||(s[47]=i=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Xr,8,Kr)])]),Zr,e("tr",null,[jr,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[48]||(s[48]=i=>t.settings.status.enabled=i)},null,512),[[F,t.settings.status.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.status.enabled===t.defaultSettings.status.enabled,onClick:s[49]||(s[49]=i=>t.settings.status.enabled=t.defaultSettings.status.enabled)},ed,8,xr)])])])],512)):p("",!0)],512)])}var nd=A(Ya,[["render",sd]]);const he=(t=null)=>{const s=(n,d,g)=>n?typeof n[d]=="undefined"?g:n[d]:g;return{name:s(t,"name",""),width:s(t,"width",64),height:s(t,"height",64),stateDefinitions:s(t,"stateDefinitions",[]),slotDefinitions:s(t,"slotDefinitions",[]),state:s(t,"state",{slots:{},lockedState:""})}},Qt=(t=null)=>{var s,n;return{styles:{bgColor:typeof((s=t==null?void 0:t.styles)==null?void 0:s.bgColor)!="undefined"?t.styles.bgColor:"#80ff00",bgColorEnabled:typeof((n=t==null?void 0:t.styles)==null?void 0:n.bgColorEnabled)!="undefined"?t.styles.bgColorEnabled:!0},avatarDefinitions:typeof(t==null?void 0:t.avatarDefinitions)!="undefined"?t.avatarDefinitions.map(he):[]}};var id={name:"Hyottoko-Chan",width:400,height:400,stateDefinitions:[{value:"default",deletable:!1},{value:"speaking",deletable:!1},{value:"brb",deletable:!0}],slotDefinitions:[{slot:"Base",defaultItemIndex:0,items:[{title:"Default Clothing",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/bVyo1l-BASE.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"https://hyottoko.club/uploads/JFvasz-2022-01-30T01_30_40.133Z-xUI5QQ.png",duration:100}]}]},{title:"Neko Maid",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/CnWpBL-BASE 2.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"https://hyottoko.club/uploads/xV8vXJ-brb2.png",duration:100}]}]}]},{slot:"Mouth",defaultItemIndex:0,items:[{title:"Confused",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/GkDE45-mouth-confused-open.png",duration:100}]},{state:"speaking",frames:[{url:"https://hyottoko.club/uploads/snKSAf-mouth-open.png",duration:100}]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Mild Smile",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/TTeOCx-mouth-mild-smile.png",duration:100}]},{state:"speaking",frames:[{url:"https://hyottoko.club/uploads/gjs4vW-mouth-open.png",duration:100}]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Focused",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/bbpNaD-mouth-focused.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"",duration:100}]}]}]},{slot:"Eyes",defaultItemIndex:1,items:[{title:"Calm",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/NO7zrl-eyes-calm.png",duration:"4500"},{url:"https://hyottoko.club/uploads/nmUEqi-eyes-closed.png",duration:"150"}]},{state:"speaking",frames:[{url:"https://hyottoko.club/uploads/9eidC9-l2idid-eyes-calm.png",duration:"4500"},{url:"https://hyottoko.club/uploads/pw1HJw-nmUEqi-eyes-closed.png",duration:"150"}]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Interested",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/2wlpCr-eyes-interested.png",duration:"4500"},{url:"https://hyottoko.club/uploads/DwiBor-eyes-closed.png",duration:"150"}]},{state:"speaking",frames:[{url:"https://hyottoko.club/uploads/5fP25n-eyes-interested.png",duration:"4500"},{url:"https://hyottoko.club/uploads/PYiAtV-eyes-closed.png",duration:"150"}]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Focused",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/LQkiXq-eyes-down-focused.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"",duration:100}]}]}]},{slot:"Hands + Table",defaultItemIndex:0,items:[{title:"Empty",states:[{state:"default",frames:[{url:"",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[]}]},{title:"Mouse Study",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/YJnPbG-mouse-study.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Tablet",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/MNHy2s-tablet-osu.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Hands Knitting",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/pn9ZlM-knitting-hands2.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"",duration:100}]}]},{title:"Hands Cross Stitch",states:[{state:"default",frames:[{url:"https://hyottoko.club/uploads/XZRYyh-crossstitch-hands.png",duration:100}]},{state:"speaking",frames:[]},{state:"brb",frames:[{url:"",duration:100}]}]}]}],state:{slots:{Mouth:1,Eyes:1,Base:1,"Hands + Table":1},lockedState:"default"}};const ld=I({data:()=>({editIdx:-1,editEntity:null,unchangedJson:"{}",changedJson:"{}",settings:Qt(),defaultSettings:Qt(),ws:null,inited:!1,tabDefinitions:[{tab:"avatars",title:"Avatars"},{tab:"settings",title:"Settings"}],tab:"avatars",controlWidgetUrl:"",displayWidgetUrl:""}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{edit(t){if(!this.settings){console.warn("edit: this.settings not initialized");return}this.editIdx=t,this.editEntity=this.settings.avatarDefinitions[t]},remove(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.avatarDefinitions=this.settings.avatarDefinitions.filter((s,n)=>n!==t),this.sendSave()},duplicate(t){if(!this.settings){console.warn("duplicate: this.settings not initialized");return}this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=JSON.parse(JSON.stringify(this.settings.avatarDefinitions[t]))},updatedAvatar(t){if(!this.settings){console.warn("updateAvatar: this.settings not initialized");return}this.settings.avatarDefinitions[this.editIdx]=t,this.sendSave()},addAvatar(){if(!this.settings){console.warn("addAvatar: this.settings not initialized");return}const t={name:"Unnamed Avatar",width:64,height:64,stateDefinitions:[{value:"default",deletable:!1},{value:"speaking",deletable:!1}],slotDefinitions:[],state:{slots:{},lockedState:"default"}};this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=t},addExampleAvatar(){const t=JSON.parse(JSON.stringify(id));this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=t},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},dragEnd(t){if(!this.settings){console.warn("dragEnd: this.settings not initialized");return}this.settings.avatarDefinitions=Y.arrayMove(this.settings.avatarDefinitions,t.oldIndex,t.newIndex),this.sendSave()}},async mounted(){this.ws=et.wsClient("avatar"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.controlWidgetUrl=t.controlWidgetUrl,this.displayWidgetUrl=t.displayWidgetUrl,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),ad={class:"view"},od={id:"top",ref:"top"},rd={id:"actionbar",class:"p-1"},dd=["href"],ud=["href"],md={key:0,id:"main",ref:"main"},hd={class:"tabs"},cd=["onClick"],pd={key:0,class:"table is-striped"},gd=e("tr",null,[e("td",{colspan:"3"},"General")],-1),fd=e("td",null,[e("code",null,"settings.style.bgColor")],-1),vd=["disabled"],yd=e("td",null,[e("code",null,"settings.style.bgColorEnabled")],-1),$d={key:1},_d={class:"table is-striped"},bd=e("thead",null,[e("tr",null,[e("th"),e("th"),e("th",null,"Preview"),e("th",null,"Name"),e("th",null,"Actions")])],-1),wd=e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1),kd={class:"pl-0 pr-0"},Cd=["onClick"],Vd=e("i",{class:"fa fa-pencil"},null,-1),Sd=[Vd],Ud={class:"pl-0 pr-0"},Dd=e("i",{class:"fa fa-trash"},null,-1),Id=["onClick"],Ad=e("i",{class:"fa fa-clone"},null,-1),Td=[Ad],Pd=["href"],Nd=e("i",{class:"fa fa-external-link mr-1"},null,-1),Md=h(" Control widget"),Ed=[Nd,Md],Rd=["href"],Fd=e("i",{class:"fa fa-external-link mr-1"},null,-1),Ld=h(" Display widget"),qd=[Fd,Ld];function Od(t,s,n,d,g,y){const m=w("navbar"),i=w("avatar-preview"),r=w("doubleclick-button"),o=w("draggable"),c=w("avatar-editor");return l(),a("div",ad,[e("div",od,[k(m),e("div",rd,[e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open control widget",8,dd),e("a",{class:"button is-small mr-1",href:t.displayWidgetUrl,target:"_blank"},"Open display widget",8,ud)])],512),t.inited?(l(),a("div",md,[e("div",hd,[e("ul",null,[(l(!0),a(D,null,P(t.tabDefinitions,(b,_)=>(l(),a("li",{key:_,class:E({"is-active":t.tab===b.tab}),onClick:$=>t.tab=b.tab},[e("a",null,C(b.title),1)],10,cd))),128))])]),t.tab==="settings"?(l(),a("table",pd,[e("tbody",null,[gd,e("tr",null,[fd,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":[s[0]||(s[0]=b=>t.settings.styles.bgColor=b),s[1]||(s[1]=(...b)=>t.sendSave&&t.sendSave(...b))]},null,512),[[f,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=b=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)}," Reset to default ",8,vd)])]),e("tr",null,[yd,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[3]||(s[3]=b=>t.settings.styles.bgColorEnabled=b),s[4]||(s[4]=(...b)=>t.sendSave&&t.sendSave(...b))]},null,512),[[F,t.settings.styles.bgColorEnabled]])])])])])):p("",!0),t.tab==="avatars"?(l(),a("div",$d,[e("table",_d,[bd,k(o,{modelValue:t.settings.avatarDefinitions,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:O(({element:b,index:_})=>[e("tr",null,[wd,e("td",kd,[e("button",{class:"button is-small",onClick:$=>t.edit(_)},Sd,8,Cd)]),e("td",null,[k(i,{avatar:b},null,8,["avatar"])]),e("td",null,C(b.name),1),e("td",Ud,[k(r,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:$=>t.remove(_)},{default:O(()=>[Dd]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small mr-1",onClick:$=>t.duplicate(_)},Td,8,Id),e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl+"?avatar="+b.name,target:"_blank"},Ed,8,Pd),e("a",{class:"button is-small",href:t.displayWidgetUrl+"?avatar="+b.name,target:"_blank"},qd,8,Rd)])])]),_:1},8,["modelValue","onEnd"])]),t.editEntity?(l(),L(c,{key:0,modelValue:t.editEntity,"onUpdate:modelValue":t.updatedAvatar,onCancel:s[5]||(s[5]=b=>t.editEntity=null)},null,8,["modelValue","onUpdate:modelValue"])):p("",!0),e("span",{class:"button is-small mr-1",onClick:s[6]||(s[6]=(...b)=>t.addAvatar&&t.addAvatar(...b))},"Add new avatar"),e("span",{class:"button is-small",onClick:s[7]||(s[7]=(...b)=>t.addExampleAvatar&&t.addExampleAvatar(...b))},"Add example avatar (Hyottoko-Chan)")])):p("",!0)],512)):p("",!0)])}var zd=A(ld,[["render",Od]]);const Jd=I({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const s=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const n=await q.resetPassword({pass:this.pass,token:s});if(n.status===200)this.success=!0;else try{this.error=(await n.json()).reason}catch{this.error="Unknown error"}}}}),Wd={class:"view center-screen mt-2"},Bd=e("h1",{class:"title is-4"},"Hyottoko.club",-1),Hd={key:0,class:"field has-background-success-light has-text-success-dark"},Gd=h(" Password successfully set. Click "),Qd=h("here"),Kd=h(" to login. "),Yd={key:1},Xd={key:0,class:"field has-background-danger-light has-text-danger-dark"},Zd={class:"field"},jd={class:"control has-icons-left"},xd=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-lock"})],-1),tu={class:"field"},eu=["disabled"];function su(t,s,n,d,g,y){const m=w("router-link");return l(),a("div",Wd,[Bd,t.success?(l(),a("div",Hd,[Gd,k(m,{to:{name:"login"}},{default:O(()=>[Qd]),_:1}),Kd])):(l(),a("div",Yd,[t.error?(l(),a("div",Xd,C(t.error),1)):p("",!0),e("div",Zd,[e("div",jd,[u(e("input",{class:"input",type:"password",placeholder:"New Password","onUpdate:modelValue":s[0]||(s[0]=i=>t.pass=i),onKeyup:[s[1]||(s[1]=i=>t.error=""),s[2]||(s[2]=X((...i)=>t.submit&&t.submit(...i),["enter"]))]},null,544),[[f,t.pass]]),xd])]),e("div",tu,[e("button",{class:"button is-primary is-fullwidth",disabled:t.canSubmit?null:!0,onClick:s[3]||(s[3]=(...i)=>t.submit&&t.submit(...i))}," Save Password ",8,eu)])]))])}var nu=A(Jd,[["render",su]]);const iu=I({data:()=>({email:"",error:"",success:!1,data:vt.getData()}),methods:{async submit(){this.success=!1,this.error="";const t=await q.requestPasswordReset({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),lu={class:"view center-screen mt-2"},au=e("h1",{class:"title is-4"},"Hyottoko.club",-1),ou={key:0,class:"field has-background-success-light has-text-success-dark"},ru=h(" Password-reset mail sent. Click "),du=h("here"),uu=h(" to login. "),mu={key:1},hu={key:0,class:"field has-background-danger-light has-text-danger-dark"},cu={class:"field"},pu={class:"control has-icons-left"},gu=e("span",{class:"icon is-left"},[e("i",{class:"fa fa-envelope"})],-1),fu={class:"field"},vu={class:"field"},yu=h("Register an account"),$u=h(" | "),_u=h("Login"),bu={class:"field has-text-grey-light"};function wu(t,s,n,d,g,y){const m=w("router-link");return l(),a("div",lu,[au,t.success?(l(),a("div",ou,[ru,k(m,{to:{name:"login"}},{default:O(()=>[du]),_:1}),uu])):(l(),a("form",mu,[t.error?(l(),a("div",hu,C(t.error),1)):p("",!0),e("div",cu,[e("div",pu,[u(e("input",{class:"input",type:"email",placeholder:"Email","onUpdate:modelValue":s[0]||(s[0]=i=>t.email=i),onKeyup:s[1]||(s[1]=i=>t.error="")},null,544),[[f,t.email]]),gu])]),e("div",fu,[e("span",{class:"button is-primary is-fullwidth",onClick:s[2]||(s[2]=(...i)=>t.submit&&t.submit(...i))},"Request Password Reset")]),e("div",vu,[k(m,{to:{name:"register"}},{default:O(()=>[yu]),_:1}),$u,k(m,{to:{name:"login"}},{default:O(()=>[_u]),_:1})]),e("div",bu," There are currently "+C(t.data.registeredUserCount)+" streamers registered \u2728. ",1)]))])}var ku=A(iu,[["render",wu]]);const K=(t=null)=>({chatMessage:!t||typeof t.chatMessage=="undefined"?"":t.chatMessage,sound:!t||typeof t.sound=="undefined"?{file:"",filename:"",urlpath:"",volume:100}:t.sound}),ce=(t=null)=>({effect:!t||typeof t.effect=="undefined"?K():K(t.effect),offsetMs:!t||typeof t.offsetMs=="undefined"?"":t.offsetMs}),Cu=(t=null)=>({fontFamily:!t||typeof t.fontFamily=="undefined"?"":t.fontFamily,fontSize:!t||typeof t.fontSize=="undefined"?"72px":t.fontSize,color:!t||typeof t.color=="undefined"?"":t.color,timerFormat:!t||typeof t.timerFormat=="undefined"?"{mm}:{ss}":t.timerFormat,showTimerWhenFinished:!t||typeof t.showTimerWhenFinished=="undefined"?!0:t.showTimerWhenFinished,finishedText:!t||typeof t.finishedText=="undefined"?"":t.finishedText,startEffect:!t||typeof t.startEffect=="undefined"?K():K(t.startEffect),endEffect:!t||typeof t.endEffect=="undefined"?K():K(t.endEffect),stopEffect:!t||typeof t.stopEffect=="undefined"?K():K(t.stopEffect),notifications:!t||typeof t.notifications=="undefined"?[]:t.notifications.map(ce)}),Vu=I({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:Cu(),inited:!1,ws:null,widgetUrl:""}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},addNotification(){this.settings.notifications.push(ce())},removeNotification(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.notifications=this.settings.notifications.filter((s,n)=>n!==t)}},async mounted(){this.ws=et.wsClient("pomo"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.widgetUrl=t.widgetUrl,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Su={class:"view"},Uu={id:"top",ref:"top"},Du={id:"actionbar",class:"p-1"},Iu=["disabled"],Au=["href"],Tu={id:"main",ref:"main"},Pu={key:0,class:"table is-striped",ref:"table"},Nu=e("tr",null,[e("td",{colspan:"2"},"Pomo")],-1),Mu=e("td",null,[e("code",null,"settings.color")],-1),Eu=e("td",null,"The text color in the widget.",-1),Ru=e("td",null,[e("code",null,"settings.fontFamily")],-1),Fu=e("td",null,"The font in the widget.",-1),Lu=e("td",null,[e("code",null,"settings.fontSize")],-1),qu=e("td",null,[h(" The text size in the widget, for example "),e("code",null,"12px"),h(", "),e("code",null,"20pt"),h(". ")],-1),Ou=e("td",null,[e("code",null,"settings.timerFormat")],-1),zu=e("td",null,[h(" Format of the timer, you can use the following placeholders: "),e("code",{innerHTML:"{{hh}}"}),h(" for hours, "),e("code",{innerHTML:"{{mm}}"}),h(" for minutes, "),e("code",{innerHTML:"{{ss}}"}),h(" for seconds. ")],-1),Ju=e("td",null,[e("code",null,"settings.finishedText")],-1),Wu=e("td",null,"Text that is displayed when the timer reaches 0.",-1),Bu=e("td",null,[e("code",null,"settings.showTimerWhenFinished")],-1),Hu=e("td",null," If enabled, the timer will be displayed even when it reached 0. ",-1),Gu=e("td",null,[e("code",null,"settings.startEffect.chatMessage")],-1),Qu=e("td",null,"Chat message that is sent when pomo is started.",-1),Ku=e("td",null,[e("code",null,"settings.startEffect.sound")],-1),Yu=e("td",null,"Sound that will be displayed when pomo is started.",-1),Xu=e("td",null,[e("code",null,"settings.endEffect.chatMessage")],-1),Zu=e("td",null,"Chat message that is sent when pomo reaches 0.",-1),ju=e("td",null,[e("code",null,"settings.endEffect.sound")],-1),xu=e("td",null,"Sound that will be displayed when pomo reaches 0.",-1),tm=e("td",null,[e("code",null,"settings.stopEffect.chatMessage")],-1),em=e("td",null," Chat message that is sent when pomo is stopped (via pomo exit). ",-1),sm=e("td",null,[e("code",null,"settings.stopEffect.sound")],-1),nm=e("td",null," Sound that will be displayed when pomo is stopped (via pomo exit). ",-1),im=e("code",null,"settings.notifications",-1),lm=["onClick"],am=e("td",null,[e("code",null,"offsetMs")],-1),om=e("td",null," Offset to the end of pomo. Negative offset means time before end of pomo. ",-1),rm=e("td",null,[e("code",null,"chatMessage")],-1),dm=["onUpdate:modelValue"],um=e("td",null,"Chat message sent at the set offset.",-1),mm=e("td",null,[e("code",null,"sound")],-1),hm=e("td",null,"Sound played at the set offset.",-1);function cm(t,s,n,d,g,y){const m=w("navbar"),i=w("sound-upload"),r=w("duration-input");return l(),a("div",Su,[e("div",Uu,[k(m),e("div",Du,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...o)=>t.sendSave&&t.sendSave(...o))}," Save ",8,Iu),e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open widget",8,Au)])],512),e("div",Tu,[t.inited?(l(),a("table",Pu,[e("tbody",null,[Nu,e("tr",null,[Mu,e("td",null,[u(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=o=>t.settings.color=o)},null,512),[[f,t.settings.color]])]),Eu]),e("tr",null,[Ru,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>t.settings.fontFamily=o)},null,512),[[f,t.settings.fontFamily]])]),Fu]),e("tr",null,[Lu,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.settings.fontSize=o)},null,512),[[f,t.settings.fontSize]])]),qu]),e("tr",null,[Ou,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[4]||(s[4]=o=>t.settings.timerFormat=o)},null,512),[[f,t.settings.timerFormat]])]),zu]),e("tr",null,[Ju,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.settings.finishedText=o)},null,512),[[f,t.settings.finishedText]])]),Wu]),e("tr",null,[Bu,e("td",null,[u(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=o=>t.settings.showTimerWhenFinished=o)},null,512),[[F,t.settings.showTimerWhenFinished]])]),Hu]),e("tr",null,[Gu,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[7]||(s[7]=o=>t.settings.startEffect.chatMessage=o)},null,512),[[f,t.settings.startEffect.chatMessage]])]),Qu]),e("tr",null,[Ku,e("td",null,[k(i,{modelValue:t.settings.startEffect.sound,"onUpdate:modelValue":s[8]||(s[8]=o=>t.settings.startEffect.sound=o),baseVolume:100},null,8,["modelValue"])]),Yu]),e("tr",null,[Xu,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=o=>t.settings.endEffect.chatMessage=o)},null,512),[[f,t.settings.endEffect.chatMessage]])]),Zu]),e("tr",null,[ju,e("td",null,[k(i,{modelValue:t.settings.endEffect.sound,"onUpdate:modelValue":s[10]||(s[10]=o=>t.settings.endEffect.sound=o),baseVolume:100},null,8,["modelValue"])]),xu]),e("tr",null,[tm,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[11]||(s[11]=o=>t.settings.stopEffect.chatMessage=o)},null,512),[[f,t.settings.stopEffect.chatMessage]])]),em]),e("tr",null,[sm,e("td",null,[k(i,{modelValue:t.settings.stopEffect.sound,"onUpdate:modelValue":s[12]||(s[12]=o=>t.settings.stopEffect.sound=o),baseVolume:100},null,8,["modelValue"])]),nm]),e("tr",null,[e("td",null,[im,e("span",{class:"button is-small",onClick:s[13]||(s[13]=(...o)=>t.addNotification&&t.addNotification(...o))},"Add notification")]),e("td",null,[(l(!0),a(D,null,P(t.settings.notifications,(o,c)=>(l(),a("div",{key:c},[e("span",{class:"button is-small",onClick:b=>t.removeNotification(c)},"Remove",8,lm),e("table",null,[e("tr",null,[am,e("td",null,[k(r,{modelValue:o.offsetMs,"onUpdate:modelValue":b=>o.offsetMs=b,allowNegative:!0},null,8,["modelValue","onUpdate:modelValue"])]),om]),e("tr",null,[rm,e("td",null,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":b=>o.effect.chatMessage=b},null,8,dm),[[f,o.effect.chatMessage]])]),um]),e("tr",null,[mm,e("td",null,[k(i,{modelValue:o.effect.sound,"onUpdate:modelValue":b=>o.effect.sound=b,baseVolume:100},null,8,["modelValue","onUpdate:modelValue"])]),hm])])]))),128))])])])],512)):p("",!0)],512)])}var pm=A(Vu,[["render",cm]]);const gm=I({name:"upload",props:{accept:String,label:{type:String,default:"Upload File"}},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?` Uploading (${this.uploadPercent}%)`:this.label?` ${this.label}`:""},progressStyle(){if(!this.uploading)return{};const t=this.uploadPercent,s="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${s} 0%, ${s} ${t}%, transparent ${t}%)`}}},methods:{async uploadFile(t){this.uploading=!0;const s=await q.upload(t,d=>{this.progress=d.loaded/d.total});this.uploading=!1;const n=await s.json();this.$emit("uploaded",n)},async upload(t){const s=t.target.files[0];!s||this.uploadFile(s)}}}),fm={class:"upload"},vm=["disabled","accept"],ym={class:"button is-small"};function $m(t,s,n,d,g,y){return l(),a("label",fm,[e("input",{type:"file",disabled:t.uploading,style:{display:"none"},onChange:s[0]||(s[0]=(...m)=>t.upload&&t.upload(...m)),accept:t.accept},null,40,vm),e("span",ym,[e("i",{class:E(["fa fa-upload",{"mr-1":t.buttonText}])},null,2),h(C(t.buttonText),1)]),e("span",{class:"progress",style:Z(t.progressStyle)},null,4)])}var _m=A(gm,[["render",$m],["__scopeId","data-v-5e75275a"]]);const bm=I({props:{modelValue:{required:!0},width:{type:String,required:!1,default:"100%"},height:{type:String,required:!1,default:"90px"}},emits:["update:modelValue"],data(){return{value:{file:"",filename:"",urlpath:""},draggingOver:!1}},created(){this.modelValue!==null&&(this.value=JSON.parse(JSON.stringify(this.modelValue)))},methods:{emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={file:"",filename:"",urlpath:""},this.emitUpdate()},onUploaded(t){this.value=ie(t),this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if(t.dataTransfer.items[n].kind==="file"){s=t.dataTransfer.items[n].getAsFile();break}}else for(var n=0;n<t.dataTransfer.files.length;n++){s=t.dataTransfer.files[n];break}return s&&(this.value.file="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),wm=t=>(G("data-v-2882bcde"),t=t(),Q(),t),km=wm(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Cm=h(" Remove "),Vm=[km,Cm],Sm={key:2};function Um(t,s,n,d,g,y){const m=w("responsive-image"),i=w("upload");return l(),a("div",{onDrop:s[1]||(s[1]=(...r)=>t.onDrop&&t.onDrop(...r)),onDragover:s[2]||(s[2]=(...r)=>t.onDragover&&t.onDragover(...r)),onDragleave:s[3]||(s[3]=(...r)=>t.onDragleave&&t.onDragleave(...r)),class:E(["image-upload",{"dragging-over":t.draggingOver}])},[t.value.file?(l(),L(m,{key:0,src:t.value.urlpath,title:t.value.filename,width:t.width,height:t.height,style:{display:"block"}},null,8,["src","title","width","height"])):p("",!0),t.value.file?(l(),a("button",{key:1,class:"button is-small",onClick:s[0]||(s[0]=(...r)=>t.onRemove&&t.onRemove(...r))},Vm)):p("",!0),t.value.file?(l(),a("br",Sm)):p("",!0),k(i,{onUploaded:t.onUploaded,accept:"image/*",label:"Upload Image",class:E({"mt-1":t.value.file}),ref:"uploadComponent"},null,8,["onUploaded","class"])],34)}var Dm=A(bm,[["render",Um],["__scopeId","data-v-2882bcde"]]);const Im=I({props:{modelValue:{required:!0},baseVolume:{default:100}},emits:["update:modelValue"],data(){return{value:{file:"",filename:"",urlpath:"",volume:100},draggingOver:!1}},created(){this.modelValue!==null&&(this.value=JSON.parse(JSON.stringify(this.modelValue)))},methods:{emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={file:"",filename:"",urlpath:"",volume:100},this.emitUpdate()},onUploaded(t){this.value=le(t),this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if(t.dataTransfer.items[n].kind==="file"){s=t.dataTransfer.items[n].getAsFile();break}}else for(var n=0;n<t.dataTransfer.files.length;n++){s=t.dataTransfer.files[n];break}return s&&(this.value.file="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),Am=t=>(G("data-v-7ae97750"),t=t(),Q(),t),Tm=Am(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Pm=h(" Remove "),Nm=[Tm,Pm],Mm={key:3};function Em(t,s,n,d,g,y){const m=w("player"),i=w("volume-slider"),r=w("upload");return l(),a("div",{onDrop:s[2]||(s[2]=(...o)=>t.onDrop&&t.onDrop(...o)),onDragover:s[3]||(s[3]=(...o)=>t.onDragover&&t.onDragover(...o)),onDragleave:s[4]||(s[4]=(...o)=>t.onDragleave&&t.onDragleave(...o)),class:E(["sound-upload",{"dragging-over":t.draggingOver}])},[t.value.file?(l(),L(m,{key:0,src:t.value.urlpath,name:t.value.filename,volume:t.value.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):p("",!0),t.value.file?(l(),L(i,{key:1,modelValue:t.value.volume,"onUpdate:modelValue":s[0]||(s[0]=o=>{t.value.volume=o,this.emitUpdate()})},null,8,["modelValue"])):p("",!0),t.value.file?(l(),a("button",{key:2,class:"button is-small",onClick:s[1]||(s[1]=(...o)=>t.onRemove&&t.onRemove(...o))},Nm)):p("",!0),t.value.file?(l(),a("br",Mm)):p("",!0),k(r,{onUploaded:t.onUploaded,accept:"audio/*",label:"Upload Sound",class:E({"mt-1":t.value.file}),ref:"uploadComponent"},null,8,["onUploaded","class"])],34)}var Rm=A(Im,[["render",Em],["__scopeId","data-v-7ae97750"]]);const Fm=I({props:{modelValue:{required:!0},allowNegative:{type:Boolean,default:!1}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(t){try{const s=Y.doDummyReplacements(t,"0");Y.mustParseHumanDuration(s,this.allowNegative),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",t)}},modelValue:{handler(t){this.v=`${t}`}}}});function Lm(t,s,n,d,g,y){return u((l(),a("input",{class:E(["input is-small spaceinput",t.classes]),"onUpdate:modelValue":s[0]||(s[0]=m=>t.v=m)},null,2)),[[f,t.v]])}var qm=A(Fm,[["render",Lm]]);const Om=I({props:{modelValue:{type:Object,required:!0},onValue:{type:Object,default:!0},offValue:{type:Object,default:!1}},emits:["update:modelValue"],data(){return{value:!1}},created(){this.value=this.modelValue===this.onValue},methods:{emitUpdate(){this.$emit("update:modelValue",this.value?this.onValue:this.offValue)}}});function zm(t,s,n,d,g,y){return u((l(),a("input",{type:"checkbox","onUpdate:modelValue":[s[0]||(s[0]=m=>t.value=m),s[1]||(s[1]=(...m)=>t.emitUpdate&&t.emitUpdate(...m))]},null,512)),[[F,t.value]])}var Jm=A(Om,[["render",zm]]);const Wm=I({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const t=parseInt(`${this.baseVolume}`,10)/100,s=parseInt(`${this.volume}`,10)/100;this.audio.volume=t*s,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio(this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function Bm(t,s,n,d,g,y){return t.src?(l(),a("span",{key:0,class:"player",onClick:s[0]||(s[0]=(...m)=>t.toggle&&t.toggle(...m))},[h(C(t.name)+" ",1),e("i",{class:E(["fa ml-1",t.cls])},null,2)])):p("",!0)}var Hm=A(Wm,[["render",Bm]]);const Gm=I({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),Qm={class:"columns"},Km={class:"column is-four-fifth"},Ym={class:"control has-icons-left has-icons-right range slider"},Xm=["min","max"],Zm={class:"icon is-small is-left"},jm={class:"icon is-small is-right"},xm={class:"column is-one-fifth"};function th(t,s,n,d,g,y){return l(),a("div",Qm,[e("div",Km,[e("div",Ym,[u(e("input",{type:"range",class:"input is-small",min:t.min,max:t.max,"onUpdate:modelValue":[s[0]||(s[0]=m=>t.curVal=m),s[1]||(s[1]=(...m)=>t.valChange&&t.valChange(...m))]},null,8,Xm),[[f,t.curVal]]),e("span",Zm,[e("i",{class:E(["fa",t.iconLeft])},null,2)]),e("span",jm,[e("i",{class:E(["fa",t.iconRight])},null,2)])])]),e("div",xm,[u(e("input",{type:"number",class:"input is-small","onUpdate:modelValue":[s[2]||(s[2]=m=>t.curVal=m),s[3]||(s[3]=(...m)=>t.valChange&&t.valChange(...m))]},null,512),[[f,t.curVal]])])])}var eh=A(Gm,[["render",th],["__scopeId","data-v-8095ce2a"]]);const sh=I({name:"volume-slider",props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.volume}`,10))}},created(){this.volume=parseInt(`${this.modelValue}`,10)}});function nh(t,s,n,d,g,y){const m=w("slider");return l(),L(m,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:t.volume,"onUpdate:modelValue":[s[0]||(s[0]=i=>t.volume=i),t.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var ih=A(sh,[["render",nh]]);const lh=I({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(${this.src})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),ah=["title"];function oh(t,s,n,d,g,y){return l(),a("div",{class:"responsive-image",style:Z(t.style),title:t.title},null,12,ah)}var rh=A(lh,[["render",oh]]);const dh=I({data:()=>({show:!1,macros:[{value:"$args",title:"All args, joined with spaces"},{value:"$args(1:)",title:"Args starting from the second one, joined with spaces"},{value:"$args(1:4)",title:"Second to fifth args, joined with spaces"},{value:"$args(:4)",title:"All args up to and including the fifth, joined with spaces"},{value:"$var(VARNAME)",title:"Value of variable VARNAME"},{value:"$bot.version",title:"Bot version"},{value:"$bot.date",title:"Bot build date"},{value:"$bot.website",title:"Bot website"},{value:"$bot.github",title:"Bot github link"},{value:"$bot.features",title:"Bot feature description"},{value:"$rand(1,100)",title:"Random number between (inclusive) 1 and 100"},{value:"$user.name",title:"Name of user who executed the command"},{value:"$user.profile_image_url",title:"Profile image url of user who executed the command"},{value:"$user.recent_clip_url",title:"Recent clip url of user who executed the command"},{value:"$user.last_stream_category",title:"Last stream category of user who executed the command"},{value:"$user(NAME).name",title:"Name of user identified by username NAME"},{value:"$user(NAME).profile_image_url",title:"Profile image url of user identified by username NAME"},{value:"$user(NAME).recent_clip_url",title:"Recent clip url of user identified by username NAME"},{value:"$user(NAME).last_stream_category",title:"Last stream category of user identified by username NAME"},{value:"$customapi(URL)",title:"Text response of a GET request to URL."},{value:"$customapi(URL)['FIELD']",title:"Field FIELD of a json returned from GET request to URL."},{value:"$calc(NUM_1+NUM_2)",title:"The result of addition of NUM_1 and NUM_2"},{value:"$calc(NUM_1-NUM_2)",title:"The result of substraction of NUM_1 and NUM_2"},{value:"$calc(NUM_1*NUM_2)",title:"The result of multiplication of NUM_1 and NUM_2"},{value:"$calc(NUM_1/NUM_2)",title:"The result of division of NUM_1 and NUM_2"}]}),methods:{onMacroClicked(t){this.$emit("selected",t)}}}),uh={class:"macro-select"},mh={key:0,class:"table-holder"},hh=["title"],ch=["onClick"];function ph(t,s,n,d,g,y){return l(),a("div",uh,[e("a",{onClick:s[0]||(s[0]=m=>t.show=!t.show)},"Select macro"),t.show?(l(),a("div",mh,[e("table",null,[(l(!0),a(D,null,P(t.macros,(m,i)=>(l(),a("tr",{key:i},[e("td",{title:m.title},[e("code",{class:"is-clickable",onClick:r=>t.onMacroClicked(m)},C(m.value),9,ch)],8,hh),e("td",null,C(m.title),1)]))),128))])])):p("",!0)])}var gh=A(dh,[["render",ph]]);const pt=Zt();let nt,_t={problems:[]};function fh(){nt=et.wsClient("core"),nt.onMessage(["status"],t=>{JSON.stringify(_t)!==JSON.stringify(t)&&(_t=t,pt.emit("status",_t))}),nt.connect()}function vh(){nt&&(nt.disconnect(),nt=null)}var Kt={init:fh,stop:vh,eventBus:pt},yh="/assets/hyottoko.30d2bcb9.png";const $h=I({name:"navbar",computed:{user(){var t,s;return((s=(t=this.$me)==null?void 0:t.user)==null?void 0:s.name)||""}},created(){this.$me=B.getMe(),this.darkmode=B.isDarkmode(),pt.on("status",this.statusChanged)},beforeUnmount(){pt.off("status",this.statusChanged)},data:()=>({$me:null,linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"avatar"},text:"Avatar"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"pomo"},text:"Pomo"},{to:{name:"settings"},text:"Settings"}],problems:[],burgerActive:!1,darkmode:!1}),methods:{onDarkmodeSwitch(){B.setDarkmode(this.darkmode)},statusChanged(t){this.problems=t.problems},toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){const t=await B.logout();if(t.error)throw new Error(t.error);this.$router.push({name:"login"})}}}),_h={class:"navbar",role:"navigation","aria-label":"main navigation"},bh={class:"navbar-brand"},wh=e("img",{src:yh,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),kh={class:"greeting"},Ch=e("span",{"aria-hidden":"true"},null,-1),Vh=e("span",{"aria-hidden":"true"},null,-1),Sh=e("span",{"aria-hidden":"true"},null,-1),Uh=[Ch,Vh,Sh],Dh={class:"navbar-start"},Ih={class:"navbar-end"},Ah=["title"],Th=e("i",{class:"fa fa-warning mr-1"},null,-1),Ph={class:"navbar-item"},Nh=e("label",{for:"darkmode-switch"},"Switch dark/light mode",-1);function Mh(t,s,n,d,g,y){const m=w("router-link");return l(),a("nav",_h,[e("div",bh,[k(m,{class:"navbar-item",to:{name:"index"}},{default:O(()=>[wh,e("span",kh,"Welcome back, "+C(t.user),1)]),_:1}),e("a",{role:"button",class:E(["navbar-burger",{"is-active":t.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:s[0]||(s[0]=(...i)=>t.toggleBurgerMenu&&t.toggleBurgerMenu(...i))},Uh,2)]),e("div",{id:"navbarBasicExample",class:E(["navbar-menu",{"is-active":t.burgerActive}])},[e("div",Dh,[(l(!0),a(D,null,P(t.linksStart,(i,r)=>(l(),L(m,{class:"navbar-item",key:r,to:i.to},{default:O(()=>[h(C(i.text),1)]),_:2},1032,["to"]))),128))]),e("div",Ih,[t.problems.length?(l(),a("a",{key:0,class:"navbar-item has-text-danger",title:t.problems.join(" ---- ")},[Th,h(" "+C(t.problems.length)+" Problem"+C(t.problems.length>1?"s":""),1)],8,Ah)):p("",!0),e("span",Ph,[u(e("input",{type:"checkbox",id:"darkmode-switch",class:"mr-1","onUpdate:modelValue":s[1]||(s[1]=i=>t.darkmode=i),onChange:s[2]||(s[2]=(...i)=>t.onDarkmodeSwitch&&t.onDarkmodeSwitch(...i))},null,544),[[F,t.darkmode]]),Nh]),e("a",{class:"navbar-item",onClick:s[3]||(s[3]=(...i)=>t.onLogoutClick&&t.onLogoutClick(...i))},"Logout")])],2)])}var Eh=A($h,[["render",Mh]]);const Rh=I({props:{value:{required:!0}},computed:{tag(){try{return Y.mustParseHumanDuration(`${this.value}`),"span"}catch{return"code"}},humanReadable(){try{return Y.humanDuration(Y.mustParseHumanDuration(`${this.value}`))}catch{return this.value}}}}),Fh={key:0},Lh={key:1};function qh(t,s,n,d,g,y){return t.tag==="span"?(l(),a("span",Fh,C(t.humanReadable),1)):(l(),a("code",Lh,C(t.humanReadable),1))}var Oh=A(Rh,[["render",qh]]);const zh=I({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null||this.time===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time&&(this.time-=10),(!this.time||this.time<=0)&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),Jh={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function Wh(t,s,n,d,g,y){return l(),a("button",{class:"doubleclick-button",onClick:s[0]||(s[0]=(...m)=>t.onClick&&t.onClick(...m))},[pe(t.$slots,"default",{},void 0,!0),t.timer?(l(),a("span",Jh,[h(C(t.message)+" ",1),e("span",{class:"doubleclick-button-timout-indicator",style:Z(t.indicatorStyle)},null,4)])):p("",!0)])}var Bh=A(zh,[["render",Wh],["__scopeId","data-v-e15a5c1a"]]);const Hh=I({props:{label:{type:String,required:!0},actions:{type:Array,required:!0}},emits:["click"],data(){return{active:!1}},methods:{onActionClick(t){this.closeDropdown(),this.$emit("click",t)},openDropdown(){this.active=!0},closeDropdown(){this.active=!1},hideDropdown(t){!this.$refs.dropdown||this.$refs.dropdown.contains(t.target)||this.closeDropdown()}},mounted(){window.addEventListener("click",this.hideDropdown)},unmounted(){window.removeEventListener("click",this.hideDropdown)}}),Gh=t=>(G("data-v-56f27a9a"),t=t(),Q(),t),Qh={class:"dropdown-trigger"},Kh=Gh(()=>e("span",{class:"icon is-small"},[e("i",{class:"fa fa-angle-down","aria-hidden":"true"})],-1)),Yh={class:"dropdown-menu",id:"dropdown-menu",role:"menu"},Xh={class:"dropdown-content"},Zh=["onClick","title"];function jh(t,s,n,d,g,y){return l(),a("div",{class:E(["dropdown mr-1",{"is-active":t.active}]),ref:"dropdown"},[e("div",Qh,[e("button",{class:"button is-small mr-1","aria-haspopup":"true","aria-controls":"dropdown-menu",onClick:s[0]||(s[0]=(...m)=>t.openDropdown&&t.openDropdown(...m))},[e("span",null,C(t.label),1),Kh])]),e("div",Yh,[e("div",Xh,[(l(!0),a(D,null,P(t.actions,(m,i)=>(l(),a("span",{class:"dropdown-item is-clickable",key:i,onClick:r=>t.onActionClick(m),title:m.title},C(m.label),9,Zh))),128))])])],2)}var xh=A(Hh,[["render",jh],["__scopeId","data-v-56f27a9a"]]);const tt=(...t)=>console.log("[youtube.js]",...t);let Yt=!1;function tc(){return Yt?(tt("ytapi ALREADY ready"),Promise.resolve()):new Promise(t=>{const s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",document.head.append(s),window.onYouTubeIframeAPIReady=()=>{Yt=!0,tt("ytapi ready"),t()}})}function ec(t){return new Promise(s=>{tt("create player on "+t);const n=new YT.Player(t,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{tt("player ready"),s(n)}}})})}async function sc(t){return await tc(),await ec(t)}const nc=I({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const t=this.getDuration(),s=this.getCurrentTime();return t?s/t:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let t=20;this.tryPlayInterval=setInterval(()=>{if(tt("playing",this.playing(),"triesRemaining",t),--t,this.playing()||t<0){tt("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(t){this.yt?(this.yt.cueVideoById(t),this.tryPlay()):this.toplay=t},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(t){this.yt?this.yt.setVolume(t):this.tovolume=t},setLoop(t){this.loop=t},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await sc(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(tt("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",t=>{t.data===YT.PlayerState.CUED?this.tryPlay():t.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),ic=["id"];function lc(t,s,n,d,g,y){return l(),a("div",{id:t.id},null,8,ic)}var ac=A(nc,[["render",lc]]);const oc=I({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},channelPointsCustomRewards:{type:Object,required:!0},baseVolume:{default:100},widgetUrl:{type:String,required:!1,default:""}},emits:["update:modelValue","cancel"],data:()=>({item:null,variableChangeFocusIdx:-1,dictLangs:[{value:"ja",flag:"\u{1F1EF}\u{1F1F5}",title:"Japanese"},{value:"ru",flag:"\u{1F1F7}\u{1F1FA}",title:"Russian"},{value:"de",flag:"\u{1F1E9}\u{1F1EA}",title:"German"},{value:"es",flag:"\u{1F1EA}\u{1F1F8}",title:"Spanish"},{value:"fr",flag:"\u{1F1EB}\u{1F1F7}",title:"French"},{value:"it",flag:"\u{1F1EE}\u{1F1F9}",title:"Italian"},{value:"pt",flag:"\u{1F1F5}\u{1F1F9}/\u{1F1E7}\u{1F1F7}",title:"Portuguese"}],possiblePermissions:re}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(t){this.item=JSON.parse(JSON.stringify(t))}}},methods:{addtxt(){if(!this.item){console.warn("addtxt: this.item not initialized");return}this.item.data.text.push(wt())},addtrigger(t){if(!this.item){console.warn("addtrigger: this.item not initialized");return}this.item.triggers.push(ue(t.type))},onAddVariableChange(){if(!this.item){console.warn("onAddVariableChange: this.item not initialized");return}this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(t){if(!this.item){console.warn("rmVariableChange: this.item not initialized");return}this.item.variableChanges=this.item.variableChanges.filter((s,n)=>n!==t)},onAddVariable(){if(!this.item){console.warn("onAddVariable: this.item not initialized");return}this.item.variables.push({name:"",value:""})},rmVariable(t){if(!this.item){console.warn("rmVariable: this.item not initialized");return}this.item.variables=this.item.variables.filter((s,n)=>n!==t)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndChanged(t){if(!this.item){console.warn("mediaSndChanged: this.item not initialized");return}this.item.data.sound=t},mediaImgChanged(t){if(!this.item){console.warn("mediaImgUploaded: this.item not initialized");return}this.item.data.image=t},rmtxt(t){if(!this.item){console.warn("rmtxt: this.item not initialized");return}this.item.data.text=this.item.data.text.filter((s,n)=>n!==t)},rmtrigger(t){if(!this.item){console.warn("rmtrigger: this.item not initialized");return}this.item.triggers=this.item.triggers.filter((s,n)=>n!==t)},insertMacro(t,s){if(!this.item){console.warn("insertMacro: this.item not initialized");return}this.item.data.text[t]+=s.value},autocompletableVariables(t){if(!this.item){console.warn("autocompletableVariables: this.item not initialized");return}const s=this.item.variables.slice().map(n=>({var:n,type:"local"}));return this.globalVariables.forEach(n=>{s.find(d=>d.var.name===n.name)||s.push({var:n,type:"global"})}),s.filter(n=>n.var.name.startsWith(t)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{requiresAccessToken(){return this.item?st[this.item.action].RequiresAccessToken():!1},possibleTriggerActions(){return[{type:"command",label:"Add Command",title:"Command"},{type:"first_chat",label:"Add First Chat",title:"First Chat"},{type:"reward_redemption",label:"Add Reward Redemption",title:"Reward Redemption"},{type:"timer",label:"Add Timer",title:"Timer"}]},valid(){if(!this.item)return!1;for(const t of this.item.triggers)if(!zl(t))return!1;if(this.item.action==="text"){for(const t of this.item.data.text)if(t==="")return!1}return!0},actionDescription(){return this.item?st[this.item.action].Description():""},title(){return this.item?`${{create:"Create new ",edit:"Edit "}[this.mode]}${st[this.item.action].Name()}`:""}}}),S=t=>(G("data-v-6f025cb4"),t=t(),Q(),t),rc={key:0,class:"modal is-active"},dc={class:"modal-card"},uc={class:"modal-card-head"},mc={class:"modal-card-title"},hc={class:"modal-card-body"},cc={class:"table is-striped"},pc=S(()=>e("td",null,"Triggers:",-1)),gc={key:0},fc=S(()=>e("td",null,"Description:",-1)),vc=["innerHTML"],yc={key:1},$c=S(()=>e("td",null,"Attention:",-1)),_c=S(()=>e("td",null,[e("div",{class:"help"},[h(" This requires "),e("code",null,"Access Token"),h(" to be set in the user settings. ")])],-1)),bc=[$c,_c],wc={key:2},kc=S(()=>e("td",null,"Stream title:",-1)),Cc={key:3},Vc=S(()=>e("td",null,"Stream category:",-1)),Sc={key:4},Uc=S(()=>e("td",null,"Tag to add:",-1)),Dc={key:5},Ic=S(()=>e("td",null,"Tag to remove:",-1)),Ac={key:6},Tc=S(()=>e("td",null,"Tag:",-1)),Pc=S(()=>e("td",null,"Language:",-1)),Nc=["onClick","title"],Mc=S(()=>e("code",null,"$args(0)",-1)),Ec=[Mc],Rc=S(()=>e("td",null,"Phrase:",-1)),Fc=S(()=>e("code",null,"$args(1:)",-1)),Lc=[Fc],qc=S(()=>e("tr",null,[e("td",null,"Response:"),e("td",null,[e("div",{class:"help"},[h(" Outputs the translation for the input phrase. The translation is always from/to english. "),e("br"),h(" To let the user decide on the language use "),e("code",null,"$args(0)"),h(" as language, and "),e("code",null,"$args(1:)"),h(" as phrase. "),e("br"),h(" If phrase is left empty, all arguments to the command will be used as the phrase. ")])])],-1)),Oc=S(()=>e("td",null,"Model:",-1)),zc={class:"control"},Jc=S(()=>e("div",{class:"help"},[h(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),Wc=S(()=>e("td",null,"Weirdness:",-1)),Bc={class:"control"},Hc=S(()=>e("div",{class:"help"},[h(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),Gc={key:9},Qc=S(()=>e("td",null,"Response:",-1)),Kc=S(()=>e("td",null,"Outputs the people who chatted during the stream.",-1)),Yc=[Qc,Kc],Xc={key:10},Zc=S(()=>e("td",null,"Response:",-1)),jc=["onUpdate:modelValue"],xc={class:"help"},tp=["disabled","onClick"],ep=S(()=>e("i",{class:"fa fa-remove"},null,-1)),sp=[ep],np={class:"field"},ip=S(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),lp=h(" Add response "),ap=[ip,lp],op=S(()=>e("div",null,[e("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),rp={key:11},dp=S(()=>e("td",null,"Exclude from global widget:",-1)),up=["href"],mp=S(()=>e("div",{class:"help"}," If this checkbox is checked, the media will not be played in the regular media widget. A button will appear with a special widget URL that will only display media from THIS command. ",-1)),hp={key:12},cp=S(()=>e("td",null,"Image:",-1)),pp={key:13},gp=S(()=>e("td",null,"Sound:",-1)),fp={key:14},vp=S(()=>e("td",null,"Image (by URL):",-1)),yp={key:15},$p=S(()=>e("td",null,"Twitch clip:",-1)),_p=S(()=>e("td",null,"Url:",-1)),bp=S(()=>e("td",null,"Volume:",-1)),wp={key:16},kp=S(()=>e("td",null,"Duration:",-1)),Cp={class:"control has-icons-left"},Vp=S(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),Sp={key:17},Up=S(()=>e("td",null,"Settings",-1)),Dp=S(()=>e("td",null,"Variables:",-1)),Ip={key:0},Ap=S(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Value")])],-1)),Tp=["onUpdate:modelValue"],Pp=["onUpdate:modelValue"],Np=["onClick"],Mp=S(()=>e("i",{class:"fa fa-remove"},null,-1)),Ep=[Mp],Rp=S(()=>e("div",{class:"help"},[h(" Variables can be used from the command with "),e("code",null,"$var(variable_name)"),h(". If the referenced variable is not defined here, "),e("a",{href:"/variables/",target:"_blank"},"global variables"),h(" are used. ")],-1)),Fp=S(()=>e("td",null,"Variable changes:",-1)),Lp={key:0},qp=S(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Change"),e("td",null,"Value"),e("td")])],-1)),Op={class:"dropdown is-active is-up"},zp={class:"dropdown-trigger"},Jp=["onUpdate:modelValue","onFocus"],Wp={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},Bp={class:"dropdown-content"},Hp=["onClick"],Gp=h(") "),Qp={class:"select is-small"},Kp=["onUpdate:modelValue"],Yp=S(()=>e("option",{value:"set"},"set",-1)),Xp=S(()=>e("option",{value:"increase_by"},"increase by",-1)),Zp=S(()=>e("option",{value:"decrease_by"},"decrease by",-1)),jp=[Yp,Xp,Zp],xp=["onUpdate:modelValue"],tg=["onClick"],eg=S(()=>e("i",{class:"fa fa-remove"},null,-1)),sg=[eg],ng=S(()=>e("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),ig=S(()=>e("td",null,"Permissions:",-1)),lg=["value"],ag={class:"modal-card-foot"},og=["disabled"];function rg(t,s,n,d,g,y){const m=w("trigger-editor"),i=w("dropdown-button"),r=w("macro-select"),o=w("image-upload"),c=w("sound-upload"),b=w("volume-slider"),_=w("duration-input"),$=w("countdown-editor");return t.item?(l(),a("div",rc,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...v)=>t.onOverlayClick&&t.onOverlayClick(...v))}),e("div",dc,[e("header",uc,[e("p",mc,C(t.title),1),e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...v)=>t.onCloseClick&&t.onCloseClick(...v))})]),e("section",hc,[e("table",cc,[e("tbody",null,[e("tr",null,[pc,e("td",null,[(l(!0),a(D,null,P(t.item.triggers,(v,U)=>(l(),L(m,{key:U,class:"spacerow",modelValue:v,channelPointsCustomRewards:t.channelPointsCustomRewards,removable:t.item.triggers.length>1,"onUpdate:modelValue":V=>t.item.triggers[U]=V,onRemove:V=>t.rmtrigger(U)},null,8,["modelValue","channelPointsCustomRewards","removable","onUpdate:modelValue","onRemove"]))),128)),k(i,{actions:t.possibleTriggerActions,label:"Add trigger",onClick:t.addtrigger},null,8,["actions","onClick"])])]),t.actionDescription?(l(),a("tr",gc,[fc,e("td",{innerHTML:t.actionDescription},null,8,vc)])):p("",!0),t.requiresAccessToken?(l(),a("tr",yc,bc)):p("",!0),t.item.action==="set_channel_title"?(l(),a("tr",wc,[kc,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[2]||(s[2]=v=>t.item.data.title=v)},null,512),[[f,t.item.data.title]]),e("span",{class:"button is-small mr-1",onClick:s[3]||(s[3]=v=>t.item.data.title="")},"All args")])])):p("",!0),t.item.action==="set_channel_game_id"?(l(),a("tr",Cc,[Vc,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[4]||(s[4]=v=>t.item.data.game_id=v)},null,512),[[f,t.item.data.game_id]]),e("span",{class:"button is-small mr-1",onClick:s[5]||(s[5]=v=>t.item.data.game_id="")},"All args")])])):p("",!0),t.item.action==="add_stream_tags"?(l(),a("tr",Sc,[Uc,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[6]||(s[6]=v=>t.item.data.tag=v)},null,512),[[f,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[7]||(s[7]=v=>t.item.data.tag="")},"All args")])])):p("",!0),t.item.action==="remove_stream_tags"?(l(),a("tr",Dc,[Ic,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[8]||(s[8]=v=>t.item.data.tag=v)},null,512),[[f,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[9]||(s[9]=v=>t.item.data.tag="")},"All args")])])):p("",!0),t.item.action==="sr_addtag"?(l(),a("tr",Ac,[Tc,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[10]||(s[10]=v=>t.item.data.tag=v)},null,512),[[f,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[11]||(s[11]=v=>t.item.data.tag="")},"All args")])])):p("",!0),t.item.action==="dict_lookup"?(l(),a(D,{key:7},[e("tr",null,[Pc,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[12]||(s[12]=v=>t.item.data.lang=v)},null,512),[[f,t.item.data.lang]]),(l(!0),a(D,null,P(t.dictLangs,(v,U)=>(l(),a("span",{key:U,class:"button is-small mr-1",onClick:V=>t.item.data.lang=v.value,title:v.title},C(v.flag),9,Nc))),128)),e("span",{class:"button is-small mr-1",onClick:s[13]||(s[13]=v=>t.item.data.lang="$args(0)")},Ec)])]),e("tr",null,[Rc,e("td",null,[u(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[14]||(s[14]=v=>t.item.data.phrase=v)},null,512),[[f,t.item.data.phrase]]),e("span",{class:"button is-small mr-1",onClick:s[15]||(s[15]=v=>t.item.data.phrase="")},"All args"),e("span",{class:"button is-small mr-1",onClick:s[16]||(s[16]=v=>t.item.data.phrase="$args(1:)")},Lc)])]),qc],64)):p("",!0),t.item.action==="madochan_createword"?(l(),a(D,{key:8},[e("tr",null,[Oc,e("td",null,[e("div",zc,[u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[17]||(s[17]=v=>t.item.data.model=v)},null,512),[[f,t.item.data.model]])]),Jc])]),e("tr",null,[Wc,e("td",null,[e("div",Bc,[u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[18]||(s[18]=v=>t.item.data.weirdness=v)},null,512),[[f,t.item.data.weirdness]])]),Hc])])],64)):p("",!0),t.item.action==="chatters"?(l(),a("tr",Gc,Yc)):p("",!0),t.item.action==="text"?(l(),a("tr",Xc,[Zc,e("td",null,[(l(!0),a(D,null,P(t.item.data.text,(v,U)=>(l(),a("div",{key:U,class:"field textarea-holder"},[u(e("textarea",{class:E(["textarea",{"has-background-danger-light":!t.item.data.text[U],"has-text-danger-dark":!t.item.data.text[U]}]),type:"text","onUpdate:modelValue":V=>t.item.data.text[U]=V},null,10,jc),[[f,t.item.data.text[U]]]),e("div",xc,[k(r,{onSelected:V=>t.insertMacro(U,V)},null,8,["onSelected"])]),e("button",{class:"button is-small",disabled:t.item.data.text.length<=1,onClick:V=>t.rmtxt(U)},sp,8,tp)]))),128)),e("div",np,[e("button",{class:"button is-small",onClick:s[19]||(s[19]=(...v)=>t.addtxt&&t.addtxt(...v))},ap)]),op])])):p("",!0),t.item.action==="media"?(l(),a("tr",rp,[dp,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[20]||(s[20]=v=>t.item.data.excludeFromGlobalWidget=v)},null,512),[[F,t.item.data.excludeFromGlobalWidget]]),t.item.data.excludeFromGlobalWidget?(l(),a("a",{key:0,class:"button is-small ml-1",href:`${t.widgetUrl}?id=${t.item.id}`},"Open widget",8,up)):p("",!0),mp])])):p("",!0),t.item.action==="media"?(l(),a("tr",hp,[cp,e("td",null,[k(o,{modelValue:t.item.data.image,"onUpdate:modelValue":[s[21]||(s[21]=v=>t.item.data.image=v),t.mediaImgChanged]},null,8,["modelValue","onUpdate:modelValue"])])])):p("",!0),t.item.action==="media"?(l(),a("tr",pp,[gp,e("td",null,[k(c,{modelValue:t.item.data.sound,"onUpdate:modelValue":[s[22]||(s[22]=v=>t.item.data.sound=v),t.mediaSndChanged],baseVolume:t.baseVolume},null,8,["modelValue","baseVolume","onUpdate:modelValue"])])])):p("",!0),t.item.action==="media"?(l(),a("tr",fp,[vp,e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":s[23]||(s[23]=v=>t.item.data.image_url=v)},null,512),[[f,t.item.data.image_url]]),e("div",null,[e("span",{class:"button is-small",onClick:s[24]||(s[24]=v=>t.item.data.image_url="$user($args).profile_image_url")},"Profile image of user given by args"),e("span",{class:"button is-small",onClick:s[25]||(s[25]=v=>t.item.data.image_url="$user.profile_image_url")},"Profile image of user who executes the command")])])])):p("",!0),t.item.action==="media"?(l(),a("tr",yp,[$p,e("td",null,[e("table",null,[e("tr",null,[_p,e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":s[26]||(s[26]=v=>t.item.data.twitch_clip.url=v)},null,512),[[f,t.item.data.twitch_clip.url]])])]),e("tr",null,[bp,e("td",null,[k(b,{modelValue:t.item.data.twitch_clip.volume,"onUpdate:modelValue":s[27]||(s[27]=v=>t.item.data.twitch_clip.volume=v)},null,8,["modelValue"])])])]),e("div",null,[e("span",{class:"button is-small",onClick:s[28]||(s[28]=v=>t.item.data.twitch_clip.url="$user($args).recent_clip_url")},"A recent clip of user given by args"),e("span",{class:"button is-small",onClick:s[29]||(s[29]=v=>t.item.data.twitch_clip.url="$user.recent_clip_url")},"A recent clip of user who executes the command")])])])):p("",!0),t.item.action==="media"?(l(),a("tr",wp,[kp,e("td",null,[e("div",Cp,[k(_,{modelValue:t.item.data.minDurationMs,"onUpdate:modelValue":s[30]||(s[30]=v=>t.item.data.minDurationMs=v)},null,8,["modelValue"]),Vp])])])):p("",!0),t.item.action==="countdown"?(l(),a("tr",Sp,[Up,e("td",null,[k($,{modelValue:t.item.data,"onUpdate:modelValue":s[31]||(s[31]=v=>t.item.data=v),baseVolume:t.baseVolume},null,8,["modelValue","baseVolume"])])])):p("",!0),e("tr",null,[Dp,e("td",null,[t.item.variables.length>0?(l(),a("table",Ip,[Ap,e("tbody",null,[(l(!0),a(D,null,P(t.item.variables,(v,U)=>(l(),a("tr",{key:U},[e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>v.name=V},null,8,Tp),[[f,v.name]])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>v.value=V},null,8,Pp),[[f,v.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:V=>t.rmVariable(U)},Ep,8,Np)])]))),128))])])):p("",!0),e("span",{class:"button is-small",onClick:s[32]||(s[32]=(...v)=>t.onAddVariable&&t.onAddVariable(...v))},"Add Variable"),Rp])]),e("tr",null,[Fp,e("td",null,[t.item.variableChanges.length>0?(l(),a("table",Lp,[qp,e("tbody",null,[(l(!0),a(D,null,P(t.item.variableChanges,(v,U)=>(l(),a("tr",{key:U},[e("td",null,[e("div",Op,[e("div",zp,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>v.name=V,onFocus:V=>t.variableChangeFocusIdx=U,onBlur:s[33]||(s[33]=(...V)=>t.onVarChangeInputBlur&&t.onVarChangeInputBlur(...V))},null,40,Jp),[[f,v.name]])]),t.variableChangeFocusIdx===U?(l(),a("div",Wp,[e("div",Bp,[(l(!0),a(D,null,P(t.autocompletableVariables(v.name),(V,ut)=>(l(),a("a",{class:"dropdown-item",key:ut,onClick:$t=>v.name=V.var.name},[h(C(V.var.name)+" ("+C(V.type)+", ",1),e("code",null,C(V.var.value),1),Gp],8,Hp))),128))])])):p("",!0)])]),e("td",null,[e("div",Qp,[u(e("select",{"onUpdate:modelValue":V=>v.change=V},jp,8,Kp),[[jt,v.change]])])]),e("td",null,[u(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":V=>v.value=V},null,8,xp),[[f,v.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:V=>t.rmVariableChange(U)},sg,8,tg)])]))),128))])])):p("",!0),e("span",{class:"button is-small",onClick:s[34]||(s[34]=(...v)=>t.onAddVariableChange&&t.onAddVariableChange(...v))},"Add Variable Change"),ng])]),e("tr",null,[ig,e("td",null,[(l(!0),a(D,null,P(t.possiblePermissions,(v,U)=>(l(),a("label",{key:U,class:"mr-1"},[u(e("input",{type:"checkbox","onUpdate:modelValue":s[35]||(s[35]=V=>t.item.restrict_to=V),value:v.value},null,8,lg),[[F,t.item.restrict_to]]),h(" "+C(v.label),1)]))),128))])])])])]),e("footer",ag,[e("button",{class:"button is-small is-primary",disabled:!t.valid,onClick:s[36]||(s[36]=(...v)=>t.onSaveClick&&t.onSaveClick(...v))}," Save changes ",8,og),e("button",{class:"button is-small",onClick:s[37]||(s[37]=(...v)=>t.onCancelClick&&t.onCancelClick(...v))},"Cancel")])])])):p("",!0)}var dg=A(oc,[["render",rg],["__scopeId","data-v-6f025cb4"]]);const ug=I({props:{globalVariables:{type:Array,required:!0},channelPointsCustomRewards:{type:Object,required:!0},possibleActions:{type:Array,required:!0},baseVolume:{type:Number,required:!0},modelValue:{type:Array,required:!0},showToggleImages:{type:Boolean,required:!1,default:!1},showFilterActions:{type:Boolean,required:!1,default:!1},showImages:{type:Boolean,required:!1,default:!1},widgetUrl:{type:String,required:!1,default:""}},emits:["update:modelValue","showImagesChange"],data(){return{commands:[],editIdx:null,editCommand:null,filter:{search:"",actions:[]},imagesVisible:!1}},computed:{possibleActionsMapped(){return this.possibleActions.map(t=>({type:t,title:this.actionDescription(t),label:`Add ${this.actionName(t)}`}))},possibleActionsWithCount(){return this.possibleActions.map(t=>({action:t,count:this.commandCount(t)})).filter(t=>t.count>0)}},methods:{onImageVisibleChange(){this.$emit("showImagesChange",this.imagesVisible)},emitChange(){this.$emit("update:modelValue",this.commands)},commandCount(t){let s=0;for(const n of this.commands)n.action===t&&s++;return s},filteredOut(t){if(this.filter.actions.length>0&&!this.filter.actions.includes(t.action))return!0;if(!this.filter.search)return!1;const s=this.filter.search.toLowerCase();return!t.triggers.find(({type:n,data:d})=>n==="command"&&d.command.toLowerCase().indexOf(s)>=0)},permissionsStr(t){return Fl(t.restrict_to)},remove(t){this.commands=this.commands.filter((s,n)=>n!==t),this.emitChange()},add(t){const s=t.type;this.editIdx=this.commands.length,this.editCommand=st[s].NewCommand()},edit(t){this.editIdx=t,this.editCommand=this.commands[t]},duplicate(t){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[t]))},editedCommand(t){this.editIdx!==null&&(this.commands[this.editIdx]=t,this.emitChange(),this.editIdx=null,this.editCommand=null)},dragEnd(t){this.commands=Y.arrayMove(this.commands,t.oldIndex,t.newIndex),this.emitChange()},actionDescription(t){return st[t].Description()},actionName(t){return st[t].Name()}},created(){this.commands=JSON.parse(JSON.stringify(this.modelValue)),this.imagesVisible=this.showImages}}),z=t=>(G("data-v-7ea14b54"),t=t(),Q(),t),mg={class:"actions"},hg=z(()=>e("div",{class:"mr-1"},"Filter:",-1)),cg={class:"field has-addons mr-1 mb-0"},pg={class:"control"},gg={key:0,class:"field"},fg=["value"],vg={key:0,class:"table-container"},yg={class:"table is-striped",ref:"table"},$g=z(()=>e("th",null,null,-1)),_g=z(()=>e("th",null,null,-1)),bg=z(()=>e("th",null,"Trigger",-1)),wg=h(" Response "),kg={key:0},Cg=h(" Show images "),Vg=z(()=>e("th",null,"Type",-1)),Sg=z(()=>e("th",null,"Permissions",-1)),Ug=z(()=>e("th",null,null,-1)),Dg=z(()=>e("th",null,null,-1)),Ig=z(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Ag={class:"pl-0 pr-0"},Tg=["onClick"],Pg=z(()=>e("i",{class:"fa fa-pencil"},null,-1)),Ng=[Pg],Mg={class:"col-triggers"},Eg={key:0},Rg=h(" First chat: "),Fg={key:0},Lg={key:1},qg={key:1},Og={key:2},zg=z(()=>e("span",{class:"is-small",title:"Channel Point Reward"},[e("i",{class:"fa fa-bullseye"}),h(": ")],-1)),Jg={key:3},Wg=z(()=>e("span",{class:"is-small"},"Timer: ",-1)),Bg={key:0},Hg={key:0},Gg={key:0,class:"spacerow media-holder media-holder-inline"},Qg={key:1},Kg={key:2,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},Yg={key:3,class:"ml-2"},Xg=h("for at least "),Zg={key:4,class:"ml-2"},jg=h("for "),xg={key:2},tf={key:0},ef=z(()=>e("span",null,"\u2192",-1)),sf=h(" \u2715 "),nf=z(()=>e("span",null,"\u2192",-1)),lf={key:1},af={key:1},of={key:2},rf=h(" Media("),df={key:0},uf={key:1},mf={key:2},hf=h(") "),cf={key:3},pf=["innerHTML"],gf={class:"pl-0 pr-0"},ff=z(()=>e("i",{class:"fa fa-trash"},null,-1)),vf=["onClick"],yf=z(()=>e("i",{class:"fa fa-clone"},null,-1)),$f=[yf],_f={key:1};function bf(t,s,n,d,g,y){const m=w("dropdown-button"),i=w("duration"),r=w("responsive-image"),o=w("player"),c=w("doubleclick-button"),b=w("draggable"),_=w("command-editor");return l(),a("div",null,[e("div",mg,[k(m,{actions:t.possibleActionsMapped,label:"Add command",onClick:t.add},null,8,["actions","onClick"]),hg,e("div",cg,[e("div",pg,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=$=>t.filter.search=$)},null,512),[[f,t.filter.search]])])]),t.showFilterActions?(l(),a("div",gg,[(l(!0),a(D,null,P(t.possibleActionsWithCount,($,v)=>(l(),a("label",{class:"mr-1",key:v},[u(e("input",{class:"mr-1",type:"checkbox",value:$.action,"onUpdate:modelValue":s[1]||(s[1]=U=>t.filter.actions=U)},null,8,fg),[[F,t.filter.actions]]),h(C($.action)+" ("+C($.count)+")",1)]))),128))])):p("",!0)]),t.commands.length>0?(l(),a("div",vg,[e("table",yg,[e("thead",null,[e("tr",null,[$g,_g,bg,e("th",null,[wg,t.showToggleImages?(l(),a("label",kg,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[2]||(s[2]=$=>t.imagesVisible=$),s[3]||(s[3]=(...$)=>t.onImageVisibleChange&&t.onImageVisibleChange(...$))]},null,512),[[F,t.imagesVisible]]),Cg])):p("",!0)]),Vg,Sg,Ug,Dg])]),k(b,{modelValue:t.commands,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:O(({element:$,index:v})=>[u(e("tr",null,[Ig,e("td",Ag,[e("button",{class:"button is-small",onClick:U=>t.edit(v)},Ng,8,Tg)]),e("td",Mg,[(l(!0),a(D,null,P($.triggers,(U,V)=>(l(),a("div",{key:V,class:"spacerow"},[$.triggers[V].type==="first_chat"?(l(),a("div",Eg,[Rg,$.triggers[V].data.since==="alltime"?(l(),a("code",Fg,"alltime")):p("",!0),$.triggers[V].data.since==="stream"?(l(),a("code",Lg,"current stream")):p("",!0)])):p("",!0),$.triggers[V].type==="command"?(l(),a("div",qg,[e("code",null,C($.triggers[V].data.command),1)])):p("",!0),$.triggers[V].type==="reward_redemption"?(l(),a("div",Og,[zg,e("code",null,C($.triggers[V].data.command),1)])):p("",!0),$.triggers[V].type==="timer"?(l(),a("div",Jg,[Wg,e("code",null,[h(C($.triggers[V].data.minLines)+" lines, ",1),k(i,{value:$.triggers[V].data.minInterval},null,8,["value"])])])):p("",!0)]))),128))]),e("td",null,[$.action==="text"?(l(),a("div",Bg,[(l(!0),a(D,null,P($.data.text,(U,V)=>(l(),a(D,{key:V},[e("code",null,C($.data.text[V]),1),V<$.data.text.length-1?(l(),a("span",Hg,"or")):p("",!0)],64))),128))])):$.action==="media"?(l(),a("div",{key:1,class:E($.action)},[$.data.image.file||$.data.sound.file?(l(),a("div",Gg,[$.data.image.file&&t.imagesVisible?(l(),L(r,{key:0,src:$.data.image.urlpath,title:$.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):$.data.image.file?(l(),a("code",Qg,C($.data.image.filename),1)):p("",!0),$.data.image.file&&$.data.sound.file?(l(),a("i",Kg)):p("",!0),k(o,{src:$.data.sound.urlpath,name:$.data.sound.filename,volume:$.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),$.data.image.file&&$.data.sound.file?(l(),a("span",Yg,[Xg,k(i,{value:$.data.minDurationMs},null,8,["value"])])):$.data.image.file?(l(),a("span",Zg,[jg,k(i,{value:$.data.minDurationMs},null,8,["value"])])):p("",!0)])):p("",!0)],2)):$.action==="countdown"?(l(),a("div",xg,[($.data.type||"auto")==="auto"?(l(),a("div",tf,[e("code",null,C($.data.intro),1),ef,e("code",null,C($.data.steps),1),sf,k(i,{value:$.data.interval},null,8,["value"]),nf,e("code",null,C($.data.outro),1)])):(l(),a("div",lf,[(l(!0),a(D,null,P($.data.actions,(U,V)=>(l(),a(D,{key:V},[U.type==="delay"?(l(),L(i,{key:0,value:U.value},null,8,["value"])):p("",!0),U.type==="text"?(l(),a("code",af,C(U.value),1)):p("",!0),U.type==="media"?(l(),a("code",of,[rf,U.value.image.file?(l(),a("span",df,C(U.value.image.filename),1)):p("",!0),U.value.image.file&&U.value.sound.file?(l(),a("span",uf,"+")):p("",!0),U.value.sound.file?(l(),a("span",mf,C(U.value.sound.filename),1)):p("",!0),hf])):p("",!0),V<$.data.actions.length-1?(l(),a("span",cf,"\u2192")):p("",!0)],64))),128))]))])):t.actionDescription($.action)?(l(),a("div",{key:3,innerHTML:t.actionDescription($.action)},null,8,pf)):p("",!0)]),e("td",null,C($.action),1),e("td",null,C(t.permissionsStr($)),1),e("td",gf,[k(c,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:U=>t.remove(v)},{default:O(()=>[ff]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:U=>t.duplicate(v)},$f,8,vf)])],512),[[gt,!t.filteredOut($)]])]),_:1},8,["modelValue","onEnd"])],512)])):(l(),a("div",_f,"No commands set up")),t.editCommand?(l(),L(_,{key:2,globalVariables:t.globalVariables,channelPointsCustomRewards:t.channelPointsCustomRewards,modelValue:t.editCommand,mode:t.editIdx>=t.commands.length?"create":"edit",baseVolume:t.baseVolume,widgetUrl:t.widgetUrl,"onUpdate:modelValue":t.editedCommand,onCancel:s[4]||(s[4]=$=>t.editCommand=null)},null,8,["globalVariables","channelPointsCustomRewards","modelValue","mode","baseVolume","widgetUrl","onUpdate:modelValue"])):p("",!0)])}var wf=A(ug,[["render",bf],["__scopeId","data-v-7ea14b54"]]);const kf=I({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(t){this.countdown.actions=Y.arrayMove(this.countdown.actions,t.oldIndex,t.newIndex)},onAddDelay(){this.countdown.actions.push(Ll())},onAddText(){this.countdown.actions.push(ql())},onAddMedia(){this.countdown.actions.push(Ol())},rmaction(t){this.countdown.actions=this.countdown.actions.filter((s,n)=>n!==t)},mediaSndChanged(t,s){this.countdown.actions[t].value.sound=s},mediaImgChanged(t,s){this.countdown.actions[t].value.image=s}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),Cf={class:"control"},Vf={class:"radio"},Sf=h(" Manual "),Uf={class:"radio"},Df=h(" Auto "),If={key:0},Af={class:"spacerow"},Tf=e("label",{class:"spacelabel"},"Steps ",-1),Pf={class:"spacerow"},Nf=e("label",{class:"spacelabel"},"Interval ",-1),Mf={class:"spacerow"},Ef=e("label",{class:"spacelabel"},"Intro ",-1),Rf={class:"spacerow"},Ff=e("label",{class:"spacelabel"},"Outro ",-1),Lf={key:1},qf={class:"field has-addons mr-1"},Of=e("span",{class:"handle p-2"},[e("i",{class:"fa fa-arrows"})],-1),zf={key:0,class:"control has-icons-left"},Jf=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),Wf={key:1,class:"control has-icons-left"},Bf=["onUpdate:modelValue"],Hf=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),Gf={key:2,class:"control has-icons-left"},Qf=e("td",null,"Image:",-1),Kf=e("td",null,"Sound:",-1),Yf=e("td",null,"Duration:",-1),Xf={class:"control has-icons-left"},Zf=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),jf={class:"control"},xf=["onClick"],tv=e("i",{class:"fa fa-remove"},null,-1),ev=[tv],sv=e("i",{class:"fa fa-hourglass mr-1"},null,-1),nv=h(" Add Delay "),iv=[sv,nv],lv=e("i",{class:"fa fa-comments-o mr-1"},null,-1),av=h(" Add Chat "),ov=[lv,av],rv=e("i",{class:"fa fa-picture-o mr-1"},null,-1),dv=h(" Add Media "),uv=[rv,dv];function mv(t,s,n,d,g,y){const m=w("duration-input"),i=w("image-upload"),r=w("sound-upload"),o=w("draggable");return l(),a("div",null,[e("div",Cf,[e("label",Vf,[u(e("input",{type:"radio",value:"manual","onUpdate:modelValue":s[0]||(s[0]=c=>t.countdown.type=c)},null,512),[[x,t.countdown.type]]),Sf]),e("label",Uf,[u(e("input",{type:"radio",value:"auto","onUpdate:modelValue":s[1]||(s[1]=c=>t.countdown.type=c)},null,512),[[x,t.countdown.type]]),Df])]),t.countdown.type==="auto"?(l(),a("div",If,[e("div",Af,[Tf,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[2]||(s[2]=c=>t.countdown.steps=c)},null,512),[[f,t.countdown.steps]])]),e("div",Pf,[Nf,k(m,{modelValue:t.countdown.interval,"onUpdate:modelValue":s[3]||(s[3]=c=>t.countdown.interval=c)},null,8,["modelValue"])]),e("div",Mf,[Ef,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[4]||(s[4]=c=>t.countdown.intro=c)},null,512),[[f,t.countdown.intro]])]),e("div",Rf,[Ff,u(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[5]||(s[5]=c=>t.countdown.outro=c)},null,512),[[f,t.countdown.outro]])])])):(l(),a("div",Lf,[k(o,{modelValue:t.countdown.actions,onEnd:t.dragEnd,handle:".handle","item-key":"id"},{item:O(({element:c,index:b})=>[e("div",qf,[Of,c.type==="delay"?(l(),a("div",zf,[k(m,{modelValue:c.value,"onUpdate:modelValue":_=>c.value=_},null,8,["modelValue","onUpdate:modelValue"]),Jf])):c.type==="text"?(l(),a("div",Wf,[u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":_=>c.value=_},null,8,Bf),[[f,c.value]]),Hf])):c.type==="media"?(l(),a("div",Gf,[e("table",null,[e("tr",null,[Qf,e("td",null,[k(i,{modelValue:c.value.image,"onUpdate:modelValue":[_=>c.value.image=_,_=>t.mediaImgChanged(b,_)]},null,8,["modelValue","onUpdate:modelValue"])])]),e("tr",null,[Kf,e("td",null,[k(r,{modelValue:c.value.sound,"onUpdate:modelValue":[_=>c.value.sound=_,_=>t.mediaSndChanged(b,_)],baseVolume:t.baseVolume},null,8,["modelValue","onUpdate:modelValue","baseVolume"])])]),e("tr",null,[Yf,e("td",null,[e("div",Xf,[k(m,{modelValue:c.value.minDurationMs,"onUpdate:modelValue":_=>c.value.minDurationMs=_},null,8,["modelValue","onUpdate:modelValue"]),Zf])])])])])):p("",!0),e("div",jf,[e("button",{class:"button is-small",onClick:_=>t.rmaction(b)},ev,8,xf)])])]),_:1},8,["modelValue","onEnd"]),e("button",{class:"button is-small",onClick:s[6]||(s[6]=(...c)=>t.onAddDelay&&t.onAddDelay(...c))},iv),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...c)=>t.onAddText&&t.onAddText(...c))},ov),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(...c)=>t.onAddMedia&&t.onAddMedia(...c))},uv)]))])}var hv=A(kf,[["render",mv]]);const cv=I({props:{modelValue:{type:Object,required:!0},removable:{type:Boolean,required:!0},channelPointsCustomRewards:{type:Object,required:!0}},emits:["update:modelValue","remove"],data(){return{value:{type:"",data:{command:"",commandExact:!1,minInterval:0,minLines:0}}}},created(){this.apply(this.modelValue)},computed:{rewardRedemptionActions(){const t=[];for(let s in this.channelPointsCustomRewards)t.push(...this.channelPointsCustomRewards[s].map(n=>({type:n,title:n,label:n})));return t.sort((s,n)=>s.title===n.title?0:s.title<n.title?-1:1),t}},methods:{emitRemove(){this.$emit("remove")},emitUpdate(){this.$emit("update:modelValue",this.value)},apply(t){this.value=JSON.parse(JSON.stringify(t))}},watch:{modelValue(t,s){this.apply(t)}}}),W=t=>(G("data-v-beb1981a"),t=t(),Q(),t),pv={class:"trigger-editor"},gv={key:0,class:"field has-addons"},fv=W(()=>e("span",{class:"mr-1"},"First chat by user",-1)),vv={class:"control"},yv={class:"mr-1"},$v=h(" Alltime "),_v={class:"mr-1"},bv=h(" Current Stream "),wv={class:"control"},kv=["disabled"],Cv=W(()=>e("i",{class:"fa fa-remove"},null,-1)),Vv=[Cv],Sv={key:1,class:"field has-addons"},Uv={class:"control has-icons-left mr-1"},Dv=W(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),Iv={class:"control mr-1",title:"Check if command should only be executed if it matches exactly (= no arguments come after it)."},Av=W(()=>e("span",{class:"is-small is-left"},"exact",-1)),Tv={class:"control"},Pv=["disabled"],Nv=W(()=>e("i",{class:"fa fa-remove"},null,-1)),Mv=[Nv],Ev={key:2,class:"field has-addons"},Rv={class:"control has-icons-left"},Fv=W(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-bullseye"})],-1)),Lv={class:"control"},qv=["disabled"],Ov=W(()=>e("i",{class:"fa fa-remove"},null,-1)),zv=[Ov],Jv={key:3,class:"timer-trigger"},Wv={class:"control remove-control"},Bv=["disabled"],Hv=W(()=>e("i",{class:"fa fa-remove"},null,-1)),Gv=[Hv],Qv={class:"timer-trigger-inner"},Kv=W(()=>e("label",{class:"mr-1"},"Messages \u2265",-1)),Yv={class:"control has-icons-left mr-1"},Xv=W(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),Zv=W(()=>e("label",{class:"mr-1"},"Interval \u2265",-1)),jv={class:"control has-icons-left has-icons-right mr-1"},xv=W(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),t1=W(()=>e("p",{class:"help"},[h(" Command will be triggered when at least "),e("code",null,"Messages"),h(" chat messages arrived AND "),e("code",null,"Interval"),h(" have passed. ")],-1));function e1(t,s,n,d,g,y){const m=w("dropdown-button"),i=w("duration-input");return l(),a("div",pv,[t.value.type==="first_chat"?(l(),a("div",gv,[fv,e("div",vv,[e("label",yv,[u(e("input",{type:"radio",class:"checkbox mr-1","onUpdate:modelValue":[s[0]||(s[0]=r=>t.value.data.since=r),s[1]||(s[1]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))],value:"alltime"},null,512),[[x,t.value.data.since]]),$v]),e("label",_v,[u(e("input",{type:"radio",class:"checkbox mr-1","onUpdate:modelValue":[s[2]||(s[2]=r=>t.value.data.since=r),s[3]||(s[3]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))],value:"stream"},null,512),[[x,t.value.data.since]]),bv])]),e("div",wv,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[4]||(s[4]=(...r)=>t.emitRemove&&t.emitRemove(...r))},Vv,8,kv)])])):p("",!0),t.value.type==="command"?(l(),a("div",Sv,[e("div",Uv,[u(e("input",{class:E(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[5]||(s[5]=r=>t.value.data.command=r),s[6]||(s[6]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,2),[[f,t.value.data.command]]),Dv]),e("div",Iv,[e("label",null,[u(e("input",{type:"checkbox",class:"checkbox mr-1","onUpdate:modelValue":[s[7]||(s[7]=r=>t.value.data.commandExact=r),s[8]||(s[8]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,512),[[F,t.value.data.commandExact]]),Av])]),e("div",Tv,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[9]||(s[9]=(...r)=>t.emitRemove&&t.emitRemove(...r))},Mv,8,Pv)])])):p("",!0),t.value.type==="reward_redemption"?(l(),a("div",Ev,[e("div",Rv,[u(e("input",{class:E(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[10]||(s[10]=r=>t.value.data.command=r),s[11]||(s[11]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,2),[[f,t.value.data.command]]),t.rewardRedemptionActions.length?(l(),L(m,{key:0,label:"Pick a reward",actions:t.rewardRedemptionActions,onClick:s[12]||(s[12]=r=>{t.value.data.command=r.type,t.emitUpdate()})},null,8,["actions"])):p("",!0),Fv]),e("div",Lv,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[13]||(s[13]=(...r)=>t.emitRemove&&t.emitRemove(...r))},zv,8,qv)])])):p("",!0),t.value.type==="timer"?(l(),a("div",Jv,[e("div",Wv,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[14]||(s[14]=(...r)=>t.emitRemove&&t.emitRemove(...r))},Gv,8,Bv)]),e("div",Qv,[Kv,e("div",Yv,[u(e("input",{class:"input is-small","onUpdate:modelValue":[s[15]||(s[15]=r=>t.value.data.minLines=r),s[16]||(s[16]=(...r)=>t.emitUpdate&&t.emitUpdate(...r))]},null,512),[[f,t.value.data.minLines]]),Xv]),Zv,e("div",jv,[k(i,{modelValue:t.value.data.minInterval,"onUpdate:modelValue":s[17]||(s[17]=r=>{t.value.data.minInterval=r,t.emitUpdate()})},null,8,["modelValue"]),xv])]),t1])):p("",!0)])}var s1=A(cv,[["render",e1],["__scopeId","data-v-beb1981a"]]);const n1=I({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1,itemsDisplayed:20}),methods:{toggleVisibility(t,s){const n=!!t.hidevideo;this.sendCtrl("videoVisibility",[n,s])},dragEnd(t){this.sendCtrl("move",[t.oldIndex,t.newIndex])},applyFilter(t){this.$emit("filterChange",t)},sendCtrl(t,s){this.$emit("ctrl",[t,s])},isFilteredOut(t){return this.filter.tag!==""&&!t.tags.includes(this.filter.tag)},startAddTag(t){this.tagInputIdx=t,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(t=>(t.filteredOut=this.isFilteredOut(t),t)).slice(0,this.itemsDisplayed)},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(t=>t.tags.includes(this.filter.tag))}},watch:{playlist:function(t,s){t.find(n=>!this.isFilteredOut(n))||this.$emit("stopPlayer")},filter:function(t,s){this.playlist.find(n=>!this.isFilteredOut(n))||this.$emit("stopPlayer")}}}),J=t=>(G("data-v-d02884fc"),t=t(),Q(),t),i1={class:"filters"},l1={class:"currentfilter"},a1=J(()=>e("div",{class:"mr-1"},"Filter:",-1)),o1=J(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),r1={key:1,class:"field has-addons mr-1 mb-0"},d1={class:"control"},u1={class:"control"},m1={class:"pt-1"},h1=h(" Hide filtered out"),c1={key:0},p1={class:"table is-striped"},g1=J(()=>e("thead",null,[e("tr",null,[e("th"),e("th"),e("th"),e("th",null,"Title"),e("th",null,"User"),e("th",null,"Plays"),e("th"),e("th"),e("th"),e("th")])],-1)),f1=J(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),v1=["disabled","onClick"],y1=J(()=>e("i",{class:"fa fa-play"},null,-1)),$1=[y1],_1=["href"],b1=J(()=>e("i",{class:"fa fa-external-link"},null,-1)),w1=["onClick"],k1=J(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),C1=["onClick"],V1=J(()=>e("i",{class:"fa fa-plus"},null,-1)),S1=[V1],U1={key:0,class:"field has-addons"},D1={class:"control"},I1=["onKeyup"],A1={class:"control"},T1=["disabled","onClick"],P1=["onClick"],N1=J(()=>e("i",{class:"fa fa-eraser"},null,-1)),M1=[N1],E1=["onClick","title"],R1=["onClick"],F1=J(()=>e("i",{class:"fa fa-thumbs-up mr-1"},null,-1)),L1=["onClick"],q1=J(()=>e("i",{class:"fa fa-eraser"},null,-1)),O1=[q1],z1=["onClick"],J1=J(()=>e("i",{class:"fa fa-thumbs-down mr-1"},null,-1)),W1=["onClick"],B1=J(()=>e("i",{class:"fa fa-eraser"},null,-1)),H1=[B1],G1=["onClick"],Q1=J(()=>e("i",{class:"fa fa-trash"},null,-1)),K1=[Q1],Y1={key:1};function X1(t,s,n,d,g,y){const m=w("draggable");return l(),a("div",null,[e("div",i1,[e("div",l1,[a1,t.filter.tag?(l(),a("span",{key:0,class:"tag mr-1",onClick:s[0]||(s[0]=i=>t.applyFilter(""))},[h(C(t.filter.tag)+" ",1),o1])):(l(),a("div",r1,[e("div",d1,[u(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>t.filterTagInput=i),onKeyup:s[2]||(s[2]=X(i=>t.applyFilter(t.filterTagInput),["enter"]))},null,544),[[f,t.filterTagInput]])]),e("div",u1,[e("span",{class:"button is-small",onClick:s[3]||(s[3]=i=>t.applyFilter(t.filterTagInput))},"Apply filter")])])),e("label",m1,[u(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=i=>t.hideFilteredOut=i)},null,512),[[F,t.hideFilteredOut]]),h1])])]),t.playlist.length>0?(l(),a("div",c1,[e("table",p1,[g1,k(m,{modelValue:t.enhancedPlaylist,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:O(({element:i,index:r})=>[u(e("tr",null,[f1,e("td",null,C(r+1),1),e("td",null,[r!==t.firstIndex?(l(),a("button",{key:0,class:"button is-small",disabled:i.filteredOut?!0:null,onClick:o=>t.sendCtrl("playIdx",[r]),title:"Play"},$1,8,v1)):p("",!0)]),e("td",null,[e("a",{href:"https://www.youtube.com/watch?v="+i.yt,target:"_blank"},[h(C(i.title||i.yt)+" ",1),b1],8,_1),e("div",null,[(l(!0),a(D,null,P(i.tags,(o,c)=>(l(),a("span",{key:c,class:"tag",onClick:b=>t.sendCtrl("rmtag",[o,r])},[h(C(o)+" ",1),k1],8,w1))),128)),e("span",{class:"button is-small",onClick:o=>t.startAddTag(r)},S1,8,C1)]),t.tagInputIdx===r?(l(),a("div",U1,[e("div",D1,[u(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.tagInput=o),onKeyup:X(o=>{t.sendCtrl("addtag",[t.tagInput,r]),t.tagInput=""},["enter"])},null,40,I1),[[f,t.tagInput]])]),e("div",A1,[e("span",{class:"button is-small",disabled:t.tagInput?null:!0,onClick:o=>{t.sendCtrl("addtag",[t.tagInput,r]),t.tagInput=""}},"Add tag",8,T1)])])):p("",!0)]),e("td",null,C(i.user),1),e("td",null,[h(C(i.plays)+"x ",1),e("button",{class:"button is-small ml-1",onClick:o=>t.sendCtrl("resetStatIdx",["plays",r]),title:"Reset plays"},M1,8,P1)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.toggleVisibility(i,r),title:i.hidevideo?"Video hidden":"Video visible"},[e("i",{class:E(["fa mr-1",{"fa-eye":!i.hidevideo,"fa-eye-slash":i.hidevideo}])},null,2)],8,E1)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.sendCtrl("goodIdx",[r])},[F1,h(" "+C(i.goods),1)],8,R1),e("button",{class:"button is-small ml-1",onClick:o=>t.sendCtrl("resetStatIdx",["goods",r]),title:"Reset upvotes"},O1,8,L1)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.sendCtrl("badIdx",[r])},[J1,h(" "+C(i.bads),1)],8,z1),e("button",{class:"button is-small ml-1",onClick:o=>t.sendCtrl("resetStatIdx",["bads",r]),title:"Reset downvotes"},H1,8,W1)]),e("td",null,[e("button",{class:"button is-small",onClick:o=>t.sendCtrl("rmIdx",[r]),title:"Remove"},K1,8,G1)])],512),[[gt,!t.hideFilteredOut||!i.filteredOut]])]),_:1},8,["modelValue","onEnd"])]),e("div",null,[t.itemsDisplayed<t.playlist.length?(l(),a("span",{key:0,class:"button is-small mr-1",onClick:s[6]||(s[6]=i=>t.itemsDisplayed+=20)},"Show more (+20)")):p("",!0),t.itemsDisplayed<t.playlist.length?(l(),a("span",{key:1,class:"button is-small",onClick:s[7]||(s[7]=i=>t.itemsDisplayed=t.playlist.length)},"Show all ("+C(t.playlist.length)+")",1)):p("",!0)])])):(l(),a("div",Y1,"Playlist is empty"))])}var Z1=A(n1,[["render",X1],["__scopeId","data-v-d02884fc"]]);const j1=I({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(t){const s=this.settings.customCssPresets.find(n=>n.name===t);s?(this.settings.customCss=s.css,this.settings.showProgressBar=s.showProgressBar,this.settings.showThumbnails=s.showThumbnails,this.settings.maxItemsShown=s.maxItemsShown):console.warn(`preset not found: ${t}`),this.sendSettings()},removePreset(t){this.settings.customCssPresets=this.settings.customCssPresets.filter(s=>s.name!==t),this.sendSettings()},savePreset(){const t=this.settings.customCssPresets.findIndex(s=>s.name===this.cssPresetName);t>=0?(this.settings.customCssPresets[t].css=this.settings.customCss,this.settings.customCssPresets[t].showProgressBar=this.settings.showProgressBar,this.settings.customCssPresets[t].showThumbnails=this.settings.showThumbnails,this.settings.customCssPresets[t].maxItemsShown=this.settings.maxItemsShown):this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss,showProgressBar:this.settings.showProgressBar,showThumbnails:this.settings.showThumbnails,maxItemsShown:this.settings.maxItemsShown}),this.sendSettings()},hideVideoImageChanged(t){this.settings.hideVideoImage=t,this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:me(),css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.title { margin-bottom: 0; }
.meta-left, .meta-right, .thumbnail { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Replace icon for thumbs-up with an image",code:`.meta-right .vote-up { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }
.meta-right .vote-up .fa { display: none; }`},{desc:"Remove text before/after username",code:`.meta-user-text-before,
.meta-user-text-after {display: none}`},{desc:"Add a fontawesome icon before username (\\f075 is the icon unicode, refer to https://fontawesome.com/v4.7/icons/)",code:'.meta-user-name::before { content: "\\f075"; display: inline-block; font: normal normal normal 14px/1 FontAwesome; font-size: inherit; margin-right: .5em; }'},{desc:"Add an image icon before username",code:".meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }"},{desc:"Add an image icon before username for specific user only",code:`[data-user="nc_para_" i] .meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }`},{desc:"Change item display depending on username (this one changes background and makes thumbnails black boxes)",code:`[data-user="nc_para_" i] { background: #dd0066; }
[data-user="nc_para_" i] .thumbnail img { display: none; }
[data-user="nc_para_" i] .thumbnail { background: black; }`},{desc:"Show player left of the playlist (and limit its height to 320px)",code:`.wrapper { display: grid; grid-template-areas: "player playlist"; grid-template-columns: 50% auto; grid-template-rows: 320px; }
.player iframe { height: 320px; }`},{desc:"Show thumbnails only, and display meta info above them",code:`.item { display: block; position: relative; padding: 0; color: white; }
.title, .meta-left, .meta-right { position: absolute; padding: .2em; background: rgba(244,0,90,.9); }
.meta-left { top: 0; left: 0; font-size: 1em; }
.meta-right { top: 0; right: 0; font-size: 1em; }
.title { bottom: 0; left: 0; right: 0; margin-bottom: 0; }
.thumbnail { width: auto; }`},{desc:"Align thumbnails to the bottom",code:".thumbnail { align-self: end; }"},{desc:"Align thumbnails to the center",code:".thumbnail { align-self: center; }"},{desc:"Add a margin/padding to the thumbnails",code:".thumbnail { padding: 20px; }"},{desc:"Show number of plays not at player, but in icon form on the right near votes",code:`.meta-left .meta-user:after,
.meta-left .meta-plays { display: none; }
.meta-right .meta-plays { display: inline-block; }`},{desc:"Show the progress bar only, and no video (progress bar above list)",code:`
.player { height: 5px; padding-bottom: 0; }
.progress { height: 5px; }`},{desc:"Show the progress bar only, and no video (progress bar below list)",code:`
.wrapper { display: grid; grid-template-areas: "list" "player"; }
.player { height: 5px; padding-bottom: 0; grid-area: player }
.list { grid-area: list }
.progress { height: 5px; }`}]}})}),M=t=>(G("data-v-766b21f4"),t=t(),Q(),t),x1={key:0,class:"table is-striped",ref:"table"},ty=M(()=>e("tr",null,[e("td",{colspan:"3"},"General")],-1)),ey=M(()=>e("td",null,[e("code",null,"settings.volume")],-1)),sy=M(()=>e("td",null,"Base volume for all songs played.",-1)),ny=M(()=>e("td",null,[e("code",null,"settings.initAutoplay")],-1)),iy=M(()=>e("td",null,"If checked, the widget will autoplay when first opened.",-1)),ly=M(()=>e("td",null,[e("code",null,"settings.hideVideoImage")],-1)),ay=M(()=>e("td",null,"Image to display when a video is hidden.",-1)),oy=M(()=>e("td",null,[e("code",null,"settings.maxSongLength.viewer")],-1)),ry=M(()=>e("td",null,[h(" Limits the maximum duration of songs that viewers can add/request. ("),e("code",null,"0"),h(" = unlimited, for example: "),e("code",null,"5m"),h(", "),e("code",null,"1h"),h(", ...) ")],-1)),dy=M(()=>e("td",null,[e("code",null,"settings.maxSongLength.mod")],-1)),uy=M(()=>e("td",null,[h(" Limits the maximum duration of songs that mods can add/request. ("),e("code",null,"0"),h(" = unlimited, for example: "),e("code",null,"5m"),h(", "),e("code",null,"1h"),h(", ...) ")],-1)),my=M(()=>e("td",null,[e("code",null,"settings.maxSongLength.sub")],-1)),hy=M(()=>e("td",null,[h(" Limits the maximum duration of songs that subscribers can add/request. ("),e("code",null,"0"),h(" = unlimited, for example: "),e("code",null,"5m"),h(", "),e("code",null,"1h"),h(", ...) ")],-1)),cy=M(()=>e("td",null,[e("code",null,"settings.maxSongsQueued.viewer")],-1)),py=M(()=>e("td",null,"Number of new songs that viewers can request. (0 = unlimited)",-1)),gy=M(()=>e("td",null,[e("code",null,"settings.maxSongsQueued.mod")],-1)),fy=M(()=>e("td",null,"Number of new songs that mods can request. (0 = unlimited)",-1)),vy=M(()=>e("td",null,[e("code",null,"settings.maxSongsQueued.sub")],-1)),yy=M(()=>e("td",null,"Number of new songs that subscribers can request. (0 = unlimited)",-1)),$y=M(()=>e("tr",null,[e("td",{colspan:"3"},"Visuals")],-1)),_y=M(()=>e("td",null,[e("code",null,"settings.showProgressBar")],-1)),by=M(()=>e("td",null,"Render a progress bar in the bottom part of the video in the widget.",-1)),wy=M(()=>e("td",null,[e("code",null,"settings.showThumbnails")],-1)),ky={class:"mr-1"},Cy=h("Off"),Vy={class:"mr-1"},Sy=h("Left"),Uy={class:"mr-1"},Dy=h("Right"),Iy=M(()=>e("td",null,"Render video thumbnails in the widget.",-1)),Ay=M(()=>e("td",null,[e("code",null,"settings.maxItemsShown")],-1)),Ty=M(()=>e("td",null,"Max. number of items displayed in the playlist. Set to -1 for no limit.",-1)),Py=M(()=>e("code",null,"settings.customCss",-1)),Ny={class:"field has-addons mr-1"},My={class:"control is-expanded"},Ey={class:"control"},Ry=["onClick"],Fy=["onClick"],Ly=M(()=>e("i",{class:"fa fa-remove"},null,-1)),qy=[Ly],Oy=M(()=>e("p",null,"Classes that can be used for styling:",-1)),zy={class:"table"},Jy=M(()=>e("thead",null,[e("tr",null,[e("th",null,"Class"),e("th",null,"Description")])],-1)),Wy=M(()=>e("p",null,[e("b",null,"Examples:")],-1));function By(t,s,n,d,g,y){const m=w("volume-slider"),i=w("image-upload"),r=w("duration-input");return l(),a("div",null,[t.settings?(l(),a("table",x1,[e("tbody",null,[ty,e("tr",null,[ey,e("td",null,[k(m,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[0]||(s[0]=o=>t.settings.volume=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),sy]),e("tr",null,[ny,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[1]||(s[1]=o=>t.settings.initAutoplay=o),s[2]||(s[2]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[F,t.settings.initAutoplay]])]),iy]),e("tr",null,[ly,e("td",null,[k(i,{modelValue:t.settings.hideVideoImage,"onUpdate:modelValue":[s[3]||(s[3]=o=>t.settings.hideVideoImage=o),t.hideVideoImageChanged],width:"100px",height:"50px",class:"mb-1"},null,8,["modelValue","onUpdate:modelValue"])]),ay]),e("tr",null,[oy,e("td",null,[k(r,{modelValue:t.settings.maxSongLength.viewer,"onUpdate:modelValue":[s[4]||(s[4]=o=>t.settings.maxSongLength.viewer=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),ry]),e("tr",null,[dy,e("td",null,[k(r,{modelValue:t.settings.maxSongLength.mod,"onUpdate:modelValue":[s[5]||(s[5]=o=>t.settings.maxSongLength.mod=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),uy]),e("tr",null,[my,e("td",null,[k(r,{modelValue:t.settings.maxSongLength.sub,"onUpdate:modelValue":[s[6]||(s[6]=o=>t.settings.maxSongLength.sub=o),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),hy]),e("tr",null,[cy,e("td",null,[u(e("input",{class:"input is-small",type:"number","onUpdate:modelValue":[s[7]||(s[7]=o=>t.settings.maxSongsQueued.viewer=o),s[8]||(s[8]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[f,t.settings.maxSongsQueued.viewer]])]),py]),e("tr",null,[gy,e("td",null,[u(e("input",{class:"input is-small",type:"number","onUpdate:modelValue":[s[9]||(s[9]=o=>t.settings.maxSongsQueued.mod=o),s[10]||(s[10]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[f,t.settings.maxSongsQueued.mod]])]),fy]),e("tr",null,[vy,e("td",null,[u(e("input",{class:"input is-small",type:"number","onUpdate:modelValue":[s[11]||(s[11]=o=>t.settings.maxSongsQueued.sub=o),s[12]||(s[12]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[f,t.settings.maxSongsQueued.sub]])]),yy]),$y,e("tr",null,[_y,e("td",null,[u(e("input",{type:"checkbox","onUpdate:modelValue":[s[13]||(s[13]=o=>t.settings.showProgressBar=o),s[14]||(s[14]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[F,t.settings.showProgressBar]])]),by]),e("tr",null,[wy,e("td",null,[e("label",ky,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[15]||(s[15]=o=>t.settings.showThumbnails=o),s[16]||(s[16]=(...o)=>t.sendSettings&&t.sendSettings(...o))],value:!1},null,512),[[x,t.settings.showThumbnails]]),Cy]),e("label",Vy,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[17]||(s[17]=o=>t.settings.showThumbnails=o),s[18]||(s[18]=(...o)=>t.sendSettings&&t.sendSettings(...o))],value:"left"},null,512),[[x,t.settings.showThumbnails]]),Sy]),e("label",Uy,[u(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[19]||(s[19]=o=>t.settings.showThumbnails=o),s[20]||(s[20]=(...o)=>t.sendSettings&&t.sendSettings(...o))],value:"right"},null,512),[[x,t.settings.showThumbnails]]),Dy])]),Iy]),e("tr",null,[Ay,e("td",null,[u(e("input",{type:"number",min:"-1","onUpdate:modelValue":[s[21]||(s[21]=o=>t.settings.maxItemsShown=o),s[22]||(s[22]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[f,t.settings.maxItemsShown]])]),Ty]),e("tr",null,[e("td",null,[Py,e("div",Ny,[e("div",My,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[23]||(s[23]=o=>t.cssPresetName=o),onFocus:s[24]||(s[24]=o=>t.cssPresetDropdownActive=!0),onBlur:s[25]||(s[25]=o=>t.cssPresetDropdownActive=!1)},null,544),[[f,t.cssPresetName]])]),e("div",Ey,[e("span",{class:"button is-small",onClick:s[26]||(s[26]=(...o)=>t.savePreset&&t.savePreset(...o))},"Save preset")])]),(l(!0),a(D,null,P(t.settings.customCssPresets,(o,c)=>(l(),a("div",{class:"mb-1",key:c},[e("span",{class:"button is-small",onClick:b=>t.loadPreset(o.name)},C(o.name),9,Ry),e("span",{class:"button is-small ml-1",onClick:b=>t.removePreset(o.name)},qy,8,Fy)]))),128))]),e("td",null,[u(e("textarea",{class:"textarea","onUpdate:modelValue":[s[27]||(s[27]=o=>t.settings.customCss=o),s[28]||(s[28]=(...o)=>t.sendSettings&&t.sendSettings(...o))]},null,512),[[f,t.settings.customCss]])]),e("td",null,[Oy,e("table",zy,[Jy,e("tbody",null,[(l(!0),a(D,null,P(t.css.classExamples,(o,c)=>(l(),a("tr",{key:c},[e("td",null,[e("code",null,C(o.class),1)]),e("td",null,C(o.desc),1)]))),128))])]),Wy,(l(!0),a(D,null,P(t.css.codeExamples,(o,c)=>(l(),a("p",{key:c},[h(C(o.desc)+" ",1),e("pre",null,[e("code",null,C(o.code),1)])]))),128))])])])],512)):p("",!0)])}var Hy=A(j1,[["render",By],["__scopeId","data-v-766b21f4"]]);const Gy=I({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(t,s){this.editTag=t.value,this.tagEditIdx=s},updateTag(t,s){this.$emit("updateTag",[t,s])}}}),Qy={class:"table is-striped"},Ky=e("tr",null,[e("th",null,"Tag"),e("th"),e("th")],-1),Yy=["onKeyup"],Xy=["value","onFocus"],Zy=["disabled","onClick"];function jy(t,s,n,d,g,y){return l(),a("table",Qy,[Ky,(l(!0),a(D,null,P(t.tags,(m,i)=>(l(),a("tr",{key:i},[e("td",null,[t.tagEditIdx===i?u((l(),a("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=r=>t.editTag=r),onKeyup:X(r=>t.updateTag(m.value,t.editTag),["enter"])},null,40,Yy)),[[f,t.editTag]]):(l(),a("input",{key:1,type:"text",class:"input is-small",value:m.value,onFocus:r=>t.onInputFocus(m,i)},null,40,Xy))]),e("td",null,[t.tagEditIdx===i?(l(),a("span",{key:0,class:"button is-small",disabled:m.value===t.editTag?!0:null,onClick:r=>t.updateTag(m.value,t.editTag)},"Save",8,Zy)):p("",!0)]),e("td",null,C(m.count)+"x",1)]))),128))])}var xy=A(Gy,[["render",jy]]);const t$=I({props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","cancel"],data:()=>({item:null,itemStr:"null",newState:"",newSlotDefinitionName:""}),mounted(){this.itemStr=JSON.stringify(this.modelValue),this.item=JSON.parse(this.itemStr),this.adjustAllImagesDivSize(),window.addEventListener("resize",this.adjustAllImagesDivSize)},unmounted(){window.removeEventListener("resize",this.adjustAllImagesDivSize)},watch:{modelValue:{handler(t){this.item=JSON.parse(this.itemStr)}},item:{handler(t){this.itemStr=JSON.stringify(t)},deep:!0},itemStr:{handler(t){const s=JSON.stringify(this.item);try{const n=JSON.parse(t);s!==n&&(this.item=n)}catch(n){console.warn(n)}}}},computed:{allImages(){var s;const t=[];return(s=this.item)==null||s.slotDefinitions.forEach(n=>{n.items.forEach(d=>{d.states.forEach(g=>{g.frames.forEach(y=>{y.url&&!t.includes(y.url)&&t.push(y.url)})})})}),t},isStateAddable(){return!(!this.item||this.newState===""||this.item.stateDefinitions.find(({value:t})=>t===this.newState))}},methods:{autoDetectDimensions(){if(this.allImages.length===0)return;const t=new Image;t.onload=()=>{!this.item||(this.item.width=t.width,this.item.height=t.height)},t.src=this.allImages[0]},adjustAllImagesDivSize(){this.$nextTick(()=>{if(!this.$refs.cardBody||!this.$refs.allImagesDiv)return;const t=this.$refs.cardBody.clientHeight;this.$refs.allImagesDiv.style.maxHeight=`${t}px`})},imageDragStart(t){t.dataTransfer.setData("avatar-image-url",t.target.getAttribute("data-src"))},emitUpdate(){if(!this.item){console.warn("emitUpdate: this.item not initialized");return}this.$emit("update:modelValue",he({name:this.item.name,width:parseInt(`${this.item.width}`,10),height:parseInt(`${this.item.height}`,10),stateDefinitions:this.item.stateDefinitions,slotDefinitions:this.item.slotDefinitions,state:this.item.state}))},onSaveClick(){this.emitUpdate()},onSaveAndCloseClick(){this.emitUpdate(),this.$emit("cancel")},onCancelClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},addStateDefinition(){if(!this.item){console.warn("addStateDefinition: this.item not initialized");return}const t={value:this.newState,deletable:!0};this.item.stateDefinitions.push(t);for(let s of this.item.slotDefinitions)for(let n of s.items)n.states.push({state:t.value,frames:[]})},removeStateDefinition(t){if(!this.item){console.warn("removeStateDefinition: this.item not initialized");return}const s=[];for(let d in this.item.stateDefinitions)parseInt(d,10)!==parseInt(`${t}`,10)&&s.push(this.item.stateDefinitions[d]);this.item.stateDefinitions=s;const n=s.map(d=>d.value);for(let d of this.item.slotDefinitions)for(let g of d.items)g.states=g.states.filter(y=>n.includes(y.state))},removeSlotDefinition(t){if(!this.item){console.warn("removeSlotDefinition: this.item not initialized");return}const s=[];for(let n in this.item.slotDefinitions)parseInt(n,10)!==parseInt(`${t}`,10)&&s.push(this.item.slotDefinitions[n]);this.item.slotDefinitions=s},updateSlotDefinition(t,s){if(!this.item){console.warn("updateSlotDefinition: this.item not initialized");return}this.item.slotDefinitions[parseInt(`${t}`,10)]=s},addSlotDefinition(){if(!this.item){console.warn("addSlotDefinition: this.item not initialized");return}const t={slot:"Unnamed slot",defaultItemIndex:-1,items:[]};this.item.slotDefinitions.push(t)},moveSlotUp(t){this.swapItems(t-1,t)},moveSlotDown(t){this.swapItems(t+1,t)},swapItems(t,s){if(!this.item){console.warn("swapItems: this.item not initialized");return}yt(this.item.slotDefinitions,t,s)}}}),e$={key:0,class:"avatar-editor modal is-active"},s$={class:"modal-card"},n$={class:"modal-card-head"},i$=e("p",{class:"modal-card-title"},"Edit Avatar",-1),l$={class:"modal-card-body",ref:"cardBody"},a$={class:"columns"},o$={class:"column is-three-quarters"},r$={class:"table is-striped"},d$=e("td",null,"Name:",-1),u$=e("td",null,"Dimensions:",-1),m$=h("\u2716"),h$=h(" Pixels "),c$=e("td",null,"States:",-1),p$=["onClick"],g$=e("i",{class:"fa fa-trash"},null,-1),f$=[g$],v$=["disabled"],y$=e("td",null,"Slots",-1),$$={class:"column"},_$=e("div",null,"JSON:",-1),b$=e("div",null,"All images in use:",-1),w$={class:"avatar-all-images",ref:"allImagesDiv"},k$=["src","data-src"],C$={class:"modal-card-foot"};function V$(t,s,n,d,g,y){const m=w("avatar-slot-definition-editor");return t.item?(l(),a("div",e$,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...i)=>t.onOverlayClick&&t.onOverlayClick(...i))}),e("div",s$,[e("header",n$,[i$,e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...i)=>t.onCloseClick&&t.onCloseClick(...i))})]),e("section",l$,[e("div",a$,[e("div",o$,[e("table",r$,[e("tbody",null,[e("tr",null,[d$,e("td",null,[u(e("input",{class:"input is-small","onUpdate:modelValue":s[2]||(s[2]=i=>t.item.name=i)},null,512),[[f,t.item.name]])])]),e("tr",null,[u$,e("td",null,[u(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.item.width=i)},null,512),[[f,t.item.width]]),m$,u(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.item.height=i)},null,512),[[f,t.item.height]]),h$,t.allImages.length?(l(),a("span",{key:0,class:"button is-small",onClick:s[5]||(s[5]=(...i)=>t.autoDetectDimensions&&t.autoDetectDimensions(...i))},"Auto-detect")):p("",!0)])]),e("tr",null,[c$,e("td",null,[(l(!0),a(D,null,P(t.item.stateDefinitions,(i,r)=>(l(),a("span",{class:"tag",key:r},[e("span",null,C(i.value),1),i.deletable?(l(),a("span",{key:0,class:"ml-1 is-clickable",onClick:o=>t.removeStateDefinition(r)},f$,8,p$)):p("",!0)]))),128)),u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=i=>t.newState=i),placeholder:"State"},null,512),[[f,t.newState]]),e("span",{class:"button is-small",onClick:s[7]||(s[7]=(...i)=>t.addStateDefinition&&t.addStateDefinition(...i)),disabled:t.isStateAddable?null:!0},"Add custom state",8,v$)])]),e("tr",null,[y$,e("td",null,[(l(!0),a(D,null,P(t.item.slotDefinitions,(i,r)=>(l(),L(m,{class:"card mb-2",key:r,modelValue:i,avatarDef:t.item,"onUpdate:modelValue":o=>t.updateSlotDefinition(r,o),onMoveUp:o=>t.moveSlotUp(r),onMoveDown:o=>t.moveSlotDown(r),onRemove:o=>t.removeSlotDefinition(r)},null,8,["modelValue","avatarDef","onUpdate:modelValue","onMoveUp","onMoveDown","onRemove"]))),128))])])])]),e("span",{class:"button is-small",onClick:s[8]||(s[8]=(...i)=>t.addSlotDefinition&&t.addSlotDefinition(...i))},"Add slot")]),e("div",$$,[_$,u(e("textarea",{class:"textarea mb-2","onUpdate:modelValue":s[9]||(s[9]=i=>t.itemStr=i)},null,512),[[f,t.itemStr]]),b$,e("div",w$,[(l(!0),a(D,null,P(t.allImages,(i,r)=>(l(),a("img",{key:r,src:i,draggable:"true",class:"mr-1 mb-1",onDragstart:s[10]||(s[10]=(...o)=>t.imageDragStart&&t.imageDragStart(...o)),"data-src":i},null,40,k$))),128))],512)])])],512),e("footer",C$,[e("button",{class:"button is-small is-primary",onClick:s[11]||(s[11]=(...i)=>t.onSaveClick&&t.onSaveClick(...i))}," Save "),e("button",{class:"button is-small is-primary",onClick:s[12]||(s[12]=(...i)=>t.onSaveAndCloseClick&&t.onSaveAndCloseClick(...i))}," Save and close "),e("button",{class:"button is-small",onClick:s[13]||(s[13]=(...i)=>t.onCancelClick&&t.onCancelClick(...i))},"Cancel")])])])):p("",!0)}var S$=A(t$,[["render",V$]]);const U$=I({props:{modelValue:{type:Object,required:!0},avatarDef:{type:Object,required:!0}},emits:["update:modelValue","remove","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultItem(){return this.modelValue.defaultItemIndex>=0&&this.modelValue.items.length>this.modelValue.defaultItemIndex?this.modelValue.items[this.modelValue.defaultItemIndex]:null},defaultAnimation(){if(!this.defaultItem)return[];const t=this.defaultItem.states.find(({state:s})=>s==="default");return t?t.frames:[]}},methods:{emitChange(){this.$emit("update:modelValue",this.modelValue)},updateItem(t,s){this.modelValue.items[t]=s,this.emitChange()},removeItem(t,s){this.modelValue.items=this.modelValue.items.filter((n,d)=>d!==t),t<=this.modelValue.defaultItemIndex&&(this.modelValue.defaultItemIndex=this.modelValue.defaultItemIndex-1),this.modelValue.items.length>0&&this.modelValue.defaultItemIndex<0&&(this.modelValue.defaultItemIndex=0),this.emitChange()},makeItemDefault(t,s){this.modelValue.defaultItemIndex=t,this.emitChange()},addItem(){const t={title:`${this.modelValue.slot} item ${this.modelValue.items.length+1}`,states:this.avatarDef.stateDefinitions.map(s=>({state:s.value,frames:[]}))};this.modelValue.items.push(t),this.modelValue.defaultItemIndex===-1&&(this.modelValue.defaultItemIndex=0),this.emitChange()},moveItemUp(t){this.swapItems(t-1,t)},moveItemDown(t){this.swapItems(t+1,t)},swapItems(t,s){yt(this.modelValue.items,t,s)&&(this.modelValue.defaultItemIndex===t?this.modelValue.defaultItemIndex=s:this.modelValue.defaultItemIndex===s&&(this.modelValue.defaultItemIndex=t))}}}),D$={class:"avatar-slot-definition-editor"},I$={class:"level avatar-slot-definition-editor-title p-1"},A$={class:"level-left"},T$={class:"level-item"},P$={class:"level-item"},N$={class:"level-right"},M$={class:"level-item"},E$={class:"level-item"},R$={class:"level-item"},F$=e("i",{class:"fa fa-trash"},null,-1),L$=[F$],q$={class:"p-1"};function O$(t,s,n,d,g,y){const m=w("avatar-animation"),i=w("avatar-slot-item-editor");return l(),a("div",D$,[e("div",I$,[e("div",A$,[e("div",T$,[k(m,{frames:t.defaultAnimation,width:32,height:32},null,8,["frames"])]),e("div",P$,[u(e("input",{class:E(["input is-small avatar-slot-definition-editor-title-input",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=r=>t.titleFocused=!0),onBlur:s[1]||(s[1]=r=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=r=>t.modelValue.slot=r)},null,34),[[f,t.modelValue.slot]])])]),e("div",N$,[e("div",M$,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[3]||(s[3]=r=>t.$emit("moveUp"))})]),e("div",E$,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[4]||(s[4]=r=>t.$emit("moveDown"))})]),e("div",R$,[e("span",{class:"button is-small",onClick:s[5]||(s[5]=r=>t.$emit("remove"))},L$)])])]),e("div",q$,[(l(!0),a(D,null,P(t.modelValue.items,(r,o)=>(l(),L(i,{class:E(["card mb-1",{"is-default":o===this.modelValue.defaultItemIndex}]),key:o,modelValue:r,isDefault:o===this.modelValue.defaultItemIndex,onMoveUp:c=>t.moveItemUp(o),onMoveDown:c=>t.moveItemDown(o),"onUpdate:modelValue":c=>t.updateItem(o,c),onRemove:c=>t.removeItem(o,c),onMakeDefault:c=>t.makeItemDefault(o,c)},null,8,["class","modelValue","isDefault","onMoveUp","onMoveDown","onUpdate:modelValue","onRemove","onMakeDefault"]))),128))]),e("span",{class:"button is-small",onClick:s[6]||(s[6]=(...r)=>t.addItem&&t.addItem(...r))},"Add item")])}var z$=A(U$,[["render",O$]]);const J$=I({props:{modelValue:{type:Object,required:!0},isDefault:{type:Boolean,required:!0}},emits:["update:modelValue","makeDefault","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultState(){return this.modelValue.states.find(({state:t})=>t==="default")}},methods:{updateAnimation(t,s){},makeDefault(){this.$emit("makeDefault",this.modelValue)}}}),W$={class:"avatar-slot-item-editor p-1"},B$={class:"level"},H$={class:"level-left"},G$={class:"level-item"},Q$={class:"level-item"},K$={key:0,class:"has-text-success mr-1"},Y$=e("i",{class:"fa fa-check"},null,-1),X$=h(" Default"),Z$=[Y$,X$],j$={class:"level-right"},x$={class:"level-item"},t_={class:"level-item"},e_={class:"level-item"},s_=e("i",{class:"fa fa-trash"},null,-1),n_=[s_];function i_(t,s,n,d,g,y){const m=w("avatar-slot-item-state-editor");return l(),a("div",W$,[e("div",B$,[e("div",H$,[e("div",G$,[u(e("input",{type:"text",class:E(["input is-small avatar-slot-item-editor-title",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=i=>t.titleFocused=!0),onBlur:s[1]||(s[1]=i=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=i=>t.modelValue.title=i)},null,34),[[f,t.modelValue.title]])]),e("div",Q$,[t.isDefault?(l(),a("span",K$,Z$)):(l(),a("span",{key:1,class:"button is-small",onClick:s[3]||(s[3]=(...i)=>t.makeDefault&&t.makeDefault(...i))},"Make default"))])]),e("div",j$,[e("div",x$,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[4]||(s[4]=i=>t.$emit("moveUp"))})]),e("div",t_,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[5]||(s[5]=i=>t.$emit("moveDown"))})]),e("div",e_,[e("span",{class:"button is-small",onClick:s[6]||(s[6]=i=>t.$emit("remove"))},n_)])])]),(l(!0),a(D,null,P(t.modelValue.states,(i,r)=>(l(),L(m,{class:"mr-1",modelValue:i,defaultState:t.defaultState,"onUpdate:modelValue":o=>t.updateAnimation(r,o),key:r},null,8,["modelValue","defaultState","onUpdate:modelValue"]))),128))])}var l_=A(J$,[["render",i_]]);const a_=I({props:{avatar:{type:Object,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},computed:{animations(){return this.avatar.slotDefinitions.map(t=>{const s=t.items[t.defaultItemIndex];return s?s.states.find(({state:n})=>n==="default"):{title:"",states:[]}})}}});function o_(t,s,n,d,g,y){const m=w("avatar-animation");return l(),a("div",{class:"avatar-preview",style:Z({width:`${t.width}px`,height:`${t.height}px`})},[(l(!0),a(D,null,P(t.animations,(i,r)=>(l(),L(m,{frames:i.frames,key:r,width:t.width,height:t.height},null,8,["frames","width","height"]))),128))],4)}var r_=A(a_,[["render",o_]]);const d_=I({props:{modelValue:{type:Object,required:!0},defaultState:{type:Object,required:!0}},data(){return{draggingOver:!1,editing:!1}},methods:{onDragOver(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragLeave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1},onDragEnter(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDrop(t){if(this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),t.dataTransfer.getData("avatar-image-url")){const n={url:t.dataTransfer.getData("avatar-image-url"),duration:100};this.modelValue.frames.push(n)}else{let n=null;if(t.dataTransfer.items){for(var s=0;s<t.dataTransfer.items.length;s++)if(t.dataTransfer.items[s].kind==="file"){n=t.dataTransfer.items[s].getAsFile();break}}else for(var s=0;s<t.dataTransfer.files.length;s++){n=t.dataTransfer.files[s];break}n&&this.$refs.uploadComponent.uploadFile(n)}return!1},onUploaded(t){this.modelValue.frames.push({url:t.urlpath,duration:100})},onOverlayClick(){this.editing=!1},frameChanged(t,s){s.url===""?this.modelValue.frames=this.modelValue.frames.filter((n,d)=>d!==t):this.modelValue.frames[t]=s},addFrame(){const t={url:"",duration:100};this.modelValue.frames.push(t)}}}),u_={class:"avatar-slot-item-state-editor-title"},m_={class:"avatar-animation-card mr-1"},h_={class:"avatar-animation-frame"},c_=e("i",{class:"fa fa-plus"},null,-1),p_=[c_];function g_(t,s,n,d,g,y){const m=w("avatar-animation"),i=w("avatar-frame-upload"),r=w("upload");return l(),a("div",{class:E(["avatar-slot-item-state-editor card",{"dragging-over":t.draggingOver}]),onDragover:s[1]||(s[1]=(...o)=>t.onDragOver&&t.onDragOver(...o)),onDragenter:s[2]||(s[2]=(...o)=>t.onDragEnter&&t.onDragEnter(...o)),onDragleave:s[3]||(s[3]=(...o)=>t.onDragLeave&&t.onDragLeave(...o)),onDrop:s[4]||(s[4]=(...o)=>t.onDrop&&t.onDrop(...o))},[e("div",u_,C(t.modelValue.state),1),t.modelValue.frames.length?(l(),L(m,{key:0,frames:t.modelValue.frames},null,8,["frames"])):(l(),L(m,{key:1,frames:t.defaultState.frames,class:"avatar-fallback-animation"},null,8,["frames"])),e("div",null,[(l(!0),a(D,null,P(t.modelValue.frames,(o,c)=>(l(),a("div",{class:"avatar-animation-card mr-1",key:c},[k(i,{modelValue:o,"onUpdate:modelValue":b=>t.frameChanged(c,b)},null,8,["modelValue","onUpdate:modelValue"])]))),128)),e("div",m_,[e("span",h_,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...o)=>t.addFrame&&t.addFrame(...o))},p_)])])]),u(k(r,{onUploaded:t.onUploaded,accept:"image/*",label:"",ref:"uploadComponent"},null,8,["onUploaded"]),[[gt,!1]])],34)}var f_=A(d_,[["render",g_]]);const v_=I({props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{value:{url:"",duration:100},draggingOver:!1}},created(){this.applyValue()},watch:{modelValue(){this.applyValue()}},methods:{applyValue(){this.modelValue!==null?this.value=JSON.parse(JSON.stringify(this.modelValue)):this.value={url:"",duration:100}},emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onDurationChange(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={url:"",duration:100},this.emitUpdate()},onUploaded(t){this.value={url:t.urlpath,duration:100},this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if(t.dataTransfer.items[n].kind==="file"){s=t.dataTransfer.items[n].getAsFile();break}}else for(var n=0;n<t.dataTransfer.files.length;n++){s=t.dataTransfer.files[n];break}return s&&(this.value.url="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),y_=t=>(G("data-v-345011c1"),t=t(),Q(),t),$_={class:"avatar-animation-frame-remove"},__=y_(()=>e("i",{class:"fa fa-trash"},null,-1)),b_=[__],w_=["src"];function k_(t,s,n,d,g,y){const m=w("upload");return l(),a("span",{onDrop:s[3]||(s[3]=(...i)=>t.onDrop&&t.onDrop(...i)),onDragover:s[4]||(s[4]=(...i)=>t.onDragover&&t.onDragover(...i)),onDragleave:s[5]||(s[5]=(...i)=>t.onDragleave&&t.onDragleave(...i)),class:E(["avatar-animation-frame",{"dragging-over":t.draggingOver}])},[e("div",$_,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...i)=>t.onRemove&&t.onRemove(...i))},b_)]),t.value.url?(l(),a("img",{key:0,src:t.value.url,width:"64",height:"64"},null,8,w_)):p("",!0),u(k(m,{onUploaded:t.onUploaded,accept:"image/*",label:"",class:"avatar-animation-frame-upload",ref:"uploadComponent"},null,8,["onUploaded"]),[[gt,!t.value.url]]),u(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":[s[1]||(s[1]=i=>t.value.duration=i),s[2]||(s[2]=(...i)=>t.onDurationChange&&t.onDurationChange(...i))]},null,512),[[f,t.value.duration]])],34)}var C_=A(v_,[["render",k_],["__scopeId","data-v-345011c1"]]);const V_=I({props:{frames:{type:Array,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},data(){return{timeout:null,idx:-1}},computed:{src(){return this.idx>=0&&this.idx<this.frames.length?this.frames[this.idx].url:""}},methods:{nextFrame(){if(this.frames.length===0){this.idx=-1;return}this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.idx++,this.idx>=this.frames.length&&(this.idx=0),this.timeout=setTimeout(()=>{this.nextFrame()},this.frames[this.idx].duration)}},created(){this.nextFrame(),this.$watch("frames",()=>{this.idx=-1,this.nextFrame()},{deep:!0})},unmounted(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}),S_=["src","width","height"];function U_(t,s,n,d,g,y){return l(),a("span",{class:"avatar-animation",style:Z({width:`${t.width}px`,height:`${t.width}px`})},[t.src?(l(),a("img",{key:0,src:t.src,width:t.width,height:t.height},null,8,S_)):(l(),a("span",{key:1,style:Z({width:`${t.width}px`,height:`${t.width}px`,display:"inline-block"})},null,4))],4)}var D_=A(V_,[["render",U_]]);const I_=async()=>{const t=ge({history:fe(),routes:[{name:"index",path:"/",component:Me,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:ns,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:Bi,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:nu,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:ku,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:Ka,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:ri,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:Na,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:nd,meta:{title:"Speech to text",protected:!0}},{name:"avatar",path:"/avatar/",component:zd,meta:{title:"Avatar",protected:!0}},{name:"pomo",path:"/pomo/",component:pm,meta:{title:"Pomo",protected:!0}},{name:"drawcast",path:"/drawcast/",component:Gn,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:Rl,meta:{title:"Settings",protected:!0}}]});B.eventBus.on("login",()=>{Kt.init()}),B.eventBus.on("logout",()=>{Kt.stop()}),B.eventBus.on("darkmode",n=>{n?document.documentElement.classList.add("darkmode"):document.documentElement.classList.remove("darkmode")}),await vt.init(),await oe.init(),await B.init(),t.beforeEach((n,d,g)=>{if(n.meta.protected&&!B.getMe()){g({name:"login"});return}if(!n.meta.protected&&B.getMe()){g({name:"index"});return}d.name&&document.documentElement.classList.remove(`view-${String(d.name)}`),document.documentElement.classList.add(`view-${String(n.name)}`),document.title=`${n.meta.title}`,g()});const s=ve(ke);s.use(t),s.use(ye,{}),s.component("doubleclick-button",Bh),s.component("dropdown-button",xh),s.component("checkbox",Jm),s.component("draggable",$e),s.component("duration-input",qm),s.component("duration",Oh),s.component("macro-select",gh),s.component("navbar",Eh),s.component("player",Hm),s.component("responsive-image",rh),s.component("slider",eh),s.component("upload",_m),s.component("image-upload",Dm),s.component("sound-upload",Rm),s.component("volume-slider",ih),s.component("youtube",ac),s.component("commands-editor",wf),s.component("command-editor",dg),s.component("countdown-editor",hv),s.component("trigger-editor",s1),s.component("playlist-editor",Z1),s.component("tags-editor",xy),s.component("song-request-settings",Hy),s.component("avatar-editor",S$),s.component("avatar-slot-definition-editor",z$),s.component("avatar-slot-item-editor",l_),s.component("avatar-preview",r_),s.component("avatar-slot-item-state-editor",f_),s.component("avatar-frame-upload",C_),s.component("avatar-animation",D_),s.mount("#app")};I_();
