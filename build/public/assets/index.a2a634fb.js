import{d as V,r as _,o as a,c as o,a as w,b as e,F as D,e as A,t as $,f as v,m as St,w as m,v as y,g as X,h as z,i as g,j as q,n as Q,k as P,u as Gt,l as O,p as H,q as K,s as Dt,x as Yt,y as ot,z as tt,A as Xt,B as Qt,C as Zt,D as jt,E as xt}from"./vendor.7107ada0.js";const te=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const b of c)if(b.type==="childList")for(const h of b.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function i(c){const b={};return c.integrity&&(b.integrity=c.integrity),c.referrerpolicy&&(b.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?b.credentials="include":c.crossorigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function r(c){if(c.ep)return;c.ep=!0;const b=i(c);fetch(c.href,b)}};te();var S=(t,s)=>{const i=t.__vccOpts||t;for(const[r,c]of s)i[r]=c;return i};const ee=V({name:"app"}),se={id:"app"};function ne(t,s,i,r,c,b){const h=_("router-view");return a(),o("div",se,[w(h)])}var ie=S(ee,[["render",ne]]);const lt=async(t,s,i)=>new Promise((r,c)=>{const b=new window.XMLHttpRequest;b.open(t,s,!0),b.withCredentials=!0;const h=i.headers||{};for(const n in h)b.setRequestHeader(n,h[n]);b.addEventListener("load",function(n){r({status:this.status,text:this.responseText,json:async()=>JSON.parse(this.responseText)})}),b.addEventListener("error",function(n){c(new Error("xhr error"))}),b.upload&&i.onUploadProgress&&b.upload.addEventListener("progress",function(n){i.onUploadProgress&&i.onUploadProgress(n)}),b.send(i.body)}),j=async(t,s={})=>lt("get",t,s),ae=async(t,s={})=>lt("post",t,s),It=async(t,s)=>lt("post",t,{headers:{Accept:"application/json","Content-Type":"application/json"},body:s}),G=async(t,s)=>It(t,JSON.stringify(s));var E={resendVerificationMail:async t=>G("/api/user/_resend_verification_mail",t),requestPasswordReset:async t=>G("/api/user/_request_password_reset",t),register:async t=>G("/api/user/_register",t),resetPassword:async t=>G("/api/user/_reset_password",t),handleToken:async t=>G("/api/_handle-token",t),saveVariables:async t=>G("/api/save-variables",t),twitchUserIdByName:async t=>G("/api/twitch/user-id-by-name",t),saveUserSettings:async t=>G("/api/save-settings",t),getPageVariablesData:async()=>j("/api/page/variables"),getPageIndexData:async()=>j("/api/page/index"),getPageSettingsData:async()=>j("/api/page/settings"),getMe:async()=>j("/api/user/me"),logout:async()=>ae("/api/logout"),login:async t=>G("/api/auth",t),getConf:async()=>j("/api/conf"),upload:async(t,s)=>{const i=new FormData;return i.append("file",t,t.name),lt("post","/api/upload",{body:i,onUploadProgress:s})},importPlaylist:async t=>It("/api/sr/import",t),getDrawcastAllImages:async()=>j("/api/drawcast/all-images/")};const oe=V({data:()=>({widgets:null}),async created(){const t=await E.getPageIndexData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.widgets=s.widgets}}),le={key:0,id:"app"},re={id:"top",ref:"top"},de={id:"main",ref:"main"},ue={class:"table is-striped is-fullwidth"},me=e("thead",null,[e("tr",null,[e("th",null,"Widget"),e("th",null,"Hint")])],-1),he=["href"];function ce(t,s,i,r,c,b){const h=_("navbar");return t.widgets?(a(),o("div",le,[e("div",re,[w(h)],512),e("div",de,[e("table",ue,[me,e("tbody",null,[(a(!0),o(D,null,A(t.widgets,(n,l)=>(a(),o("tr",{key:l},[e("td",null,[e("a",{href:n.url,target:"blank"},$(n.title),9,he)]),e("td",null,$(n.hint),1)]))),128))])])],512)])):v("",!0)}var pe=S(oe,[["render",ce]]);let rt=null;const ht=St();async function Ut(){const t=await E.getMe();rt=t.status===200?await t.json():null,rt&&ht.emit("login")}async function ge(){return(await(await E.logout()).json()).success?(rt=null,ht.emit("logout"),{error:!1}):{error:"[2021-09-25 18:36]"}}async function fe(t,s){const i=await E.login({user:t,pass:s});return i.status===200?(await Ut(),{error:!1}):i.status===401?{error:(await i.json()).reason}:{error:"Unknown error"}}var W={getMe:()=>rt,eventBus:ht,logout:ge,login:fe,init:Ut};const ve=V({data:()=>({user:"",pass:"",error:"",success:""}),async mounted(){const s=new URLSearchParams(window.location.search).get("t");if(s){this.success="",this.error="";const i=await E.handleToken({token:s});i.status===200?(await i.json()).type==="registration-verified"&&(this.success="Registration complete"):this.error="Unknown error"}},methods:{async submit(){this.success="",this.error="";const t=await W.login(this.user,this.pass);t.error?this.error=t.error:this.$router.push({name:"index"})}}}),ye={class:"center-screen"},be=e("h1",{class:"title is-6"},"Hyottoko.club",-1),_e={key:0,class:"field has-background-success-light has-text-success-dark"},$e={key:1,class:"field has-background-danger-light has-text-danger-dark"},we={class:"field"},ke={class:"control has-icons-left"},Ce=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),Ve={class:"field"},Se={class:"control has-icons-left"},De=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Ie={class:"field"},Ue={class:"field"},Ae=g("Register an account"),Pe=g(" | "),Te=g("Forgot password?");function Ne(t,s,i,r,c,b){const h=_("router-link");return a(),o("div",ye,[be,e("form",null,[t.success?(a(),o("div",_e,$(t.success),1)):v("",!0),t.error?(a(),o("div",$e,$(t.error),1)):v("",!0),e("div",we,[e("div",ke,[m(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":s[0]||(s[0]=n=>t.user=n),onKeyup:s[1]||(s[1]=n=>t.error="")},null,544),[[y,t.user]]),Ce])]),e("div",Ve,[e("div",Se,[m(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":s[2]||(s[2]=n=>t.pass=n),onKeyup:[s[3]||(s[3]=n=>t.error=""),s[4]||(s[4]=X((...n)=>t.submit&&t.submit(...n),["enter"]))]},null,544),[[y,t.pass]]),De])]),e("div",Ie,[e("span",{class:"button is-small is-primary",onClick:s[5]||(s[5]=(...n)=>t.submit&&t.submit(...n))},"Login")]),e("div",Ue,[w(h,{to:{name:"register"}},{default:z(()=>[Ae]),_:1}),Pe,w(h,{to:{name:"forgot-password"}},{default:z(()=>[Te]),_:1})])])])}var Oe=S(ve,[["render",Ne]]);const At=()=>({submitButtonText:"Submit",submitConfirm:"",recentImagesTitle:"",canvasWidth:720,canvasHeight:405,customDescription:"",customProfileImage:null,palette:["#000000","#808080","#ff0000","#ff8000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff8080","#80ff80","#ffffff","#c0c0c0","#800000","#804000","#808000","#008000","#008080","#000080","#800080","#8080ff","#ffff80"],displayDuration:5e3,displayLatestForever:!1,displayLatestAutomatically:!1,notificationSound:null,favoriteLists:[{list:[],title:""}]});let Pt=null;const Fe=async()=>{const t=await E.getConf();Pt=t.status===200?await t.json():null};var Tt={init:Fe,getConf:()=>Pt};const Ee=1,et=1e3*Ee,st=60*et,nt=60*st,dt=24*nt;let it=[];const Me=t=>{switch(t){case"error":it=["error"];break;case"info":it=["error","info"];break;case"log":it=["error","info","log"];break;case"debug":it=["error","info","log","debug"];break}};Me("info");const Nt=(t,...s)=>{const i=t,r=c=>(...b)=>{it.includes(c)&&console[c](Le("hh:mm:ss",new Date),`[${i}]`,...s,...b)};return{log:r("log"),info:r("info"),debug:r("debug"),error:r("error")}},Le=(t,s)=>t.replace(/(hh|mm|ss)/g,(i,r)=>{switch(r){case"hh":return ut(s.getHours(),"00");case"mm":return ut(s.getMinutes(),"00");case"ss":return ut(s.getSeconds(),"00");default:return i}}),ut=(t,s)=>{const i=`${t}`;return i.length>=s.length?i:s.substr(0,s.length-i.length)+i},Ot=t=>{if(t==="")throw new Error("unable to parse duration");const s=`${t}`.trim();if(!s)throw new Error("unable to parse duration");if(s.match(/^\d+$/))return parseInt(s,10);const i=s.match(/^((?:\d*)\.(?:\d*))(d|h|m|s)$/);if(i){const u=parseFloat(i[1]);if(isNaN(u))throw new Error("unable to parse duration");const f=i[2];let k=0;return f==="d"?k=u*dt:f==="h"?k=u*nt:f==="m"?k=u*st:f==="s"&&(k=u*et),Math.round(k)}const r=s.match(/^(?:(\d+)d)?\s?(?:(\d+)h)?\s?(?:(\d+)m)?\s?(?:(\d+)s)?\s?(?:(\d+)ms)?$/);if(!r)throw new Error("unable to parse duration");const c=r[1]?parseInt(r[1],10):0,b=r[2]?parseInt(r[2],10):0,h=r[3]?parseInt(r[3],10):0,n=r[4]?parseInt(r[4],10):0,l=r[5]?parseInt(r[5],10):0;return n*et+h*st+b*nt+c*dt+l},ze=t=>{try{return Ot(t)}catch{return 0}},qe=t=>{let s=t;const i=Math.floor(s/dt);s=s%dt;const r=Math.floor(s/nt);s=s%nt;const c=Math.floor(s/st);s=s%st;const b=Math.floor(s/et);s=s%et;const h=s,n=["ms","s","m","h","d"],l=[h,b,c,r,i];let u=0;for(;u<l.length&&l[u]===0;)u++;let f=l.length-1;for(;f>=0&&l[f]===0;)f--;const k=[];for(let d=u;d<=f;d++)k.unshift(`${l[d]}${n[d]}`);return k.join(" ")};function Re(t,s,i){if(i>=t.length){let r=i-t.length+1;for(;r--;)t.push(void 0)}return t.splice(i,0,t.splice(s,1)[0]),t}const Je=(t,s)=>{const i=[/\$args(?:\((\d*)(:?)(\d*)\))?/g,/\$rand\(\s*(\d+)?\s*,\s*?(\d+)?\s*\)/g,/\$var\(([^)]+)\)/g,/\$user\.name/g,/\$customapi\(([^$)]*)\)\['([A-Za-z0-9_ -]+)'\]/g,/\$customapi\(([^$)]*)\)/g,/\$urlencode\(([^$)]*)\)/g,/\$calc\((\d+)([*/+-])(\d+)\)/g];let r=t,c;do{c=r;for(const b of i)r=r.replace(b,s)}while(c!==r);return r},Be=(t,s=",",i=-1)=>{const r=t.split(s);return i===-1||r.length<=i?r:[...r.slice(0,i-1),r.slice(i-1).join(s)]},We=t=>{let s=t.length;for(;s>0;){const i=Math.floor(Math.random()*s);s--;const r=t[s];t[s]=t[i],t[i]=r}return t};function Ft(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath}}function Et(t){return{filename:t.originalname,file:t.filename,urlpath:t.urlpath,volume:100}}var Y={arrayMove:Re,humanDuration:qe,parseHumanDuration:ze,mustParseHumanDuration:Ot,doDummyReplacements:Je,split:Be,shuffle:We,pad:ut,mediaFileFromUploadedFile:Ft,soundMediaFileFromUploadedFile:Et};const He=1001,Mt=4e3,Lt=Nt("WsWrapper.ts");class Ke{constructor(s,i){this.handle=null,this.reconnectTimeout=null,this.sendBuffer=[],this.onopen=()=>{},this.onclose=()=>{},this.onmessage=()=>{},this.addr=s,this.protocols=i}send(s){this.handle?this.handle.send(s):this.sendBuffer.push(s)}connect(){const s=new WebSocket(this.addr,this.protocols);s.onopen=i=>{for(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.handle=s;this.sendBuffer.length>0;){const r=this.sendBuffer.shift();r&&this.handle.send(r)}this.onopen(i)},s.onmessage=i=>{this.onmessage(i)},s.onclose=i=>{this.handle=null,i.code===Mt?Lt.info("custom disconnect, will not reconnect"):i.code===He?Lt.info("going away, will not reconnect"):this.reconnectTimeout=setTimeout(()=>{this.connect()},1e3),this.onclose(i)}}disconnect(){this.handle&&this.handle.close(Mt)}}const zt=Nt("WsClient.ts");class Ge extends Ke{constructor(s,i){super(s,i);this._on={},this.onopen=r=>{this._dispatch("socket","open",r)},this.onmessage=r=>{if(this._dispatch("socket","message",r),this._on.message){const c=this._parseMessageData(r.data);c.event&&this._dispatch("message",`${c.event}`,c.data)}},this.onclose=r=>{this._dispatch("socket","close",r)}}onSocket(s,i){this.addEventListener("socket",s,i)}onMessage(s,i){this.addEventListener("message",s,i)}addEventListener(s,i,r){const c=Array.isArray(i)?i:[i];this._on[s]=this._on[s]||{};for(const b of c)this._on[s][b]=this._on[s][b]||[],this._on[s][b].push(r)}_parseMessageData(s){try{const i=JSON.parse(s);if(i.event)return{event:i.event,data:i.data||null}}catch(i){zt.info(i)}return{event:null,data:null}}_dispatch(s,i,...r){const b=(this._on[s]||{})[i]||[];if(b.length!==0){zt.log(`ws dispatch ${s} ${i}`);for(const h of b)h(...r)}}}const Ye=t=>{const s=W.getMe();return`${location.protocol}//${location.host}/widget/${t}/${s.widgetToken}/`},Xe=t=>{const s=Tt.getConf(),i=W.getMe();return new Ge(`${s.wsBase}/${t}`,i?i.token:"")};var R={widgetUrl:Ye,wsClient:Xe};const Qe=V({data:()=>({unchangedJson:"{}",changedJson:"{}",inited:!1,settings:At(),defaultSettings:At(),ws:null,drawUrl:"",favoriteSelection:{hovered:"",items:[],pagination:{page:1,perPage:20}}}),async created(){this.ws=R.wsClient("drawcast"),this.ws.onMessage("init",async t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.drawUrl=t.drawUrl;const s=await E.getDrawcastAllImages();this.favoriteSelection.items=await s.json(),this.inited=!0}),this.ws.connect()},watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},receiveUrl(){return R.widgetUrl("drawcast_receive")},favoriteSelectionTotalPages(){return Math.floor(this.favoriteSelection.items.length/this.favoriteSelection.pagination.perPage)+(this.favoriteSelection.items.length%this.favoriteSelection.pagination.perPage==0?0:1)},currentFavoriteSelectionItems(){const t=(this.favoriteSelection.pagination.page-1)*this.favoriteSelection.pagination.perPage;return this.favoriteSelection.items.slice(t,t+this.favoriteSelection.pagination.perPage)}},methods:{addFavoriteList(){if(!this.settings){console.warn("addFavoriteList: this.settings not initialized");return}this.settings.favoriteLists.push({list:[],title:""})},removeFavoriteList(t){if(!this.settings){console.warn("removeFavoriteList: this.settings not initialized");return}const s=[];for(let i in this.settings.favoriteLists)parseInt(i,10)!==parseInt(`${t}`,10)&&s.push(this.settings.favoriteLists[i]);this.settings.favoriteLists=s},toggleFavorite(t,s){if(!this.settings){console.warn("toggleFavorite: this.settings not initialized");return}this.settings.favoriteLists[t].list.includes(s)?this.settings.favoriteLists[t].list=this.settings.favoriteLists[t].list.filter(i=>i!==s):this.settings.favoriteLists[t].list.push(s)},customProfileImageChanged(t){if(!this.settings){console.warn("customProfileImageChanged: this.settings not initialized");return}this.settings.customProfileImage=t.file?t:null},notificationSoundChanged(t){if(!this.settings){console.warn("notificationSoundChanged: this.settings not initialized");return}this.settings.notificationSound=t.file?t:null},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:{canvasWidth:parseInt(`${this.settings.canvasWidth}`,10)||720,canvasHeight:parseInt(`${this.settings.canvasHeight}`,10)||405,submitButtonText:this.settings.submitButtonText,submitConfirm:this.settings.submitConfirm,recentImagesTitle:this.settings.recentImagesTitle,customDescription:this.settings.customDescription,customProfileImage:this.settings.customProfileImage,palette:this.settings.palette,displayDuration:parseInt(`${this.settings.displayDuration}`,10)||5e3,displayLatestForever:this.settings.displayLatestForever,displayLatestAutomatically:this.settings.displayLatestAutomatically,notificationSound:this.settings.notificationSound,favoriteLists:this.settings.favoriteLists}})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},unmounted(){this.ws&&this.ws.disconnect()}}),Ze={id:"app"},je={id:"top",ref:"top"},xe={id:"actionbar",class:"p-1"},ts=["disabled"],es=["href"],ss=["href"],ns={id:"main",ref:"main"},is={key:0,class:"table is-striped",ref:"table"},as=e("tr",null,[e("td",{colspan:"3"},"General")],-1),os=e("td",null,[e("code",null,"settings.canvasWidth")],-1),ls=e("td",null,[g(" Width of the drawing area."),e("br"),g(" Caution: changing this will clear the area for currenty connected users. ")],-1),rs=e("td",null,[e("code",null,"settings.canvasHeight")],-1),ds=e("td",null,[g(" Height of the drawing area."),e("br"),g(" Caution: changing this will clear the area for currenty connected users. ")],-1),us=e("td",null,[e("code",null,"settings.displayDuration")],-1),ms=e("td",null," The duration in Milliseconds that each drawing will be shown ",-1),hs=e("td",null,[e("code",null,"settings.displayLatestForever")],-1),cs=e("td",null,"If checked, the latest drawing will be shown indefinately.",-1),ps=e("td",null,[e("code",null,"settings.displayLatestAutomatically")],-1),gs=e("td",null," If checked, the latest drawing will be shown in widget automatically. ",-1),fs=e("td",null,[e("code",null,"settings.submitButtonText")],-1),vs=e("td",null,null,-1),ys=e("td",null,[e("code",null,"settings.submitConfirm")],-1),bs=e("td",null," Leave empty if no confirm is required by user before sending. ",-1),_s=e("td",null,[e("code",null,"settings.recentImagesTitle")],-1),$s=e("td",null,"Title for the recently submitted images gallery.",-1),ws=e("td",null,[e("code",null,"settings.customDescription")],-1),ks=e("td",null,"Description text below the drawing panel.",-1),Cs=e("td",null,[e("code",null,"settings.customProfileImage")],-1),Vs=e("td",null,[g(" Profile image that will be displayed next to the "),e("code",null,"settings.customDescription"),g(". ")],-1),Ss=e("td",null,[e("code",null,"settings.palette")],-1),Ds=["onUpdate:modelValue"],Is=e("br",null,null,-1),Us=e("br",null,null,-1),As=e("td",null,[g(" Default colors appearing on the draw page."),e("br"),g(" Caution: Changing this will change selected color for currenty connected users. ")],-1),Ps=e("td",null,[e("code",null,"settings.notificationSound")],-1),Ts=e("td",null,[g(" Add a sound here that plays when new drawings arrive. "),e("br"),g(" Note: Not played in drawing window, only in widget. ")],-1),Ns=e("div",null,[e("code",null,"settings.favoriteLists")],-1),Os={class:"preview"},Fs=["src"],Es={key:0},Ms=["onClick"],Ls=e("div",null,"Title:",-1),zs=["onUpdate:modelValue"],qs=e("div",null,"Currently selected favorites:",-1),Rs={class:"favorites"},Js=["src","onClick","onMouseover"],Bs=e("div",{class:"mt-2"},"Select favorites:",-1),Ws={class:"favorites-select"},Hs=["src","onClick","onMouseover"],Ks=["disabled"],Gs=["disabled"],Ys=e("td",null," The favorites will always be displayed at the beginning of the gallery in the draw widget. ",-1);function Xs(t,s,i,r,c,b){const h=_("navbar"),n=_("image-upload"),l=_("sound-upload");return a(),o("div",Ze,[e("div",je,[w(h),e("div",xe,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...u)=>t.sendSave&&t.sendSave(...u))}," Save ",8,ts),e("a",{class:"button is-small mr-1",href:t.receiveUrl,target:"_blank"},"Open widget",8,es),e("a",{class:"button is-small",href:t.drawUrl,target:"_blank"},"Open draw",8,ss)])],512),e("div",ns,[t.inited?(a(),o("table",is,[e("tbody",null,[as,e("tr",null,[os,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[1]||(s[1]=u=>t.settings.canvasWidth=u)},null,512),[[y,t.settings.canvasWidth]])]),ls]),e("tr",null,[rs,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[2]||(s[2]=u=>t.settings.canvasHeight=u)},null,512),[[y,t.settings.canvasHeight]])]),ds]),e("tr",null,[us,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=u=>t.settings.displayDuration=u)},null,512),[[y,t.settings.displayDuration]])]),ms]),e("tr",null,[hs,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=u=>t.settings.displayLatestForever=u)},null,512),[[q,t.settings.displayLatestForever]])]),cs]),e("tr",null,[ps,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=u=>t.settings.displayLatestAutomatically=u)},null,512),[[q,t.settings.displayLatestAutomatically]])]),gs]),e("tr",null,[fs,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=u=>t.settings.submitButtonText=u)},null,512),[[y,t.settings.submitButtonText]])]),vs]),e("tr",null,[ys,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[7]||(s[7]=u=>t.settings.submitConfirm=u)},null,512),[[y,t.settings.submitConfirm]])]),bs]),e("tr",null,[_s,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[8]||(s[8]=u=>t.settings.recentImagesTitle=u)},null,512),[[y,t.settings.recentImagesTitle]])]),$s]),e("tr",null,[ws,e("td",null,[m(e("textarea",{class:"textarea","onUpdate:modelValue":s[9]||(s[9]=u=>t.settings.customDescription=u)},null,512),[[y,t.settings.customDescription]])]),ks]),e("tr",null,[Cs,e("td",null,[w(n,{modelValue:t.settings.customProfileImage,"onUpdate:modelValue":[s[10]||(s[10]=u=>t.settings.customProfileImage=u),t.customProfileImageChanged],width:"100px",height:"50px",class:"spacerow media-holder"},null,8,["modelValue","onUpdate:modelValue"])]),Vs]),e("tr",null,[Ss,e("td",null,[(a(!0),o(D,null,A(t.settings.palette,(u,f)=>(a(),o("label",{class:"square",key:f},[m(e("input",{type:"color","onUpdate:modelValue":k=>t.settings.palette[f]=k},null,8,Ds),[[y,t.settings.palette[f]]]),e("span",{class:"square-inner",style:Q({backgroundColor:u})},null,4)]))),128)),Is,Us,e("button",{class:"button is-small",onClick:s[11]||(s[11]=u=>t.settings.palette=t.defaultSettings.palette)}," Reset to default palette ")]),As]),e("tr",null,[Ps,e("td",null,[w(l,{modelValue:t.settings.notificationSound,"onUpdate:modelValue":[s[12]||(s[12]=u=>t.settings.notificationSound=u),t.notificationSoundChanged],class:"spacerow media-holder"},null,8,["modelValue","onUpdate:modelValue"])]),Ts]),e("tr",null,[e("td",null,[Ns,e("div",null,[e("span",{class:"button is-small",onClick:s[13]||(s[13]=(...u)=>t.addFavoriteList&&t.addFavoriteList(...u))},"Add a list")]),e("div",Os,[t.favoriteSelection.hovered?(a(),o("img",{key:0,src:t.favoriteSelection.hovered},null,8,Fs)):v("",!0)])]),e("td",null,[(a(!0),o(D,null,A(t.settings.favoriteLists,(u,f)=>(a(),o("div",{key:f},[t.settings.favoriteLists.length>1?(a(),o("div",Es,[e("span",{class:"button is-small",onClick:k=>t.removeFavoriteList(f)},"Remove this list",8,Ms)])):v("",!0),Ls,m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":k=>u.title=k},null,8,zs),[[y,u.title]]),qs,e("div",Rs,[(a(!0),o(D,null,A(u.list,(k,d)=>(a(),o("img",{src:k,key:d,width:"50",height:"50",onClick:p=>t.toggleFavorite(f,k),onMouseover:p=>t.favoriteSelection.hovered=k,onMouseleave:s[14]||(s[14]=p=>t.favoriteSelection.hovered=""),class:"thumbnail is-favorited mr-1"},null,40,Js))),128))]),Bs,e("div",Ws,[(a(!0),o(D,null,A(t.currentFavoriteSelectionItems,(k,d)=>(a(),o("img",{src:k,key:d,width:"50",height:"50",onClick:p=>t.toggleFavorite(f,k),onMouseover:p=>t.favoriteSelection.hovered=k,onMouseleave:s[15]||(s[15]=p=>t.favoriteSelection.hovered=""),class:P(["thumbnail mr-1",{"is-favorited":u.list.includes(k)}])},null,42,Hs))),128))]),e("span",{class:"button is-small",onClick:s[16]||(s[16]=k=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page-1),disabled:t.favoriteSelection.pagination.page>1?null:!0},"Prev",8,Ks),e("span",{class:"button is-small",onClick:s[17]||(s[17]=k=>t.favoriteSelection.pagination.page=t.favoriteSelection.pagination.page+1),disabled:t.favoriteSelection.pagination.page<t.favoriteSelectionTotalPages?null:!0},"Next",8,Gs)]))),128))]),Ys])])],512)):v("",!0)],512)])}var Qs=S(Qe,[["render",Xs]]);const Zs=V({data:()=>({unchangedJson:"[]",changedJson:"[]",variables:[]}),computed:{changed(){return this.unchangedJson!==this.changedJson}},methods:{remove(t){this.variables=this.variables.filter((s,i)=>i!==t)},onAdd(){this.variables.push({name:"",value:""})},setChanged(){this.changedJson=JSON.stringify({variables:this.variables})},setUnchanged(){this.unchangedJson=JSON.stringify({variables:this.variables}),this.changedJson=this.unchangedJson},async sendSave(){await E.saveVariables({variables:this.variables}),this.setUnchanged()}},watch:{variables:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await E.getPageVariablesData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.variables=s.variables,this.setUnchanged()}}),js={id:"app"},xs={id:"top",ref:"top"},tn={id:"actionbar",class:"p-1"},en=["disabled"],sn={id:"main"},nn={class:"mb-4"},an=e("h1",{class:"title mb-2"},"Global Variables",-1),on=e("div",{class:"help"},[g(" Variables can be used from commands with "),e("code",null,"$var(variable_name)"),g(". In addition to the global variables defined here, commands can define their own local variables which have precedence over the global ones. ")],-1),ln={class:"table is-striped"},rn=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Value"),e("th")])],-1),dn=["onUpdate:modelValue"],un=["onUpdate:modelValue"],mn=e("i",{class:"fa fa-trash"},null,-1);function hn(t,s,i,r,c,b){const h=_("navbar"),n=_("doubleclick-button");return a(),o("div",js,[e("div",xs,[w(h),e("div",tn,[e("button",{class:"button is-small",onClick:s[0]||(s[0]=(...l)=>t.onAdd&&t.onAdd(...l))},"Add"),e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[1]||(s[1]=(...l)=>t.sendSave&&t.sendSave(...l))}," Save ",8,en)])],512),e("div",sn,[e("div",nn,[an,on,e("table",ln,[rn,e("tbody",null,[(a(!0),o(D,null,A(t.variables,(l,u)=>(a(),o("tr",{key:u},[e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":f=>l.name=f},null,8,dn),[[y,l.name]])]),e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":f=>l.value=f},null,8,un),[[y,l.value]])]),e("td",null,[w(n,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:f=>t.remove(u)},{default:z(()=>[mn]),_:2},1032,["onDoubleclick"])])]))),128))])])])])])}var cn=S(Zs,[["render",hn]]);const pn=V({data:()=>({user:"",pass:"",email:"",error:"",success:!1}),computed:{canRegister(){return this.user&&this.pass&&this.email&&!this.error}},methods:{async onRequestVerificationEmail(){this.success=!1,this.error="";const t=await E.resendVerificationMail({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}},async submit(){this.success=!1,this.error="";const t=await E.register({user:this.user,pass:this.pass,email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),gn={class:"center-screen"},fn=e("h1",{class:"title is-6"},"Hyottoko.club",-1),vn={key:0,class:"field has-background-success-light has-text-success-dark"},yn=g(" Account registered. Please check your mail. Click "),bn=g("here"),_n=g(" to login. "),$n={key:1},wn={key:0,class:"field has-background-danger-light has-text-danger-dark"},kn={key:0},Cn=g(" A user with this email is already registered. "),Vn=e("br",null,null,-1),Sn=g("Request a password reset."),Dn={key:1},In=g(" A user with this email is already registered. "),Un=e("br",null,null,-1),An={key:2},Pn={key:3},Tn={key:4},Nn={class:"field"},On={class:"control has-icons-left"},Fn=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-user"})],-1),En={class:"field"},Mn={class:"control has-icons-left"},Ln=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),zn={class:"field"},qn={class:"control has-icons-left"},Rn=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Jn={class:"field"},Bn=["disabled"];function Wn(t,s,i,r,c,b){const h=_("router-link");return a(),o("div",gn,[fn,t.success?(a(),o("div",vn,[yn,w(h,{to:{name:"login"}},{default:z(()=>[bn]),_:1}),_n])):(a(),o("div",$n,[t.error?(a(),o("div",wn,[t.error==="verified_mail_already_exists"?(a(),o("div",kn,[Cn,Vn,w(h,{to:{name:"forgot-password"}},{default:z(()=>[Sn]),_:1})])):t.error==="unverified_mail_already_exists"?(a(),o("div",Dn,[In,Un,e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...n)=>t.onRequestVerificationEmail&&t.onRequestVerificationEmail(...n))},"Resend verification email")])):t.error==="verified_name_already_exists"?(a(),o("div",An," A user with this name is already registered. ")):t.error==="unverified_name_already_exists"?(a(),o("div",Pn," A user with this name is already registered. ")):(a(),o("span",Tn,$(t.error),1))])):v("",!0),e("div",Nn,[e("div",On,[m(e("input",{class:"input is-small",type:"text",placeholder:"User","onUpdate:modelValue":[s[1]||(s[1]=n=>t.user=n),s[2]||(s[2]=n=>t.error="")]},null,512),[[y,t.user]]),Fn])]),e("div",En,[e("div",Mn,[m(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":[s[3]||(s[3]=n=>t.email=n),s[4]||(s[4]=n=>t.error="")]},null,512),[[y,t.email]]),Ln])]),e("div",zn,[e("div",qn,[m(e("input",{class:"input is-small",type:"password",placeholder:"Password","onUpdate:modelValue":[s[5]||(s[5]=n=>t.pass=n),s[6]||(s[6]=n=>t.error="")],onKeyup:s[7]||(s[7]=X((...n)=>t.submit&&t.submit(...n),["enter"]))},null,544),[[y,t.pass]]),Rn])]),e("div",Jn,[e("button",{class:"button is-small is-primary",disabled:t.canRegister?null:!0,onClick:s[8]||(s[8]=(...n)=>t.submit&&t.submit(...n))}," Register ",8,Bn)])]))])}var Hn=S(pn,[["render",Wn]]);const Kn=V({data:()=>({unchangedJson:"[]",changedJson:"[]",user:{id:0,name:"",email:"",pass:"",groups:[],tmi_identity_client_id:"",tmi_identity_client_secret:""},twitch_channels:[]}),computed:{isAdmin(){return this.user.groups.includes("admin")},changed(){return this.unchangedJson!==this.changedJson},accessTokenLink(){if(!this.user.tmi_identity_client_id)return;const t=["analytics:read:extensions","analytics:read:games","bits:read","channel:edit:commercial","channel:manage:broadcast","channel:manage:extensions","channel:manage:redemptions","channel:manage:videos","channel:read:editors","channel:read:hype_train","channel:read:redemptions","channel:read:stream_key","channel:read:subscriptions","clips:edit","moderation:read","user:edit","user:edit:follows","user:read:blocked_users","user:manage:blocked_users","user:read:broadcast","user:read:email"],s=document.location,i=`${s.protocol}//${s.host}/twitch/redirect_uri`;return`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=${this.user.tmi_identity_client_id}&redirect_uri=${i}&scope=${t.join("+")}`}},methods:{setChanged(){this.changedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels})},setUnchanged(){this.unchangedJson=JSON.stringify({user:this.user,twitch_channels:this.twitch_channels}),this.changedJson=this.unchangedJson},rmchannel(t){this.twitch_channels=this.twitch_channels.filter((s,i)=>i!==t)},addchannel(){this.twitch_channels.push({user_id:this.user.id,bot_status_messages:1,channel_id:"",channel_name:"",access_token:""})},async loadid(t){this.twitch_channels[t].channel_id=await this.getTwitchUserIdByName(this.twitch_channels[t].channel_name)},async getTwitchUserIdByName(t){const s={name:t,client_id:this.user.tmi_identity_client_id||null,client_secret:this.user.tmi_identity_client_secret||null},i=await E.twitchUserIdByName(s);try{return`${(await i.json()).id}`}catch{return""}},async sendSave(){await E.saveUserSettings({user:this.user,twitch_channels:this.twitch_channels}),this.setUnchanged()}},watch:{user:{deep:!0,handler(){this.setChanged()}},twitch_channels:{deep:!0,handler(){this.setChanged()}}},async mounted(){const t=await E.getPageSettingsData();if(t.status!==200){this.$router.push({name:"login"});return}const s=await t.json();this.user=s.user,this.twitch_channels=s.twitchChannels,this.setUnchanged()}}),Gn={id:"app"},Yn={id:"top",ref:"top"},Xn={id:"actionbar",class:"p-1"},Qn=["disabled"],Zn={id:"main"},jn={class:"mb-4"},xn=e("h1",{class:"title mb-2"},"User",-1),ti={class:"table is-striped"},ei=e("td",null,"Name:",-1),si=e("td",null,"Email:",-1),ni=e("td",null,"Password:",-1),ii={key:0,class:"mb-4"},ai=e("h1",{class:"title mb-2"},"Twitch-Bot",-1),oi=e("p",null,[g(" Please refer to "),e("a",{href:"https://dev.twitch.tv/docs/irc/#building-the-bot",target:"_blank"},"building the bot"),g(". ")],-1),li={class:"table is-striped"},ri=e("td",null,"Bot name:",-1),di=e("td",null,"Bot oauth (pass):",-1),ui=e("td",null,"Bot client_id:",-1),mi=e("td",null,"Bot client_secret:",-1),hi={class:"mb-4"},ci=e("h1",{class:"title mb-2"},"Twitch Channels",-1),pi=g(" List of twitch channels where the bot will connect to. "),gi={key:0},fi={key:0,class:"table is-striped"},vi=e("thead",null,[e("tr",null,[e("td",null,"Channel name"),e("td",null,"Chat status updates"),e("td",null,"Channel id*"),e("td",null,"Access Token*"),e("td")])],-1),yi=["onUpdate:modelValue"],bi=["onUpdate:modelValue"],_i=["onClick"],$i=["onUpdate:modelValue"],wi=["onClick"],ki=e("i",{class:"fa fa-remove"},null,-1),Ci=[ki],Vi={key:1,class:"content"},Si=e("p",null," Channel Id* and Access Token*: You may not need the client id or access token. They are required for channel point reward redemption triggers only. ",-1),Di={key:0},Ii={key:1,class:"list"},Ui=e("li",{class:"list-item"},"Login to twitch as the channel owner",-1),Ai={class:"list-item"},Pi=g(" Click "),Ti=["href"],Ni=g(" to authorize the bot with the channel "),Oi=e("li",{class:"list-item"}," If authorized, you get redirected back to hyottoko.club, and the access token will display ",-1),Fi={key:2};function Ei(t,s,i,r,c,b){const h=_("navbar"),n=_("checkbox");return a(),o("div",Gn,[e("div",Yn,[w(h),e("div",Xn,[e("button",{class:"button is-small is-primary",disabled:!t.changed,onClick:s[0]||(s[0]=(...l)=>t.sendSave&&t.sendSave(...l))}," Save ",8,Qn)])],512),e("div",Zn,[e("div",jn,[xn,e("table",ti,[e("tbody",null,[e("tr",null,[ei,e("td",null,$(t.user.name),1)]),e("tr",null,[si,e("td",null,[m(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=l=>t.user.email=l)},null,512),[[y,t.user.email]])])]),e("tr",null,[ni,e("td",null,[m(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=l=>t.user.pass=l)},null,512),[[y,t.user.pass]])])])])])]),t.isAdmin?(a(),o("div",ii,[ai,oi,e("table",li,[e("tbody",null,[e("tr",null,[ri,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[3]||(s[3]=l=>t.user.tmi_identity_username=l)},null,512),[[y,t.user.tmi_identity_username]])])]),e("tr",null,[di,e("td",null,[m(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[4]||(s[4]=l=>t.user.tmi_identity_password=l)},null,512),[[y,t.user.tmi_identity_password]])])]),e("tr",null,[ui,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=l=>t.user.tmi_identity_client_id=l)},null,512),[[y,t.user.tmi_identity_client_id]])])]),e("tr",null,[mi,e("td",null,[m(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":s[6]||(s[6]=l=>t.user.tmi_identity_client_secret=l)},null,512),[[y,t.user.tmi_identity_client_secret]])])])])])])):v("",!0),e("div",hi,[ci,e("p",null,[pi,t.twitch_channels.length===0?(a(),o("span",gi," Currently no channels are configured. ")):v("",!0)]),t.twitch_channels.length>0?(a(),o("table",fi,[vi,e("tbody",null,[(a(!0),o(D,null,A(t.twitch_channels,(l,u)=>(a(),o("tr",{key:u},[e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":f=>l.channel_name=f},null,8,yi),[[y,l.channel_name]])]),e("td",null,[w(n,{class:"is-small",onValue:1,offValue:0,modelValue:l.bot_status_messages,"onUpdate:modelValue":f=>l.bot_status_messages=f},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[l.channel_id?m((a(),o("input",{key:0,class:"input is-small",type:"text","onUpdate:modelValue":f=>l.channel_id=f},null,8,bi)),[[y,l.channel_id]]):v("",!0),l.channel_id?v("",!0):(a(),o("button",{key:1,class:"button is-small",onClick:f=>t.loadid(u)}," Load id ",8,_i))]),e("td",null,[m(e("input",{class:"input is-small",type:"password","onUpdate:modelValue":f=>l.access_token=f},null,8,$i),[[y,l.access_token]])]),e("td",null,[e("button",{class:"button is-small",onClick:f=>t.rmchannel(u)},Ci,8,wi)])]))),128))])])):v("",!0),e("button",{class:"button is-small",onClick:s[7]||(s[7]=l=>t.addchannel())}," Add channel ")]),t.twitch_channels.length>0?(a(),o("div",Vi,[Si,t.accessTokenLink?(a(),o("p",Di,"To get an access token, do the following:")):v("",!0),t.accessTokenLink?(a(),o("ol",Ii,[Ui,e("li",Ai,[Pi,e("a",{href:t.accessTokenLink,target:"_blank"},"here",8,Ti),Ni]),Oi])):t.isAdmin?(a(),o("p",Fi,' To configure an access token, please configure the "Bot client_id" above. ')):v("",!0)])):v("",!0)])])}var Mi=S(Kn,[["render",Ei]]);const Li=(t=null)=>({name:(t==null?void 0:t.name)||"",css:(t==null?void 0:t.css)||"",showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}),zi=(t=null)=>{var s,i,r,c;return{volume:typeof(t==null?void 0:t.volume)=="undefined"?100:t.volume,hideVideoImage:{file:((s=t==null?void 0:t.hideVideoImage)==null?void 0:s.file)||"",filename:((i=t==null?void 0:t.hideVideoImage)==null?void 0:i.filename)||"",urlpath:((r=t==null?void 0:t.hideVideoImage)==null?void 0:r.urlpath)?t.hideVideoImage.urlpath:((c=t==null?void 0:t.hideVideoImage)==null?void 0:c.file)?`/uploads/${encodeURIComponent(t.hideVideoImage.file)}`:""},customCss:(t==null?void 0:t.customCss)||"",customCssPresets:typeof(t==null?void 0:t.customCssPresets)=="undefined"?[]:t.customCssPresets.map(Li),showProgressBar:typeof(t==null?void 0:t.showProgressBar)=="undefined"?!1:t.showProgressBar,initAutoplay:typeof(t==null?void 0:t.initAutoplay)=="undefined"?!0:t.initAutoplay,showThumbnails:typeof(t==null?void 0:t.showThumbnails)=="undefined"||t.showThumbnails===!0?"left":t.showThumbnails,maxItemsShown:typeof(t==null?void 0:t.maxItemsShown)=="undefined"?-1:t.maxItemsShown}};const qi=V({data:()=>({playerVisible:!1,playlist:[],commands:[],globalVariables:[],settings:zi(),filter:{tag:""},ws:null,resrinput:"",srinput:"",inited:!1,tab:"playlist",importPlaylist:"",toast:Gt(),controlDefinitions:[{title:"Reset stats",ctrl:"resetStats",icon:"fa-eraser"},{title:"Clear playlist",ctrl:"clear",icon:"fa-eject"},{title:"Shuffle",ctrl:"shuffle",icon:"fa-random"},{title:"Play",ctrl:"unpause",icon:"fa-play"},{title:"Pause",ctrl:"pause",icon:"fa-pause"},{title:"Prev",ctrl:"prev",icon:"fa-step-backward"},{title:"Next",ctrl:"skip",icon:"fa-step-forward"}],tabDefinitions:[{tab:"playlist",title:"Playlist"},{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"},{tab:"tags",title:"Tags"},{tab:"import",title:"Import/Export"}],possibleActions:["sr_current","sr_undo","sr_good","sr_bad","sr_stats","sr_prev","sr_next","sr_jumptonew","sr_clear","sr_rm","sr_shuffle","sr_reset_stats","sr_loop","sr_noloop","sr_pause","sr_unpause","sr_hidevideo","sr_showvideo","sr_request","sr_re_request","sr_addtag","sr_rmtag","sr_volume","sr_filter","sr_preset","sr_queue"]}),computed:{tags(){const t=[];return this.playlist.forEach(s=>{s.tags.forEach(i=>{const r=t.findIndex(c=>c.value===i);r===-1?t.push({value:i,count:1}):t[r].count++})}),t},player(){return this.$refs.youtube||{stop:()=>{},play:()=>{},pause:()=>{},unpause:()=>{},setVolume:()=>{},setLoop:()=>{},playing:()=>{}}},filteredPlaylist(){return this.filter.tag===""?this.playlist:this.playlist.filter(t=>t.tags.includes(this.filter.tag))},item(){return this.filteredPlaylist[0]},hasItems(){return this.filteredPlaylist.length!==0},playerstyle(){return this.playerVisible?"":"width:0;height:0;padding:0;margin-bottom:0;"},togglePlayerButtonText(){return this.playerVisible?"Hide Player":"Show Player"},exportPlaylistUrl(){return`${location.protocol}//${location.host}/api/sr/export`},widgetUrl(){return R.widgetUrl("sr")}},methods:{sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings})},onTagUpdated(t){this.updateTag(t[0],t[1])},onPlaylistCtrl(t){this.sendCtrl(t[0],t[1])},applyFilter(t){this.sendCtrl("filter",[{tag:t}])},async doImportPlaylist(){(await E.importPlaylist(this.importPlaylist)).status===200?(this.tab="playlist",this.toast.success("Import successful")):this.toast.error("Import failed")},togglePlayer(){this.playerVisible=!this.playerVisible,this.playerVisible?this.player.playing()||this.play():this.player.stop()},resr(){this.resrinput!==""&&this.sendCtrl("resr",[this.resrinput])},sr(){this.srinput!==""&&this.sendCtrl("sr",[this.srinput])},sendCtrl(t,s){this.sendMsg({event:"ctrl",ctrl:t,args:s})},ended(){this.sendMsg({event:"ended"})},sendMsg(t){this.ws?this.ws.send(JSON.stringify(t)):console.warn("sendMsg: this.ws not initialized")},play(){this.adjustVolume(this.settings.volume),this.playerVisible&&this.hasItems&&(this.player.play(this.item.yt),this.sendMsg({event:"play",id:this.item.id}))},unpause(){this.hasItems&&(this.player.unpause(),this.sendMsg({event:"unpause",id:this.item.id}))},pause(){this.playerVisible&&this.hasItems&&(this.player.pause(),this.sendMsg({event:"pause"}))},adjustVolume(t){this.player.setVolume(t)},updateTag(t,s){t!==s&&this.sendCtrl("updatetag",[t,s])}},async mounted(){this.$nextTick(()=>{this.ws=R.wsClient("sr"),this.ws.onMessage("save",t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables}),this.ws.onMessage(["pause"],t=>{this.player.playing()&&this.pause()}),this.ws.onMessage(["unpause"],t=>{this.player.playing()||this.unpause()}),this.ws.onMessage(["loop"],t=>{this.player.setLoop(!0)}),this.ws.onMessage(["noloop"],t=>{this.player.setLoop(!1)}),this.ws.onMessage(["onEnded","prev","skip","remove","clear","move","tags"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist;const i=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;s!==i&&this.play()}),this.ws.onMessage(["filter"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables;const s=this.filteredPlaylist.length>0?this.filteredPlaylist[0].id:null;this.filter=t.filter,this.playlist=t.playlist,this.filteredPlaylist.find(i=>i.id===s)||this.play()}),this.ws.onMessage(["dislike","like","video","playIdx","resetStats","shuffle"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.filter=t.filter,this.playlist=t.playlist}),this.ws.onMessage(["add","init"],t=>{this.settings=t.settings,this.commands=t.commands,this.globalVariables=t.globalVariables,this.filter=t.filter,this.playlist=t.playlist,!this.inited&&!this.player.playing()&&this.play(),this.inited=!0}),this.ws.connect(),this.play()})},unmounted(){this.ws&&this.ws.disconnect()}}),at=t=>(H("data-v-1639230a"),t=t(),K(),t),Ri={id:"app"},Ji={id:"top",ref:"top"},Bi={id:"actionbar",class:"p-1"},Wi=["disabled","onClick","title"],Hi=["disabled","title"],Ki=at(()=>e("i",{class:"fa fa-tv mr-1"},null,-1)),Gi={class:"txt"},Yi={class:"field has-addons mr-1"},Xi={class:"control"},Qi=["disabled"],Zi={class:"control"},ji=["disabled"],xi=at(()=>e("i",{class:"fa fa-search mr-1"},null,-1)),ta=g(" from playlist "),ea=[xi,ta],sa={class:"field has-addons mr-1"},na={class:"control"},ia=["disabled"],aa={class:"control"},oa=["disabled"],la=at(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),ra=g(" from YouTube "),da=[la,ra],ua=["disabled","href"],ma={id:"main",ref:"main"},ha={style:{width:"640px","max-width":"100%"}},ca={class:"tabs"},pa=["onClick"],ga={key:0},fa={class:"mb-1"},va=["href"],ya=at(()=>e("i",{class:"fa fa-download mr-1"},null,-1)),ba=g(" Export playlist"),_a=[ya,ba],$a=at(()=>e("i",{class:"fa fa-upload mr-1"},null,-1)),wa=g(" Import playlist "),ka=[$a,wa],Ca={key:1,id:"tags"},Va={key:3,id:"playlist",class:"table-container"};function Sa(t,s,i,r,c,b){const h=_("navbar"),n=_("youtube"),l=_("tags-editor"),u=_("song-request-settings"),f=_("playlist-editor"),k=_("commands-editor");return a(),o("div",Ri,[e("div",Ji,[w(h),e("div",Bi,[(a(!0),o(D,null,A(t.controlDefinitions,(d,p)=>(a(),o("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:U=>t.sendCtrl(d.ctrl,[]),title:d.title,key:p},[e("i",{class:P(["fa",d.icon])},null,2)],8,Wi))),128)),e("button",{class:"button is-small mr-1",disabled:t.inited?null:!0,onClick:s[0]||(s[0]=(...d)=>t.togglePlayer&&t.togglePlayer(...d)),title:t.togglePlayerButtonText},[Ki,e("span",Gi,$(t.togglePlayerButtonText),1)],8,Hi),e("div",Yi,[e("div",Xi,[m(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[1]||(s[1]=d=>t.resrinput=d),onKeyup:s[2]||(s[2]=X((...d)=>t.resr&&t.resr(...d),["enter"]))},null,40,Qi),[[y,t.resrinput]])]),e("div",Zi,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[3]||(s[3]=(...d)=>t.resr&&t.resr(...d))},ea,8,ji)])]),e("div",sa,[e("div",na,[m(e("input",{class:"input is-small",disabled:t.inited?null:!0,"onUpdate:modelValue":s[4]||(s[4]=d=>t.srinput=d),onKeyup:s[5]||(s[5]=X((...d)=>t.sr&&t.sr(...d),["enter"]))},null,40,ia),[[y,t.srinput]])]),e("div",aa,[e("button",{class:"button is-small",disabled:t.inited?null:!0,onClick:s[6]||(s[6]=(...d)=>t.sr&&t.sr(...d))},da,8,oa)])]),e("a",{class:"button is-small mr-1",disabled:t.inited?null:!0,href:t.widgetUrl,target:"_blank"},"Open SR widget",8,ua)])],512),e("div",ma,[e("div",ha,[e("div",{id:"player",class:"video-16-9",style:Q(t.playerstyle)},[w(n,{ref:"youtube",onEnded:t.ended,visible:t.playerVisible},null,8,["onEnded","visible"])],4)]),e("div",ca,[e("ul",null,[(a(!0),o(D,null,A(t.tabDefinitions,(d,p)=>(a(),o("li",{key:p,class:P({"is-active":t.tab===d.tab}),onClick:U=>t.tab=d.tab},[e("a",null,$(d.title),1)],10,pa))),128))])]),t.inited&&t.tab==="import"?(a(),o("div",ga,[e("div",fa,[e("a",{class:"button is-small mr-1",href:t.exportPlaylistUrl,target:"_blank"},_a,8,va),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...d)=>t.doImportPlaylist&&t.doImportPlaylist(...d))},ka)]),m(e("textarea",{class:"textarea mb-1","onUpdate:modelValue":s[8]||(s[8]=d=>t.importPlaylist=d)},null,512),[[y,t.importPlaylist]])])):v("",!0),t.inited&&t.tab==="tags"?(a(),o("div",Ca,[w(l,{tags:t.tags,onUpdateTag:t.onTagUpdated},null,8,["tags","onUpdateTag"])])):v("",!0),t.inited&&t.tab==="settings"?(a(),O(u,{key:2,id:"settings",modelValue:t.settings,"onUpdate:modelValue":[s[9]||(s[9]=d=>t.settings=d),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),t.inited&&t.tab==="playlist"?(a(),o("div",Va,[w(f,{playlist:t.playlist,filter:t.filter,onStopPlayer:s[10]||(s[10]=d=>t.player.stop()),onFilterChange:t.applyFilter,onCtrl:t.onPlaylistCtrl},null,8,["playlist","filter","onFilterChange","onCtrl"])])):v("",!0),t.inited&&t.tab==="commands"?(a(),O(k,{key:4,modelValue:t.commands,"onUpdate:modelValue":[s[11]||(s[11]=d=>t.commands=d),t.sendSave],globalVariables:t.globalVariables,possibleActions:t.possibleActions,baseVolume:100},null,8,["modelValue","onUpdate:modelValue","globalVariables","possibleActions"])):v("",!0)],512)])}var Da=S(qi,[["render",Sa],["__scopeId","data-v-1639230a"]]);const Ia=()=>({volume:100}),Ua=()=>({showImages:!0}),Aa=V({data:()=>({commands:[],settings:Ia(),adminSettings:Ua(),globalVariables:[],ws:null,possibleActions:["text","media","media_volume","countdown","dict_lookup","madochan_createword","chatters","set_channel_title","set_channel_game_id","add_stream_tags","remove_stream_tags"],tabDefinitions:[{tab:"commands",title:"Commands"},{tab:"settings",title:"Settings"}],inited:!1,tab:"commands"}),computed:{baseVolume(){return this.settings.volume},widgetUrl(){return R.widgetUrl("media")}},methods:{updateShowImages(t){this.adminSettings.showImages=t,this.sendSave()},sendSave(){this.sendMsg({event:"save",commands:this.commands,settings:this.settings,adminSettings:this.adminSettings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=R.wsClient("general"),this.ws.onMessage("init",t=>{this.commands=t.commands,this.settings=t.settings,this.adminSettings=t.adminSettings,this.globalVariables=t.globalVariables,this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Pa={id:"app"},Ta={id:"top",ref:"top"},Na={id:"main",ref:"main"},Oa={class:"tabs"},Fa=["onClick"],Ea=["href"],Ma={key:1},La={key:0,class:"table is-striped",ref:"table"},za=e("td",null,[e("code",null,"settings.volume")],-1),qa=e("td",null,"Base volume for all media playing from commands",-1);function Ra(t,s,i,r,c,b){const h=_("navbar"),n=_("commands-editor"),l=_("volume-slider");return a(),o("div",Pa,[e("div",Ta,[w(h)],512),e("div",Na,[e("div",Oa,[e("ul",null,[(a(!0),o(D,null,A(t.tabDefinitions,(u,f)=>(a(),o("li",{key:f,class:P({"is-active":t.tab===u.tab}),onClick:k=>t.tab=u.tab},[e("a",null,$(u.title),1)],10,Fa))),128)),e("li",null,[e("a",{class:"button is-small mr-1",href:t.widgetUrl,target:"_blank"},"Open Media widget",8,Ea)])])]),t.inited&&t.tab==="commands"?(a(),O(n,{key:0,modelValue:t.commands,"onUpdate:modelValue":[s[0]||(s[0]=u=>t.commands=u),t.sendSave],globalVariables:t.globalVariables,possibleActions:t.possibleActions,baseVolume:t.baseVolume,showToggleImages:!0,showFilterActions:!0,showImages:t.adminSettings.showImages,onShowImagesChange:t.updateShowImages},null,8,["modelValue","onUpdate:modelValue","globalVariables","possibleActions","baseVolume","showImages","onShowImagesChange"])):v("",!0),t.inited&&t.tab==="settings"?(a(),o("div",Ma,[t.settings?(a(),o("table",La,[e("tbody",null,[e("tr",null,[za,e("td",null,[w(l,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[1]||(s[1]=u=>t.settings.volume=u),t.sendSave]},null,8,["modelValue","onUpdate:modelValue"])]),qa])])],512)):v("",!0)])):v("",!0)],512)])}var Ja=S(Aa,[["render",Ra]]);const qt=()=>({status:{enabled:!1},styles:{bgColor:"#ff00ff",vAlign:"bottom",recognition:{fontFamily:"sans-serif",fontSize:"30",fontWeight:"400",strokeWidth:"8",strokeColor:"#292929",color:"#ffff00"},translation:{fontFamily:"sans-serif",fontSize:"30",fontWeight:"400",strokeWidth:"8",strokeColor:"#292929",color:"#cbcbcb"}},recognition:{display:!0,lang:"ja",synthesize:!1,synthesizeLang:""},translation:{enabled:!0,langSrc:"ja",langDst:"en",synthesize:!1,synthesizeLang:""}}),Ba=V({data:()=>({unchangedJson:"{}",changedJson:"{}",settings:qt(),defaultSettings:qt(),ws:null,inited:!1}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},widgetUrl(){return R.widgetUrl("speech-to-text")}},methods:{sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))}},async mounted(){this.ws=R.wsClient("speech-to-text"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),Wa={id:"app"},Ha={id:"top",ref:"top"},Ka={id:"actionbar",class:"p-1"},Ga=["disabled"],Ya=["href"],Xa={id:"main",ref:"main"},Qa={key:0,class:"table is-striped",ref:"table"},Za=e("tr",null,[e("td",{colspan:"3"},"General")],-1),ja=e("td",null,[e("code",null,"settings.style.bgColor")],-1),xa=["disabled"],to=e("i",{class:"fa fa-remove"},null,-1),eo=[to],so=e("td",null,[e("code",null,"settings.style.vAlign")],-1),no={class:"select is-small"},io=e("option",{value:"top"},"top",-1),ao=e("option",{value:"bottom"},"bottom",-1),oo=[io,ao],lo=["disabled"],ro=e("i",{class:"fa fa-remove"},null,-1),uo=[ro],mo=e("tr",null,[e("td",{colspan:"3"},"Recognition")],-1),ho=e("td",null,[e("code",null,"settings.recognition.lang")],-1),co=["disabled"],po=e("i",{class:"fa fa-remove"},null,-1),go=[po],fo=e("td",null,[e("code",null,"settings.recognition.synthesize")],-1),vo=["disabled"],yo=e("i",{class:"fa fa-remove"},null,-1),bo=[yo],_o=e("td",null,[e("code",null,"settings.recognition.synthesizeLang")],-1),$o=["disabled"],wo=e("i",{class:"fa fa-remove"},null,-1),ko=[wo],Co=e("td",null,[e("code",null,"settings.recognition.display")],-1),Vo=["disabled"],So=e("i",{class:"fa fa-remove"},null,-1),Do=[So],Io=e("td",null,[e("code",null,"settings.styles.recognition.color")],-1),Uo=["disabled"],Ao=e("i",{class:"fa fa-remove"},null,-1),Po=[Ao],To=e("td",null,[e("code",null,"settings.styles.recognition.strokeWidth")],-1),No=["disabled"],Oo=e("i",{class:"fa fa-remove"},null,-1),Fo=[Oo],Eo=e("td",null,[e("code",null,"settings.styles.recognition.strokeColor")],-1),Mo=["disabled"],Lo=e("i",{class:"fa fa-remove"},null,-1),zo=[Lo],qo=e("td",null,[e("code",null,"settings.styles.recognition.fontFamily")],-1),Ro=["disabled"],Jo=e("i",{class:"fa fa-remove"},null,-1),Bo=[Jo],Wo=e("td",null,[e("code",null,"settings.styles.recognition.fontSize")],-1),Ho=["disabled"],Ko=e("i",{class:"fa fa-remove"},null,-1),Go=[Ko],Yo=e("td",null,[e("code",null,"settings.styles.recognition.fontWeight")],-1),Xo=["disabled"],Qo=e("i",{class:"fa fa-remove"},null,-1),Zo=[Qo],jo=e("tr",null,[e("td",{colspan:"3"},"Translation")],-1),xo=e("td",null,[e("code",null,"settings.translation.enabled")],-1),tl=["disabled"],el=e("i",{class:"fa fa-remove"},null,-1),sl=[el],nl=e("td",null,[e("code",null,"settings.translation.synthesize")],-1),il=["disabled"],al=e("i",{class:"fa fa-remove"},null,-1),ol=[al],ll=e("td",null,[e("code",null,"settings.translation.synthesizeLang")],-1),rl=["disabled"],dl=e("i",{class:"fa fa-remove"},null,-1),ul=[dl],ml=e("td",null,[e("code",null,"settings.translation.langSrc")],-1),hl=["disabled"],cl=e("i",{class:"fa fa-remove"},null,-1),pl=[cl],gl=e("td",null,[e("code",null,"settings.translation.langDst")],-1),fl=["disabled"],vl=e("i",{class:"fa fa-remove"},null,-1),yl=[vl],bl=e("td",null,[e("code",null,"settings.styles.translation.color")],-1),_l=["disabled"],$l=e("i",{class:"fa fa-remove"},null,-1),wl=[$l],kl=e("td",null,[e("code",null,"settings.styles.translation.strokeWidth")],-1),Cl=["disabled"],Vl=e("i",{class:"fa fa-remove"},null,-1),Sl=[Vl],Dl=e("td",null,[e("code",null,"settings.styles.translation.strokeColor")],-1),Il=["disabled"],Ul=e("i",{class:"fa fa-remove"},null,-1),Al=[Ul],Pl=e("td",null,[e("code",null,"settings.styles.translation.fontFamily")],-1),Tl=["disabled"],Nl=e("i",{class:"fa fa-remove"},null,-1),Ol=[Nl],Fl=e("td",null,[e("code",null,"settings.styles.translation.fontSize")],-1),El=["disabled"],Ml=e("i",{class:"fa fa-remove"},null,-1),Ll=[Ml],zl=e("td",null,[e("code",null,"settings.styles.translation.fontWeight")],-1),ql=["disabled"],Rl=e("i",{class:"fa fa-remove"},null,-1),Jl=[Rl],Bl=e("tr",null,[e("td",{colspan:"3"},"Debug")],-1),Wl=e("td",null,[e("code",null,"settings.status.enabled")],-1),Hl=["disabled"],Kl=e("i",{class:"fa fa-remove"},null,-1),Gl=[Kl];function Yl(t,s,i,r,c,b){const h=_("navbar");return a(),o("div",Wa,[e("div",Ha,[w(h),e("div",Ka,[e("button",{class:"button is-small is-primary mr-1",disabled:!t.changed,onClick:s[0]||(s[0]=(...n)=>t.sendSave&&t.sendSave(...n))}," Save ",8,Ga),e("a",{class:"button is-small",href:t.widgetUrl,target:"_blank"},"Open widget",8,Ya)])],512),e("div",Xa,[t.inited?(a(),o("table",Qa,[e("tbody",null,[Za,e("tr",null,[ja,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[1]||(s[1]=n=>t.settings.styles.bgColor=n)},null,512),[[y,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=n=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},eo,8,xa)])]),e("tr",null,[so,e("td",null,[e("div",no,[m(e("select",{"onUpdate:modelValue":s[3]||(s[3]=n=>t.settings.styles.vAlign=n)},oo,512),[[Dt,t.settings.styles.vAlign]])])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.vAlign===t.defaultSettings.styles.vAlign,onClick:s[4]||(s[4]=n=>t.settings.styles.vAlign=t.defaultSettings.styles.vAlign)},uo,8,lo)])]),mo,e("tr",null,[ho,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[5]||(s[5]=n=>t.settings.recognition.lang=n)},null,512),[[y,t.settings.recognition.lang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.lang===t.defaultSettings.recognition.lang,onClick:s[6]||(s[6]=n=>t.settings.recognition.lang=t.defaultSettings.recognition.lang)},go,8,co)])]),e("tr",null,[fo,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=n=>t.settings.recognition.synthesize=n)},null,512),[[q,t.settings.recognition.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesize===t.defaultSettings.recognition.synthesize,onClick:s[8]||(s[8]=n=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},bo,8,vo)])]),e("tr",null,[_o,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[9]||(s[9]=n=>t.settings.recognition.synthesizeLang=n)},null,512),[[y,t.settings.recognition.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.synthesizeLang===t.defaultSettings.recognition.synthesizeLang,onClick:s[10]||(s[10]=n=>t.settings.recognition.synthesizeLang=t.defaultSettings.recognition.synthesizeLang)},ko,8,$o)])]),e("tr",null,[Co,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=n=>t.settings.recognition.display=n)},null,512),[[q,t.settings.recognition.display]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.recognition.display===t.defaultSettings.recognition.display,onClick:s[12]||(s[12]=n=>t.settings.recognition.display=t.defaultSettings.recognition.display)},Do,8,Vo)])]),e("tr",null,[Io,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[13]||(s[13]=n=>t.settings.styles.recognition.color=n)},null,512),[[y,t.settings.styles.recognition.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.color===t.defaultSettings.styles.recognition.color,onClick:s[14]||(s[14]=n=>t.settings.styles.recognition.color=t.defaultSettings.styles.recognition.color)},Po,8,Uo)])]),e("tr",null,[To,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[15]||(s[15]=n=>t.settings.styles.recognition.strokeWidth=n)},null,512),[[y,t.settings.styles.recognition.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeWidth===t.defaultSettings.styles.recognition.strokeWidth,onClick:s[16]||(s[16]=n=>t.settings.styles.recognition.strokeWidth=t.defaultSettings.styles.recognition.strokeWidth)},Fo,8,No)])]),e("tr",null,[Eo,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[17]||(s[17]=n=>t.settings.styles.recognition.strokeColor=n)},null,512),[[y,t.settings.styles.recognition.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.strokeColor===t.defaultSettings.styles.recognition.strokeColor,onClick:s[18]||(s[18]=n=>t.settings.styles.recognition.strokeColor=t.defaultSettings.styles.recognition.strokeColor)},zo,8,Mo)])]),e("tr",null,[qo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[19]||(s[19]=n=>t.settings.styles.recognition.fontFamily=n)},null,512),[[y,t.settings.styles.recognition.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontFamily===t.defaultSettings.styles.recognition.fontFamily,onClick:s[20]||(s[20]=n=>t.settings.styles.recognition.fontFamily=t.defaultSettings.styles.recognition.fontFamily)},Bo,8,Ro)])]),e("tr",null,[Wo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[21]||(s[21]=n=>t.settings.styles.recognition.fontSize=n)},null,512),[[y,t.settings.styles.recognition.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontSize===t.defaultSettings.styles.recognition.fontSize,onClick:s[22]||(s[22]=n=>t.settings.styles.recognition.fontSize=t.defaultSettings.styles.recognition.fontSize)},Go,8,Ho)])]),e("tr",null,[Yo,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[23]||(s[23]=n=>t.settings.styles.recognition.fontWeight=n)},null,512),[[y,t.settings.styles.recognition.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.recognition.fontWeight===t.defaultSettings.styles.recognition.fontWeight,onClick:s[24]||(s[24]=n=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Zo,8,Xo)])]),jo,e("tr",null,[xo,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=n=>t.settings.translation.enabled=n)},null,512),[[q,t.settings.translation.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.enabled===t.defaultSettings.translation.enabled,onClick:s[26]||(s[26]=n=>t.settings.translation.enabled=t.defaultSettings.translation.enabled)},sl,8,tl)])]),e("tr",null,[nl,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=n=>t.settings.translation.synthesize=n)},null,512),[[q,t.settings.translation.synthesize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesize===t.defaultSettings.translation.synthesize,onClick:s[28]||(s[28]=n=>t.settings.translation.synthesize=t.defaultSettings.translation.synthesize)},ol,8,il)])]),e("tr",null,[ll,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[29]||(s[29]=n=>t.settings.translation.synthesizeLang=n)},null,512),[[y,t.settings.translation.synthesizeLang]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.synthesizeLang===t.defaultSettings.translation.synthesizeLang,onClick:s[30]||(s[30]=n=>t.settings.translation.synthesizeLang=t.defaultSettings.translation.synthesizeLang)},ul,8,rl)])]),e("tr",null,[ml,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[31]||(s[31]=n=>t.settings.translation.langSrc=n)},null,512),[[y,t.settings.translation.langSrc]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langSrc===t.defaultSettings.translation.langSrc,onClick:s[32]||(s[32]=n=>t.settings.translation.langSrc=t.defaultSettings.translation.langSrc)},pl,8,hl)])]),e("tr",null,[gl,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[33]||(s[33]=n=>t.settings.translation.langDst=n)},null,512),[[y,t.settings.translation.langDst]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.translation.langDst===t.defaultSettings.translation.langDst,onClick:s[34]||(s[34]=n=>t.settings.translation.langDst=t.defaultSettings.translation.langDst)},yl,8,fl)])]),e("tr",null,[bl,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[35]||(s[35]=n=>t.settings.styles.translation.color=n)},null,512),[[y,t.settings.styles.translation.color]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.color===t.defaultSettings.styles.translation.color,onClick:s[36]||(s[36]=n=>t.settings.styles.translation.color=t.defaultSettings.styles.translation.color)},wl,8,_l)])]),e("tr",null,[kl,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[37]||(s[37]=n=>t.settings.styles.translation.strokeWidth=n)},null,512),[[y,t.settings.styles.translation.strokeWidth]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeWidth===t.defaultSettings.styles.translation.strokeWidth,onClick:s[38]||(s[38]=n=>t.settings.styles.translation.strokeWidth=t.defaultSettings.styles.translation.strokeWidth)},Sl,8,Cl)])]),e("tr",null,[Dl,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":s[39]||(s[39]=n=>t.settings.styles.translation.strokeColor=n)},null,512),[[y,t.settings.styles.translation.strokeColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.strokeColor===t.defaultSettings.styles.translation.strokeColor,onClick:s[40]||(s[40]=n=>t.settings.styles.translation.strokeColor=t.defaultSettings.styles.translation.strokeColor)},Al,8,Il)])]),e("tr",null,[Pl,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[41]||(s[41]=n=>t.settings.styles.translation.fontFamily=n)},null,512),[[y,t.settings.styles.translation.fontFamily]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontFamily===t.defaultSettings.styles.translation.fontFamily,onClick:s[42]||(s[42]=n=>t.settings.styles.translation.fontFamily=t.defaultSettings.styles.translation.fontFamily)},Ol,8,Tl)])]),e("tr",null,[Fl,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[43]||(s[43]=n=>t.settings.styles.translation.fontSize=n)},null,512),[[y,t.settings.styles.translation.fontSize]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontSize===t.defaultSettings.styles.translation.fontSize,onClick:s[44]||(s[44]=n=>t.settings.styles.translation.fontSize=t.defaultSettings.styles.translation.fontSize)},Ll,8,El)])]),e("tr",null,[zl,e("td",null,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[45]||(s[45]=n=>t.settings.styles.translation.fontWeight=n)},null,512),[[y,t.settings.styles.translation.fontWeight]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.translation.fontWeight===t.defaultSettings.styles.translation.fontWeight,onClick:s[46]||(s[46]=n=>t.settings.styles.weight=t.defaultSettings.styles.weight)},Jl,8,ql)])]),Bl,e("tr",null,[Wl,e("td",null,[m(e("input",{class:"is-small",type:"checkbox","onUpdate:modelValue":s[47]||(s[47]=n=>t.settings.status.enabled=n)},null,512),[[q,t.settings.status.enabled]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.status.enabled===t.defaultSettings.status.enabled,onClick:s[48]||(s[48]=n=>t.settings.status.enabled=t.defaultSettings.status.enabled)},Gl,8,Hl)])])])],512)):v("",!0)],512)])}var Xl=S(Ba,[["render",Yl]]);const Ql=(t=null)=>{const s=(i,r,c)=>i?typeof i[r]=="undefined"?c:i[r]:c;return{name:s(t,"name",""),width:s(t,"width",64),height:s(t,"height",64),stateDefinitions:s(t,"stateDefinitions",[]),slotDefinitions:s(t,"slotDefinitions",[]),state:s(t,"state",{slots:{},lockedState:""})}},Rt=()=>({styles:{bgColor:"#80ff00"},avatarDefinitions:[]});const Zl=V({data:()=>({editIdx:-1,editEntity:null,unchangedJson:"{}",changedJson:"{}",settings:Rt(),defaultSettings:Rt(),ws:null,inited:!1,tabDefinitions:[{tab:"avatars",title:"Avatars"},{tab:"settings",title:"Settings"}],tab:"avatars"}),watch:{settings:{deep:!0,handler(t){this.changedJson=JSON.stringify(t)}}},computed:{changed(){return this.unchangedJson!==this.changedJson},controlWidgetUrl(){return R.widgetUrl("avatar")},displayWidgetUrl(){return R.widgetUrl("avatar_receive")}},methods:{edit(t){if(!this.settings){console.warn("edit: this.settings not initialized");return}this.editIdx=t,this.editEntity=this.settings.avatarDefinitions[t]},remove(t){if(!this.settings){console.warn("remove: this.settings not initialized");return}this.settings.avatarDefinitions=this.settings.avatarDefinitions.filter((s,i)=>i!==t),this.sendSave()},duplicate(t){if(!this.settings){console.warn("duplicate: this.settings not initialized");return}this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=JSON.parse(JSON.stringify(this.settings.avatarDefinitions[t]))},updatedAvatar(t){if(!this.settings){console.warn("updateAvatar: this.settings not initialized");return}this.settings.avatarDefinitions[this.editIdx]=t,this.sendSave()},addAvatar(){if(!this.settings){console.warn("addAvatar: this.settings not initialized");return}const t={name:"Unnamed Avatar",width:64,height:64,stateDefinitions:[{value:"default",deletable:!1},{value:"speaking",deletable:!1}],slotDefinitions:[]};this.editIdx=this.settings.avatarDefinitions.length,this.editEntity=t},sendSave(){if(!this.settings){console.warn("sendSave: this.settings not initialized");return}this.sendMsg({event:"save",settings:this.settings})},sendMsg(t){if(!this.ws){console.warn("sendMsg: this.ws not initialized");return}this.ws.send(JSON.stringify(t))},dragEnd(t){if(!this.settings){console.warn("dragEnd: this.settings not initialized");return}this.settings.avatarDefinitions=Y.arrayMove(this.settings.avatarDefinitions,t.oldIndex,t.newIndex),this.sendSave()}},async mounted(){this.ws=R.wsClient("avatar"),this.ws.onMessage("init",t=>{this.settings=t.settings,this.unchangedJson=JSON.stringify(t.settings),this.inited=!0}),this.ws.connect()},unmounted(){this.ws&&this.ws.disconnect()}}),jl={id:"app"},xl={id:"top",ref:"top"},tr={id:"actionbar",class:"p-1"},er=["href"],sr=["href"],nr={key:0,id:"main",ref:"main"},ir={class:"tabs"},ar=["onClick"],or={key:0,class:"table is-striped"},lr=e("tr",null,[e("td",{colspan:"3"},"General")],-1),rr=e("td",null,[e("code",null,"settings.style.bgColor")],-1),dr=["disabled"],ur=e("i",{class:"fa fa-remove"},null,-1),mr=[ur],hr={key:1},cr={class:"table is-striped"},pr=e("thead",null,[e("tr",null,[e("th"),e("th"),e("th",null,"Preview"),e("th",null,"Name"),e("th",null,"Actions")])],-1),gr=e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1),fr={class:"pl-0 pr-0"},vr=["onClick"],yr=e("i",{class:"fa fa-pencil"},null,-1),br=[yr],_r={class:"pl-0 pr-0"},$r=e("i",{class:"fa fa-trash"},null,-1),wr=["onClick"],kr=e("i",{class:"fa fa-clone"},null,-1),Cr=[kr],Vr=["href"],Sr=e("i",{class:"fa fa-external-link mr-1"},null,-1),Dr=g(" Control widget"),Ir=[Sr,Dr],Ur=["href"],Ar=e("i",{class:"fa fa-external-link mr-1"},null,-1),Pr=g(" Display widget"),Tr=[Ar,Pr];function Nr(t,s,i,r,c,b){const h=_("navbar"),n=_("avatar-preview"),l=_("doubleclick-button"),u=_("draggable"),f=_("avatar-editor");return a(),o("div",jl,[e("div",xl,[w(h),e("div",tr,[e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl,target:"_blank"},"Open control widget",8,er),e("a",{class:"button is-small mr-1",href:t.displayWidgetUrl,target:"_blank"},"Open display widget",8,sr)])],512),t.inited?(a(),o("div",nr,[e("div",ir,[e("ul",null,[(a(!0),o(D,null,A(t.tabDefinitions,(k,d)=>(a(),o("li",{key:d,class:P({"is-active":t.tab===k.tab}),onClick:p=>t.tab=k.tab},[e("a",null,$(k.title),1)],10,ar))),128))])]),t.tab==="settings"?(a(),o("table",or,[e("tbody",null,[lr,e("tr",null,[rr,e("td",null,[m(e("input",{class:"input is-small",type:"color","onUpdate:modelValue":[s[0]||(s[0]=k=>t.settings.styles.bgColor=k),s[1]||(s[1]=(...k)=>t.sendSave&&t.sendSave(...k))]},null,512),[[y,t.settings.styles.bgColor]])]),e("td",null,[e("button",{class:"button is-small",disabled:t.settings.styles.bgColor===t.defaultSettings.styles.bgColor,onClick:s[2]||(s[2]=k=>t.settings.styles.bgColor=t.defaultSettings.styles.bgColor)},mr,8,dr)])])])])):v("",!0),t.tab==="avatars"?(a(),o("div",hr,[e("table",cr,[pr,w(u,{modelValue:t.settings.avatarDefinitions,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:z(({element:k,index:d})=>[e("tr",null,[gr,e("td",fr,[e("button",{class:"button is-small",onClick:p=>t.edit(d)},br,8,vr)]),e("td",null,[w(n,{avatar:k},null,8,["avatar"])]),e("td",null,$(k.name),1),e("td",_r,[w(l,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:p=>t.remove(d)},{default:z(()=>[$r]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small mr-1",onClick:p=>t.duplicate(d)},Cr,8,wr),e("a",{class:"button is-small mr-1",href:t.controlWidgetUrl+"?avatar="+k.name,target:"_blank"},Ir,8,Vr),e("a",{class:"button is-small",href:t.displayWidgetUrl+"?avatar="+k.name,target:"_blank"},Tr,8,Ur)])])]),_:1},8,["modelValue","onEnd"])]),t.editEntity?(a(),O(f,{key:0,modelValue:t.editEntity,"onUpdate:modelValue":t.updatedAvatar,onCancel:s[3]||(s[3]=k=>t.editEntity=null)},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),e("span",{class:"button is-small",onClick:s[4]||(s[4]=(...k)=>t.addAvatar&&t.addAvatar(...k))},"Add avatar")])):v("",!0)],512)):v("",!0)])}var Or=S(Zl,[["render",Nr]]);const Fr=V({data:()=>({pass:"",error:"",success:!1}),computed:{canSubmit(){return this.pass&&!this.error}},methods:{async submit(){const s=new URLSearchParams(window.location.search).get("t");this.success=!1,this.error="";const i=await E.resetPassword({pass:this.pass,token:s});if(i.status===200)this.success=!0;else try{this.error=(await i.json()).reason}catch{this.error="Unknown error"}}}}),Er={class:"center-screen"},Mr=e("h1",{class:"title is-6"},"Hyottoko.club",-1),Lr={key:0,class:"field has-background-success-light has-text-success-dark"},zr=g(" Password successfully set. Click "),qr=g("here"),Rr=g(" to login. "),Jr={key:1},Br={key:0,class:"field has-background-danger-light has-text-danger-dark"},Wr={class:"field"},Hr={class:"control has-icons-left"},Kr=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-lock"})],-1),Gr={class:"field"},Yr=["disabled"];function Xr(t,s,i,r,c,b){const h=_("router-link");return a(),o("div",Er,[Mr,t.success?(a(),o("div",Lr,[zr,w(h,{to:{name:"login"}},{default:z(()=>[qr]),_:1}),Rr])):(a(),o("div",Jr,[t.error?(a(),o("div",Br,$(t.error),1)):v("",!0),e("div",Wr,[e("div",Hr,[m(e("input",{class:"input is-small",type:"password",placeholder:"New Password","onUpdate:modelValue":s[0]||(s[0]=n=>t.pass=n),onKeyup:[s[1]||(s[1]=n=>t.error=""),s[2]||(s[2]=X((...n)=>t.submit&&t.submit(...n),["enter"]))]},null,544),[[y,t.pass]]),Kr])]),e("div",Gr,[e("button",{class:"button is-small is-primary",disabled:t.canSubmit?null:!0,onClick:s[3]||(s[3]=(...n)=>t.submit&&t.submit(...n))}," Save Password ",8,Yr)])]))])}var Qr=S(Fr,[["render",Xr]]);const Zr=V({data:()=>({email:"",error:"",success:!1}),methods:{async submit(){this.success=!1,this.error="";const t=await E.requestPasswordReset({email:this.email});if(t.status===200)this.success=!0;else try{this.error=(await t.json()).reason}catch{this.error="Unknown error"}}}}),jr={class:"center-screen"},xr=e("h1",{class:"title is-6"},"Hyottoko.club",-1),td={key:0,class:"field has-background-success-light has-text-success-dark"},ed=g(" Password-reset mail sent. Click "),sd=g("here"),nd=g(" to login. "),id={key:1},ad={key:0,class:"field has-background-danger-light has-text-danger-dark"},od={class:"field"},ld={class:"control has-icons-left"},rd=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-envelope"})],-1),dd={class:"field"};function ud(t,s,i,r,c,b){const h=_("router-link");return a(),o("div",jr,[xr,t.success?(a(),o("div",td,[ed,w(h,{to:{name:"login"}},{default:z(()=>[sd]),_:1}),nd])):(a(),o("form",id,[t.error?(a(),o("div",ad,$(t.error),1)):v("",!0),e("div",od,[e("div",ld,[m(e("input",{class:"input is-small",type:"email",placeholder:"Email","onUpdate:modelValue":s[0]||(s[0]=n=>t.email=n),onKeyup:s[1]||(s[1]=n=>t.error="")},null,544),[[y,t.email]]),rd])]),e("div",dd,[e("span",{class:"button is-small is-primary",onClick:s[2]||(s[2]=(...n)=>t.submit&&t.submit(...n))},"Request Password Reset")])]))])}var md=S(Zr,[["render",ud]]);const hd=V({name:"upload",props:{accept:String,label:{type:String,default:"Upload File"}},data:()=>({uploading:!1,progress:0}),computed:{uploadPercent(){return Math.round(this.progress*100)},buttonText(){return this.uploading?` Uploading (${this.uploadPercent}%)`:this.label?` ${this.label}`:""},progressStyle(){if(!this.uploading)return{};const t=this.uploadPercent,s="rgba(0,255,0, .5)";return{background:`linear-gradient(90deg, ${s} 0%, ${s} ${t}%, transparent ${t}%)`}}},methods:{async uploadFile(t){this.uploading=!0;const s=await E.upload(t,r=>{this.progress=r.loaded/r.total});this.uploading=!1;const i=await s.json();this.$emit("uploaded",i)},async upload(t){const s=t.target.files[0];!s||this.uploadFile(s)}}}),cd={class:"upload"},pd=["disabled","accept"],gd={class:"button is-small"};function fd(t,s,i,r,c,b){return a(),o("label",cd,[e("input",{type:"file",disabled:t.uploading,style:{display:"none"},onChange:s[0]||(s[0]=(...h)=>t.upload&&t.upload(...h)),accept:t.accept},null,40,pd),e("span",gd,[e("i",{class:P(["fa fa-upload",{"mr-1":t.buttonText}])},null,2),g($(t.buttonText),1)]),e("span",{class:"progress",style:Q(t.progressStyle)},null,4)])}var vd=S(hd,[["render",fd],["__scopeId","data-v-3ff87f77"]]);const yd=V({props:{modelValue:{required:!0},width:{type:String,required:!1,default:"100%"},height:{type:String,required:!1,default:"90px"}},emits:["update:modelValue"],data(){return{value:{file:"",filename:"",urlpath:""},draggingOver:!1}},created(){this.modelValue!==null&&(this.value=JSON.parse(JSON.stringify(this.modelValue)))},methods:{emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={file:"",filename:"",urlpath:""},this.emitUpdate()},onUploaded(t){this.value=Ft(t),this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var i=0;i<t.dataTransfer.items.length;i++)if(t.dataTransfer.items[i].kind==="file"){s=t.dataTransfer.items[i].getAsFile();break}}else for(var i=0;i<t.dataTransfer.files.length;i++){s=t.dataTransfer.files[i];break}return s&&(this.value.file="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),bd=t=>(H("data-v-2882bcde"),t=t(),K(),t),_d=bd(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),$d=g(" Remove "),wd=[_d,$d],kd={key:2};function Cd(t,s,i,r,c,b){const h=_("responsive-image"),n=_("upload");return a(),o("div",{onDrop:s[1]||(s[1]=(...l)=>t.onDrop&&t.onDrop(...l)),onDragover:s[2]||(s[2]=(...l)=>t.onDragover&&t.onDragover(...l)),onDragleave:s[3]||(s[3]=(...l)=>t.onDragleave&&t.onDragleave(...l)),class:P(["image-upload",{"dragging-over":t.draggingOver}])},[t.value.file?(a(),O(h,{key:0,src:t.value.urlpath,title:t.value.filename,width:t.width,height:t.height,style:{display:"block"}},null,8,["src","title","width","height"])):v("",!0),t.value.file?(a(),o("button",{key:1,class:"button is-small",onClick:s[0]||(s[0]=(...l)=>t.onRemove&&t.onRemove(...l))},wd)):v("",!0),t.value.file?(a(),o("br",kd)):v("",!0),w(n,{onUploaded:t.onUploaded,accept:"image/*",label:"Upload Image",class:P({"mt-1":t.value.file}),ref:"uploadComponent"},null,8,["onUploaded","class"])],34)}var Vd=S(yd,[["render",Cd],["__scopeId","data-v-2882bcde"]]);const Sd=V({props:{modelValue:{required:!0},baseVolume:{default:100}},emits:["update:modelValue"],data(){return{value:{file:"",filename:"",urlpath:"",volume:100},draggingOver:!1}},created(){this.modelValue!==null&&(this.value=JSON.parse(JSON.stringify(this.modelValue)))},methods:{emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={file:"",filename:"",urlpath:"",volume:100},this.emitUpdate()},onUploaded(t){this.value=Et(t),this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var i=0;i<t.dataTransfer.items.length;i++)if(t.dataTransfer.items[i].kind==="file"){s=t.dataTransfer.items[i].getAsFile();break}}else for(var i=0;i<t.dataTransfer.files.length;i++){s=t.dataTransfer.files[i];break}return s&&(this.value.file="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),Dd=t=>(H("data-v-7311760f"),t=t(),K(),t),Id=Dd(()=>e("i",{class:"fa fa-remove mr-1"},null,-1)),Ud=g(" Remove "),Ad=[Id,Ud],Pd={key:3};function Td(t,s,i,r,c,b){const h=_("player"),n=_("volume-slider"),l=_("upload");return a(),o("div",{onDrop:s[2]||(s[2]=(...u)=>t.onDrop&&t.onDrop(...u)),onDragover:s[3]||(s[3]=(...u)=>t.onDragover&&t.onDragover(...u)),onDragleave:s[4]||(s[4]=(...u)=>t.onDragleave&&t.onDragleave(...u)),class:P(["sound-upload",{"dragging-over":t.draggingOver}])},[t.value.file?(a(),O(h,{key:0,src:t.value.urlpath,name:t.value.filename,volume:t.value.volume,baseVolume:t.baseVolume,class:"button is-small"},null,8,["src","name","volume","baseVolume"])):v("",!0),t.value.file?(a(),O(n,{key:1,modelValue:t.value.volume,"onUpdate:modelValue":s[0]||(s[0]=u=>t.value.volume=u)},null,8,["modelValue"])):v("",!0),t.value.file?(a(),o("button",{key:2,class:"button is-small",onClick:s[1]||(s[1]=(...u)=>t.onRemove&&t.onRemove(...u))},Ad)):v("",!0),t.value.file?(a(),o("br",Pd)):v("",!0),w(l,{onUploaded:t.onUploaded,accept:"audio/*",label:"Upload Sound",class:P({"mt-1":t.value.file}),ref:"uploadComponent"},null,8,["onUploaded","class"])],34)}var Nd=S(Sd,[["render",Td],["__scopeId","data-v-7311760f"]]);const Od=V({props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({v:"",valid:!0}),computed:{classes(){return this.valid?[]:["has-background-danger-light","has-text-danger-dark"]}},mounted(){this.v=`${this.modelValue}`},watch:{v:{handler(t){try{const s=Y.doDummyReplacements(t,"0");Y.mustParseHumanDuration(s),this.valid=!0}catch{this.valid=!1}this.$emit("update:modelValue",t)}},modelValue:{handler(t){this.v=`${t}`}}}});function Fd(t,s,i,r,c,b){return m((a(),o("input",{class:P(["input is-small spaceinput",t.classes]),"onUpdate:modelValue":s[0]||(s[0]=h=>t.v=h)},null,2)),[[y,t.v]])}var Ed=S(Od,[["render",Fd]]);const Md=V({props:{modelValue:{type:Object,required:!0},onValue:{type:Object,default:!0},offValue:{type:Object,default:!1}},emits:["update:modelValue"],data(){return{value:!1}},created(){this.value=this.modelValue===this.onValue},methods:{emitUpdate(){this.$emit("update:modelValue",this.value?this.onValue:this.offValue)}}});function Ld(t,s,i,r,c,b){return m((a(),o("input",{type:"checkbox","onUpdate:modelValue":[s[0]||(s[0]=h=>t.value=h),s[1]||(s[1]=(...h)=>t.emitUpdate&&t.emitUpdate(...h))]},null,512)),[[q,t.value]])}var zd=S(Md,[["render",Ld]]);const qd=V({name:"player",props:{src:String,name:String,volume:{required:!0},baseVolume:{default:100}},data:()=>({audio:null,playing:!1}),created:function(){this.load(),this.$watch("src",()=>{this.load()})},computed:{cls(){return this.playing?"fa-stop":"fa-play"}},methods:{toggle(){if(this.playing)this.audio.pause(),this.audio.currentTime=0;else{const t=parseInt(`${this.baseVolume}`,10)/100,s=parseInt(`${this.volume}`,10)/100;this.audio.volume=t*s,this.audio.play()}this.playing=!this.playing},load(){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio(this.src),this.audio.addEventListener("ended",()=>{this.playing=!1}),this.playing=!1}}});function Rd(t,s,i,r,c,b){return t.src?(a(),o("span",{key:0,class:"player",onClick:s[0]||(s[0]=(...h)=>t.toggle&&t.toggle(...h))},[g($(t.name)+" ",1),e("i",{class:P(["fa ml-1",t.cls])},null,2)])):v("",!0)}var Jd=S(qd,[["render",Rd]]);const Bd=V({name:"slider",props:{modelValue:{type:Number,required:!0},iconLeft:String,iconRight:String,min:{type:Number,default:0},max:{type:Number,default:100}},data:()=>({curVal:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.curVal}`,10))}},created(){this.curVal=this.modelValue}}),Wd={class:"columns"},Hd={class:"column is-four-fifth"},Kd={class:"control has-icons-left has-icons-right range slider"},Gd=["min","max"],Yd={class:"icon is-small is-left"},Xd={class:"icon is-small is-right"},Qd={class:"column is-one-fifth"};function Zd(t,s,i,r,c,b){return a(),o("div",Wd,[e("div",Hd,[e("div",Kd,[m(e("input",{type:"range",class:"input is-small",min:t.min,max:t.max,"onUpdate:modelValue":[s[0]||(s[0]=h=>t.curVal=h),s[1]||(s[1]=(...h)=>t.valChange&&t.valChange(...h))]},null,8,Gd),[[y,t.curVal]]),e("span",Yd,[e("i",{class:P(["fa",t.iconLeft])},null,2)]),e("span",Xd,[e("i",{class:P(["fa",t.iconRight])},null,2)])])]),e("div",Qd,[m(e("input",{type:"number",class:"input is-small","onUpdate:modelValue":[s[2]||(s[2]=h=>t.curVal=h),s[3]||(s[3]=(...h)=>t.valChange&&t.valChange(...h))]},null,512),[[y,t.curVal]])])])}var jd=S(Bd,[["render",Zd],["__scopeId","data-v-0799d56c"]]);const xd=V({name:"volume-slider",props:{modelValue:{required:!0}},emits:["update:modelValue"],data:()=>({volume:100}),methods:{valChange(){this.$emit("update:modelValue",parseInt(`${this.volume}`,10))}},created(){this.volume=parseInt(`${this.modelValue}`,10)}});function tu(t,s,i,r,c,b){const h=_("slider");return a(),O(h,{class:"volume-slider",iconLeft:"fa-volume-down",iconRight:"fa-volume-up",min:0,max:100,modelValue:t.volume,"onUpdate:modelValue":[s[0]||(s[0]=n=>t.volume=n),t.valChange]},null,8,["modelValue","onUpdate:modelValue"])}var eu=S(xd,[["render",tu]]);const su=V({name:"responsive-image",props:{src:String,title:String,height:{type:String,default:"100%"},width:{type:String,default:"100%"}},computed:{style(){return{display:"inline-block",verticalAlign:"text-bottom",backgroundImage:`url(${this.src})`,backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center",width:this.width,height:this.height}}}}),nu=["title"];function iu(t,s,i,r,c,b){return a(),o("div",{class:"responsive-image",style:Q(t.style),title:t.title},null,12,nu)}var au=S(su,[["render",iu]]);const mt=St();let x,ct={problems:[]};function ou(){x=R.wsClient("core"),x.onMessage(["status"],t=>{JSON.stringify(ct)!==JSON.stringify(t)&&(ct=t,mt.emit("status",ct))}),x.connect()}function lu(){x&&(x.disconnect(),x=null)}var Jt={init:ou,stop:lu,eventBus:mt},ru="/assets/hyottoko.30d2bcb9.png";const du=V({name:"navbar",computed:{user(){var t,s;return((s=(t=this.$me)==null?void 0:t.user)==null?void 0:s.name)||""}},created(){this.$me=W.getMe(),mt.on("status",this.statusChanged)},beforeUnmount(){mt.off("status",this.statusChanged)},data:()=>({$me:null,linksStart:[{to:{name:"index"},text:"Widgets"},{to:{name:"commands"},text:"Commands"},{to:{name:"variables"},text:"Variables"},{to:{name:"sr"},text:"Song Request"},{to:{name:"speech-to-text"},text:"Speech-To-Text"},{to:{name:"avatar"},text:"Avatar"},{to:{name:"drawcast"},text:"Drawcast"},{to:{name:"settings"},text:"Settings"}],problems:[],burgerActive:!1}),methods:{statusChanged(t){this.problems=t.problems},toggleBurgerMenu(){this.burgerActive=!this.burgerActive},async onLogoutClick(){const t=await W.logout();if(t.error)throw new Error(t.error);this.$router.push({name:"login"})}}}),uu={class:"navbar",role:"navigation","aria-label":"main navigation"},mu={class:"navbar-brand"},hu=e("img",{src:ru,width:"32",height:"32",alt:"hyottoko.club",class:"flip-horizontal mr-1"},null,-1),cu={class:"greeting"},pu=e("span",{"aria-hidden":"true"},null,-1),gu=e("span",{"aria-hidden":"true"},null,-1),fu=e("span",{"aria-hidden":"true"},null,-1),vu=[pu,gu,fu],yu={class:"navbar-start"},bu={class:"navbar-end"},_u=["title"],$u=e("i",{class:"fa fa-warning mr-1"},null,-1);function wu(t,s,i,r,c,b){const h=_("router-link");return a(),o("nav",uu,[e("div",mu,[w(h,{class:"navbar-item",to:{name:"index"}},{default:z(()=>[hu,e("span",cu,"Welcome back, "+$(t.user),1)]),_:1}),e("a",{role:"button",class:P(["navbar-burger",{"is-active":t.burgerActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:s[0]||(s[0]=(...n)=>t.toggleBurgerMenu&&t.toggleBurgerMenu(...n))},vu,2)]),e("div",{id:"navbarBasicExample",class:P(["navbar-menu",{"is-active":t.burgerActive}])},[e("div",yu,[(a(!0),o(D,null,A(t.linksStart,(n,l)=>(a(),O(h,{class:"navbar-item",key:l,to:n.to},{default:z(()=>[g($(n.text),1)]),_:2},1032,["to"]))),128))]),e("div",bu,[t.problems.length?(a(),o("a",{key:0,class:"navbar-item has-text-danger",title:t.problems.join(" ---- ")},[$u,g(" "+$(t.problems.length)+" Problem"+$(t.problems.length>1?"s":""),1)],8,_u)):v("",!0),e("a",{class:"navbar-item",onClick:s[1]||(s[1]=(...n)=>t.onLogoutClick&&t.onLogoutClick(...n))},"Logout")])],2)])}var ku=S(du,[["render",wu]]);const Cu=V({props:{value:{required:!0}},computed:{tag(){try{return Y.mustParseHumanDuration(`${this.value}`),"span"}catch{return"code"}},humanReadable(){try{return Y.humanDuration(Y.mustParseHumanDuration(`${this.value}`))}catch{return this.value}}}}),Vu={key:0},Su={key:1};function Du(t,s,i,r,c,b){return t.tag==="span"?(a(),o("span",Vu,$(t.humanReadable),1)):(a(),o("code",Su,$(t.humanReadable),1))}var Iu=S(Cu,[["render",Du]]);const Uu=V({emits:["click","doubleclick"],props:{message:{type:String,required:!0},timeout:{type:Number,required:!0}},data:()=>({time:null,timer:null}),computed:{indicatorStyle(){return this.timer===null||this.time===null?{}:{width:`${this.time/this.timeout*100}%`}}},methods:{onClick(){this.timer===null?(this.$emit("click"),this.time=this.timeout,this.timer=setInterval(()=>{this.time&&(this.time-=10),(!this.time||this.time<=0)&&(clearInterval(this.timer),this.timer=null,this.time=null)},10)):(this.$emit("doubleclick"),this.timer&&(clearInterval(this.timer),this.timer=null,this.time=null))}}}),Au={key:0,class:"doubleclick-button-message mr-2 p-1 has-text-danger"};function Pu(t,s,i,r,c,b){return a(),o("button",{class:"doubleclick-button",onClick:s[0]||(s[0]=(...h)=>t.onClick&&t.onClick(...h))},[Yt(t.$slots,"default",{},void 0,!0),t.timer?(a(),o("span",Au,[g($(t.message)+" ",1),e("span",{class:"doubleclick-button-timout-indicator",style:Q(t.indicatorStyle)},null,4)])):v("",!0)])}var Tu=S(Uu,[["render",Pu],["__scopeId","data-v-621de3e2"]]);const Nu=V({props:{label:{type:String,required:!0},actions:{type:Array,required:!0}},emits:["click"],data(){return{active:!1}},methods:{onActionClick(t){this.closeDropdown(),this.$emit("click",t)},openDropdown(){this.active=!0},closeDropdown(){this.active=!1},hideDropdown(t){!this.$refs.dropdown||this.$refs.dropdown.contains(t.target)||this.closeDropdown()}},mounted(){window.addEventListener("click",this.hideDropdown)},unmounted(){window.removeEventListener("click",this.hideDropdown)}}),Ou={class:"dropdown-trigger"},Fu=e("span",{class:"icon is-small"},[e("i",{class:"fa fa-angle-down","aria-hidden":"true"})],-1),Eu={class:"dropdown-menu",id:"dropdown-menu",role:"menu"},Mu={class:"dropdown-content"},Lu=["onClick","title"];function zu(t,s,i,r,c,b){return a(),o("div",{class:P(["dropdown mr-1",{"is-active":t.active}]),ref:"dropdown"},[e("div",Ou,[e("button",{class:"button is-small mr-1","aria-haspopup":"true","aria-controls":"dropdown-menu",onClick:s[0]||(s[0]=(...h)=>t.openDropdown&&t.openDropdown(...h))},[e("span",null,$(t.label),1),Fu])]),e("div",Eu,[e("div",Mu,[(a(!0),o(D,null,A(t.actions,(h,n)=>(a(),o("a",{href:"#",class:"dropdown-item",key:n,onClick:l=>t.onActionClick(h),title:h.title},$(h.label),9,Lu))),128))])])],2)}var qu=S(Nu,[["render",zu]]);const Z=(...t)=>console.log("[youtube.js]",...t);let Bt=!1;function Ru(){return Bt?(Z("ytapi ALREADY ready"),Promise.resolve()):new Promise(t=>{const s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",document.head.append(s),window.onYouTubeIframeAPIReady=()=>{Bt=!0,Z("ytapi ready"),t()}})}function Ju(t){return new Promise(s=>{Z("create player on "+t);const i=new YT.Player(t,{playerVars:{iv_load_policy:3,modestbranding:1},events:{onReady:()=>{Z("player ready"),s(i)}}})})}async function Bu(t){return await Ru(),await Ju(t)}const Wu=V({name:"youtube",props:{visible:{type:Boolean,default:!0}},data:()=>({id:"",yt:null,toplay:null,tovolume:null,tryPlayInterval:null}),created(){this.id=`yt-${Math.floor(Math.random()*99+1)}-${new Date().getTime()}`},methods:{getDuration(){return this.yt?this.yt.getDuration():0},getCurrentTime(){return this.yt?this.yt.getCurrentTime():0},getProgress(){const t=this.getDuration(),s=this.getCurrentTime();return t?s/t:0},stop(){this.yt&&this.yt.stopVideo()},stopTryPlayInterval(){this.tryPlayInterval&&(clearInterval(this.tryPlayInterval),this.tryPlayInterval=null)},tryPlay(){if(this.stopTryPlayInterval(),!this.visible)return;this.yt.playVideo();let t=20;this.tryPlayInterval=setInterval(()=>{if(Z("playing",this.playing(),"triesRemaining",t),--t,this.playing()||t<0){Z("stopping interval"),this.stopTryPlayInterval();return}this.yt.playVideo()},250)},play(t){this.yt?(this.yt.cueVideoById(t),this.tryPlay()):this.toplay=t},pause(){this.yt&&this.yt.pauseVideo()},unpause(){this.yt&&this.tryPlay()},setVolume(t){this.yt?this.yt.setVolume(t):this.tovolume=t},setLoop(t){this.loop=t},playing(){return this.yt&&this.yt.getPlayerState()===1}},async mounted(){this.yt=await Bu(this.id),this.tovolume!==null&&this.yt.setVolume(this.tovolume),this.toplay!==null&&(Z("trying to play.."),this.play(this.toplay)),this.yt.addEventListener("onStateChange",t=>{t.data===YT.PlayerState.CUED?this.tryPlay():t.data===YT.PlayerState.ENDED&&(this.loop?this.tryPlay():this.$emit("ended"))})}}),Hu=["id"];function Ku(t,s,i,r,c,b){return a(),o("div",{id:t.id},null,8,Hu)}var Gu=S(Wu,[["render",Ku]]),pt={Name:()=>"add_stream_tags command",Description:()=>"Add streamtag",NewCommand:()=>({triggers:[C()],action:"add_stream_tags",restrict_to:T,variables:[],variableChanges:[],data:{tag:""}})},gt={Name:()=>"chatters command",Description:()=>"Outputs the people who chatted during the stream.",NewCommand:()=>({triggers:[C()],action:"chatters",restrict_to:[],variables:[],variableChanges:[],data:{}})},ft={Name:()=>"countdown",Description:()=>"Add a countdown or messages spaced by time intervals.",NewCommand:()=>({triggers:[C()],action:"countdown",restrict_to:[],variables:[],variableChanges:[],data:{steps:3,interval:"1s",intro:"Starting countdown...",outro:"Done!"}})},vt={Name:()=>"dictionary lookup",Description:()=>"Outputs the translation for the searched word.",NewCommand:()=>({triggers:[C()],action:"dict_lookup",restrict_to:[],variables:[],variableChanges:[],data:{lang:"ja",phrase:""}})},yt={Name:()=>"madochan",Description:()=>"Creates a word for a definition.",NewCommand:()=>({triggers:[C()],action:"madochan_createword",restrict_to:[],variables:[],variableChanges:[],data:{model:"100epochs800lenhashingbidirectional.h5",weirdness:1}})},bt={Name:()=>"media command",Description:()=>"Display an image and/or play a sound.",NewCommand:()=>({triggers:[C()],action:"media",restrict_to:[],variables:[],variableChanges:[],data:Wt()})},_t={Name:()=>"command",Description:()=>"Send a message to chat",NewCommand:()=>({triggers:[C()],action:"text",restrict_to:[],variables:[],variableChanges:[],data:{text:[Ct()]}})},$t={Name:()=>"remove_stream_tags command",Description:()=>"Remove streamtag",NewCommand:()=>({triggers:[C()],action:"remove_stream_tags",restrict_to:T,variables:[],variableChanges:[],data:{tag:""}})},wt={Name:()=>"change stream category command",Description:()=>"Change the stream category",NewCommand:()=>({triggers:[C()],action:"set_channel_game_id",restrict_to:T,variables:[],variableChanges:[],data:{game_id:""}})},kt={Name:()=>"change stream title command",Description:()=>"Change the stream title",NewCommand:()=>({triggers:[C()],action:"set_channel_title",restrict_to:T,variables:[],variableChanges:[],data:{title:""}})};const T=["mod","broadcaster"],Ct=()=>"",Wt=()=>({sound:{filename:"",file:"",urlpath:"",volume:100},image:{filename:"",file:"",urlpath:""},minDurationMs:"1s"}),Ht=t=>({type:t,data:{command:"",commandExact:!1,minInterval:0,minLines:0}}),C=(t="",s=!1)=>{const i=Ht("command");return i.data.command=t,i.data.commandExact=s,i},Vt={dict_lookup:vt.Description(),madochan_createword:yt.Description(),chatters:gt.Description(),media:bt.Description(),media_volume:`Sets the media volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
  <br />
  If no argument is given, just outputs the current volume`,countdown:ft.Description(),text:_t.Description(),set_channel_title:kt.Description(),set_channel_game_id:wt.Description(),add_stream_tags:pt.Description(),remove_stream_tags:$t.Description(),sr_current:"Show what song is currently playing",sr_undo:"Remove the song that was last added by oneself.",sr_good:"Vote the current song up",sr_bad:"Vote the current song down",sr_stats:"Show stats about the playlist",sr_prev:"Skip to the previous song",sr_next:"Skip to the next song",sr_jumptonew:"Jump to the next unplayed song",sr_clear:"Clear the playlist",sr_rm:"Remove the current song from the playlist",sr_shuffle:`Shuffle the playlist (current song unaffected).
    <br />
    Non-played and played songs will be shuffled separately and non-played
    songs will be put after currently playing song.`,sr_reset_stats:"Reset all statistics of all songs",sr_loop:"Loop the current song",sr_noloop:"Stop looping the current song",sr_pause:"Pause currently playing song",sr_unpause:"Unpause currently paused song",sr_hidevideo:"Hide video for current song",sr_showvideo:"Show video for current song",sr_request:`
  Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
  at youtube (by id or by title)
  and queue the first result in the playlist (after the first found
  batch of unplayed songs).`,sr_re_request:`
  Search for <code>&lt;SEARCH&gt;</code> (argument to this command)
  in the current playlist and queue the first result in the playlist
  (after the first found batch of unplayed songs).`,sr_addtag:"Add tag <code>&lt;TAG&gt;</code> (argument to this command) to the current song",sr_rmtag:"Remove tag <code>&lt;TAG&gt;</code> (argument to this command) from the current song",sr_volume:`Sets the song request volume to <code>&lt;VOLUME&gt;</code> (argument to this command, min 0, max 100).
  <br />
  If no argument is given, just outputs the current volume`,sr_filter:`Play only songs with the given tag <code>&lt;TAG&gt;</code> (argument to this command). If no tag
  is given, play all songs.`,sr_preset:`Switches to the preset <code>&lt;PRESET&gt;</code> (argument to this command) if it exists.
  If no arguments are given, outputs all available presets.`,sr_queue:"Shows the next 3 songs that will play."},Kt={dict_lookup:vt.Name(),madochan_createword:yt.Name(),chatters:gt.Name(),media:bt.Name(),media_volume:"media volume command",countdown:ft.Name(),text:_t.Name(),set_channel_title:kt.Name(),set_channel_game_id:wt.Name(),add_stream_tags:pt.Name(),remove_stream_tags:$t.Name(),sr_current:"sr_current",sr_undo:"sr_undo",sr_good:"sr_good",sr_bad:"sr_bad",sr_stats:"sr_stats",sr_prev:"sr_prev",sr_next:"sr_next",sr_jumptonew:"sr_jumptonew",sr_clear:"sr_clear",sr_rm:"sr_rm",sr_shuffle:"sr_shuffle",sr_reset_stats:"sr_reset_stats",sr_loop:"sr_loop",sr_noloop:"sr_noloop",sr_pause:"sr_pause",sr_unpause:"sr_unpause",sr_hidevideo:"sr_hidevideo",sr_showvideo:"sr_showvideo",sr_request:"sr_request",sr_re_request:"sr_re_request",sr_addtag:"sr_addtag",sr_rmtag:"sr_rmtag",sr_volume:"sr_volume",sr_filter:"sr_filter",sr_preset:"sr_preset",sr_queue:"sr_queue"},Yu=t=>{switch(t){case"text":return _t.NewCommand();case"media":return bt.NewCommand();case"media_volume":return{triggers:[C()],action:"media_volume",restrict_to:T,variables:[],variableChanges:[],data:{}};case"countdown":return ft.NewCommand();case"dict_lookup":return vt.NewCommand();case"madochan_createword":return yt.NewCommand();case"chatters":return gt.NewCommand();case"set_channel_title":return kt.NewCommand();case"set_channel_game_id":return wt.NewCommand();case"add_stream_tags":return pt.NewCommand();case"remove_stream_tags":return $t.NewCommand();case"sr_current":return{action:"sr_current",triggers:[C("!sr current",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_undo":return{action:"sr_undo",triggers:[C("!sr undo",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_good":return{action:"sr_good",triggers:[C("!sr good",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_bad":return{action:"sr_bad",triggers:[C("!sr bad",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_stats":return{action:"sr_stats",triggers:[C("!sr stats",!0),C("!sr stat",!0)],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_prev":return{action:"sr_prev",triggers:[C("!sr prev",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_next":return{action:"sr_next",triggers:[C("!sr next",!0),C("!sr skip",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_jumptonew":return{action:"sr_jumptonew",triggers:[C("!sr jumptonew",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_clear":return{action:"sr_clear",triggers:[C("!sr clear",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_rm":return{action:"sr_rm",triggers:[C("!sr rm",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_shuffle":return{action:"sr_shuffle",triggers:[C("!sr shuffle",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_reset_stats":return{action:"sr_reset_stats",triggers:[C("!sr resetStats",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_loop":return{action:"sr_loop",triggers:[C("!sr loop",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_noloop":return{action:"sr_noloop",triggers:[C("!sr noloop",!0),C("!sr unloop",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_pause":return{action:"sr_pause",triggers:[C("!sr pause",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_unpause":return{action:"sr_unpause",triggers:[C("!sr nopause",!0),C("!sr unpause",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_hidevideo":return{action:"sr_hidevideo",triggers:[C("!sr hidevideo",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_showvideo":return{action:"sr_showvideo",triggers:[C("!sr showvideo",!0)],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_request":return{action:"sr_request",triggers:[C("!sr")],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_re_request":return{action:"sr_re_request",triggers:[C("!resr")],restrict_to:[],variables:[],variableChanges:[],data:{}};case"sr_addtag":return{action:"sr_addtag",triggers:[C("!sr tag"),C("!sr addtag")],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_rmtag":return{action:"sr_rmtag",triggers:[C("!sr rmtag")],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_volume":return{action:"sr_volume",triggers:[C("!sr volume")],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_filter":return{action:"sr_filter",triggers:[C("!sr filter")],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_preset":return{action:"sr_preset",triggers:[C("!sr preset")],restrict_to:T,variables:[],variableChanges:[],data:{}};case"sr_queue":return{action:"sr_queue",triggers:[C("!sr queue")],restrict_to:[],variables:[],variableChanges:[],data:{}};default:return null}};const Xu=V({props:{modelValue:{type:Object,required:!0},mode:{type:String,required:!0},globalVariables:{type:Array,required:!0},baseVolume:{default:100}},emits:["update:modelValue","cancel"],data:()=>({item:null,variableChangeFocusIdx:-1,dictLangs:[{value:"ja",flag:"\u{1F1EF}\u{1F1F5}",title:"Japanese"},{value:"ru",flag:"\u{1F1F7}\u{1F1FA}",title:"Russian"},{value:"de",flag:"\u{1F1E9}\u{1F1EA}",title:"German"},{value:"es",flag:"\u{1F1EA}\u{1F1F8}",title:"Spanish"},{value:"fr",flag:"\u{1F1EB}\u{1F1F7}",title:"French"},{value:"it",flag:"\u{1F1EE}\u{1F1F9}",title:"Italian"},{value:"pt",flag:"\u{1F1F5}\u{1F1F9}/\u{1F1E7}\u{1F1F7}",title:"Portuguese"}],possiblePermissions:[{value:"broadcaster",label:"Broadcaster"},{value:"mod",label:"Moderators"},{value:"sub",label:"Subscribers"}]}),mounted(){this.item=JSON.parse(JSON.stringify(this.modelValue)),this.$nextTick(()=>{this.$el.querySelector('input[type="text"]').focus()})},watch:{modelValue:{handler(t){this.item=JSON.parse(JSON.stringify(t))}}},methods:{addtxt(){if(!this.item){console.warn("addtxt: this.item not initialized");return}this.item.data.text.push(Ct())},addtrigger(t){if(!this.item){console.warn("addtrigger: this.item not initialized");return}this.item.triggers.push(Ht(t.type))},onAddVariableChange(){if(!this.item){console.warn("onAddVariableChange: this.item not initialized");return}this.item.variableChanges.push({name:"",change:"set",value:""})},rmVariableChange(t){if(!this.item){console.warn("rmVariableChange: this.item not initialized");return}this.item.variableChanges=this.item.variableChanges.filter((s,i)=>i!==t)},onAddVariable(){if(!this.item){console.warn("onAddVariable: this.item not initialized");return}this.item.variables.push({name:"",value:""})},rmVariable(t){if(!this.item){console.warn("rmVariable: this.item not initialized");return}this.item.variables=this.item.variables.filter((s,i)=>i!==t)},onSaveClick(){this.$emit("update:modelValue",this.item)},onCancelClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},mediaSndChanged(t){if(!this.item){console.warn("mediaSndChanged: this.item not initialized");return}this.item.data.sound=t},mediaImgChanged(t){if(!this.item){console.warn("mediaImgUploaded: this.item not initialized");return}this.item.data.image=t},rmtxt(t){if(!this.item){console.warn("rmtxt: this.item not initialized");return}this.item.data.text=this.item.data.text.filter((s,i)=>i!==t)},rmtrigger(t){if(!this.item){console.warn("rmtrigger: this.item not initialized");return}this.item.triggers=this.item.triggers.filter((s,i)=>i!==t)},autocompletableVariables(t){if(!this.item){console.warn("autocompletableVariables: this.item not initialized");return}const s=this.item.variables.slice().map(i=>({var:i,type:"local"}));return this.globalVariables.forEach(i=>{s.find(r=>r.var.name===i.name)||s.push({var:i,type:"global"})}),s.filter(i=>i.var.name.startsWith(t)).slice(0,10)},onVarChangeInputBlur(){setTimeout(()=>{this.variableChangeFocusIdx=-1},50)}},computed:{requiresAccessToken(){return this.item?this.item.action==="set_channel_title"||this.item.action==="set_channel_game_id"||this.item.action==="add_stream_tags"||this.item.action==="remove_stream_tags":!1},possibleTriggerActions(){return[{type:"command",label:"Add Command",title:"Command"},{type:"reward_redemption",label:"Add Reward Redemption",title:"Reward Redemption"},{type:"timer",label:"Add Timer",title:"Timer"}]},valid(){if(!this.item)return!1;for(const t of this.item.triggers)if(t.type==="command"){if(!t.data.command)return!1}else if(t.type==="timer"){try{Y.mustParseHumanDuration(t.data.minInterval)}catch{return!1}const s=parseInt(`${t.data.minLines}`,10);if(isNaN(s))return!1}if(this.item.action==="text"){for(const t of this.item.data.text)if(t==="")return!1}return!0},actionDescriptions(){return Vt},title(){return this.item?`${{create:"Create new ",edit:"Edit "}[this.mode]}${Kt[this.item.action]}`:""}}}),I=t=>(H("data-v-69f721b6"),t=t(),K(),t),Qu={key:0,class:"modal is-active"},Zu={class:"modal-card"},ju={class:"modal-card-head"},xu={class:"modal-card-title"},tm={class:"modal-card-body"},em={class:"table is-striped"},sm=I(()=>e("td",null,"Triggers:",-1)),nm={key:0},im=I(()=>e("td",null,"Description:",-1)),am=["innerHTML"],om={key:1},lm=I(()=>e("td",null,"Attention:",-1)),rm=I(()=>e("td",null,[e("div",{class:"help"},[g(" This requires "),e("code",null,"Access Token"),g(" to be set in the user settings. ")])],-1)),dm=[lm,rm],um={key:2},mm=I(()=>e("td",null,"Stream title:",-1)),hm={key:3},cm=I(()=>e("td",null,"Stream category:",-1)),pm={key:4},gm=I(()=>e("td",null,"Tag to add:",-1)),fm={key:5},vm=I(()=>e("td",null,"Tag to remove:",-1)),ym=I(()=>e("td",null,"Language:",-1)),bm=["onClick","title"],_m=I(()=>e("code",null,"$args(0)",-1)),$m=[_m],wm=I(()=>e("td",null,"Phrase:",-1)),km=I(()=>e("code",null,"$args(1:)",-1)),Cm=[km],Vm=I(()=>e("tr",null,[e("td",null,"Response:"),e("td",null,[e("div",{class:"help"},[g(" Outputs the translation for the input phrase. The translation is always from/to english. "),e("br"),g(" To let the user decide on the language use "),e("code",null,"$args(0)"),g(" as language, and "),e("code",null,"$args(1:)"),g(" as phrase. "),e("br"),g(" If phrase is left empty, all arguments to the command will be used as the phrase. ")])])],-1)),Sm=I(()=>e("td",null,"Model:",-1)),Dm={class:"control"},Im=I(()=>e("div",{class:"help"},[g(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),Um=I(()=>e("td",null,"Weirdness:",-1)),Am={class:"control"},Pm=I(()=>e("div",{class:"help"},[g(" For possible values refer to "),e("a",{href:"https://madochan.hyottoko.club/",target:"_blank"},"madochan")],-1)),Tm={key:8},Nm=I(()=>e("td",null,"Response:",-1)),Om=I(()=>e("td",null,"Outputs the people who chatted during the stream.",-1)),Fm=[Nm,Om],Em={key:9},Mm=I(()=>e("td",null,"Response:",-1)),Lm=["onUpdate:modelValue"],zm=["disabled","onClick"],qm=I(()=>e("i",{class:"fa fa-remove"},null,-1)),Rm=[qm],Jm={class:"field"},Bm=I(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),Wm=g(" Add response "),Hm=[Bm,Wm],Km=I(()=>e("div",null,[e("p",{class:"help"}," If multiple responses exist, a random one will be used when the command is triggered. ")],-1)),Gm={key:10},Ym=I(()=>e("td",null,"Image:",-1)),Xm={key:11},Qm=I(()=>e("td",null,"Sound:",-1)),Zm={key:12},jm=I(()=>e("td",null,"Duration:",-1)),xm={class:"control has-icons-left"},th=I(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),eh={key:13},sh=I(()=>e("td",null,"Settings",-1)),nh=I(()=>e("td",null,"Variables:",-1)),ih={key:0},ah=I(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Value")])],-1)),oh=["onUpdate:modelValue"],lh=["onUpdate:modelValue"],rh=["onClick"],dh=I(()=>e("i",{class:"fa fa-remove"},null,-1)),uh=[dh],mh=I(()=>e("div",{class:"help"},[g(" Variables can be used from the command with "),e("code",null,"$var(variable_name)"),g(". If the referenced variable is not defined here, "),e("a",{href:"/variables/",target:"_blank"},"global variables"),g(" are used. ")],-1)),hh=I(()=>e("td",null,"Variable changes:",-1)),ch={key:0},ph=I(()=>e("thead",null,[e("tr",null,[e("td",null,"Name"),e("td",null,"Change"),e("td",null,"Value"),e("td")])],-1)),gh={class:"dropdown is-active is-up"},fh={class:"dropdown-trigger"},vh=["onUpdate:modelValue","onFocus"],yh={key:0,class:"dropdown-menu",id:"dropdown-menu",role:"menu"},bh={class:"dropdown-content"},_h=["onClick"],$h=g(") "),wh={class:"select is-small"},kh=["onUpdate:modelValue"],Ch=I(()=>e("option",{value:"set"},"set",-1)),Vh=I(()=>e("option",{value:"increase_by"},"increase by",-1)),Sh=I(()=>e("option",{value:"decrease_by"},"decrease by",-1)),Dh=[Ch,Vh,Sh],Ih=["onUpdate:modelValue"],Uh=["onClick"],Ah=I(()=>e("i",{class:"fa fa-remove"},null,-1)),Ph=[Ah],Th=I(()=>e("div",{class:"help"}," Variable changes are performed when the command is executed, before anything else. ",-1)),Nh=I(()=>e("td",null,"Permissions:",-1)),Oh=["value"],Fh={class:"modal-card-foot"},Eh=["disabled"];function Mh(t,s,i,r,c,b){const h=_("trigger-editor"),n=_("dropdown-button"),l=_("image-upload"),u=_("sound-upload"),f=_("duration-input"),k=_("countdown-editor");return t.item?(a(),o("div",Qu,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...d)=>t.onOverlayClick&&t.onOverlayClick(...d))}),e("div",Zu,[e("header",ju,[e("p",xu,$(t.title),1),e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...d)=>t.onCloseClick&&t.onCloseClick(...d))})]),e("section",tm,[e("table",em,[e("tbody",null,[e("tr",null,[sm,e("td",null,[(a(!0),o(D,null,A(t.item.triggers,(d,p)=>(a(),O(h,{key:p,class:"spacerow",modelValue:d,removable:t.item.triggers.length>1,"onUpdate:modelValue":U=>t.item.triggers[p]=U,onRemove:U=>t.rmtrigger(p)},null,8,["modelValue","removable","onUpdate:modelValue","onRemove"]))),128)),w(n,{actions:t.possibleTriggerActions,label:"Add trigger",onClick:t.addtrigger},null,8,["actions","onClick"])])]),t.actionDescriptions[t.item.action]?(a(),o("tr",nm,[im,e("td",{innerHTML:t.actionDescriptions[t.item.action]},null,8,am)])):v("",!0),t.requiresAccessToken?(a(),o("tr",om,dm)):v("",!0),t.item.action==="set_channel_title"?(a(),o("tr",um,[mm,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[2]||(s[2]=d=>t.item.data.title=d)},null,512),[[y,t.item.data.title]]),e("span",{class:"button is-small mr-1",onClick:s[3]||(s[3]=d=>t.item.data.title="")},"All args")])])):v("",!0),t.item.action==="set_channel_game_id"?(a(),o("tr",hm,[cm,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[4]||(s[4]=d=>t.item.data.game_id=d)},null,512),[[y,t.item.data.game_id]]),e("span",{class:"button is-small mr-1",onClick:s[5]||(s[5]=d=>t.item.data.game_id="")},"All args")])])):v("",!0),t.item.action==="add_stream_tags"?(a(),o("tr",pm,[gm,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[6]||(s[6]=d=>t.item.data.tag=d)},null,512),[[y,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[7]||(s[7]=d=>t.item.data.tag="")},"All args")])])):v("",!0),t.item.action==="remove_stream_tags"?(a(),o("tr",fm,[vm,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[8]||(s[8]=d=>t.item.data.tag=d)},null,512),[[y,t.item.data.tag]]),e("span",{class:"button is-small mr-1",onClick:s[9]||(s[9]=d=>t.item.data.tag="")},"All args")])])):v("",!0),t.item.action==="dict_lookup"?(a(),o(D,{key:6},[e("tr",null,[ym,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[10]||(s[10]=d=>t.item.data.lang=d)},null,512),[[y,t.item.data.lang]]),(a(!0),o(D,null,A(t.dictLangs,(d,p)=>(a(),o("span",{key:p,class:"button is-small mr-1",onClick:U=>t.item.data.lang=d.value,title:d.title},$(d.flag),9,bm))),128)),e("span",{class:"button is-small mr-1",onClick:s[11]||(s[11]=d=>t.item.data.lang="$args(0)")},$m)])]),e("tr",null,[wm,e("td",null,[m(e("input",{class:"input is-small spaceinput mb-1","onUpdate:modelValue":s[12]||(s[12]=d=>t.item.data.phrase=d)},null,512),[[y,t.item.data.phrase]]),e("span",{class:"button is-small mr-1",onClick:s[13]||(s[13]=d=>t.item.data.phrase="")},"All args"),e("span",{class:"button is-small mr-1",onClick:s[14]||(s[14]=d=>t.item.data.phrase="$args(1:)")},Cm)])]),Vm],64)):v("",!0),t.item.action==="madochan_createword"?(a(),o(D,{key:7},[e("tr",null,[Sm,e("td",null,[e("div",Dm,[m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[15]||(s[15]=d=>t.item.data.model=d)},null,512),[[y,t.item.data.model]])]),Im])]),e("tr",null,[Um,e("td",null,[e("div",Am,[m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[16]||(s[16]=d=>t.item.data.weirdness=d)},null,512),[[y,t.item.data.weirdness]])]),Pm])])],64)):v("",!0),t.item.action==="chatters"?(a(),o("tr",Tm,Fm)):v("",!0),t.item.action==="text"?(a(),o("tr",Em,[Mm,e("td",null,[(a(!0),o(D,null,A(t.item.data.text,(d,p)=>(a(),o("div",{key:p,class:"field textarea-holder"},[m(e("textarea",{class:P(["textarea",{"has-background-danger-light":!t.item.data.text[p],"has-text-danger-dark":!t.item.data.text[p]}]),type:"text","onUpdate:modelValue":U=>t.item.data.text[p]=U},null,10,Lm),[[y,t.item.data.text[p]]]),e("button",{class:"button is-small",disabled:t.item.data.text.length<=1,onClick:U=>t.rmtxt(p)},Rm,8,zm)]))),128)),e("div",Jm,[e("button",{class:"button is-small",onClick:s[17]||(s[17]=(...d)=>t.addtxt&&t.addtxt(...d))},Hm)]),Km])])):v("",!0),t.item.action==="media"?(a(),o("tr",Gm,[Ym,e("td",null,[w(l,{modelValue:t.item.data.image,"onUpdate:modelValue":[s[18]||(s[18]=d=>t.item.data.image=d),t.mediaImgChanged]},null,8,["modelValue","onUpdate:modelValue"])])])):v("",!0),t.item.action==="media"?(a(),o("tr",Xm,[Qm,e("td",null,[w(u,{modelValue:t.item.data.sound,"onUpdate:modelValue":[s[19]||(s[19]=d=>t.item.data.sound=d),t.mediaSndChanged],baseVolume:t.baseVolume},null,8,["modelValue","baseVolume","onUpdate:modelValue"])])])):v("",!0),t.item.action==="media"?(a(),o("tr",Zm,[jm,e("td",null,[e("div",xm,[w(f,{modelValue:t.item.data.minDurationMs,"onUpdate:modelValue":s[20]||(s[20]=d=>t.item.data.minDurationMs=d)},null,8,["modelValue"]),th])])])):v("",!0),t.item.action==="countdown"?(a(),o("tr",eh,[sh,e("td",null,[w(k,{modelValue:t.item.data,"onUpdate:modelValue":s[21]||(s[21]=d=>t.item.data=d),baseVolume:t.baseVolume},null,8,["modelValue","baseVolume"])])])):v("",!0),e("tr",null,[nh,e("td",null,[t.item.variables.length>0?(a(),o("table",ih,[ah,e("tbody",null,[(a(!0),o(D,null,A(t.item.variables,(d,p)=>(a(),o("tr",{key:p},[e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":U=>d.name=U},null,8,oh),[[y,d.name]])]),e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":U=>d.value=U},null,8,lh),[[y,d.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:U=>t.rmVariable(p)},uh,8,rh)])]))),128))])])):v("",!0),e("span",{class:"button is-small",onClick:s[22]||(s[22]=(...d)=>t.onAddVariable&&t.onAddVariable(...d))},"Add Variable"),mh])]),e("tr",null,[hh,e("td",null,[t.item.variableChanges.length>0?(a(),o("table",ch,[ph,e("tbody",null,[(a(!0),o(D,null,A(t.item.variableChanges,(d,p)=>(a(),o("tr",{key:p},[e("td",null,[e("div",gh,[e("div",fh,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":U=>d.name=U,onFocus:U=>t.variableChangeFocusIdx=p,onBlur:s[23]||(s[23]=(...U)=>t.onVarChangeInputBlur&&t.onVarChangeInputBlur(...U))},null,40,vh),[[y,d.name]])]),t.variableChangeFocusIdx===p?(a(),o("div",yh,[e("div",bh,[(a(!0),o(D,null,A(t.autocompletableVariables(d.name),(U,N)=>(a(),o("a",{class:"dropdown-item",key:N,onClick:M=>d.name=U.var.name},[g($(U.var.name)+" ("+$(U.type)+", ",1),e("code",null,$(U.var.value),1),$h],8,_h))),128))])])):v("",!0)])]),e("td",null,[e("div",wh,[m(e("select",{"onUpdate:modelValue":U=>d.change=U},Dh,8,kh),[[Dt,d.change]])])]),e("td",null,[m(e("input",{type:"text",class:"input is-small","onUpdate:modelValue":U=>d.value=U},null,8,Ih),[[y,d.value]])]),e("td",null,[e("button",{class:"button is-small",onClick:U=>t.rmVariableChange(p)},Ph,8,Uh)])]))),128))])])):v("",!0),e("span",{class:"button is-small",onClick:s[24]||(s[24]=(...d)=>t.onAddVariableChange&&t.onAddVariableChange(...d))},"Add Variable Change"),Th])]),e("tr",null,[Nh,e("td",null,[(a(!0),o(D,null,A(t.possiblePermissions,(d,p)=>(a(),o("label",{key:p,class:"mr-1"},[m(e("input",{type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=U=>t.item.restrict_to=U),value:d.value},null,8,Oh),[[q,t.item.restrict_to]]),g(" "+$(d.label),1)]))),128))])])])])]),e("footer",Fh,[e("button",{class:"button is-small is-primary",disabled:!t.valid,onClick:s[26]||(s[26]=(...d)=>t.onSaveClick&&t.onSaveClick(...d))}," Save changes ",8,Eh),e("button",{class:"button is-small",onClick:s[27]||(s[27]=(...d)=>t.onCancelClick&&t.onCancelClick(...d))},"Cancel")])])])):v("",!0)}var Lh=S(Xu,[["render",Mh],["__scopeId","data-v-69f721b6"]]);const zh=V({props:{globalVariables:{type:Array,required:!0},possibleActions:{type:Array,required:!0},baseVolume:{type:Number,required:!0},modelValue:{type:Array,required:!0},showToggleImages:{type:Boolean,required:!1,default:!1},showFilterActions:{type:Boolean,required:!1,default:!1},showImages:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue","showImagesChange"],data(){return{commands:[],editIdx:null,editCommand:null,filter:{search:"",actions:[]},imagesVisible:!1}},computed:{possibleActionsMapped(){return this.possibleActions.map(t=>({type:t,title:this.actionDescription(t),label:`Add ${this.actionName(t)}`}))},possibleActionsWithCount(){return this.possibleActions.map(t=>({action:t,count:this.commandCount(t)})).filter(t=>t.count>0)},actionDescriptions(){return Vt}},methods:{onImageVisibleChange(){this.$emit("showImagesChange",this.imagesVisible)},emitChange(){this.$emit("update:modelValue",this.commands)},commandCount(t){let s=0;for(const i of this.commands)i.action===t&&s++;return s},filteredOut(t){if(this.filter.actions.length>0&&!this.filter.actions.includes(t.action))return!0;if(!this.filter.search)return!1;const s=this.filter.search.toLowerCase();return!t.triggers.find(({type:i,data:r})=>i==="command"&&r.command.toLowerCase().indexOf(s)>=0)},permissionsStr(t){if(!t.restrict_to||t.restrict_to.length===0)return"Everyone";const s=[];return t.restrict_to.includes("broadcaster")&&s.push("Broadcaster"),t.restrict_to.includes("mod")&&s.push("Moderators"),t.restrict_to.includes("sub")&&s.push("Subscribers"),s.join(", ")},remove(t){this.commands=this.commands.filter((s,i)=>i!==t),this.emitChange()},add(t){const s=Yu(t.type);!s||(this.editIdx=this.commands.length,this.editCommand=s)},edit(t){this.editIdx=t,this.editCommand=this.commands[t]},duplicate(t){this.editIdx=this.commands.length,this.editCommand=JSON.parse(JSON.stringify(this.commands[t]))},editedCommand(t){this.editIdx!==null&&(this.commands[this.editIdx]=t,this.emitChange(),this.editIdx=null,this.editCommand=null)},dragEnd(t){this.commands=Y.arrayMove(this.commands,t.oldIndex,t.newIndex),this.emitChange()},actionDescription(t){return Vt[t]},actionName(t){return Kt[t]}},created(){this.commands=JSON.parse(JSON.stringify(this.modelValue)),this.imagesVisible=this.showImages}}),L=t=>(H("data-v-3f10b47e"),t=t(),K(),t),qh={class:"actions"},Rh=L(()=>e("div",{class:"mr-1"},"Filter:",-1)),Jh={class:"field has-addons mr-1 mb-0"},Bh={class:"control"},Wh={key:0,class:"field"},Hh=["value"],Kh={key:0,class:"table-container"},Gh={class:"table is-striped",ref:"table"},Yh=L(()=>e("th",null,null,-1)),Xh=L(()=>e("th",null,null,-1)),Qh=L(()=>e("th",null,"Trigger",-1)),Zh=g(" Response "),jh={key:0},xh=g(" Show images "),tc=L(()=>e("th",null,"Type",-1)),ec=L(()=>e("th",null,"Permissions",-1)),sc=L(()=>e("th",null,null,-1)),nc=L(()=>e("th",null,null,-1)),ic=L(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),ac={class:"pl-0 pr-0"},oc=["onClick"],lc=L(()=>e("i",{class:"fa fa-pencil"},null,-1)),rc=[lc],dc={class:"col-triggers"},uc={key:0},mc={key:1},hc=L(()=>e("span",{class:"is-small",title:"Channel Point Reward"},[e("i",{class:"fa fa-bullseye"}),g(": ")],-1)),cc={key:2},pc=L(()=>e("span",{class:"is-small"},"Timer: ",-1)),gc={key:0},fc={key:0},vc={key:0,class:"spacerow media-holder media-holder-inline"},yc={key:1},bc={key:2,class:"fa fa-plus is-justify-content-center mr-2 ml-2"},_c={key:3,class:"ml-2"},$c=g("for at least "),wc={key:4,class:"ml-2"},kc=g("for "),Cc={key:2},Vc={key:0},Sc=L(()=>e("span",null,"\u2192",-1)),Dc=g(" \u2715 "),Ic=L(()=>e("span",null,"\u2192",-1)),Uc={key:1},Ac={key:1},Pc={key:2},Tc=g(" Media("),Nc={key:0},Oc={key:1},Fc={key:2},Ec=g(") "),Mc={key:3},Lc=["innerHTML"],zc={class:"pl-0 pr-0"},qc=L(()=>e("i",{class:"fa fa-trash"},null,-1)),Rc=["onClick"],Jc=L(()=>e("i",{class:"fa fa-clone"},null,-1)),Bc=[Jc],Wc={key:1};function Hc(t,s,i,r,c,b){const h=_("dropdown-button"),n=_("duration"),l=_("responsive-image"),u=_("player"),f=_("doubleclick-button"),k=_("draggable"),d=_("command-editor");return a(),o("div",null,[e("div",qh,[w(h,{actions:t.possibleActionsMapped,label:"Add command",onClick:t.add},null,8,["actions","onClick"]),Rh,e("div",Jh,[e("div",Bh,[m(e("input",{class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=p=>t.filter.search=p)},null,512),[[y,t.filter.search]])])]),t.showFilterActions?(a(),o("div",Wh,[(a(!0),o(D,null,A(t.possibleActionsWithCount,(p,U)=>(a(),o("label",{class:"mr-1",key:U},[m(e("input",{class:"mr-1",type:"checkbox",value:p.action,"onUpdate:modelValue":s[1]||(s[1]=N=>t.filter.actions=N)},null,8,Hh),[[q,t.filter.actions]]),g($(p.action)+" ("+$(p.count)+")",1)]))),128))])):v("",!0)]),t.commands.length>0?(a(),o("div",Kh,[e("table",Gh,[e("thead",null,[e("tr",null,[Yh,Xh,Qh,e("th",null,[Zh,t.showToggleImages?(a(),o("label",jh,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[2]||(s[2]=p=>t.imagesVisible=p),s[3]||(s[3]=(...p)=>t.onImageVisibleChange&&t.onImageVisibleChange(...p))]},null,512),[[q,t.imagesVisible]]),xh])):v("",!0)]),tc,ec,sc,nc])]),w(k,{modelValue:t.commands,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:z(({element:p,index:U})=>[m(e("tr",null,[ic,e("td",ac,[e("button",{class:"button is-small",onClick:N=>t.edit(U)},rc,8,oc)]),e("td",dc,[(a(!0),o(D,null,A(p.triggers,(N,M)=>(a(),o("div",{key:M,class:"spacerow"},[p.triggers[M].type==="command"?(a(),o("div",uc,[e("code",null,$(p.triggers[M].data.command),1)])):v("",!0),p.triggers[M].type==="reward_redemption"?(a(),o("div",mc,[hc,e("code",null,$(p.triggers[M].data.command),1)])):v("",!0),p.triggers[M].type==="timer"?(a(),o("div",cc,[pc,e("code",null,[g($(p.triggers[M].data.minLines)+" lines, ",1),w(n,{value:p.triggers[M].data.minInterval},null,8,["value"])])])):v("",!0)]))),128))]),e("td",null,[p.action==="text"?(a(),o("div",gc,[(a(!0),o(D,null,A(p.data.text,(N,M)=>(a(),o(D,{key:M},[e("code",null,$(p.data.text[M]),1),M<p.data.text.length-1?(a(),o("span",fc,"or")):v("",!0)],64))),128))])):p.action==="media"?(a(),o("div",{key:1,class:P(p.action)},[p.data.image.file||p.data.sound.file?(a(),o("div",vc,[p.data.image.file&&t.imagesVisible?(a(),O(l,{key:0,src:p.data.image.urlpath,title:p.data.image.filename,width:"100px",height:"50px",style:{display:"inline-block"}},null,8,["src","title"])):p.data.image.file?(a(),o("code",yc,$(p.data.image.filename),1)):v("",!0),p.data.image.file&&p.data.sound.file?(a(),o("i",bc)):v("",!0),w(u,{src:p.data.sound.urlpath,name:p.data.sound.filename,volume:p.data.sound.volume,baseVolume:t.baseVolume,class:"button is-small is-justify-content-center"},null,8,["src","name","volume","baseVolume"]),p.data.image.file&&p.data.sound.file?(a(),o("span",_c,[$c,w(n,{value:p.data.minDurationMs},null,8,["value"])])):p.data.image.file?(a(),o("span",wc,[kc,w(n,{value:p.data.minDurationMs},null,8,["value"])])):v("",!0)])):v("",!0)],2)):p.action==="countdown"?(a(),o("div",Cc,[(p.data.type||"auto")==="auto"?(a(),o("div",Vc,[e("code",null,$(p.data.intro),1),Sc,e("code",null,$(p.data.steps),1),Dc,w(n,{value:p.data.interval},null,8,["value"]),Ic,e("code",null,$(p.data.outro),1)])):(a(),o("div",Uc,[(a(!0),o(D,null,A(p.data.actions,(N,M)=>(a(),o(D,{key:M},[N.type==="delay"?(a(),O(n,{key:0,value:N.value},null,8,["value"])):v("",!0),N.type==="text"?(a(),o("code",Ac,$(N.value),1)):v("",!0),N.type==="media"?(a(),o("code",Pc,[Tc,N.value.image.file?(a(),o("span",Nc,$(N.value.image.filename),1)):v("",!0),N.value.image.file&&N.value.sound.file?(a(),o("span",Oc,"+")):v("",!0),N.value.sound.file?(a(),o("span",Fc,$(N.value.sound.filename),1)):v("",!0),Ec])):v("",!0),M<p.data.actions.length-1?(a(),o("span",Mc,"\u2192")):v("",!0)],64))),128))]))])):t.actionDescriptions[p.action]?(a(),o("div",{key:3,innerHTML:t.actionDescriptions[p.action]},null,8,Lc)):v("",!0)]),e("td",null,$(p.action),1),e("td",null,$(t.permissionsStr(p)),1),e("td",zc,[w(f,{class:"button is-small mr-1",message:"Are you sure?",timeout:1e3,onDoubleclick:N=>t.remove(U)},{default:z(()=>[qc]),_:2},1032,["onDoubleclick"]),e("button",{class:"button is-small",onClick:N=>t.duplicate(U)},Bc,8,Rc)])],512),[[ot,!t.filteredOut(p)]])]),_:1},8,["modelValue","onEnd"])],512)])):(a(),o("div",Wc,"No commands set up")),t.editCommand?(a(),O(d,{key:2,globalVariables:t.globalVariables,modelValue:t.editCommand,mode:t.editIdx>=t.commands.length?"create":"edit",baseVolume:t.baseVolume,"onUpdate:modelValue":t.editedCommand,onCancel:s[4]||(s[4]=p=>t.editCommand=null)},null,8,["globalVariables","modelValue","mode","baseVolume","onUpdate:modelValue"])):v("",!0)])}var Kc=S(zh,[["render",Hc],["__scopeId","data-v-3f10b47e"]]);const Gc=V({name:"countdown-edit",props:{baseVolume:{default:100},modelValue:{type:Object,required:!0}},data:()=>({countdown:{type:"manual",actions:[],steps:3,interval:1e3,intro:"",outro:""}}),methods:{dragEnd(t){this.countdown.actions=Y.arrayMove(this.countdown.actions,t.oldIndex,t.newIndex)},onAddDelay(){this.countdown.actions.push({type:"delay",value:"1s"})},onAddText(){this.countdown.actions.push({type:"text",value:Ct()})},onAddMedia(){this.countdown.actions.push({type:"media",value:Wt()})},rmaction(t){this.countdown.actions=this.countdown.actions.filter((s,i)=>i!==t)},mediaSndChanged(t,s){this.countdown.actions[t].value.sound=s},mediaImgChanged(t,s){this.countdown.actions[t].value.image=s}},created(){this.countdown.type=this.modelValue.type||"auto",this.countdown.actions=this.modelValue.actions||[],this.countdown.steps=this.modelValue.steps,this.countdown.interval=this.modelValue.interval,this.countdown.intro=this.modelValue.intro,this.countdown.outro=this.modelValue.outro,this.$watch("countdown",()=>{this.$emit("update:modelValue",{type:this.countdown.type,actions:this.countdown.actions,steps:this.countdown.steps,interval:this.countdown.interval,intro:this.countdown.intro,outro:this.countdown.outro})},{deep:!0})}}),Yc={class:"control"},Xc={class:"radio"},Qc=g(" Manual "),Zc={class:"radio"},jc=g(" Auto "),xc={key:0},tp={class:"spacerow"},ep=e("label",{class:"spacelabel"},"Steps ",-1),sp={class:"spacerow"},np=e("label",{class:"spacelabel"},"Interval ",-1),ip={class:"spacerow"},ap=e("label",{class:"spacelabel"},"Intro ",-1),op={class:"spacerow"},lp=e("label",{class:"spacelabel"},"Outro ",-1),rp={key:1},dp={class:"field has-addons mr-1"},up=e("span",{class:"handle p-2"},[e("i",{class:"fa fa-arrows"})],-1),mp={key:0,class:"control has-icons-left"},hp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),cp={key:1,class:"control has-icons-left"},pp=["onUpdate:modelValue"],gp=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1),fp={key:2,class:"control has-icons-left"},vp=e("td",null,"Image:",-1),yp=e("td",null,"Sound:",-1),bp=e("td",null,"Duration:",-1),_p={class:"control has-icons-left"},$p=e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1),wp={class:"control"},kp=["onClick"],Cp=e("i",{class:"fa fa-remove"},null,-1),Vp=[Cp],Sp=e("i",{class:"fa fa-hourglass mr-1"},null,-1),Dp=g(" Add Delay "),Ip=[Sp,Dp],Up=e("i",{class:"fa fa-comments-o mr-1"},null,-1),Ap=g(" Add Chat "),Pp=[Up,Ap],Tp=e("i",{class:"fa fa-picture-o mr-1"},null,-1),Np=g(" Add Media "),Op=[Tp,Np];function Fp(t,s,i,r,c,b){const h=_("duration-input"),n=_("image-upload"),l=_("sound-upload"),u=_("draggable");return a(),o("div",null,[e("div",Yc,[e("label",Xc,[m(e("input",{type:"radio",value:"manual","onUpdate:modelValue":s[0]||(s[0]=f=>t.countdown.type=f)},null,512),[[tt,t.countdown.type]]),Qc]),e("label",Zc,[m(e("input",{type:"radio",value:"auto","onUpdate:modelValue":s[1]||(s[1]=f=>t.countdown.type=f)},null,512),[[tt,t.countdown.type]]),jc])]),t.countdown.type==="auto"?(a(),o("div",xc,[e("div",tp,[ep,m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[2]||(s[2]=f=>t.countdown.steps=f)},null,512),[[y,t.countdown.steps]])]),e("div",sp,[np,w(h,{modelValue:t.countdown.interval,"onUpdate:modelValue":s[3]||(s[3]=f=>t.countdown.interval=f)},null,8,["modelValue"])]),e("div",ip,[ap,m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[4]||(s[4]=f=>t.countdown.intro=f)},null,512),[[y,t.countdown.intro]])]),e("div",op,[lp,m(e("input",{class:"input is-small spaceinput","onUpdate:modelValue":s[5]||(s[5]=f=>t.countdown.outro=f)},null,512),[[y,t.countdown.outro]])])])):(a(),o("div",rp,[w(u,{modelValue:t.countdown.actions,onEnd:t.dragEnd,handle:".handle","item-key":"id"},{item:z(({element:f,index:k})=>[e("div",dp,[up,f.type==="delay"?(a(),o("div",mp,[w(h,{modelValue:f.value,"onUpdate:modelValue":d=>f.value=d},null,8,["modelValue","onUpdate:modelValue"]),hp])):f.type==="text"?(a(),o("div",cp,[m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":d=>f.value=d},null,8,pp),[[y,f.value]]),gp])):f.type==="media"?(a(),o("div",fp,[e("table",null,[e("tr",null,[vp,e("td",null,[w(n,{modelValue:f.value.image,"onUpdate:modelValue":[d=>f.value.image=d,d=>t.mediaImgChanged(k,d)]},null,8,["modelValue","onUpdate:modelValue"])])]),e("tr",null,[yp,e("td",null,[w(l,{modelValue:f.value.sound,"onUpdate:modelValue":[d=>f.value.sound=d,d=>t.mediaSndChanged(k,d)],baseVolume:t.baseVolume},null,8,["modelValue","onUpdate:modelValue","baseVolume"])])]),e("tr",null,[bp,e("td",null,[e("div",_p,[w(h,{modelValue:f.value.minDurationMs,"onUpdate:modelValue":d=>f.value.minDurationMs=d},null,8,["modelValue","onUpdate:modelValue"]),$p])])])])])):v("",!0),e("div",wp,[e("button",{class:"button is-small",onClick:d=>t.rmaction(k)},Vp,8,kp)])])]),_:1},8,["modelValue","onEnd"]),e("button",{class:"button is-small",onClick:s[6]||(s[6]=(...f)=>t.onAddDelay&&t.onAddDelay(...f))},Ip),e("button",{class:"button is-small",onClick:s[7]||(s[7]=(...f)=>t.onAddText&&t.onAddText(...f))},Pp),e("button",{class:"button is-small",onClick:s[8]||(s[8]=(...f)=>t.onAddMedia&&t.onAddMedia(...f))},Op)]))])}var Ep=S(Gc,[["render",Fp]]);const Mp=V({props:{modelValue:{type:Object,required:!0},removable:{type:Boolean,required:!0}},emits:["update:modelValue","remove"],data(){return{value:{type:"",data:{command:"",commandExact:!1,minInterval:0,minLines:0}}}},created(){this.apply(this.modelValue)},methods:{emitRemove(){this.$emit("remove")},emitUpdate(){this.$emit("update:modelValue",this.value)},apply(t){this.value=JSON.parse(JSON.stringify(t))}},watch:{modelValue(t,s){this.apply(t)}}}),J=t=>(H("data-v-d4f9a1f6"),t=t(),K(),t),Lp={class:"trigger-editor"},zp={key:0,class:"field has-addons"},qp={class:"control has-icons-left mr-1"},Rp=J(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),Jp={class:"control mr-1",title:"Check if command should only be executed if it matches exactly (= no arguments come after it)."},Bp=J(()=>e("span",{class:"is-small is-left"},"exact",-1)),Wp={class:"control"},Hp=["disabled"],Kp=J(()=>e("i",{class:"fa fa-remove"},null,-1)),Gp=[Kp],Yp={key:1,class:"field has-addons"},Xp={class:"control has-icons-left"},Qp=J(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-bullseye"})],-1)),Zp={class:"control"},jp=["disabled"],xp=J(()=>e("i",{class:"fa fa-remove"},null,-1)),tg=[xp],eg={key:2,class:"timer-trigger"},sg={class:"control remove-control"},ng=["disabled"],ig=J(()=>e("i",{class:"fa fa-remove"},null,-1)),ag=[ig],og={class:"timer-trigger-inner"},lg=J(()=>e("label",{class:"mr-1"},"Messages \u2265",-1)),rg={class:"control has-icons-left mr-1"},dg=J(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-comments-o"})],-1)),ug=J(()=>e("label",{class:"mr-1"},"Interval \u2265",-1)),mg={class:"control has-icons-left has-icons-right mr-1"},hg=J(()=>e("span",{class:"icon is-small is-left"},[e("i",{class:"fa fa-hourglass"})],-1)),cg=J(()=>e("p",{class:"help"},[g(" Command will be triggered when at least "),e("code",null,"Messages"),g(" chat messages arrived AND "),e("code",null,"Interval"),g(" have passed. ")],-1));function pg(t,s,i,r,c,b){const h=_("duration-input");return a(),o("div",Lp,[t.value.type==="command"?(a(),o("div",zp,[e("div",qp,[m(e("input",{class:P(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[0]||(s[0]=n=>t.value.data.command=n),s[1]||(s[1]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,2),[[y,t.value.data.command]]),Rp]),e("div",Jp,[e("label",null,[m(e("input",{type:"checkbox",class:"checkbox mr-1","onUpdate:modelValue":[s[2]||(s[2]=n=>t.value.data.commandExact=n),s[3]||(s[3]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,512),[[q,t.value.data.commandExact]]),Bp])]),e("div",Wp,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[4]||(s[4]=(...n)=>t.emitRemove&&t.emitRemove(...n))},Gp,8,Hp)])])):v("",!0),t.value.type==="reward_redemption"?(a(),o("div",Yp,[e("div",Xp,[m(e("input",{class:P(["input is-small",{"has-background-danger-light":!t.value.data.command,"has-text-danger-dark":!t.value.data.command}]),type:"text","onUpdate:modelValue":[s[5]||(s[5]=n=>t.value.data.command=n),s[6]||(s[6]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,2),[[y,t.value.data.command]]),Qp]),e("div",Zp,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[7]||(s[7]=(...n)=>t.emitRemove&&t.emitRemove(...n))},tg,8,jp)])])):v("",!0),t.value.type==="timer"?(a(),o("div",eg,[e("div",sg,[e("button",{class:"button is-small",disabled:!t.removable,onClick:s[8]||(s[8]=(...n)=>t.emitRemove&&t.emitRemove(...n))},ag,8,ng)]),e("div",og,[lg,e("div",rg,[m(e("input",{class:"input is-small","onUpdate:modelValue":[s[9]||(s[9]=n=>t.value.data.minLines=n),s[10]||(s[10]=(...n)=>t.emitUpdate&&t.emitUpdate(...n))]},null,512),[[y,t.value.data.minLines]]),dg]),ug,e("div",mg,[w(h,{modelValue:t.value.data.minInterval,"onUpdate:modelValue":s[11]||(s[11]=n=>{t.value.data.minInterval=n,t.emitUpdate()})},null,8,["modelValue"]),hg])]),cg])):v("",!0)])}var gg=S(Mp,[["render",pg],["__scopeId","data-v-d4f9a1f6"]]);const fg=V({props:{playlist:Array,filter:Object},data:()=>({hideFilteredOut:!0,filterTagInput:"",tagInput:"",tagInputIdx:-1}),methods:{toggleVisibility(t,s){t.hidevideo?this.sendCtrl("videoVisibility",[!0,s]):this.sendCtrl("videoVisibility",[!1,s])},dragEnd(t){this.sendCtrl("move",[t.oldIndex,t.newIndex])},applyFilter(t){this.$emit("filterChange",t)},sendCtrl(t,s){this.$emit("ctrl",[t,s])},isFilteredOut(t){return this.filter.tag!==""&&!t.tags.includes(this.filter.tag)},startAddTag(t){this.tagInputIdx=t,this.$nextTick(()=>{this.$el.querySelector("table .filter-tag-input").focus()})}},computed:{enhancedPlaylist(){return this.playlist.map(t=>(t.filteredOut=this.isFilteredOut(t),t))},firstIndex(){return this.filter.tag===""?0:this.playlist.findIndex(t=>t.tags.includes(this.filter.tag))}},watch:{playlist:function(t,s){t.find(i=>!this.isFilteredOut(i))||this.$emit("stopPlayer")},filter:function(t,s){this.playlist.find(i=>!this.isFilteredOut(i))||this.$emit("stopPlayer")}}}),B=t=>(H("data-v-c0843896"),t=t(),K(),t),vg={class:"filters"},yg={class:"currentfilter"},bg=B(()=>e("div",{class:"mr-1"},"Filter:",-1)),_g=B(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),$g={key:1,class:"field has-addons mr-1 mb-0"},wg={class:"control"},kg={class:"control"},Cg={class:"pt-1"},Vg=g(" Hide filtered out"),Sg={key:0,class:"table is-striped"},Dg=B(()=>e("thead",null,[e("tr",null,[e("th"),e("th"),e("th"),e("th",null,"Title"),e("th",null,"User"),e("th",null,"Plays"),e("th"),e("th"),e("th"),e("th")])],-1)),Ig=B(()=>e("td",{class:"pt-4 handle"},[e("i",{class:"fa fa-arrows"})],-1)),Ug=["disabled","onClick"],Ag=B(()=>e("i",{class:"fa fa-play"},null,-1)),Pg=[Ag],Tg=["href"],Ng=B(()=>e("i",{class:"fa fa-external-link"},null,-1)),Og=["onClick"],Fg=B(()=>e("i",{class:"fa fa-remove ml-1"},null,-1)),Eg=["onClick"],Mg=B(()=>e("i",{class:"fa fa-plus"},null,-1)),Lg=[Mg],zg={key:0,class:"field has-addons"},qg={class:"control"},Rg=["onKeyup"],Jg={class:"control"},Bg=["disabled","onClick"],Wg=["onClick","title"],Hg=["onClick"],Kg=B(()=>e("i",{class:"fa fa-thumbs-up mr-1"},null,-1)),Gg=["onClick"],Yg=B(()=>e("i",{class:"fa fa-thumbs-down mr-1"},null,-1)),Xg=["onClick"],Qg=B(()=>e("i",{class:"fa fa-trash"},null,-1)),Zg=[Qg],jg={key:1};function xg(t,s,i,r,c,b){const h=_("draggable");return a(),o("div",null,[e("div",vg,[e("div",yg,[bg,t.filter.tag?(a(),o("span",{key:0,class:"tag mr-1",onClick:s[0]||(s[0]=n=>t.applyFilter(""))},[g($(t.filter.tag)+" ",1),_g])):(a(),o("div",$g,[e("div",wg,[m(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[1]||(s[1]=n=>t.filterTagInput=n),onKeyup:s[2]||(s[2]=X(n=>t.applyFilter(t.filterTagInput),["enter"]))},null,544),[[y,t.filterTagInput]])]),e("div",kg,[e("span",{class:"button is-small",onClick:s[3]||(s[3]=n=>t.applyFilter(t.filterTagInput))},"Apply filter")])])),e("label",Cg,[m(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=n=>t.hideFilteredOut=n)},null,512),[[q,t.hideFilteredOut]]),Vg])])]),t.playlist.length>0?(a(),o("table",Sg,[Dg,w(h,{modelValue:t.enhancedPlaylist,onEnd:t.dragEnd,tag:"tbody",handle:".handle","item-key":"id"},{item:z(({element:n,index:l})=>[m(e("tr",null,[Ig,e("td",null,$(l+1),1),e("td",null,[l!==t.firstIndex?(a(),o("button",{key:0,class:"button is-small",disabled:n.filteredOut?!0:null,onClick:u=>t.sendCtrl("playIdx",[l]),title:"Play"},Pg,8,Ug)):v("",!0)]),e("td",null,[e("a",{href:"https://www.youtube.com/watch?v="+n.yt,target:"_blank"},[g($(n.title||n.yt)+" ",1),Ng],8,Tg),e("div",null,[(a(!0),o(D,null,A(n.tags,(u,f)=>(a(),o("span",{key:f,class:"tag",onClick:k=>t.sendCtrl("rmtag",[u,l])},[g($(u)+" ",1),Fg],8,Og))),128)),e("span",{class:"button is-small",onClick:u=>t.startAddTag(l)},Lg,8,Eg)]),t.tagInputIdx===l?(a(),o("div",zg,[e("div",qg,[m(e("input",{class:"input is-small filter-tag-input",type:"text","onUpdate:modelValue":s[5]||(s[5]=u=>t.tagInput=u),onKeyup:X(u=>{t.sendCtrl("addtag",[t.tagInput,l]),t.tagInput=""},["enter"])},null,40,Rg),[[y,t.tagInput]])]),e("div",Jg,[e("span",{class:"button is-small",disabled:t.tagInput?null:!0,onClick:u=>{t.sendCtrl("addtag",[t.tagInput,l]),t.tagInput=""}},"Add tag",8,Bg)])])):v("",!0)]),e("td",null,$(n.user),1),e("td",null,$(n.plays)+"x",1),e("td",null,[e("button",{class:"button is-small",onClick:u=>t.toggleVisibility(n,l),title:n.hidevideo?"Video hidden":"Video visible"},[e("i",{class:P(["fa mr-1",{"fa-eye":!n.hidevideo,"fa-eye-slash":n.hidevideo}])},null,2)],8,Wg)]),e("td",null,[e("button",{class:"button is-small",onClick:u=>t.sendCtrl("goodIdx",[l])},[Kg,g(" "+$(n.goods),1)],8,Hg)]),e("td",null,[e("button",{class:"button is-small",onClick:u=>t.sendCtrl("badIdx",[l])},[Yg,g(" "+$(n.bads),1)],8,Gg)]),e("td",null,[e("button",{class:"button is-small",onClick:u=>t.sendCtrl("rmIdx",[l]),title:"Remove"},Zg,8,Xg)])],512),[[ot,!t.hideFilteredOut||!n.filteredOut]])]),_:1},8,["modelValue","onEnd"])])):(a(),o("div",jg,"Playlist is empty"))])}var tf=S(fg,[["render",xg],["__scopeId","data-v-c0843896"]]);const ef=V({props:{modelValue:{type:Object,required:!0}},emits:{"update:modelValue":null},created(){this.settings=this.modelValue},methods:{loadPreset(t){const s=this.settings.customCssPresets.find(i=>i.name===t);s?(this.settings.customCss=s.css,this.settings.showProgressBar=s.showProgressBar,this.settings.showThumbnails=s.showThumbnails,this.settings.maxItemsShown=s.maxItemsShown):console.warn(`preset not found: ${t}`),this.sendSettings()},removePreset(t){this.settings.customCssPresets=this.settings.customCssPresets.filter(s=>s.name!==t),this.sendSettings()},savePreset(){const t=this.settings.customCssPresets.findIndex(s=>s.name===this.cssPresetName);t>=0?(this.settings.customCssPresets[t].css=this.settings.customCss,this.settings.customCssPresets[t].showProgressBar=this.settings.showProgressBar,this.settings.customCssPresets[t].showThumbnails=this.settings.showThumbnails,this.settings.customCssPresets[t].maxItemsShown=this.settings.maxItemsShown):this.settings.customCssPresets.push({name:this.cssPresetName,css:this.settings.customCss,showProgressBar:this.settings.showProgressBar,showThumbnails:this.settings.showThumbnails,maxItemsShown:this.settings.maxItemsShown}),this.sendSettings()},hideVideoImageChanged(t){this.settings.hideVideoImage=t,this.sendSettings()},sendSettings(){this.$emit("update:modelValue",this.settings)}},data:()=>({cssPresetName:"",cssPresetDropdownActive:!1,settings:{volume:100,hideVideoImage:{file:"",filename:""},initAutoplay:!0,showThumbnails:!1,maxItemsShown:0,showProgressBar:!1,customCssPresets:[],customCss:""},css:{classExamples:[{class:".wrapper",desc:"Wrapper for everything"},{class:".player",desc:"The player"},{class:".list",desc:"The playlist"},{class:".item",desc:"A playlist item"},{class:".playing",desc:"Currently playing item"},{class:".not-playing",desc:"Queued items"},{class:".title",desc:"Wrapper for the title of a playlist item"},{class:".title-content",desc:"Title texts"},{class:".title-orig",desc:"Title text displayed by default"},{class:".title-dupl",desc:"Title text duplicated, useful for marquee effect"},{class:".vote",desc:"Vote elements"},{class:".vote-up",desc:"Up vote element"},{class:".vote-down",desc:"Down vote element"},{class:".meta",desc:"Meta info about an item"},{class:".meta-user",desc:"User who requested the song"},{class:".meta-plays",desc:"How many times the song was played"}],codeExamples:[{desc:"Hide Player:",code:".player { position: absolute; }"},{desc:"Change font to external font:",code:`@import url('https://fonts.googleapis.com/css2?family=Shadows+Into+Light');
body { font-family: 'Shadows into Light'; font-size: 30px; }`},{desc:"Change colors of items:",code:`.playing { background: #222; color: #bbb; }
.not-playing { background: #eee; color: #444; }`},{desc:"Display something in front of the currently playing item title:",code:".playing .title:before { content: '\u{1F3B6} Now Playing \u{1F3B6} ' }"},{desc:"Add a margin between the items:",code:".item { margin-bottom: 20px; }"},{desc:"Hide votes and meta:",code:".vote, .meta { display: none; }"},{desc:"Hide down votes:",code:".vote-down { display: none; }"},{desc:"Hite all items starting from the 6th:",code:".item:nth-child(n+6) { display: none; }"},{desc:"Show only titles and marquee the current song:",code:`.playing .title { overflow: hidden; white-space: nowrap; height: 20px; line-height: 20px; }
.playing .title-content { position: absolute; padding: 0 10px; min-width: 100%; animation: init 5s linear, back 10s linear 5s infinite; }
.playing .title-content.title-dupl { display: block; animation: back 10s linear 0s infinite; }
.title { margin-bottom: 0; }
.meta-left, .meta-right, .thumbnail { display: none; }
@keyframes back {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
@keyframes init {
    to { transform: translateX(-100%); }
}`},{desc:"Replace icon for thumbs-up with an image",code:`.meta-right .vote-up { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }
.meta-right .vote-up .fa { display: none; }`},{desc:"Remove text before/after username",code:`.meta-user-text-before,
.meta-user-text-after {display: none}`},{desc:"Add a fontawesome icon before username (\\f075 is the icon unicode, refer to https://fontawesome.com/v4.7/icons/)",code:'.meta-user-name::before { content: "\\f075"; display: inline-block; font: normal normal normal 14px/1 FontAwesome; font-size: inherit; margin-right: .5em; }'},{desc:"Add an image icon before username",code:".meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }"},{desc:"Add an image icon before username for specific user only",code:`[data-user="nc_para_" i] .meta-user-name { background: url('https://hyottoko.club/assets/hyottoko.30d2bcb9.png') no-repeat 0 center; background-size: 1em; padding-left: 1.2em; }`},{desc:"Change item display depending on username (this one changes background and makes thumbnails black boxes)",code:`[data-user="nc_para_" i] { background: #dd0066; }
[data-user="nc_para_" i] .thumbnail img { display: none; }
[data-user="nc_para_" i] .thumbnail { background: black; }`},{desc:"Show player left of the playlist (and limit its height to 320px)",code:`.wrapper { display: grid; grid-template-areas: "player playlist"; grid-template-columns: 50% auto; grid-template-rows: 320px; }
.player iframe { height: 320px; }`},{desc:"Show thumbnails only, and display meta info above them",code:`.item { display: block; position: relative; padding: 0; color: white; }
.title, .meta-left, .meta-right { position: absolute; padding: .2em; background: rgba(244,0,90,.9); }
.meta-left { top: 0; left: 0; font-size: 1em; }
.meta-right { top: 0; right: 0; font-size: 1em; }
.title { bottom: 0; left: 0; right: 0; margin-bottom: 0; }
.thumbnail { width: auto; }`},{desc:"Align thumbnails to the bottom",code:".thumbnail { align-self: end; }"},{desc:"Align thumbnails to the center",code:".thumbnail { align-self: center; }"},{desc:"Add a margin/padding to the thumbnails",code:".thumbnail { padding: 20px; }"},{desc:"Show number of plays not at player, but in icon form on the right near votes",code:`.meta-left .meta-user:after,
.meta-left .meta-plays { display: none; }
.meta-right .meta-plays { display: inline-block; }`},{desc:"Show the progress bar only, and no video (progress bar above list)",code:`
.player { height: 5px; padding-bottom: 0; }
.progress { height: 5px; }`},{desc:"Show the progress bar only, and no video (progress bar below list)",code:`
.wrapper { display: grid; grid-template-areas: "list" "player"; }
.player { height: 5px; padding-bottom: 0; grid-area: player }
.list { grid-area: list }
.progress { height: 5px; }`}]}})}),F=t=>(H("data-v-75499e97"),t=t(),K(),t),sf={key:0,class:"table is-striped",ref:"table"},nf=F(()=>e("tr",null,[e("td",{colspan:"3"},"General")],-1)),af=F(()=>e("td",null,[e("code",null,"settings.volume")],-1)),of=F(()=>e("td",null,"Base volume for all songs played.",-1)),lf=F(()=>e("td",null,[e("code",null,"settings.initAutoplay")],-1)),rf=F(()=>e("td",null,"If checked, the widget will autoplay when first opened.",-1)),df=F(()=>e("td",null,[e("code",null,"settings.hideVideoImage")],-1)),uf=F(()=>e("td",null,"Image to display when a video is hidden.",-1)),mf=F(()=>e("tr",null,[e("td",{colspan:"3"},"Visuals")],-1)),hf=F(()=>e("td",null,[e("code",null,"settings.showProgressBar")],-1)),cf=F(()=>e("td",null,"Render a progress bar in the bottom part of the video in the widget.",-1)),pf=F(()=>e("td",null,[e("code",null,"settings.showThumbnails")],-1)),gf={class:"mr-1"},ff=g("Off"),vf={class:"mr-1"},yf=g("Left"),bf={class:"mr-1"},_f=g("Right"),$f=F(()=>e("td",null,"Render video thumbnails in the widget.",-1)),wf=F(()=>e("td",null,[e("code",null,"settings.maxItemsShown")],-1)),kf=F(()=>e("td",null,"Max. number of items displayed in the playlist. Set to -1 for no limit.",-1)),Cf=F(()=>e("code",null,"settings.customCss",-1)),Vf={class:"field has-addons mr-1"},Sf={class:"control is-expanded"},Df={class:"control"},If=["onClick"],Uf=["onClick"],Af=F(()=>e("i",{class:"fa fa-remove"},null,-1)),Pf=[Af],Tf=F(()=>e("p",null,"Classes that can be used for styling:",-1)),Nf={class:"table"},Of=F(()=>e("thead",null,[e("tr",null,[e("th",null,"Class"),e("th",null,"Description")])],-1)),Ff=F(()=>e("p",null,[e("b",null,"Examples:")],-1));function Ef(t,s,i,r,c,b){const h=_("volume-slider"),n=_("image-upload");return a(),o("div",null,[t.settings?(a(),o("table",sf,[e("tbody",null,[nf,e("tr",null,[af,e("td",null,[w(h,{modelValue:t.settings.volume,"onUpdate:modelValue":[s[0]||(s[0]=l=>t.settings.volume=l),t.sendSettings]},null,8,["modelValue","onUpdate:modelValue"])]),of]),e("tr",null,[lf,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[1]||(s[1]=l=>t.settings.initAutoplay=l),s[2]||(s[2]=(...l)=>t.sendSettings&&t.sendSettings(...l))]},null,512),[[q,t.settings.initAutoplay]])]),rf]),e("tr",null,[df,e("td",null,[w(n,{modelValue:t.settings.hideVideoImage,"onUpdate:modelValue":[s[3]||(s[3]=l=>t.settings.hideVideoImage=l),t.hideVideoImageChanged],width:"100px",height:"50px",class:"mb-1"},null,8,["modelValue","onUpdate:modelValue"])]),uf]),mf,e("tr",null,[hf,e("td",null,[m(e("input",{type:"checkbox","onUpdate:modelValue":[s[4]||(s[4]=l=>t.settings.showProgressBar=l),s[5]||(s[5]=(...l)=>t.sendSettings&&t.sendSettings(...l))]},null,512),[[q,t.settings.showProgressBar]])]),cf]),e("tr",null,[pf,e("td",null,[e("label",gf,[m(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[6]||(s[6]=l=>t.settings.showThumbnails=l),s[7]||(s[7]=(...l)=>t.sendSettings&&t.sendSettings(...l))],value:!1},null,512),[[tt,t.settings.showThumbnails]]),ff]),e("label",vf,[m(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[8]||(s[8]=l=>t.settings.showThumbnails=l),s[9]||(s[9]=(...l)=>t.sendSettings&&t.sendSettings(...l))],value:"left"},null,512),[[tt,t.settings.showThumbnails]]),yf]),e("label",bf,[m(e("input",{class:"mr-1",type:"radio","onUpdate:modelValue":[s[10]||(s[10]=l=>t.settings.showThumbnails=l),s[11]||(s[11]=(...l)=>t.sendSettings&&t.sendSettings(...l))],value:"right"},null,512),[[tt,t.settings.showThumbnails]]),_f])]),$f]),e("tr",null,[wf,e("td",null,[m(e("input",{type:"number",min:"-1","onUpdate:modelValue":[s[12]||(s[12]=l=>t.settings.maxItemsShown=l),s[13]||(s[13]=(...l)=>t.sendSettings&&t.sendSettings(...l))]},null,512),[[y,t.settings.maxItemsShown]])]),kf]),e("tr",null,[e("td",null,[Cf,e("div",Vf,[e("div",Sf,[m(e("input",{class:"input is-small","onUpdate:modelValue":s[14]||(s[14]=l=>t.cssPresetName=l),onFocus:s[15]||(s[15]=l=>t.cssPresetDropdownActive=!0),onBlur:s[16]||(s[16]=l=>t.cssPresetDropdownActive=!1)},null,544),[[y,t.cssPresetName]])]),e("div",Df,[e("span",{class:"button is-small",onClick:s[17]||(s[17]=(...l)=>t.savePreset&&t.savePreset(...l))},"Save preset")])]),(a(!0),o(D,null,A(t.settings.customCssPresets,(l,u)=>(a(),o("div",{class:"mb-1",key:u},[e("span",{class:"button is-small",onClick:f=>t.loadPreset(l.name)},$(l.name),9,If),e("span",{class:"button is-small ml-1",onClick:f=>t.removePreset(l.name)},Pf,8,Uf)]))),128))]),e("td",null,[m(e("textarea",{class:"textarea","onUpdate:modelValue":[s[18]||(s[18]=l=>t.settings.customCss=l),s[19]||(s[19]=(...l)=>t.sendSettings&&t.sendSettings(...l))]},null,512),[[y,t.settings.customCss]])]),e("td",null,[Tf,e("table",Nf,[Of,e("tbody",null,[(a(!0),o(D,null,A(t.css.classExamples,(l,u)=>(a(),o("tr",{key:u},[e("td",null,[e("code",null,$(l.class),1)]),e("td",null,$(l.desc),1)]))),128))])]),Ff,(a(!0),o(D,null,A(t.css.codeExamples,(l,u)=>(a(),o("p",{key:u},[g($(l.desc)+" ",1),e("pre",null,[e("code",null,$(l.code),1)])]))),128))])])])],512)):v("",!0)])}var Mf=S(ef,[["render",Ef],["__scopeId","data-v-75499e97"]]);const Lf=V({props:{tags:Array},data:()=>({editTag:"",tagEditIdx:-1}),methods:{onInputFocus(t,s){this.editTag=t.value,this.tagEditIdx=s},updateTag(t,s){this.$emit("updateTag",[t,s])}}}),zf={class:"table is-striped"},qf=e("tr",null,[e("th",null,"Tag"),e("th"),e("th")],-1),Rf=["onKeyup"],Jf=["value","onFocus"],Bf=["disabled","onClick"];function Wf(t,s,i,r,c,b){return a(),o("table",zf,[qf,(a(!0),o(D,null,A(t.tags,(h,n)=>(a(),o("tr",{key:n},[e("td",null,[t.tagEditIdx===n?m((a(),o("input",{key:0,type:"text",class:"input is-small","onUpdate:modelValue":s[0]||(s[0]=l=>t.editTag=l),onKeyup:X(l=>t.updateTag(h.value,t.editTag),["enter"])},null,40,Rf)),[[y,t.editTag]]):(a(),o("input",{key:1,type:"text",class:"input is-small",value:h.value,onFocus:l=>t.onInputFocus(h,n)},null,40,Jf))]),e("td",null,[t.tagEditIdx===n?(a(),o("span",{key:0,class:"button is-small",disabled:h.value===t.editTag?!0:null,onClick:l=>t.updateTag(h.value,t.editTag)},"Save",8,Bf)):v("",!0)]),e("td",null,$(h.count)+"x",1)]))),128))])}var Hf=S(Lf,[["render",Wf]]);const Kf=V({props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","cancel"],data:()=>({item:null,itemStr:"null",newState:"",newSlotDefinitionName:""}),mounted(){this.itemStr=JSON.stringify(this.modelValue),this.item=JSON.parse(this.itemStr),this.adjustAllImagesDivSize(),window.addEventListener("resize",this.adjustAllImagesDivSize)},unmounted(){window.removeEventListener("resize",this.adjustAllImagesDivSize)},watch:{modelValue:{handler(t){this.item=JSON.parse(this.itemStr)}},item:{handler(t){this.itemStr=JSON.stringify(t)},deep:!0},itemStr:{handler(t){const s=JSON.stringify(this.item);try{const i=JSON.parse(t);s!==i&&(this.item=i)}catch(i){console.warn(i)}}}},computed:{allImages(){var s;const t=[];return(s=this.item)==null||s.slotDefinitions.forEach(i=>{i.items.forEach(r=>{r.states.forEach(c=>{c.frames.forEach(b=>{b.url&&!t.includes(b.url)&&t.push(b.url)})})})}),t},isStateAddable(){return!(!this.item||this.newState===""||this.item.stateDefinitions.find(({value:t})=>t===this.newState))}},methods:{autoDetectDimensions(){if(this.allImages.length===0)return;const t=new Image;t.onload=()=>{!this.item||(this.item.width=t.width,this.item.height=t.height)},t.src=this.allImages[0]},adjustAllImagesDivSize(){this.$nextTick(()=>{if(!this.$refs.cardBody||!this.$refs.allImagesDiv)return;const t=this.$refs.cardBody.clientHeight;this.$refs.allImagesDiv.style.maxHeight=`${t}px`})},imageDragStart(t){t.dataTransfer.setData("avatar-image-url",t.target.getAttribute("data-src"))},emitUpdate(){if(!this.item){console.warn("emitUpdate: this.item not initialized");return}this.$emit("update:modelValue",Ql({name:this.item.name,width:parseInt(`${this.item.width}`,10),height:parseInt(`${this.item.height}`,10),stateDefinitions:this.item.stateDefinitions,slotDefinitions:this.item.slotDefinitions,state:this.item.state}))},onSaveClick(){this.emitUpdate()},onSaveAndCloseClick(){this.emitUpdate(),this.$emit("cancel")},onCancelClick(){this.$emit("cancel")},onOverlayClick(){this.$emit("cancel")},onCloseClick(){this.$emit("cancel")},addStateDefinition(){if(!this.item){console.warn("addStateDefinition: this.item not initialized");return}const t={value:this.newState,deletable:!0};this.item.stateDefinitions.push(t);for(let s of this.item.slotDefinitions)for(let i of s.items)i.states.push({state:t.value,frames:[]})},removeStateDefinition(t){if(!this.item){console.warn("removeStateDefinition: this.item not initialized");return}const s=[];for(let r in this.item.stateDefinitions)parseInt(r,10)!==parseInt(`${t}`,10)&&s.push(this.item.stateDefinitions[r]);this.item.stateDefinitions=s;const i=s.map(r=>r.value);for(let r of this.item.slotDefinitions)for(let c of r.items)c.states=c.states.filter(b=>i.includes(b.state))},removeSlotDefinition(t){if(!this.item){console.warn("removeSlotDefinition: this.item not initialized");return}const s=[];for(let i in this.item.slotDefinitions)parseInt(i,10)!==parseInt(`${t}`,10)&&s.push(this.item.slotDefinitions[i]);this.item.slotDefinitions=s},updateSlotDefinition(t,s){if(!this.item){console.warn("updateSlotDefinition: this.item not initialized");return}this.item.slotDefinitions[parseInt(`${t}`,10)]=s},addSlotDefinition(){if(!this.item){console.warn("addSlotDefinition: this.item not initialized");return}const t={slot:"Unnamed slot",defaultItemIndex:-1,items:[]};this.item.slotDefinitions.push(t)},moveSlotUp(t){if(!this.item){console.warn("moveSlotUp: this.item not initialized");return}if(t<=0)return;const s=this.item.slotDefinitions[t-1];this.item.slotDefinitions[t-1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s},moveSlotDown(t){if(!this.item){console.warn("moveSlotDown: this.item not initialized");return}if(t>=this.item.slotDefinitions.length-1)return;const s=this.item.slotDefinitions[t+1];this.item.slotDefinitions[t+1]=this.item.slotDefinitions[t],this.item.slotDefinitions[t]=s}}}),Gf={key:0,class:"avatar-editor modal is-active"},Yf={class:"modal-card"},Xf={class:"modal-card-head"},Qf=e("p",{class:"modal-card-title"},"Edit Avatar",-1),Zf={class:"modal-card-body",ref:"cardBody"},jf={class:"columns"},xf={class:"column is-three-quarters"},tv={class:"table is-striped"},ev=e("td",null,"Name:",-1),sv=e("td",null,"Dimensions:",-1),nv=g("\u2716"),iv=g(" Pixels "),av=e("td",null,"States:",-1),ov=["onClick"],lv=e("i",{class:"fa fa-trash"},null,-1),rv=[lv],dv=["disabled"],uv=e("td",null,"Slots",-1),mv={class:"column"},hv=e("div",null,"JSON:",-1),cv=e("div",null,"All images in use:",-1),pv={class:"avatar-all-images",ref:"allImagesDiv"},gv=["src","data-src"],fv={class:"modal-card-foot"};function vv(t,s,i,r,c,b){const h=_("avatar-slot-definition-editor");return t.item?(a(),o("div",Gf,[e("div",{class:"modal-background",onClick:s[0]||(s[0]=(...n)=>t.onOverlayClick&&t.onOverlayClick(...n))}),e("div",Yf,[e("header",Xf,[Qf,e("button",{class:"delete","aria-label":"close",onClick:s[1]||(s[1]=(...n)=>t.onCloseClick&&t.onCloseClick(...n))})]),e("section",Zf,[e("div",jf,[e("div",xf,[e("table",tv,[e("tbody",null,[e("tr",null,[ev,e("td",null,[m(e("input",{class:"input is-small","onUpdate:modelValue":s[2]||(s[2]=n=>t.item.name=n)},null,512),[[y,t.item.name]])])]),e("tr",null,[sv,e("td",null,[m(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[3]||(s[3]=n=>t.item.width=n)},null,512),[[y,t.item.width]]),nv,m(e("input",{class:"input is-small number-input","onUpdate:modelValue":s[4]||(s[4]=n=>t.item.height=n)},null,512),[[y,t.item.height]]),iv,t.allImages.length?(a(),o("span",{key:0,class:"button is-small",onClick:s[5]||(s[5]=(...n)=>t.autoDetectDimensions&&t.autoDetectDimensions(...n))},"Auto-detect")):v("",!0)])]),e("tr",null,[av,e("td",null,[(a(!0),o(D,null,A(t.item.stateDefinitions,(n,l)=>(a(),o("span",{class:"tag",key:l},[e("span",null,$(n.value),1),n.deletable?(a(),o("span",{key:0,class:"ml-1 is-clickable",onClick:u=>t.removeStateDefinition(l)},rv,8,ov)):v("",!0)]))),128)),m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":s[6]||(s[6]=n=>t.newState=n),placeholder:"State"},null,512),[[y,t.newState]]),e("span",{class:"button is-small",onClick:s[7]||(s[7]=(...n)=>t.addStateDefinition&&t.addStateDefinition(...n)),disabled:t.isStateAddable?null:!0},"Add custom state",8,dv)])]),e("tr",null,[uv,e("td",null,[(a(!0),o(D,null,A(t.item.slotDefinitions,(n,l)=>(a(),O(h,{class:"card mb-2",key:l,modelValue:n,avatarDef:t.item,"onUpdate:modelValue":u=>t.updateSlotDefinition(l,u),onMoveUp:u=>t.moveSlotUp(l),onMoveDown:u=>t.moveSlotDown(l),onRemove:u=>t.removeSlotDefinition(l)},null,8,["modelValue","avatarDef","onUpdate:modelValue","onMoveUp","onMoveDown","onRemove"]))),128))])])])]),e("span",{class:"button is-small",onClick:s[8]||(s[8]=(...n)=>t.addSlotDefinition&&t.addSlotDefinition(...n))},"Add slot")]),e("div",mv,[hv,m(e("textarea",{class:"textarea mb-2","onUpdate:modelValue":s[9]||(s[9]=n=>t.itemStr=n)},null,512),[[y,t.itemStr]]),cv,e("div",pv,[(a(!0),o(D,null,A(t.allImages,(n,l)=>(a(),o("img",{key:l,src:n,draggable:"true",class:"mr-1 mb-1",onDragstart:s[10]||(s[10]=(...u)=>t.imageDragStart&&t.imageDragStart(...u)),"data-src":n},null,40,gv))),128))],512)])])],512),e("footer",fv,[e("button",{class:"button is-small is-primary",onClick:s[11]||(s[11]=(...n)=>t.onSaveClick&&t.onSaveClick(...n))}," Save "),e("button",{class:"button is-small is-primary",onClick:s[12]||(s[12]=(...n)=>t.onSaveAndCloseClick&&t.onSaveAndCloseClick(...n))}," Save and close "),e("button",{class:"button is-small",onClick:s[13]||(s[13]=(...n)=>t.onCancelClick&&t.onCancelClick(...n))},"Cancel")])])])):v("",!0)}var yv=S(Kf,[["render",vv]]);const bv=V({props:{modelValue:{type:Object,required:!0},avatarDef:{type:Object,required:!0}},emits:["update:modelValue","remove","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultItem(){return this.modelValue.defaultItemIndex>=0&&this.modelValue.items.length>this.modelValue.defaultItemIndex?this.modelValue.items[this.modelValue.defaultItemIndex]:null},defaultAnimation(){if(!this.defaultItem)return[];const t=this.defaultItem.states.find(({state:s})=>s==="default");return t?t.frames:[]}},methods:{emitChange(){this.$emit("update:modelValue",this.modelValue)},updateItem(t,s){this.modelValue.items[t]=s,this.emitChange()},removeItem(t,s){this.modelValue.items=this.modelValue.items.filter((i,r)=>r!==t),t<=this.modelValue.defaultItemIndex&&(this.modelValue.defaultItemIndex=this.modelValue.defaultItemIndex-1),this.modelValue.items.length>0&&this.modelValue.defaultItemIndex<0&&(this.modelValue.defaultItemIndex=0),this.emitChange()},makeItemDefault(t,s){this.modelValue.defaultItemIndex=t,this.emitChange()},addItem(){const t={title:`${this.modelValue.slot} item ${this.modelValue.items.length+1}`,states:this.avatarDef.stateDefinitions.map(s=>({state:s.value,frames:[]}))};this.modelValue.items.push(t),this.modelValue.defaultItemIndex===-1&&(this.modelValue.defaultItemIndex=0),this.emitChange()},moveItemUp(t){this.swapItems(t-1,t)},moveItemDown(t){this.swapItems(t+1,t)},swapItems(t,s){if(t<0||t>this.modelValue.items.length-1||s<0||s>this.modelValue.items.length-1)return;const i=this.modelValue.items[t];this.modelValue.items[t]=this.modelValue.items[s],this.modelValue.items[s]=i,this.modelValue.defaultItemIndex===t?this.modelValue.defaultItemIndex=s:this.modelValue.defaultItemIndex===s&&(this.modelValue.defaultItemIndex=t),this.modelValue.items=this.modelValue.items.slice()}}}),_v={class:"avatar-slot-definition-editor"},$v={class:"level avatar-slot-definition-editor-title p-1"},wv={class:"level-left"},kv={class:"level-item"},Cv={class:"level-item"},Vv={class:"level-right"},Sv={class:"level-item"},Dv={class:"level-item"},Iv={class:"level-item"},Uv=e("i",{class:"fa fa-trash"},null,-1),Av=[Uv],Pv={class:"p-1"};function Tv(t,s,i,r,c,b){const h=_("avatar-animation"),n=_("avatar-slot-item-editor");return a(),o("div",_v,[e("div",$v,[e("div",wv,[e("div",kv,[w(h,{frames:t.defaultAnimation,width:32,height:32},null,8,["frames"])]),e("div",Cv,[m(e("input",{class:P(["input is-small avatar-slot-definition-editor-title-input",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=l=>t.titleFocused=!0),onBlur:s[1]||(s[1]=l=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=l=>t.modelValue.slot=l)},null,34),[[y,t.modelValue.slot]])])]),e("div",Vv,[e("div",Sv,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[3]||(s[3]=l=>t.$emit("moveUp"))})]),e("div",Dv,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[4]||(s[4]=l=>t.$emit("moveDown"))})]),e("div",Iv,[e("span",{class:"button is-small",onClick:s[5]||(s[5]=l=>t.$emit("remove"))},Av)])])]),e("div",Pv,[(a(!0),o(D,null,A(t.modelValue.items,(l,u)=>(a(),O(n,{class:P(["card mb-1",{"is-default":u===this.modelValue.defaultItemIndex}]),key:u,modelValue:l,isDefault:u===this.modelValue.defaultItemIndex,onMoveUp:f=>t.moveItemUp(u),onMoveDown:f=>t.moveItemDown(u),"onUpdate:modelValue":f=>t.updateItem(u,f),onRemove:f=>t.removeItem(u,f),onMakeDefault:f=>t.makeItemDefault(u,f)},null,8,["class","modelValue","isDefault","onMoveUp","onMoveDown","onUpdate:modelValue","onRemove","onMakeDefault"]))),128))]),e("span",{class:"button is-small",onClick:s[6]||(s[6]=(...l)=>t.addItem&&t.addItem(...l))},"Add item")])}var Nv=S(bv,[["render",Tv]]);const Ov=V({props:{modelValue:{type:Object,required:!0},isDefault:{type:Boolean,required:!0}},emits:["update:modelValue","makeDefault","moveUp","moveDown"],data:()=>({titleFocused:!1}),computed:{defaultState(){return this.modelValue.states.find(({state:t})=>t==="default")}},methods:{updateAnimation(t,s){},makeDefault(){this.$emit("makeDefault",this.modelValue)}}}),Fv={class:"avatar-slot-item-editor p-1"},Ev={class:"level"},Mv={class:"level-left"},Lv={class:"level-item"},zv={class:"level-item"},qv={key:0,class:"has-text-success mr-1"},Rv=e("i",{class:"fa fa-check"},null,-1),Jv=g(" Default"),Bv=[Rv,Jv],Wv={class:"level-right"},Hv={class:"level-item"},Kv={class:"level-item"},Gv={class:"level-item"},Yv=e("i",{class:"fa fa-trash"},null,-1),Xv=[Yv];function Qv(t,s,i,r,c,b){const h=_("avatar-slot-item-state-editor");return a(),o("div",Fv,[e("div",Ev,[e("div",Mv,[e("div",Lv,[m(e("input",{type:"text",class:P(["input is-small avatar-slot-item-editor-title",{"is-static":!t.titleFocused}]),onFocus:s[0]||(s[0]=n=>t.titleFocused=!0),onBlur:s[1]||(s[1]=n=>t.titleFocused=!1),"onUpdate:modelValue":s[2]||(s[2]=n=>t.modelValue.title=n)},null,34),[[y,t.modelValue.title]])]),e("div",zv,[t.isDefault?(a(),o("span",qv,Bv)):(a(),o("span",{key:1,class:"button is-small",onClick:s[3]||(s[3]=(...n)=>t.makeDefault&&t.makeDefault(...n))},"Make default"))])]),e("div",Wv,[e("div",Hv,[e("i",{class:"fa fa-chevron-up is-clickable ml-1",onClick:s[4]||(s[4]=n=>t.$emit("moveUp"))})]),e("div",Kv,[e("i",{class:"fa fa-chevron-down is-clickable ml-1",onClick:s[5]||(s[5]=n=>t.$emit("moveDown"))})]),e("div",Gv,[e("span",{class:"button is-small",onClick:s[6]||(s[6]=n=>t.$emit("remove"))},Xv)])])]),(a(!0),o(D,null,A(t.modelValue.states,(n,l)=>(a(),O(h,{class:"mr-1",modelValue:n,defaultState:t.defaultState,"onUpdate:modelValue":u=>t.updateAnimation(l,u),key:l},null,8,["modelValue","defaultState","onUpdate:modelValue"]))),128))])}var Zv=S(Ov,[["render",Qv]]);const jv=V({props:{avatar:{type:Object,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},computed:{animations(){return this.avatar.slotDefinitions.map(t=>{const s=t.items[t.defaultItemIndex];return s?s.states.find(({state:i})=>i==="default"):{title:"",states:[]}})}}});function xv(t,s,i,r,c,b){const h=_("avatar-animation");return a(),o("div",{class:"avatar-preview",style:Q({width:`${t.width}px`,height:`${t.height}px`})},[(a(!0),o(D,null,A(t.animations,(n,l)=>(a(),O(h,{frames:n.frames,key:l,width:t.width,height:t.height},null,8,["frames","width","height"]))),128))],4)}var t1=S(jv,[["render",xv]]);const e1=V({props:{modelValue:{type:Object,required:!0},defaultState:{type:Object,required:!0}},data(){return{draggingOver:!1,editing:!1}},methods:{onDragOver(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragLeave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1},onDragEnter(t){t.dataTransfer.getData("avatar-image-url")&&t.preventDefault()},onDrop(t){if(this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),t.dataTransfer.getData("avatar-image-url")){const i={url:t.dataTransfer.getData("avatar-image-url"),duration:100};this.modelValue.frames.push(i)}else{let i=null;if(t.dataTransfer.items){for(var s=0;s<t.dataTransfer.items.length;s++)if(t.dataTransfer.items[s].kind==="file"){i=t.dataTransfer.items[s].getAsFile();break}}else for(var s=0;s<t.dataTransfer.files.length;s++){i=t.dataTransfer.files[s];break}i&&this.$refs.uploadComponent.uploadFile(i)}return!1},onUploaded(t){this.modelValue.frames.push({url:t.urlpath,duration:100})},onOverlayClick(){this.editing=!1},frameChanged(t,s){s.url===""?this.modelValue.frames=this.modelValue.frames.filter((i,r)=>r!==t):this.modelValue.frames[t]=s},addFrame(){const t={url:"",duration:100};this.modelValue.frames.push(t)}}}),s1={class:"avatar-slot-item-state-editor-title"},n1={class:"avatar-animation-card mr-1"},i1={class:"avatar-animation-frame"},a1=e("i",{class:"fa fa-plus"},null,-1),o1=[a1];function l1(t,s,i,r,c,b){const h=_("avatar-animation"),n=_("avatar-frame-upload"),l=_("upload");return a(),o("div",{class:P(["avatar-slot-item-state-editor card",{"dragging-over":t.draggingOver}]),onDragover:s[1]||(s[1]=(...u)=>t.onDragOver&&t.onDragOver(...u)),onDragenter:s[2]||(s[2]=(...u)=>t.onDragEnter&&t.onDragEnter(...u)),onDragleave:s[3]||(s[3]=(...u)=>t.onDragLeave&&t.onDragLeave(...u)),onDrop:s[4]||(s[4]=(...u)=>t.onDrop&&t.onDrop(...u))},[e("div",s1,$(t.modelValue.state),1),t.modelValue.frames.length?(a(),O(h,{key:0,frames:t.modelValue.frames},null,8,["frames"])):(a(),O(h,{key:1,frames:t.defaultState.frames,class:"avatar-fallback-animation"},null,8,["frames"])),e("div",null,[(a(!0),o(D,null,A(t.modelValue.frames,(u,f)=>(a(),o("div",{class:"avatar-animation-card mr-1",key:f},[w(n,{modelValue:u,"onUpdate:modelValue":k=>t.frameChanged(f,k)},null,8,["modelValue","onUpdate:modelValue"])]))),128)),e("div",n1,[e("span",i1,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...u)=>t.addFrame&&t.addFrame(...u))},o1)])])]),m(w(l,{onUploaded:t.onUploaded,accept:"image/*",label:"",ref:"uploadComponent"},null,8,["onUploaded"]),[[ot,!1]])],34)}var r1=S(e1,[["render",l1]]);const d1=V({props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{value:{url:"",duration:100},draggingOver:!1}},created(){this.applyValue()},watch:{modelValue(){this.applyValue()}},methods:{applyValue(){this.modelValue!==null?this.value=JSON.parse(JSON.stringify(this.modelValue)):this.value={url:"",duration:100}},emitUpdate(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onDurationChange(){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))},onRemove(){this.value={url:"",duration:100},this.emitUpdate()},onUploaded(t){this.value={url:t.urlpath,duration:100},this.emitUpdate()},onDrop(t){this.draggingOver=!1,t.preventDefault(),t.stopPropagation();let s=null;if(t.dataTransfer.items){for(var i=0;i<t.dataTransfer.items.length;i++)if(t.dataTransfer.items[i].kind==="file"){s=t.dataTransfer.items[i].getAsFile();break}}else for(var i=0;i<t.dataTransfer.files.length;i++){s=t.dataTransfer.files[i];break}return s&&(this.value.url="",this.$refs.uploadComponent.uploadFile(s)),!1},onDragover(t){return this.draggingOver=!0,t.preventDefault(),t.stopPropagation(),!1},onDragleave(t){return this.draggingOver=!1,t.preventDefault(),t.stopPropagation(),!1}}}),u1=t=>(H("data-v-345011c1"),t=t(),K(),t),m1={class:"avatar-animation-frame-remove"},h1=u1(()=>e("i",{class:"fa fa-trash"},null,-1)),c1=[h1],p1=["src"];function g1(t,s,i,r,c,b){const h=_("upload");return a(),o("span",{onDrop:s[3]||(s[3]=(...n)=>t.onDrop&&t.onDrop(...n)),onDragover:s[4]||(s[4]=(...n)=>t.onDragover&&t.onDragover(...n)),onDragleave:s[5]||(s[5]=(...n)=>t.onDragleave&&t.onDragleave(...n)),class:P(["avatar-animation-frame",{"dragging-over":t.draggingOver}])},[e("div",m1,[e("span",{class:"button is-small",onClick:s[0]||(s[0]=(...n)=>t.onRemove&&t.onRemove(...n))},c1)]),t.value.url?(a(),o("img",{key:0,src:t.value.url,width:"64",height:"64"},null,8,p1)):v("",!0),m(w(h,{onUploaded:t.onUploaded,accept:"image/*",label:"",class:"avatar-animation-frame-upload",ref:"uploadComponent"},null,8,["onUploaded"]),[[ot,!t.value.url]]),m(e("input",{class:"input is-small",type:"text","onUpdate:modelValue":[s[1]||(s[1]=n=>t.value.duration=n),s[2]||(s[2]=(...n)=>t.onDurationChange&&t.onDurationChange(...n))]},null,512),[[y,t.value.duration]])],34)}var f1=S(d1,[["render",g1],["__scopeId","data-v-345011c1"]]);const v1=V({props:{frames:{type:Array,required:!0},width:{type:Number,required:!1,default:64},height:{type:Number,required:!1,default:64}},data(){return{timeout:null,idx:-1}},computed:{src(){return this.idx>=0&&this.idx<this.frames.length?this.frames[this.idx].url:""}},methods:{nextFrame(){if(this.frames.length===0){this.idx=-1;return}this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.idx++,this.idx>=this.frames.length&&(this.idx=0),this.timeout=setTimeout(()=>{this.nextFrame()},this.frames[this.idx].duration)}},created(){this.nextFrame(),this.$watch("frames",()=>{this.idx=-1,this.nextFrame()},{deep:!0})},unmounted(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}),y1=["src","width","height"];function b1(t,s,i,r,c,b){return a(),o("span",{class:"avatar-animation",style:Q({width:`${t.width}px`,height:`${t.width}px`})},[t.src?(a(),o("img",{key:0,src:t.src,width:t.width,height:t.height},null,8,y1)):(a(),o("span",{key:1,style:Q({width:`${t.width}px`,height:`${t.width}px`,display:"inline-block"})},null,4))],4)}var _1=S(v1,[["render",b1]]);const $1=async()=>{const t=Xt({history:Qt(),routes:[{name:"index",path:"/",component:pe,meta:{title:"Hyottoko.club",protected:!0}},{name:"login",path:"/login",component:Oe,meta:{title:"Login",protected:!1}},{name:"register",path:"/register",component:Hn,meta:{title:"Register",protected:!1}},{name:"password-reset",path:"/password-reset",component:Qr,meta:{title:"Password Reset",protected:!1}},{name:"forgot-password",path:"/forgot-password",component:md,meta:{title:"Forgot Password",protected:!1}},{name:"commands",path:"/commands/",component:Ja,meta:{title:"Commands",protected:!0}},{name:"variables",path:"/variables/",component:cn,meta:{title:"Variables",protected:!0}},{name:"sr",path:"/sr/",component:Da,meta:{title:"Song Request",protected:!0}},{name:"speech-to-text",path:"/speech-to-text/",component:Xl,meta:{title:"Speech to text",protected:!0}},{name:"avatar",path:"/avatar/",component:Or,meta:{title:"Avatar",protected:!0}},{name:"drawcast",path:"/drawcast/",component:Qs,meta:{title:"Drawcast",protected:!0}},{name:"settings",path:"/settings/",component:Mi,meta:{title:"Settings",protected:!0}}]});W.eventBus.on("login",()=>{Jt.init()}),W.eventBus.on("logout",()=>{Jt.stop()}),await Tt.init(),await W.init(),t.beforeEach((i,r,c)=>{if(i.meta.protected&&!W.getMe()){c({name:"login"});return}if(!i.meta.protected&&W.getMe()){c({name:"index"});return}r.name&&document.documentElement.classList.remove(`view-${String(r.name)}`),document.documentElement.classList.add(`view-${String(i.name)}`),document.title=`${i.meta.title}`,c()});const s=Zt(ie);s.use(t),s.use(jt,{}),s.component("doubleclick-button",Tu),s.component("dropdown-button",qu),s.component("checkbox",zd),s.component("draggable",xt),s.component("duration-input",Ed),s.component("duration",Iu),s.component("navbar",ku),s.component("player",Jd),s.component("responsive-image",au),s.component("slider",jd),s.component("upload",vd),s.component("image-upload",Vd),s.component("sound-upload",Nd),s.component("volume-slider",eu),s.component("youtube",Gu),s.component("commands-editor",Kc),s.component("command-editor",Lh),s.component("countdown-editor",Ep),s.component("trigger-editor",gg),s.component("playlist-editor",tf),s.component("tags-editor",Hf),s.component("song-request-settings",Mf),s.component("avatar-editor",yv),s.component("avatar-slot-definition-editor",Nv),s.component("avatar-slot-item-editor",Zv),s.component("avatar-preview",t1),s.component("avatar-slot-item-state-editor",r1),s.component("avatar-frame-upload",f1),s.component("avatar-animation",_1),s.mount("#app")};$1();
